<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>005_RDDsTransformationsActionsHOMEWORK - sds-3.x/ScaDaMaLe</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../scroll-mdbook-outputs.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/000_ScaDaMaLe.html">000_ScaDaMaLe</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/001_whySpark.html">001_whySpark</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/002_00_loginToDatabricks.html">002_00_loginToDatabricks</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/002_01_multiLingualNotebooks.html">002_01_multiLingualNotebooks</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/002_02_dbcCEdataLoader.html">002_02_dbcCEdataLoader</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/003_00_scalaCrashCourse.html">003_00_scalaCrashCourse</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/003_01_scalaCrashCourse.html">003_01_scalaCrashCourse</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/004_RDDsTransformationsActions.html">004_RDDsTransformationsActions</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/005_RDDsTransformationsActionsHOMEWORK.html" class="active">005_RDDsTransformationsActionsHOMEWORK</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/006_WordCount.html">006_WordCount</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x-spark/006a_PipedRDD.html">006a_PipedRDD</a></li><li class="chapter-item expanded affix "><a href="../../editors.html">Editors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">sds-3.x/ScaDaMaLe</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="homework-on-rdd-transformations-and-actions"><a class="header" href="#homework-on-rdd-transformations-and-actions">HOMEWORK on RDD Transformations and Actions</a></h1>
<p>Just go through the notebook and familiarize yourself with these transformations and actions. This will help you do the autograded Assignment.</p>
</div>
<div class="cell markdown">
<ol>
<li>Perform the <code>takeOrdered</code> action on the RDD</li>
</ol>
<hr />
<p>To illustrate <code>take</code> and <code>takeOrdered</code> actions, let's create a bigger RDD named <code>rdd0_1000000</code> that is made up of a million integers from 0 to 1000000.
We will <code>sc.parallelize</code> the <code>Seq</code> Scala collection by using its <code>.range(startInteger,stopInteger)</code> method.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd0_1000000 = sc.parallelize(Seq.range(0, 1000000)) // &lt;Shift+Enter&gt; to create an RDD of million integers: 0,1,2,...,10^6
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd0_1000000: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[39] at parallelize at command-4088905069025406:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd0_1000000.take(5) // &lt;Ctrl+Enter&gt; gives the first 5 elements of the RDD, (0, 1, 2, 3, 4)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res0: Array[Int] = Array(0, 1, 2, 3, 4)
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><code>takeordered(n)</code> returns <code>n</code> elements ordered in ascending order (by default) or as specified by the optional key function, as shown below.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd0_1000000.takeOrdered(5) // &lt;Shift+Enter&gt; is same as rdd0_1000000.take(5) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res1: Array[Int] = Array(0, 1, 2, 3, 4)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd0_1000000.takeOrdered(5)(Ordering[Int].reverse) // &lt;Ctrl+Enter&gt; to get the last 5 elements of the RDD 999999, 999998, ..., 999995
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res2: Array[Int] = Array(999999, 999998, 999997, 999996, 999995)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// HOMEWORK: edit the numbers below to get the last 20 elements of an RDD made of a sequence of integers from 669966 to 969696
sc.parallelize(Seq.range(0, 10)).takeOrdered(5)(Ordering[Int].reverse) // &lt;Ctrl+Enter&gt; evaluate this cell after editing it for the right answer
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res3: Array[Int] = Array(9, 8, 7, 6, 5)
</code></pre>
</div>
</div>
<div class="cell markdown">
<ol start="2">
<li>More examples of <code>map</code></li>
</ol>
<hr />
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd = sc.parallelize(Seq(1, 2, 3, 4))    // &lt;Shift+Enter&gt; to evaluate this cell (using default number of partitions)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[41] at parallelize at command-4088905069025413:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.map( x =&gt; x*2) // &lt;Ctrl+Enter&gt; to transform rdd by map that doubles each element
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res4: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[42] at map at command-4088905069025414:1
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>To see what's in the transformed RDD, let's perform the actions of <code>count</code> and <code>collect</code> on the <code>rdd.map( x =&gt; x*2)</code>, the transformation of <code>rdd</code> by the <code>map</code> given by the closure <code>x =&gt; x*2</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.map( x =&gt; x*2).count()    // &lt;Shift+Enter&gt; to perform count (action) the element of the RDD = 4
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res5: Long = 4
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.map( x =&gt; x*2).collect()    // &lt;Shift+Enter&gt; to perform collect (action) to show 2, 4, 6, 8
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res6: Array[Int] = Array(2, 4, 6, 8)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// HOMEWORK: uncomment the last line in this cell and modify the '&lt;Fill-In-Here&gt;' in the code below to collect and display the square (x*x) of each element of the RDD
// the answer should be Array[Int] = Array(1, 4, 9, 16) Press &lt;Cntrl+Enter&gt; to evaluate the cell after modifying '???'

//sc.parallelize(Seq(1, 2, 3, 4)).map( x =&gt; &lt;Fill-In-Here&gt; ).collect()
</code></pre>
</div>
<div class="cell markdown">
<ol start="3">
<li>More examples of <code>filter</code></li>
</ol>
<hr />
<p>Let's declare another <code>val</code> RDD named <code>rddFiltered</code> by transforming our first RDD named <code>rdd</code> via the <code>filter</code> transformation <code>x%2==0</code> (of being even).</p>
<p>This filter transformation based on the closure <code>x =&gt; x%2==0</code> will return <code>true</code> if the element, modulo two, equals zero. The closure is automatically passed on to the workers for evaluation (when an action is called later). So this will take our RDD of (1,2,3,4) and return RDD of (2, 4).</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rddFiltered = rdd.filter( x =&gt; x%2==0 )    // &lt;Ctrl+Enter&gt; to declare rddFiltered from transforming rdd
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rddFiltered: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[45] at filter at command-4088905069025420:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddFiltered.collect()    // &lt;Ctrl+Enter&gt; to collect (action) elements of rddFiltered; should be (2, 4)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res8: Array[Int] = Array(2, 4)
</code></pre>
</div>
</div>
<div class="cell markdown">
<ol start="4">
<li>More examples of <code>reduce</code></li>
</ol>
<hr />
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd = sc.parallelize(Array(1,2,3,4,5))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[46] at parallelize at command-4088905069025423:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.reduce( (x,y)=&gt;x+y ) // &lt;Shift+Enter&gt; to do reduce (action) to sum and return Int = 15
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res9: Int = 15
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.reduce( _ + _ )    // &lt;Shift+Enter&gt; to do same sum as above and return Int = 15 (undescore syntax)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res10: Int = 15
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd.reduce( (x,y)=&gt;x*y ) // &lt;Shift+Enter&gt; to do reduce (action) to multiply and return Int = 120
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res11: Int = 120
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd0_1000000 = sc.parallelize(Seq.range(0, 1000000)) // &lt;Shift+Enter&gt; to create an RDD of million integers: 0,1,2,...,10^6
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd0_1000000: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[47] at parallelize at command-4088905069025427:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd0_1000000.reduce( (x,y)=&gt;x+y ) // &lt;Ctrl+Enter&gt; to do reduce (action) to sum and return Int 1783293664
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res12: Int = 1783293664
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// the following correctly returns Int = 0 although for wrong reason 
// we have flowed out of Int's numeric limits!!! (but got lucky with 0*x=0 for any Int x)
// &lt;Shift+Enter&gt; to do reduce (action) to multiply and return Int = 0
rdd0_1000000.reduce( (x,y)=&gt;x*y ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res13: Int = 0
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// &lt;Ctrl+Enter&gt; to do reduce (action) to multiply 1*2*...*9*10 and return correct answer Int = 3628800
sc.parallelize(Seq.range(1, 11)).reduce( (x,y)=&gt;x*y ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res14: Int = 3628800
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>CAUTION: Know the limits of your numeric types!</strong></p>
</div>
<div class="cell markdown">
<p>The minimum and maximum value of <code>Int</code> and <code>Long</code> types are as follows:</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">(Int.MinValue , Int.MaxValue)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res15: (Int, Int) = (-2147483648,2147483647)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">(Long.MinValue, Long.MaxValue)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res16: (Long, Long) = (-9223372036854775808,9223372036854775807)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// &lt;Ctrl+Enter&gt; to do reduce (action) to multiply 1*2*...*20 and return wrong answer as Int = -2102132736
//  we have overflowed out of Int's in a circle back to negative Ints!!! (rigorous distributed numerics, anyone?)
sc.parallelize(Seq.range(1, 21)).reduce( (x,y)=&gt;x*y ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res17: Int = -2102132736
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">//&lt;Ctrl+Enter&gt; we can accomplish the multiplication using Long Integer types 
// by adding 'L' ro integer values, Scala infers that it is type Long
sc.parallelize(Seq.range(1L, 21L)).reduce( (x,y)=&gt;x*y ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res18: Long = 2432902008176640000
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>As the following products over Long Integers indicate, they are limited too!</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala"> // &lt;Shift+Enter&gt; for wrong answer Long = -8718968878589280256 (due to Long's numeric limits)
sc.parallelize(Seq.range(1L, 61L)).reduce( (x,y)=&gt;x*y )
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res19: Long = -8718968878589280256
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// &lt;Cntrl+Enter&gt; for wrong answer Long = 0 (due to Long's numeric limits)
sc.parallelize(Seq.range(1L, 100L)).reduce( (x,y)=&gt;x*y ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res20: Long = 0
</code></pre>
</div>
</div>
<div class="cell markdown">
<hr />
<ol start="5">
<li>Let us do a bunch of transformations to our RDD and perform an action</li>
</ol>
<hr />
<ul>
<li>start from a Scala <code>Seq</code>,</li>
<li><code>sc.parallelize</code> the list to create an RDD,</li>
<li><code>filter</code> that RDD, creating a new filtered RDD,</li>
<li>do a <code>map</code> transformation that maps that RDD to a new mapped RDD,</li>
<li>and finally, perform a <code>reduce</code> action to sum the elements in the RDD.</li>
</ul>
<p>This last <code>reduce</code> action causes the <code>parallelize</code>, the <code>filter</code>, and the <code>map</code> transformations to actually be executed, and return a result back to the driver machine.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">sc.parallelize(Seq(1, 2, 3, 4))    // &lt;Ctrl+Enter&gt; will return Array(4, 8)
  .filter(x =&gt; x%2==0)             // (2, 4) is the filtered RDD
  .map(x =&gt; x*2)                   // (4, 8) is the mapped RDD
  .reduce(_+_)                     // 4+8=12 is the final result from reduce
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res21: Int = 12
</code></pre>
</div>
</div>
<div class="cell markdown">
<ol start="6">
<li>Transform the RDD by <code>distinct</code> to make another RDD</li>
</ol>
<hr />
<p>Let's declare another RDD named <code>rdd2</code> that has some repeated elements to apply the <code>distinct</code> transformation to it. That would give us a new RDD that only contains the distinct elements of the input RDD.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd2 = sc.parallelize(Seq(4, 1, 3, 2, 2, 2, 3, 4))    // &lt;Ctrl+Enter&gt; to declare rdd2
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd2: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[56] at parallelize at command-4088905069025443:1
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Let's apply the <code>distinct</code> transformation to <code>rdd2</code> and have it return a new RDD named <code>rdd2Distinct</code> that contains the distinct elements of the source RDD <code>rdd2</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd2Distinct = rdd2.distinct() // &lt;Ctrl+Enter&gt; transformation: distinct gives distinct elements of rdd2
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd2Distinct: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[59] at distinct at command-4088905069025445:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rdd2Distinct.collect()    // &lt;Ctrl+Enter&gt; to collect (action) as Array(4, 2, 1, 3)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res22: Array[Int] = Array(4, 2, 1, 3)
</code></pre>
</div>
</div>
<div class="cell markdown">
<ol start="7">
<li>more flatMap</li>
</ol>
<hr />
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rdd = sc. parallelize(Array(1,2,3)) // &lt;Shift+Enter&gt; to create an RDD of three Int elements 1,2,3
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[60] at parallelize at command-4088905069025448:1
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Let us pass the <code>rdd</code> above to a map with a closure that will take in each element <code>x</code> and return <code>Array(x, x+5)</code>. So each element of the mapped RDD named <code>rddOfArrays</code> is an <code>Array[Int]</code>, an array of integers.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// &lt;Shift+Enter&gt; to make RDD of Arrays, i.e., RDD[Array[int]]
val rddOfArrays = rdd.map( x =&gt; Array(x, x+5) ) 
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rddOfArrays: org.apache.spark.rdd.RDD[Array[Int]] = MapPartitionsRDD[61] at map at command-4088905069025450:2
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddOfArrays.collect() // &lt;Ctrl+Enter&gt; to see it is RDD[Array[int]] = (Array(1, 6), Array(2, 7), Array(3, 8))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res23: Array[Array[Int]] = Array(Array(1, 6), Array(2, 7), Array(3, 8))
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Now let's observer what happens when we use <code>flatMap</code> to transform the same <code>rdd</code> and create another RDD called <code>rddfM</code>.</p>
<p>Interestingly, <code>flatMap</code> <em>flattens</em> our <code>rdd</code> by taking each <code>Array</code> (or sequence in general) and truning it into individual elements.</p>
<p>Thus, we end up with the RDD <code>rddfM</code> consisting of the elements (1, 6, 2, 7, 3, 8) as shown from the output of <code>rddfM.collect</code> below.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rddfM = rdd.flatMap(x =&gt; Array(x, x+5))    // &lt;Shift+Enter&gt; to flatMap the rdd using closure (x =&gt; Array(x, x+5))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rddfM: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[62] at flatMap at command-4088905069025453:1
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddfM.collect    // &lt;Ctrl+Enter&gt; to collect rddfM = (1, 6, 2, 7, 3, 8)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res24: Array[Int] = Array(1, 6, 2, 7, 3, 8)
</code></pre>
</div>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../contents/000_1-sds-3-x-spark/004_RDDsTransformationsActions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../contents/000_1-sds-3-x-spark/006_WordCount.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../contents/000_1-sds-3-x-spark/004_RDDsTransformationsActions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../contents/000_1-sds-3-x-spark/006_WordCount.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
