<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>sds-3.x/ScaDaMaLe</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="scroll-mdbook-outputs.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/037a_AnimalNamesStructStreamingFiles.html">037a_AnimalNamesStructStreamingFiles</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/037b_Mix2NormalsStructStreamingFiles.html">037b_Mix2NormalsStructStreamingFiles</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/037c_Mix2RandomGraphStructStreamingFiles.html">037c_Mix2RandomGraphStructStreamingFiles</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/038_StructuredStreamingProgGuide.html">038_StructuredStreamingProgGuide</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/039_StructuredStreamingFromJSONFileStream.html">039_StructuredStreamingFromJSONFileStream</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/040_Sketching.html">040_Sketching</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/040a_TDigestInputStream.html">040a_TDigestInputStream</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/041_SketchingWithTDigest.html">041_SketchingWithTDigest</a></li><li class="chapter-item expanded affix "><a href="contents/000_4-sds-3-x-ss/042_streamingWithTDigest.html">042_streamingWithTDigest</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">sds-3.x/ScaDaMaLe</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="write-files-with-animal-names-continuously-for-structured-streaming"><a class="header" href="#write-files-with-animal-names-continuously-for-structured-streaming">Write files with animal names continuously for structured streaming</a></h1>
<p>This notebook can be used to write files every 2 seconds into the distributed file system where each of these files contains a row given by the time stamp and two animals chosen at random from six animals in a <code>animals.txt</code> file in the driver.</p>
<p>After running the commands in this notebook you should have a a set of files named by the minute and second for easy setting up of structured streaming jobs in another notebook. This is mainly to create a structured streaming of files for learning purposes. In a real situation, you will have such streams coming from more robust ingestion frameworks such as kafka queues.</p>
<p>It is a good idea to understand how to run executibles from the driver to set up a stream of files for ingestion in structured streaming tasks down stream.</p>
<p>The following <em>seven steps (Steps 0-6)</em> can be used in more complex situations like running a more complex simulator from an executible file.</p>
</div>
<div class="cell markdown">
<h2 id="step-0"><a class="header" href="#step-0">Step 0</a></h2>
<p>let's get our bearings and prepare for setting up a structured streaming from files.</p>
</div>
<div class="cell markdown">
<p>Just find the working directory using <code>%sh</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">pwd
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>/databricks/driver
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We are in <code>databricks/driver</code> directory.</p>
</div>
<div class="cell markdown">
<p>To run the script and be able to kill it you need a few installs.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">apt-get install -y psmisc
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>Reading package lists...
Building dependency tree...
Reading state information...
psmisc is already the newest version (23.1-1ubuntu0.1).
psmisc set to manually installed.
The following packages were automatically installed and are no longer required:
  libcap2-bin libpam-cap zulu-repo
Use 'sudo apt autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2 id="step-1"><a class="header" href="#step-1">Step 1</a></h2>
<p>Let's first make the <code>animals.txt</code> file in the driver.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">rm -f animals.txt &amp;&amp;
echo &quot;cat&quot; &gt;&gt; animals.txt &amp;&amp;
echo &quot;dog&quot; &gt;&gt; animals.txt &amp;&amp;
echo &quot;owl&quot; &gt;&gt; animals.txt &amp;&amp;
echo &quot;pig&quot; &gt;&gt; animals.txt &amp;&amp;
echo &quot;bat&quot; &gt;&gt; animals.txt &amp;&amp;
echo &quot;rat&quot; &gt;&gt; animals.txt &amp;&amp;
cat animals.txt
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>cat
dog
owl
pig
bat
rat
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2 id="step-2"><a class="header" href="#step-2">Step 2</a></h2>
<p>Now let's make a <code>bash</code> shell script that can be executed every two seconds to produce the desired <code>.log</code> files with names prepended by minute and second inside the local directory <code>logsEvery2Secs</code>. Each line the file <code>every2SecsRndWordsInFiles.sh</code> is explained line by line:</p>
<ul>
<li><code>#!/bin/bash</code> is how we tell that this is a <code>bash</code> script which needs the <code>/bin/bash</code> binary. I remember the magic two characters <code>#!</code> as &quot;SHA-BANG&quot; for &quot;hash&quot; for <code>#</code> and &quot;bang&quot; for <code>!</code></li>
<li><code>rm -f every2SecsRndWordsInFiles.sh &amp;&amp;</code> forcefully removes the file <code>every2SecsRndWordsInFiles.sh</code> and <code>&amp;&amp;</code> executes the command preceeding it before going to the next line</li>
<li><code>echo &quot;blah&quot; &gt;&gt; every2SecsRndWordsInFiles.sh</code> just spits out the content of the string, i.e., <code>blah</code>, in append mode due to <code>&gt;&gt;</code> into the file <code>every2SecsRndWordsInFiles.sh</code></li>
</ul>
<p>The rest of the commands simply create a fresh directory <code>logsEvery2Secs</code> and write two randomly chosen animals from the <code>animals.txt</code> file into the directory <code>logsEvery2Secs</code> with <code>.log</code> file names preceeded by minute and second of current time to make a finite number of file names (at most 3600 unique <code>.log</code> filenames).</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">rm -f every2SecsRndWordsInFiles.sh &amp;&amp;
echo &quot;#!/bin/bash&quot; &gt;&gt; every2SecsRndWordsInFiles.sh &amp;&amp;
echo &quot;rm -rf logsEvery2Secs&quot; &gt;&gt; every2SecsRndWordsInFiles.sh &amp;&amp;
echo &quot;mkdir -p logsEvery2Secs&quot; &gt;&gt; every2SecsRndWordsInFiles.sh &amp;&amp;
echo &quot;while true; do echo \$( date --rfc-3339=second )\; | cat - &lt;(shuf -n2 animals.txt) | sed '$!{:a;N;s/\n/ /;ta}' &gt; logsEvery2Secs/\$( date '+%M_%S.log' ); sleep 2; done&quot; &gt;&gt; every2SecsRndWordsInFiles.sh &amp;&amp;
cat every2SecsRndWordsInFiles.sh
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>#!/bin/bash
rm -rf logsEvery2Secs
mkdir -p logsEvery2Secs
while true; do echo $( date --rfc-3339=second )\; | cat - &lt;(shuf -n2 animals.txt) | sed '{:a;N;s/\n/ /;ta}' &gt; logsEvery2Secs/$( date '+%M_%S.log' ); sleep 2; done
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2 id="step-3"><a class="header" href="#step-3">Step 3</a></h2>
<p>Time to run the script!</p>
</div>
<div class="cell markdown">
<p>The next two cells in <code>%sh</code> do the following:</p>
<ul>
<li>makes sure the BASH script <code>every2SecsRndWordsInFiles.sh</code> is executible</li>
<li>run the script in the background without hangup</li>
</ul>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">chmod 744 every2SecsRndWordsInFiles.sh
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">nohup ./every2SecsRndWordsInFiles.sh &amp; 
</code></pre>
</div>
<div class="cell markdown">
<p>After executing the above cell <strong>hit the cancel button above</strong> to get the notebook process back. The BASH shell will still be running in the background as you can verify by evaluating the cell below to get the time-stamped file names inside the <code>logsEvery2Secs</code> directory.</p>
</div>
<div class="cell markdown">
<h2 id="step-4"><a class="header" href="#step-4">Step 4</a></h2>
<p>Check that everything is running as expected.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sh">pwd
ls -al logsEvery2Secs
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>/databricks/driver
total 196
drwxr-xr-x 2 root root 4096 Nov 20 13:21 .
drwxr-xr-x 1 root root 4096 Nov 20 13:20 ..
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_10.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_12.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_14.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_16.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_18.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_20.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_22.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_24.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_26.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_28.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_30.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_32.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_34.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_36.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_38.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_40.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_42.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_44.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_46.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_48.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_50.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_52.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_54.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_56.log
-rw-r--r-- 1 root root   35 Nov 20 13:20 20_58.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_00.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_02.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_04.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_06.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_08.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_10.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_12.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_14.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_16.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_18.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_20.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_22.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_24.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_26.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_28.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_30.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_32.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_34.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_36.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_38.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_40.log
-rw-r--r-- 1 root root   35 Nov 20 13:21 21_42.log
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">cat logsEvery2Secs/21_42.log
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>2020-11-20 13:21:42+00:00; owl dog
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2 id="step-5"><a class="header" href="#step-5">Step 5</a></h2>
<p>Next, let us prepare the distibuted file system for ingesting this data by a simple <code>dbutils.cp</code> command in a for loop with a 5 second delay between each copy from the local file system where the BASH script is writing to.</p>
<p>We use this method of running a BASH script and copying from the local file system to the distributed one in order to mimic arbirary file contents by merely changing the bash script.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">dbutils.fs.rm(&quot;/datasets/streamingFiles/&quot;,true) // this is to delete the directory before staring a job
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res0: Boolean = true
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">var a = 0;
// for loop execution to move files from local fs to distributed fs
for( a &lt;- 1 to 60*60/5){ 
  // you may need to replace 60*60/5 above by a smaller number like 10 or 20 in the CE depending on how many files of your quota you have used up already
  dbutils.fs.cp(&quot;file:///databricks/driver/logsEvery2Secs/&quot;,&quot;/datasets/streamingFiles/&quot;,true)
  Thread.sleep(5000L) // sleep 5 seconds
}
</code></pre>
</div>
<div class="cell markdown">
<h2 id="step-6"><a class="header" href="#step-6">Step 6</a></h2>
<p>When you are done with this streaming job it is important that you <code>cancel</code> the above cell if it is still running and also terminate the BASH shell <code>every2SecsRndWordsInFiles.sh</code> in the cell below to prevent it from running &quot;for ever&quot;!</p>
<p>In fact, you can execture the next cell before leaving this notebook so that the job gets killed once the above <code>for</code> loop finishes after an hour. You may need to remove the <code>//</code> in the next cell before killing the bash job.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">killall every2SecsRndWordsInFiles.sh
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="write-files-periodically-with-normal-mixture-samples-for-structured-streaming"><a class="header" href="#write-files-periodically-with-normal-mixture-samples-for-structured-streaming">Write files periodically with normal mixture samples for structured streaming</a></h1>
<p>This notebook can be used to write files every few seconds into the distributed file system where each of these files contains a time stamp field followed by randomly drawn words.</p>
<p>After running the commands in this notebook you should have a a set of files named by the minute and second for easy setting up of structured streaming jobs in another notebook.</p>
</div>
<div class="cell markdown">
<h2 id="mixture-of-2-normals"><a class="header" href="#mixture-of-2-normals">Mixture of 2 Normals</a></h2>
<p>Here we will write some Gaussian mixture samples to files.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.util.Random
import scala.util.Random._

// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  Thread.sleep(5L) // sleep 5 milliseconds
  val now = (new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;)).format(new java.util.Date())
  return (now,sample)
   }
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.util.Random
import scala.util.Random._
myMixtureOf2Normals: (normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: scala.util.Random)(String, Double)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val r = new Random(1L)
println(myMixtureOf2Normals(1.0, 10.0, 0.99, r), myMixtureOf2Normals(1.0, 10.0, 0.99, r))
// should always produce samples as (0.5876430182311466,-0.34037937678788865) when seed = 1L
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>((2020-11-16 10:47:55.774,0.5876430182311466),(2020-11-16 10:47:55.780,-0.34037937678788865))
r: scala.util.Random = scala.util.Random@cb2fa8b
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(sc.parallelize(Vector.fill(1000){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).toDF.select(&quot;_2&quot;)) // histogram of 1000 samples
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.63847575097573</td>
</tr>
<tr class="even">
<td>0.8497955378433464</td>
</tr>
<tr class="odd">
<td>1.0173381805959432</td>
</tr>
<tr class="even">
<td>-2.6960935205721848e-2</td>
</tr>
<tr class="odd">
<td>-6.096818465288045e-2</td>
</tr>
<tr class="even">
<td>0.6235321652739503</td>
</tr>
<tr class="odd">
<td>1.1594225593708558</td>
</tr>
<tr class="even">
<td>2.6812781205628102</td>
</tr>
<tr class="odd">
<td>2.3144624015522943</td>
</tr>
<tr class="even">
<td>3.2746230371718874</td>
</tr>
<tr class="odd">
<td>0.6239556140200029</td>
</tr>
<tr class="even">
<td>0.6428284914761508</td>
</tr>
<tr class="odd">
<td>-0.42618967795971496</td>
</tr>
<tr class="even">
<td>0.4090774320731605</td>
</tr>
<tr class="odd">
<td>0.731226227370048</td>
</tr>
<tr class="even">
<td>1.392728206581036</td>
</tr>
<tr class="odd">
<td>1.3354355936933495</td>
</tr>
<tr class="even">
<td>0.17821385872329187</td>
</tr>
<tr class="odd">
<td>-0.23317608061362294</td>
</tr>
<tr class="even">
<td>0.47289802886431465</td>
</tr>
<tr class="odd">
<td>-1.9401934414671596</td>
</tr>
<tr class="even">
<td>10.214120281108658</td>
</tr>
<tr class="odd">
<td>1.892684662207417</td>
</tr>
<tr class="even">
<td>1.0166947170672929</td>
</tr>
<tr class="odd">
<td>2.2709372842290798e-2</td>
</tr>
<tr class="even">
<td>2.1067186310892803</td>
</tr>
<tr class="odd">
<td>-0.2704224394550252</td>
</tr>
<tr class="even">
<td>1.1899806078296409</td>
</tr>
<tr class="odd">
<td>1.9798405611441416</td>
</tr>
<tr class="even">
<td>1.674277523545705</td>
</tr>
<tr class="odd">
<td>1.7051472629603235</td>
</tr>
<tr class="even">
<td>0.30230911121326054</td>
</tr>
<tr class="odd">
<td>1.3131677682296694</td>
</tr>
<tr class="even">
<td>0.6862907308874912</td>
</tr>
<tr class="odd">
<td>1.5472597655237206</td>
</tr>
<tr class="even">
<td>-0.21817241232347429</td>
</tr>
<tr class="odd">
<td>2.7926715721364213</td>
</tr>
<tr class="even">
<td>1.076185529891312</td>
</tr>
<tr class="odd">
<td>1.553330079653454</td>
</tr>
<tr class="even">
<td>1.8513287666787783</td>
</tr>
<tr class="odd">
<td>0.9573896481551991</td>
</tr>
<tr class="even">
<td>5.970253671115444e-2</td>
</tr>
<tr class="odd">
<td>1.1541469640881448</td>
</tr>
<tr class="even">
<td>0.2802123113351551</td>
</tr>
<tr class="odd">
<td>-0.5344837021313593</td>
</tr>
<tr class="even">
<td>1.725283845177347</td>
</tr>
<tr class="odd">
<td>1.755161663154593</td>
</tr>
<tr class="even">
<td>-0.5917988890618884</td>
</tr>
<tr class="odd">
<td>-0.16673131970385602</td>
</tr>
<tr class="even">
<td>-0.8875029732034849</td>
</tr>
<tr class="odd">
<td>0.8698903603546103</td>
</tr>
<tr class="even">
<td>2.114856053952625</td>
</tr>
<tr class="odd">
<td>2.497996116473529</td>
</tr>
<tr class="even">
<td>9.58947465374601</td>
</tr>
<tr class="odd">
<td>2.9441080471551846</td>
</tr>
<tr class="even">
<td>2.5155704683949165</td>
</tr>
<tr class="odd">
<td>0.17630763054020993</td>
</tr>
<tr class="even">
<td>0.18281600980713353</td>
</tr>
<tr class="odd">
<td>1.9274188319901921</td>
</tr>
<tr class="even">
<td>-0.5948223586642365</td>
</tr>
<tr class="odd">
<td>-1.2010559428888148</td>
</tr>
<tr class="even">
<td>0.39178009640886724</td>
</tr>
<tr class="odd">
<td>1.8700313397445891</td>
</tr>
<tr class="even">
<td>1.9822181107950154</td>
</tr>
<tr class="odd">
<td>1.2988415493692078</td>
</tr>
<tr class="even">
<td>0.19172302714886202</td>
</tr>
<tr class="odd">
<td>1.8821092899972611</td>
</tr>
<tr class="even">
<td>1.3022299642012503</td>
</tr>
<tr class="odd">
<td>1.4752832590499911</td>
</tr>
<tr class="even">
<td>0.3609863067031439</td>
</tr>
<tr class="odd">
<td>1.9323022237840024</td>
</tr>
<tr class="even">
<td>1.69205485183195</td>
</tr>
<tr class="odd">
<td>2.837382612764204</td>
</tr>
<tr class="even">
<td>0.1910603148124741</td>
</tr>
<tr class="odd">
<td>0.341728700100859</td>
</tr>
<tr class="even">
<td>2.2890102177414597</td>
</tr>
<tr class="odd">
<td>0.9364985206830795</td>
</tr>
<tr class="even">
<td>-9.834860359562425e-2</td>
</tr>
<tr class="odd">
<td>1.9684980059019335</td>
</tr>
<tr class="even">
<td>2.1078374167392218</td>
</tr>
<tr class="odd">
<td>0.8418311806515589</td>
</tr>
<tr class="even">
<td>-6.692278803103968e-2</td>
</tr>
<tr class="odd">
<td>3.0610863387705947</td>
</tr>
<tr class="even">
<td>2.5970193768494565</td>
</tr>
<tr class="odd">
<td>1.7322441665190011</td>
</tr>
<tr class="even">
<td>1.906475635230355</td>
</tr>
<tr class="odd">
<td>0.7904177135359902</td>
</tr>
<tr class="even">
<td>2.251629313442862</td>
</tr>
<tr class="odd">
<td>0.821157571251303</td>
</tr>
<tr class="even">
<td>0.604717877958487</td>
</tr>
<tr class="odd">
<td>-2.786225541637921e-2</td>
</tr>
<tr class="even">
<td>0.25604168086650014</td>
</tr>
<tr class="odd">
<td>2.227036911451595</td>
</tr>
<tr class="even">
<td>0.5553767689608333</td>
</tr>
<tr class="odd">
<td>1.2188030914528114</td>
</tr>
<tr class="even">
<td>0.4514774439330318</td>
</tr>
<tr class="odd">
<td>0.6543905674437465</td>
</tr>
<tr class="even">
<td>0.40245654155097643</td>
</tr>
<tr class="odd">
<td>0.5060580393139191</td>
</tr>
<tr class="even">
<td>0.39607300301218784</td>
</tr>
<tr class="odd">
<td>1.2148439132942364</td>
</tr>
<tr class="even">
<td>-1.1732951662319397</td>
</tr>
<tr class="odd">
<td>2.73880972901814</td>
</tr>
<tr class="even">
<td>1.8021623567418805</td>
</tr>
<tr class="odd">
<td>1.7158266876051977</td>
</tr>
<tr class="even">
<td>-5.753772099978405e-2</td>
</tr>
<tr class="odd">
<td>0.8372348006260973</td>
</tr>
<tr class="even">
<td>1.0550026092093487</td>
</tr>
<tr class="odd">
<td>-0.195219134074764</td>
</tr>
<tr class="even">
<td>0.8383022815662486</td>
</tr>
<tr class="odd">
<td>1.2379684980482244</td>
</tr>
<tr class="even">
<td>-0.9744247939864081</td>
</tr>
<tr class="odd">
<td>0.34334678488869397</td>
</tr>
<tr class="even">
<td>0.9559281181537529</td>
</tr>
<tr class="odd">
<td>0.1404041195836977</td>
</tr>
<tr class="even">
<td>-0.3013816873777868</td>
</tr>
<tr class="odd">
<td>2.3896906481802835</td>
</tr>
<tr class="even">
<td>0.32642106560403683</td>
</tr>
<tr class="odd">
<td>1.1731296744694082</td>
</tr>
<tr class="even">
<td>1.5569305149964348</td>
</tr>
<tr class="odd">
<td>1.5889387851920198</td>
</tr>
<tr class="even">
<td>0.4731172095886468</td>
</tr>
<tr class="odd">
<td>1.8856173342031206</td>
</tr>
<tr class="even">
<td>2.3639372705821358</td>
</tr>
<tr class="odd">
<td>-4.477980164340978e-2</td>
</tr>
<tr class="even">
<td>1.0290704620759326</td>
</tr>
<tr class="odd">
<td>1.9189177950037783</td>
</tr>
<tr class="even">
<td>-1.0270431347512887</td>
</tr>
<tr class="odd">
<td>0.29509917268188934</td>
</tr>
<tr class="even">
<td>0.2778311015556939</td>
</tr>
<tr class="odd">
<td>2.0003447521256588</td>
</tr>
<tr class="even">
<td>1.1150669950847454</td>
</tr>
<tr class="odd">
<td>0.8896045579010659</td>
</tr>
<tr class="even">
<td>0.6672200055719166</td>
</tr>
<tr class="odd">
<td>2.835109610406893</td>
</tr>
<tr class="even">
<td>0.7007330220501728</td>
</tr>
<tr class="odd">
<td>0.9750338145448016</td>
</tr>
<tr class="even">
<td>1.5645635468047536</td>
</tr>
<tr class="odd">
<td>0.9674358170359617</td>
</tr>
<tr class="even">
<td>0.25227970595044513</td>
</tr>
<tr class="odd">
<td>1.375957412863052</td>
</tr>
<tr class="even">
<td>1.308418670787698</td>
</tr>
<tr class="odd">
<td>1.9419970123581474</td>
</tr>
<tr class="even">
<td>0.8365053262598314</td>
</tr>
<tr class="odd">
<td>1.9114557211166892</td>
</tr>
<tr class="even">
<td>3.8001770349623225</td>
</tr>
<tr class="odd">
<td>0.8274099015781488</td>
</tr>
<tr class="even">
<td>0.8067385461002958</td>
</tr>
<tr class="odd">
<td>-1.4655370928162954</td>
</tr>
<tr class="even">
<td>1.8238007602460073</td>
</tr>
<tr class="odd">
<td>0.5594066359278937</td>
</tr>
<tr class="even">
<td>1.6110515128363136</td>
</tr>
<tr class="odd">
<td>0.6652500763228728</td>
</tr>
<tr class="even">
<td>1.0793393655154422</td>
</tr>
<tr class="odd">
<td>2.245390820036886</td>
</tr>
<tr class="even">
<td>0.35470134173051693</td>
</tr>
<tr class="odd">
<td>1.2952852735590668</td>
</tr>
<tr class="even">
<td>1.8610829534004827</td>
</tr>
<tr class="odd">
<td>0.33089671577831126</td>
</tr>
<tr class="even">
<td>1.1590236911322995</td>
</tr>
<tr class="odd">
<td>2.2514554017998076</td>
</tr>
<tr class="even">
<td>1.3216086127545497</td>
</tr>
<tr class="odd">
<td>0.5881415761335955</td>
</tr>
<tr class="even">
<td>3.0225970797989596</td>
</tr>
<tr class="odd">
<td>1.9673222329020743</td>
</tr>
<tr class="even">
<td>1.9658660340337613</td>
</tr>
<tr class="odd">
<td>1.8710008504436737</td>
</tr>
<tr class="even">
<td>1.845446759447753</td>
</tr>
<tr class="odd">
<td>0.14370718520286974</td>
</tr>
<tr class="even">
<td>1.908535196201739</td>
</tr>
<tr class="odd">
<td>1.0842042894798714</td>
</tr>
<tr class="even">
<td>2.3715209552442835</td>
</tr>
<tr class="odd">
<td>1.5054700276157238</td>
</tr>
<tr class="even">
<td>3.2507198636175434</td>
</tr>
<tr class="odd">
<td>1.2191172203825102</td>
</tr>
<tr class="even">
<td>0.8790791380073175</td>
</tr>
<tr class="odd">
<td>-1.0037247733674635</td>
</tr>
<tr class="even">
<td>0.9049623487323446</td>
</tr>
<tr class="odd">
<td>1.2089925367368337</td>
</tr>
<tr class="even">
<td>0.6882976824476612</td>
</tr>
<tr class="odd">
<td>2.5434935418288713</td>
</tr>
<tr class="even">
<td>1.0027620856353483</td>
</tr>
<tr class="odd">
<td>-0.27959350084891055</td>
</tr>
<tr class="even">
<td>0.3279655527731484</td>
</tr>
<tr class="odd">
<td>1.5786118902182438</td>
</tr>
<tr class="even">
<td>-0.39629416278043617</td>
</tr>
<tr class="odd">
<td>1.1770224496224355</td>
</tr>
<tr class="even">
<td>2.383953754814976</td>
</tr>
<tr class="odd">
<td>1.091832388214859</td>
</tr>
<tr class="even">
<td>1.6301831536311209</td>
</tr>
<tr class="odd">
<td>0.935425666376106</td>
</tr>
<tr class="even">
<td>2.1401208410667696</td>
</tr>
<tr class="odd">
<td>1.5922472337477118</td>
</tr>
<tr class="even">
<td>0.34768463336762756</td>
</tr>
<tr class="odd">
<td>3.4257932035179848</td>
</tr>
<tr class="even">
<td>0.7149821525322468</td>
</tr>
<tr class="odd">
<td>1.5415488633926249</td>
</tr>
<tr class="even">
<td>1.6496390565891736</td>
</tr>
<tr class="odd">
<td>0.9593424220951506</td>
</tr>
<tr class="even">
<td>0.6518631532504793</td>
</tr>
<tr class="odd">
<td>3.403687949320813</td>
</tr>
<tr class="even">
<td>0.8320258402390563</td>
</tr>
<tr class="odd">
<td>0.12142126647709839</td>
</tr>
<tr class="even">
<td>3.597300820980316</td>
</tr>
<tr class="odd">
<td>0.14741363170749655</td>
</tr>
<tr class="even">
<td>0.8462912401166103</td>
</tr>
<tr class="odd">
<td>1.0584643703479584</td>
</tr>
<tr class="even">
<td>1.1487138176792762</td>
</tr>
<tr class="odd">
<td>0.3488425183144027</td>
</tr>
<tr class="even">
<td>1.391612358634887</td>
</tr>
<tr class="odd">
<td>1.505017789786627</td>
</tr>
<tr class="even">
<td>0.5244087078660062</td>
</tr>
<tr class="odd">
<td>0.2705096241707795</td>
</tr>
<tr class="even">
<td>2.216688343494393</td>
</tr>
<tr class="odd">
<td>-1.6589238926022496</td>
</tr>
<tr class="even">
<td>1.708690947086617</td>
</tr>
<tr class="odd">
<td>2.961208276039951</td>
</tr>
<tr class="even">
<td>6.522128902971014e-2</td>
</tr>
<tr class="odd">
<td>1.930831478373714</td>
</tr>
<tr class="even">
<td>1.1607184811130336</td>
</tr>
<tr class="odd">
<td>1.6688339248285566</td>
</tr>
<tr class="even">
<td>1.6470200278340348</td>
</tr>
<tr class="odd">
<td>2.449696037385742</td>
</tr>
<tr class="even">
<td>0.8251476817941197</td>
</tr>
<tr class="odd">
<td>1.40403402944069</td>
</tr>
<tr class="even">
<td>1.2942215447658563</td>
</tr>
<tr class="odd">
<td>1.7120981908967403</td>
</tr>
<tr class="even">
<td>-8.929122874418227e-2</td>
</tr>
<tr class="odd">
<td>3.7731683503114843</td>
</tr>
<tr class="even">
<td>-6.239748698038494e-2</td>
</tr>
<tr class="odd">
<td>1.1840870589278099</td>
</tr>
<tr class="even">
<td>1.441608712447355</td>
</tr>
<tr class="odd">
<td>1.208878651490341</td>
</tr>
<tr class="even">
<td>1.8920599151149384</td>
</tr>
<tr class="odd">
<td>2.527569684835118e-2</td>
</tr>
<tr class="even">
<td>0.38124154100408325</td>
</tr>
<tr class="odd">
<td>-0.2393929330098632</td>
</tr>
<tr class="even">
<td>0.1338106966810938</td>
</tr>
<tr class="odd">
<td>0.2676880074695901</td>
</tr>
<tr class="even">
<td>2.1281668027663505</td>
</tr>
<tr class="odd">
<td>0.3098286754011822</td>
</tr>
<tr class="even">
<td>0.4585965277423747</td>
</tr>
<tr class="odd">
<td>-2.5930812376542933e-2</td>
</tr>
<tr class="even">
<td>2.083732337529618</td>
</tr>
<tr class="odd">
<td>0.6731348015628896</td>
</tr>
<tr class="even">
<td>0.1312853060580106</td>
</tr>
<tr class="odd">
<td>1.6205120279909435</td>
</tr>
<tr class="even">
<td>3.665204102481068e-2</td>
</tr>
<tr class="odd">
<td>0.38840609319995334</td>
</tr>
<tr class="even">
<td>0.16412699262051766</td>
</tr>
<tr class="odd">
<td>1.0044846177991755</td>
</tr>
<tr class="even">
<td>0.45217422200704216</td>
</tr>
<tr class="odd">
<td>-0.18519175139069355</td>
</tr>
<tr class="even">
<td>-0.29646999575663124</td>
</tr>
<tr class="odd">
<td>0.47945009163424923</td>
</tr>
<tr class="even">
<td>1.7615776520354332</td>
</tr>
<tr class="odd">
<td>0.35352511094407846</td>
</tr>
<tr class="even">
<td>0.5902336217395934</td>
</tr>
<tr class="odd">
<td>1.7471513985001184</td>
</tr>
<tr class="even">
<td>0.4125022414098265</td>
</tr>
<tr class="odd">
<td>0.7484837707176137</td>
</tr>
<tr class="even">
<td>2.4227348582478037</td>
</tr>
<tr class="odd">
<td>1.0572595828548697</td>
</tr>
<tr class="even">
<td>3.0750919548401128</td>
</tr>
<tr class="odd">
<td>1.0066299184508531</td>
</tr>
<tr class="even">
<td>1.1704717372072126e-2</td>
</tr>
<tr class="odd">
<td>0.5249712753060873</td>
</tr>
<tr class="even">
<td>-0.3285040378625381</td>
</tr>
<tr class="odd">
<td>1.342275367397042</td>
</tr>
<tr class="even">
<td>0.4464461744940117</td>
</tr>
<tr class="odd">
<td>1.8011252317891455</td>
</tr>
<tr class="even">
<td>0.814252403591333</td>
</tr>
<tr class="odd">
<td>1.394324297666107</td>
</tr>
<tr class="even">
<td>1.746173303844829</td>
</tr>
<tr class="odd">
<td>0.9316948966812066</td>
</tr>
<tr class="even">
<td>0.200871837759239</td>
</tr>
<tr class="odd">
<td>0.21504170344279683</td>
</tr>
<tr class="even">
<td>1.3508727155177145</td>
</tr>
<tr class="odd">
<td>1.5029472339851955</td>
</tr>
<tr class="even">
<td>1.3410205427121795</td>
</tr>
<tr class="odd">
<td>-0.29787456681066304</td>
</tr>
<tr class="even">
<td>0.5368515430517165</td>
</tr>
<tr class="odd">
<td>0.4903528739420413</td>
</tr>
<tr class="even">
<td>1.385472033421005</td>
</tr>
<tr class="odd">
<td>-0.2770976989604108</td>
</tr>
<tr class="even">
<td>0.14383609785529106</td>
</tr>
<tr class="odd">
<td>2.136175000080348</td>
</tr>
<tr class="even">
<td>1.3623047924484522</td>
</tr>
<tr class="odd">
<td>1.7982361871358026</td>
</tr>
<tr class="even">
<td>0.31744493918444716</td>
</tr>
<tr class="odd">
<td>1.6350814336974835</td>
</tr>
<tr class="even">
<td>2.1281399761210897</td>
</tr>
<tr class="odd">
<td>2.502566064523463</td>
</tr>
<tr class="even">
<td>-0.24563123892361882</td>
</tr>
<tr class="odd">
<td>1.1658851718667056</td>
</tr>
<tr class="even">
<td>0.9774056737281539</td>
</tr>
<tr class="odd">
<td>-0.9759524597979035</td>
</tr>
<tr class="even">
<td>1.189619858484149</td>
</tr>
<tr class="odd">
<td>1.5319416027989528</td>
</tr>
<tr class="even">
<td>2.1398379560783063</td>
</tr>
<tr class="odd">
<td>-0.8795632577020192</td>
</tr>
<tr class="even">
<td>0.9740025013919826</td>
</tr>
<tr class="odd">
<td>2.1670377423670066</td>
</tr>
<tr class="even">
<td>1.8772156837816794</td>
</tr>
<tr class="odd">
<td>1.4824573418919358</td>
</tr>
<tr class="even">
<td>2.0936166431428</td>
</tr>
<tr class="odd">
<td>0.48330193647070885</td>
</tr>
<tr class="even">
<td>1.1693862084127395</td>
</tr>
<tr class="odd">
<td>2.9630411557020633</td>
</tr>
<tr class="even">
<td>0.7910395376475294</td>
</tr>
<tr class="odd">
<td>2.2572758761916054</td>
</tr>
<tr class="even">
<td>0.5908398656455651</td>
</tr>
<tr class="odd">
<td>1.0801869359536456</td>
</tr>
<tr class="even">
<td>1.6034174887237207</td>
</tr>
<tr class="odd">
<td>2.06427635708377</td>
</tr>
<tr class="even">
<td>1.7447902837676048</td>
</tr>
<tr class="odd">
<td>2.031505217347445</td>
</tr>
<tr class="even">
<td>0.7818721634007395</td>
</tr>
<tr class="odd">
<td>0.7546588629356998</td>
</tr>
<tr class="even">
<td>0.21941395803984998</td>
</tr>
<tr class="odd">
<td>1.269969127498187</td>
</tr>
<tr class="even">
<td>0.6995395205381358</td>
</tr>
<tr class="odd">
<td>1.6248745281288801</td>
</tr>
<tr class="even">
<td>0.8263012944805543</td>
</tr>
<tr class="odd">
<td>1.4386440510670049</td>
</tr>
<tr class="even">
<td>2.190301845034811</td>
</tr>
<tr class="odd">
<td>0.21078498872972096</td>
</tr>
<tr class="even">
<td>0.9513469983933799</td>
</tr>
<tr class="odd">
<td>1.7125428803482596</td>
</tr>
<tr class="even">
<td>1.398303536566959</td>
</tr>
<tr class="odd">
<td>1.1206534766009186</td>
</tr>
<tr class="even">
<td>2.290467145367123</td>
</tr>
<tr class="odd">
<td>4.7109383568383345e-3</td>
</tr>
<tr class="even">
<td>2.294594854357012</td>
</tr>
<tr class="odd">
<td>1.4766168147668075</td>
</tr>
<tr class="even">
<td>1.1557121731747513</td>
</tr>
<tr class="odd">
<td>1.9080418901330192</td>
</tr>
<tr class="even">
<td>1.8649147337827425</td>
</tr>
<tr class="odd">
<td>1.4389071560055176</td>
</tr>
<tr class="even">
<td>0.10082531163297859</td>
</tr>
<tr class="odd">
<td>0.9702568121268303</td>
</tr>
<tr class="even">
<td>2.7799453357863033</td>
</tr>
<tr class="odd">
<td>2.24549312231816</td>
</tr>
<tr class="even">
<td>0.5235703215957042</td>
</tr>
<tr class="odd">
<td>4.74734605167747e-2</td>
</tr>
<tr class="even">
<td>6.947954022632907e-2</td>
</tr>
<tr class="odd">
<td>0.3108356478112668</td>
</tr>
<tr class="even">
<td>0.8394845735542491</td>
</tr>
<tr class="odd">
<td>1.6339257039230628</td>
</tr>
<tr class="even">
<td>-7.81874305278627e-2</td>
</tr>
<tr class="odd">
<td>10.700496016278244</td>
</tr>
<tr class="even">
<td>1.306079988619333</td>
</tr>
<tr class="odd">
<td>1.0105357675060997</td>
</tr>
<tr class="even">
<td>0.994188218965991</td>
</tr>
<tr class="odd">
<td>1.8719149336462086</td>
</tr>
<tr class="even">
<td>-1.802104678175969</td>
</tr>
<tr class="odd">
<td>1.3547952390058997</td>
</tr>
<tr class="even">
<td>1.6863315414298679</td>
</tr>
<tr class="odd">
<td>0.4044486829589423</td>
</tr>
<tr class="even">
<td>0.663151463812041</td>
</tr>
<tr class="odd">
<td>1.1770322429105757</td>
</tr>
<tr class="even">
<td>0.352603150929493</td>
</tr>
<tr class="odd">
<td>-0.3331634174041469</td>
</tr>
<tr class="even">
<td>0.3219528023599839</td>
</tr>
<tr class="odd">
<td>-4.993059725088589e-2</td>
</tr>
<tr class="even">
<td>2.1359810727430015</td>
</tr>
<tr class="odd">
<td>6.7435821150996e-2</td>
</tr>
<tr class="even">
<td>0.8152880685205637</td>
</tr>
<tr class="odd">
<td>1.3355438274268063</td>
</tr>
<tr class="even">
<td>0.2584888411640408</td>
</tr>
<tr class="odd">
<td>2.1807115216184654</td>
</tr>
<tr class="even">
<td>1.6447860615623693</td>
</tr>
<tr class="odd">
<td>1.3607208126185033</td>
</tr>
<tr class="even">
<td>-0.7821045197212251</td>
</tr>
<tr class="odd">
<td>0.7038349029306756</td>
</tr>
<tr class="even">
<td>2.1151467870965206</td>
</tr>
<tr class="odd">
<td>6.485239215670013e-4</td>
</tr>
<tr class="even">
<td>0.7343141400907413</td>
</tr>
<tr class="odd">
<td>1.481231890529832</td>
</tr>
<tr class="even">
<td>0.7436383571380679</td>
</tr>
<tr class="odd">
<td>0.3623319184166701</td>
</tr>
<tr class="even">
<td>1.631447713261156</td>
</tr>
<tr class="odd">
<td>1.9006969436568095</td>
</tr>
<tr class="even">
<td>1.4157080835736964</td>
</tr>
<tr class="odd">
<td>1.1280983721670481</td>
</tr>
<tr class="even">
<td>0.9426963726981692</td>
</tr>
<tr class="odd">
<td>0.24856063619656132</td>
</tr>
<tr class="even">
<td>2.255628154607799</td>
</tr>
<tr class="odd">
<td>2.252115121208546</td>
</tr>
<tr class="even">
<td>0.7841223760628484</td>
</tr>
<tr class="odd">
<td>2.3421293755672297</td>
</tr>
<tr class="even">
<td>2.8348182486914295</td>
</tr>
<tr class="odd">
<td>1.7318785148989992</td>
</tr>
<tr class="even">
<td>0.9762383915277096</td>
</tr>
<tr class="odd">
<td>0.2616760398200866</td>
</tr>
<tr class="even">
<td>-2.0755223554176574</td>
</tr>
<tr class="odd">
<td>0.8670675571509455</td>
</tr>
<tr class="even">
<td>2.396557755329019</td>
</tr>
<tr class="odd">
<td>1.1056101876800475</td>
</tr>
<tr class="even">
<td>0.2021889628502218</td>
</tr>
<tr class="odd">
<td>1.1500629266145144</td>
</tr>
<tr class="even">
<td>-5.934104215058822e-2</td>
</tr>
<tr class="odd">
<td>1.3810015349944087</td>
</tr>
<tr class="even">
<td>1.4678912177406023</td>
</tr>
<tr class="odd">
<td>2.673868252550129</td>
</tr>
<tr class="even">
<td>1.124862297586977</td>
</tr>
<tr class="odd">
<td>1.1197692140235738</td>
</tr>
<tr class="even">
<td>0.5797093329389853</td>
</tr>
<tr class="odd">
<td>0.6109162599915521</td>
</tr>
<tr class="even">
<td>1.494308943924204</td>
</tr>
<tr class="odd">
<td>1.1433812164404558</td>
</tr>
<tr class="even">
<td>-3.285316146399686e-2</td>
</tr>
<tr class="odd">
<td>0.6761399530014083</td>
</tr>
<tr class="even">
<td>1.1616013112893129</td>
</tr>
<tr class="odd">
<td>0.36992246959386677</td>
</tr>
<tr class="even">
<td>-0.22957870942980962</td>
</tr>
<tr class="odd">
<td>1.8420697014408531</td>
</tr>
<tr class="even">
<td>1.668302982091929</td>
</tr>
<tr class="odd">
<td>-0.9984398554534477</td>
</tr>
<tr class="even">
<td>1.273607856169444</td>
</tr>
<tr class="odd">
<td>1.050632908723346</td>
</tr>
<tr class="even">
<td>3.256210339328564</td>
</tr>
<tr class="odd">
<td>1.0280169417144063</td>
</tr>
<tr class="even">
<td>0.25615873705323133</td>
</tr>
<tr class="odd">
<td>1.7462784369850581</td>
</tr>
<tr class="even">
<td>1.062093713031747</td>
</tr>
<tr class="odd">
<td>1.2932300520227344</td>
</tr>
<tr class="even">
<td>-0.7938447295027886</td>
</tr>
<tr class="odd">
<td>-0.7609148389003666</td>
</tr>
<tr class="even">
<td>1.4574415363357067</td>
</tr>
<tr class="odd">
<td>2.135798938708896</td>
</tr>
<tr class="even">
<td>2.348280132734578</td>
</tr>
<tr class="odd">
<td>0.8734588034850551</td>
</tr>
<tr class="even">
<td>9.973604957378543</td>
</tr>
<tr class="odd">
<td>0.35196987232964316</td>
</tr>
<tr class="even">
<td>0.9035385778892631</td>
</tr>
<tr class="odd">
<td>2.831102216825725</td>
</tr>
<tr class="even">
<td>1.0048753977495803</td>
</tr>
<tr class="odd">
<td>0.10451954987326095</td>
</tr>
<tr class="even">
<td>1.1013729655881508</td>
</tr>
<tr class="odd">
<td>1.7585193090606088</td>
</tr>
<tr class="even">
<td>1.226418453772686</td>
</tr>
<tr class="odd">
<td>1.4531562937415308</td>
</tr>
<tr class="even">
<td>0.7619165788941504</td>
</tr>
<tr class="odd">
<td>0.5461009604744256</td>
</tr>
<tr class="even">
<td>0.6008649427727283</td>
</tr>
<tr class="odd">
<td>1.3780057162734836</td>
</tr>
<tr class="even">
<td>1.4622978840755851</td>
</tr>
<tr class="odd">
<td>0.34759263562314335</td>
</tr>
<tr class="even">
<td>0.5736485977723396</td>
</tr>
<tr class="odd">
<td>2.3452708258883352</td>
</tr>
<tr class="even">
<td>0.9744585521015179</td>
</tr>
<tr class="odd">
<td>1.285268161746166</td>
</tr>
<tr class="even">
<td>3.3071183043196593</td>
</tr>
<tr class="odd">
<td>2.5080380549754593</td>
</tr>
<tr class="even">
<td>1.4259274788963952</td>
</tr>
<tr class="odd">
<td>-2.5903667885951664e-2</td>
</tr>
<tr class="even">
<td>10.986550512370714</td>
</tr>
<tr class="odd">
<td>-7.581817475272645e-2</td>
</tr>
<tr class="even">
<td>0.6416173679276148</td>
</tr>
<tr class="odd">
<td>0.9534229122939114</td>
</tr>
<tr class="even">
<td>2.132841239825161</td>
</tr>
<tr class="odd">
<td>0.6563712251065035</td>
</tr>
<tr class="even">
<td>0.5765226219933468</td>
</tr>
<tr class="odd">
<td>1.5821498064982138</td>
</tr>
<tr class="even">
<td>0.8155216333285705</td>
</tr>
<tr class="odd">
<td>2.405818410234607</td>
</tr>
<tr class="even">
<td>2.1354048597660134</td>
</tr>
<tr class="odd">
<td>0.1630525718563236</td>
</tr>
<tr class="even">
<td>0.8804014022168887</td>
</tr>
<tr class="odd">
<td>1.7677390861016287</td>
</tr>
<tr class="even">
<td>-8.660285888231711e-2</td>
</tr>
<tr class="odd">
<td>1.4957055199119156</td>
</tr>
<tr class="even">
<td>1.1686901432590528</td>
</tr>
<tr class="odd">
<td>1.230599828613972</td>
</tr>
<tr class="even">
<td>0.8291351676730639</td>
</tr>
<tr class="odd">
<td>0.16369805405490445</td>
</tr>
<tr class="even">
<td>1.7141910766526713</td>
</tr>
<tr class="odd">
<td>-6.948651912105075e-2</td>
</tr>
<tr class="even">
<td>1.1025296196845764</td>
</tr>
<tr class="odd">
<td>2.085963027757715</td>
</tr>
<tr class="even">
<td>2.3289725923192126</td>
</tr>
<tr class="odd">
<td>9.123696930094438e-2</td>
</tr>
<tr class="even">
<td>0.7863635245315979</td>
</tr>
<tr class="odd">
<td>1.2210644347049109</td>
</tr>
<tr class="even">
<td>2.536308464119898</td>
</tr>
<tr class="odd">
<td>0.7390652688383932</td>
</tr>
<tr class="even">
<td>1.7955412008455056</td>
</tr>
<tr class="odd">
<td>-0.4063994398735684</td>
</tr>
<tr class="even">
<td>0.417663857272753</td>
</tr>
<tr class="odd">
<td>0.7572268352036777</td>
</tr>
<tr class="even">
<td>2.2956618964137903</td>
</tr>
<tr class="odd">
<td>0.8643802079825195</td>
</tr>
<tr class="even">
<td>0.6085757743161285</td>
</tr>
<tr class="odd">
<td>0.8861852158953121</td>
</tr>
<tr class="even">
<td>0.20486279885097103</td>
</tr>
<tr class="odd">
<td>1.6421903961418307</td>
</tr>
<tr class="even">
<td>-1.4786102936414443</td>
</tr>
<tr class="odd">
<td>1.61151014329611</td>
</tr>
<tr class="even">
<td>1.458781222964441</td>
</tr>
<tr class="odd">
<td>0.9231917785415031</td>
</tr>
<tr class="even">
<td>2.987811838778618</td>
</tr>
<tr class="odd">
<td>-0.11728923230585608</td>
</tr>
<tr class="even">
<td>-0.5667637111213064</td>
</tr>
<tr class="odd">
<td>0.6043249745554822</td>
</tr>
<tr class="even">
<td>0.5250792304891077</td>
</tr>
<tr class="odd">
<td>1.7590856628461462</td>
</tr>
<tr class="even">
<td>2.9472816508826574</td>
</tr>
<tr class="odd">
<td>-0.5091218022791495</td>
</tr>
<tr class="even">
<td>0.2743637223565212</td>
</tr>
<tr class="odd">
<td>0.7727501145356438</td>
</tr>
<tr class="even">
<td>1.402853616121213</td>
</tr>
<tr class="odd">
<td>1.7554959619234003</td>
</tr>
<tr class="even">
<td>0.7230708651518659</td>
</tr>
<tr class="odd">
<td>-0.6084691576920431</td>
</tr>
<tr class="even">
<td>0.17482707245078832</td>
</tr>
<tr class="odd">
<td>2.067354421609911</td>
</tr>
<tr class="even">
<td>0.7901599165913906</td>
</tr>
<tr class="odd">
<td>1.652492308966036e-2</td>
</tr>
<tr class="even">
<td>2.2069354262628993</td>
</tr>
<tr class="odd">
<td>0.5663855120607604</td>
</tr>
<tr class="even">
<td>1.3454449336721601</td>
</tr>
<tr class="odd">
<td>2.2789771861802697</td>
</tr>
<tr class="even">
<td>-0.22026555210551368</td>
</tr>
<tr class="odd">
<td>2.0631465437978855</td>
</tr>
<tr class="even">
<td>2.039163346272715</td>
</tr>
<tr class="odd">
<td>-1.055015394694371</td>
</tr>
<tr class="even">
<td>1.7388420238468236</td>
</tr>
<tr class="odd">
<td>1.872637961652257</td>
</tr>
<tr class="even">
<td>3.2010804478144554</td>
</tr>
<tr class="odd">
<td>1.3562671867479166</td>
</tr>
<tr class="even">
<td>-0.32950571604262713</td>
</tr>
<tr class="odd">
<td>-0.12503275455021545</td>
</tr>
<tr class="even">
<td>1.277154825764409</td>
</tr>
<tr class="odd">
<td>0.8843613626221687</td>
</tr>
<tr class="even">
<td>1.0729763052881904</td>
</tr>
<tr class="odd">
<td>2.3265082147700946</td>
</tr>
<tr class="even">
<td>1.396457159161225</td>
</tr>
<tr class="odd">
<td>2.0285111744592372</td>
</tr>
<tr class="even">
<td>1.330964559152572</td>
</tr>
<tr class="odd">
<td>2.2179887039102653</td>
</tr>
<tr class="even">
<td>0.6284429614059523</td>
</tr>
<tr class="odd">
<td>0.3504227161829304</td>
</tr>
<tr class="even">
<td>1.059416715157096</td>
</tr>
<tr class="odd">
<td>2.138857533311191</td>
</tr>
<tr class="even">
<td>0.8094290918556053</td>
</tr>
<tr class="odd">
<td>0.46138825363082825</td>
</tr>
<tr class="even">
<td>1.7155270828145763</td>
</tr>
<tr class="odd">
<td>1.2795402627927337</td>
</tr>
<tr class="even">
<td>1.923106069471253</td>
</tr>
<tr class="odd">
<td>1.5104912344606418</td>
</tr>
<tr class="even">
<td>0.5207525194340703</td>
</tr>
<tr class="odd">
<td>0.9946842162070768</td>
</tr>
<tr class="even">
<td>3.5622068453996514e-2</td>
</tr>
<tr class="odd">
<td>0.18537526816937433</td>
</tr>
<tr class="even">
<td>0.6111284963963912</td>
</tr>
<tr class="odd">
<td>0.8203863356928468</td>
</tr>
<tr class="even">
<td>2.6753862253484195</td>
</tr>
<tr class="odd">
<td>1.650835985592774</td>
</tr>
<tr class="even">
<td>1.5665183929170006</td>
</tr>
<tr class="odd">
<td>1.8194416800691129</td>
</tr>
<tr class="even">
<td>2.0526203700510672</td>
</tr>
<tr class="odd">
<td>-0.651338434409015</td>
</tr>
<tr class="even">
<td>1.7895684845926731</td>
</tr>
<tr class="odd">
<td>2.418781611162374</td>
</tr>
<tr class="even">
<td>1.0787214433473757</td>
</tr>
<tr class="odd">
<td>0.18911021430460961</td>
</tr>
<tr class="even">
<td>-0.2730870440651234</td>
</tr>
<tr class="odd">
<td>1.1132512450740597</td>
</tr>
<tr class="even">
<td>1.0791906170600118</td>
</tr>
<tr class="odd">
<td>0.655348601135614</td>
</tr>
<tr class="even">
<td>1.8662289569576362</td>
</tr>
<tr class="odd">
<td>1.627670496605692</td>
</tr>
<tr class="even">
<td>11.004554142758568</td>
</tr>
<tr class="odd">
<td>0.1965392063488054</td>
</tr>
<tr class="even">
<td>1.544545432892698</td>
</tr>
<tr class="odd">
<td>1.5832867870520477</td>
</tr>
<tr class="even">
<td>1.8981385396481731</td>
</tr>
<tr class="odd">
<td>2.8183382851231302</td>
</tr>
<tr class="even">
<td>0.5740375808180014</td>
</tr>
<tr class="odd">
<td>-0.22669316378819526</td>
</tr>
<tr class="even">
<td>-0.24362648940070186</td>
</tr>
<tr class="odd">
<td>0.6735629913863805</td>
</tr>
<tr class="even">
<td>2.602135296264379</td>
</tr>
<tr class="odd">
<td>8.790069946983575</td>
</tr>
<tr class="even">
<td>2.5322332152585725</td>
</tr>
<tr class="odd">
<td>3.3409503348064518</td>
</tr>
<tr class="even">
<td>0.687556087265665</td>
</tr>
<tr class="odd">
<td>3.0425649254546347</td>
</tr>
<tr class="even">
<td>2.303391429846904</td>
</tr>
<tr class="odd">
<td>1.4423838621149456</td>
</tr>
<tr class="even">
<td>1.4532350387273563</td>
</tr>
<tr class="odd">
<td>1.4533824084502533</td>
</tr>
<tr class="even">
<td>3.587876263951717e-2</td>
</tr>
<tr class="odd">
<td>2.20315841028769</td>
</tr>
<tr class="even">
<td>0.36244134638228875</td>
</tr>
<tr class="odd">
<td>0.6105194199863686</td>
</tr>
<tr class="even">
<td>-0.45389649712820246</td>
</tr>
<tr class="odd">
<td>1.0252296817007915</td>
</tr>
<tr class="even">
<td>3.1243573699805918</td>
</tr>
<tr class="odd">
<td>-0.3343748567492124</td>
</tr>
<tr class="even">
<td>0.5029922338992889</td>
</tr>
<tr class="odd">
<td>1.7237601942074183</td>
</tr>
<tr class="even">
<td>1.3511410651578275</td>
</tr>
<tr class="odd">
<td>1.0909840953480212</td>
</tr>
<tr class="even">
<td>-0.32919830466100297</td>
</tr>
<tr class="odd">
<td>2.141237972293073</td>
</tr>
<tr class="even">
<td>0.5392802259404192</td>
</tr>
<tr class="odd">
<td>2.0625972069627694</td>
</tr>
<tr class="even">
<td>1.244091480416753</td>
</tr>
<tr class="odd">
<td>0.5541089423362922</td>
</tr>
<tr class="even">
<td>0.6229771138177793</td>
</tr>
<tr class="odd">
<td>1.6750943089353725</td>
</tr>
<tr class="even">
<td>0.6582509099634593</td>
</tr>
<tr class="odd">
<td>1.3833368320356623</td>
</tr>
<tr class="even">
<td>1.5435711785532977</td>
</tr>
<tr class="odd">
<td>0.522680525295731</td>
</tr>
<tr class="even">
<td>1.1915344402925043</td>
</tr>
<tr class="odd">
<td>0.35720513834862744</td>
</tr>
<tr class="even">
<td>-8.565981412975487e-3</td>
</tr>
<tr class="odd">
<td>1.5372133772727767</td>
</tr>
<tr class="even">
<td>5.533905500333114e-2</td>
</tr>
<tr class="odd">
<td>2.106400343304179</td>
</tr>
<tr class="even">
<td>0.9291634254575988</td>
</tr>
<tr class="odd">
<td>0.85445925115937</td>
</tr>
<tr class="even">
<td>1.4490678502266374</td>
</tr>
<tr class="odd">
<td>2.1619334568272004</td>
</tr>
<tr class="even">
<td>0.2576823307255467</td>
</tr>
<tr class="odd">
<td>3.0652975358670402</td>
</tr>
<tr class="even">
<td>1.7957493894493899</td>
</tr>
<tr class="odd">
<td>1.3815187097537076</td>
</tr>
<tr class="even">
<td>0.7289953121054422</td>
</tr>
<tr class="odd">
<td>0.6648198928488573</td>
</tr>
<tr class="even">
<td>2.796805936556927</td>
</tr>
<tr class="odd">
<td>-0.6218526047970672</td>
</tr>
<tr class="even">
<td>3.443106828552411</td>
</tr>
<tr class="odd">
<td>0.5417960512110482</td>
</tr>
<tr class="even">
<td>0.132679330973015</td>
</tr>
<tr class="odd">
<td>1.682704565079506</td>
</tr>
<tr class="even">
<td>-0.9024146545484664</td>
</tr>
<tr class="odd">
<td>1.7184762053500053</td>
</tr>
<tr class="even">
<td>-1.0864413777491877</td>
</tr>
<tr class="odd">
<td>2.4082299567533854</td>
</tr>
<tr class="even">
<td>0.6867344491764446</td>
</tr>
<tr class="odd">
<td>0.6342469814283839</td>
</tr>
<tr class="even">
<td>1.4948735109252287</td>
</tr>
<tr class="odd">
<td>-9.172542759290137e-3</td>
</tr>
<tr class="even">
<td>1.6946662014403582</td>
</tr>
<tr class="odd">
<td>0.5055706186920743</td>
</tr>
<tr class="even">
<td>0.8321247164414739</td>
</tr>
<tr class="odd">
<td>-1.9229724798355035</td>
</tr>
<tr class="even">
<td>2.0668198169520764</td>
</tr>
<tr class="odd">
<td>0.6061498747704183</td>
</tr>
<tr class="even">
<td>1.1542480718044577</td>
</tr>
<tr class="odd">
<td>0.8061008067230262</td>
</tr>
<tr class="even">
<td>3.082304566988994</td>
</tr>
<tr class="odd">
<td>0.860398339444179</td>
</tr>
<tr class="even">
<td>0.8735622227950341</td>
</tr>
<tr class="odd">
<td>1.645389530143016</td>
</tr>
<tr class="even">
<td>0.31526948080501604</td>
</tr>
<tr class="odd">
<td>1.752922329065294</td>
</tr>
<tr class="even">
<td>1.569150260594506</td>
</tr>
<tr class="odd">
<td>1.7989690892449675</td>
</tr>
<tr class="even">
<td>1.8128536428855522</td>
</tr>
<tr class="odd">
<td>2.174392027870953</td>
</tr>
<tr class="even">
<td>2.0629021196034616</td>
</tr>
<tr class="odd">
<td>2.846679590420721</td>
</tr>
<tr class="even">
<td>1.6394381805033087</td>
</tr>
<tr class="odd">
<td>0.5575890384195411</td>
</tr>
<tr class="even">
<td>-6.1635562922423226e-2</td>
</tr>
<tr class="odd">
<td>0.8770394819777554</td>
</tr>
<tr class="even">
<td>0.18278872308418326</td>
</tr>
<tr class="odd">
<td>0.6653187571193362</td>
</tr>
<tr class="even">
<td>0.3097532566309745</td>
</tr>
<tr class="odd">
<td>1.4422363582612099</td>
</tr>
<tr class="even">
<td>2.2343382287346265</td>
</tr>
<tr class="odd">
<td>1.324757244250018</td>
</tr>
<tr class="even">
<td>-0.6265562099516999</td>
</tr>
<tr class="odd">
<td>0.7530623041134055</td>
</tr>
<tr class="even">
<td>2.4548974876953755</td>
</tr>
<tr class="odd">
<td>1.1505257093180181</td>
</tr>
<tr class="even">
<td>0.18314366349299938</td>
</tr>
<tr class="odd">
<td>1.0957673061461137</td>
</tr>
<tr class="even">
<td>1.5898966599318236</td>
</tr>
<tr class="odd">
<td>-0.8021527506395465</td>
</tr>
<tr class="even">
<td>2.9919524601934695</td>
</tr>
<tr class="odd">
<td>0.16404921511675252</td>
</tr>
<tr class="even">
<td>-1.2374220758846475</td>
</tr>
<tr class="odd">
<td>1.0926015540947187</td>
</tr>
<tr class="even">
<td>1.7047203204003867</td>
</tr>
<tr class="odd">
<td>2.0361007784966425</td>
</tr>
<tr class="even">
<td>-1.1129955618534204</td>
</tr>
<tr class="odd">
<td>1.2078806959684631</td>
</tr>
<tr class="even">
<td>1.3823025668814726</td>
</tr>
<tr class="odd">
<td>-0.20117996650194825</td>
</tr>
<tr class="even">
<td>0.4368510042955428</td>
</tr>
<tr class="odd">
<td>1.548393626209222</td>
</tr>
<tr class="even">
<td>0.4462763885045765</td>
</tr>
<tr class="odd">
<td>0.9980172029792674</td>
</tr>
<tr class="even">
<td>0.2244700800716185</td>
</tr>
<tr class="odd">
<td>-0.21800349448603162</td>
</tr>
<tr class="even">
<td>0.16417229737752437</td>
</tr>
<tr class="odd">
<td>0.6207189588427342</td>
</tr>
<tr class="even">
<td>-0.6888898628873894</td>
</tr>
<tr class="odd">
<td>0.5459693517409819</td>
</tr>
<tr class="even">
<td>0.9025080719803394</td>
</tr>
<tr class="odd">
<td>-0.80260527881833</td>
</tr>
<tr class="even">
<td>1.6163270811863857</td>
</tr>
<tr class="odd">
<td>2.633075725131599</td>
</tr>
<tr class="even">
<td>-0.7773305013995544</td>
</tr>
<tr class="odd">
<td>0.2526721145132672</td>
</tr>
<tr class="even">
<td>-0.1366344706945435</td>
</tr>
<tr class="odd">
<td>0.6144275159404241</td>
</tr>
<tr class="even">
<td>1.97335159695082</td>
</tr>
<tr class="odd">
<td>0.653596005828342</td>
</tr>
<tr class="even">
<td>1.6116893597735258</td>
</tr>
<tr class="odd">
<td>1.2014572106480943</td>
</tr>
<tr class="even">
<td>1.5512973474330294</td>
</tr>
<tr class="odd">
<td>1.1163799230226856</td>
</tr>
<tr class="even">
<td>0.7681458989542176</td>
</tr>
<tr class="odd">
<td>-1.3590749505030857</td>
</tr>
<tr class="even">
<td>1.808641901084573</td>
</tr>
<tr class="odd">
<td>1.360253821157752</td>
</tr>
<tr class="even">
<td>1.650932132662064</td>
</tr>
<tr class="odd">
<td>2.7784418591342397e-2</td>
</tr>
<tr class="even">
<td>6.352095139713354e-4</td>
</tr>
<tr class="odd">
<td>1.441774342046809</td>
</tr>
<tr class="even">
<td>1.2027746328482523</td>
</tr>
<tr class="odd">
<td>2.3897838732271515</td>
</tr>
<tr class="even">
<td>-0.716495277439726</td>
</tr>
<tr class="odd">
<td>1.4815526561707035</td>
</tr>
<tr class="even">
<td>0.6060868601377281</td>
</tr>
<tr class="odd">
<td>1.0576521934236953</td>
</tr>
<tr class="even">
<td>0.48936224390584415</td>
</tr>
<tr class="odd">
<td>1.9354637823092111</td>
</tr>
<tr class="even">
<td>0.9117750291708597</td>
</tr>
<tr class="odd">
<td>1.5859428172890642</td>
</tr>
<tr class="even">
<td>0.3265619461022775</td>
</tr>
<tr class="odd">
<td>1.4075266094882544</td>
</tr>
<tr class="even">
<td>0.1875530632757464</td>
</tr>
<tr class="odd">
<td>3.785747077498869e-2</td>
</tr>
<tr class="even">
<td>0.1631893341844134</td>
</tr>
<tr class="odd">
<td>1.3291278928477839</td>
</tr>
<tr class="even">
<td>2.052089759378511</td>
</tr>
<tr class="odd">
<td>1.669824081897619</td>
</tr>
<tr class="even">
<td>2.1070512246301867</td>
</tr>
<tr class="odd">
<td>0.6995955417782742</td>
</tr>
<tr class="even">
<td>0.8007672174475671</td>
</tr>
<tr class="odd">
<td>0.7544785261517125</td>
</tr>
<tr class="even">
<td>0.35717027130006673</td>
</tr>
<tr class="odd">
<td>0.1475616766180351</td>
</tr>
<tr class="even">
<td>1.058691342729173</td>
</tr>
<tr class="odd">
<td>2.066376270854084</td>
</tr>
<tr class="even">
<td>0.7760634597252762</td>
</tr>
<tr class="odd">
<td>0.8763163198863502</td>
</tr>
<tr class="even">
<td>0.7454179518243453</td>
</tr>
<tr class="odd">
<td>0.4854355686115821</td>
</tr>
<tr class="even">
<td>1.5918037585502445</td>
</tr>
<tr class="odd">
<td>1.0851213695662045</td>
</tr>
<tr class="even">
<td>2.0203357822531967</td>
</tr>
<tr class="odd">
<td>1.7808274985539043</td>
</tr>
<tr class="even">
<td>3.3342822479741083</td>
</tr>
<tr class="odd">
<td>0.5663200540954269</td>
</tr>
<tr class="even">
<td>1.2312898243010122</td>
</tr>
<tr class="odd">
<td>2.441121828813979</td>
</tr>
<tr class="even">
<td>1.7131802924620656</td>
</tr>
<tr class="odd">
<td>1.8828830522974154</td>
</tr>
<tr class="even">
<td>1.219662609175296</td>
</tr>
<tr class="odd">
<td>0.6260480088733502</td>
</tr>
<tr class="even">
<td>0.6699112699464786</td>
</tr>
<tr class="odd">
<td>2.9616463814694187</td>
</tr>
<tr class="even">
<td>0.4897205675463613</td>
</tr>
<tr class="odd">
<td>1.3817814430979267</td>
</tr>
<tr class="even">
<td>2.368499575307164</td>
</tr>
<tr class="odd">
<td>0.7666593765571403</td>
</tr>
<tr class="even">
<td>-0.2356306903167824</td>
</tr>
<tr class="odd">
<td>0.11121972846306671</td>
</tr>
<tr class="even">
<td>0.13048302696943748</td>
</tr>
<tr class="odd">
<td>2.0296555679842934</td>
</tr>
<tr class="even">
<td>0.6821008335751151</td>
</tr>
<tr class="odd">
<td>0.824902101020345</td>
</tr>
<tr class="even">
<td>-1.4357280652706677</td>
</tr>
<tr class="odd">
<td>0.43551196308521123</td>
</tr>
<tr class="even">
<td>0.42864594983955717</td>
</tr>
<tr class="odd">
<td>1.5708973296624738</td>
</tr>
<tr class="even">
<td>0.7355576398800922</td>
</tr>
<tr class="odd">
<td>1.7698063948887048</td>
</tr>
<tr class="even">
<td>1.5506318814642417</td>
</tr>
<tr class="odd">
<td>7.337999234267556e-2</td>
</tr>
<tr class="even">
<td>-0.5590435862206975</td>
</tr>
<tr class="odd">
<td>2.0708510087246363</td>
</tr>
<tr class="even">
<td>1.0937426555598604</td>
</tr>
<tr class="odd">
<td>1.866409592951821</td>
</tr>
<tr class="even">
<td>1.4315729492342215</td>
</tr>
<tr class="odd">
<td>0.4352270706743224</td>
</tr>
<tr class="even">
<td>-0.32282708992213793</td>
</tr>
<tr class="odd">
<td>-0.7926070985572229</td>
</tr>
<tr class="even">
<td>4.1313375262139385</td>
</tr>
<tr class="odd">
<td>2.5182310368999583</td>
</tr>
<tr class="even">
<td>1.5517727635341054</td>
</tr>
<tr class="odd">
<td>1.2112227339558879</td>
</tr>
<tr class="even">
<td>1.088870081894894</td>
</tr>
<tr class="odd">
<td>1.3840364826625247</td>
</tr>
<tr class="even">
<td>0.7313598601928168</td>
</tr>
<tr class="odd">
<td>1.4979622853866332</td>
</tr>
<tr class="even">
<td>-9.589043964797783e-2</td>
</tr>
<tr class="odd">
<td>0.18259590774466605</td>
</tr>
<tr class="even">
<td>-0.605015706579229</td>
</tr>
<tr class="odd">
<td>0.479252514082421</td>
</tr>
<tr class="even">
<td>2.446158573827078</td>
</tr>
<tr class="odd">
<td>0.9738579307442236</td>
</tr>
<tr class="even">
<td>0.8806136322907132</td>
</tr>
<tr class="odd">
<td>-1.208394918011912</td>
</tr>
<tr class="even">
<td>-0.14037642146707818</td>
</tr>
<tr class="odd">
<td>-8.062071408017712e-2</td>
</tr>
<tr class="even">
<td>0.325790154240306</td>
</tr>
<tr class="odd">
<td>0.2876391391859443</td>
</tr>
<tr class="even">
<td>-5.4041048579440476e-2</td>
</tr>
<tr class="odd">
<td>0.8773670649720676</td>
</tr>
<tr class="even">
<td>2.367842331811702</td>
</tr>
<tr class="odd">
<td>0.26889262808832914</td>
</tr>
<tr class="even">
<td>1.724119815882517</td>
</tr>
<tr class="odd">
<td>1.7791641061471468</td>
</tr>
<tr class="even">
<td>0.734736381050196</td>
</tr>
<tr class="odd">
<td>1.6845526251491851</td>
</tr>
<tr class="even">
<td>1.621893865768243</td>
</tr>
<tr class="odd">
<td>2.0312929797085744</td>
</tr>
<tr class="even">
<td>0.7494718435492904</td>
</tr>
<tr class="odd">
<td>1.2022212419280855</td>
</tr>
<tr class="even">
<td>1.8619921045777033</td>
</tr>
<tr class="odd">
<td>0.7029888222716667</td>
</tr>
<tr class="even">
<td>1.994083595934665</td>
</tr>
<tr class="odd">
<td>0.7072489103032473</td>
</tr>
<tr class="even">
<td>-1.1377100954267716</td>
</tr>
<tr class="odd">
<td>2.043095143556785</td>
</tr>
<tr class="even">
<td>2.166457075549966</td>
</tr>
<tr class="odd">
<td>0.5807453858478133</td>
</tr>
<tr class="even">
<td>1.4374121122629657</td>
</tr>
<tr class="odd">
<td>0.954614007781135</td>
</tr>
<tr class="even">
<td>1.953034562155581</td>
</tr>
<tr class="odd">
<td>-0.31599836594918784</td>
</tr>
<tr class="even">
<td>0.4068636792746446</td>
</tr>
<tr class="odd">
<td>1.7729848751693704</td>
</tr>
<tr class="even">
<td>0.13604733276520964</td>
</tr>
<tr class="odd">
<td>1.5733429242522448</td>
</tr>
<tr class="even">
<td>-0.24138972935741654</td>
</tr>
<tr class="odd">
<td>1.9768168747035486</td>
</tr>
<tr class="even">
<td>0.8346709933535629</td>
</tr>
<tr class="odd">
<td>-1.0458047931412482</td>
</tr>
<tr class="even">
<td>0.6197520625356908</td>
</tr>
<tr class="odd">
<td>1.624038733446523</td>
</tr>
<tr class="even">
<td>1.2010762746847274</td>
</tr>
<tr class="odd">
<td>-0.9819289179145085</td>
</tr>
<tr class="even">
<td>2.4170778788623286</td>
</tr>
<tr class="odd">
<td>1.107936607297393</td>
</tr>
<tr class="even">
<td>1.3942450780076066</td>
</tr>
<tr class="odd">
<td>1.3573378818806876</td>
</tr>
<tr class="even">
<td>4.1669854205718004e-2</td>
</tr>
<tr class="odd">
<td>-1.0230668880126963</td>
</tr>
<tr class="even">
<td>2.1672936942995924</td>
</tr>
<tr class="odd">
<td>2.119034877005035</td>
</tr>
<tr class="even">
<td>2.617354118940299</td>
</tr>
<tr class="odd">
<td>0.2064667615861927</td>
</tr>
<tr class="even">
<td>-0.5725286096934115</td>
</tr>
<tr class="odd">
<td>2.1705557671839575</td>
</tr>
<tr class="even">
<td>1.074568348781358</td>
</tr>
<tr class="odd">
<td>1.5117862398041413</td>
</tr>
<tr class="even">
<td>1.720961326096484</td>
</tr>
<tr class="odd">
<td>0.5484584732722113</td>
</tr>
<tr class="even">
<td>-0.5487880960214739</td>
</tr>
<tr class="odd">
<td>0.6889819892464035</td>
</tr>
<tr class="even">
<td>1.0619551547481028</td>
</tr>
<tr class="odd">
<td>1.211942404937342</td>
</tr>
<tr class="even">
<td>1.6696784059290148</td>
</tr>
<tr class="odd">
<td>1.3761977731682555</td>
</tr>
<tr class="even">
<td>3.071527103226564</td>
</tr>
<tr class="odd">
<td>0.8205571465304501</td>
</tr>
<tr class="even">
<td>0.27290043128415853</td>
</tr>
<tr class="odd">
<td>1.0653401225764465</td>
</tr>
<tr class="even">
<td>1.1614811977828927</td>
</tr>
<tr class="odd">
<td>1.7383121079945434</td>
</tr>
<tr class="even">
<td>-0.1599579688189814</td>
</tr>
<tr class="odd">
<td>0.7161844910476673</td>
</tr>
<tr class="even">
<td>1.5825851430026225</td>
</tr>
<tr class="odd">
<td>1.729082954840492</td>
</tr>
<tr class="even">
<td>2.9837819396012546</td>
</tr>
<tr class="odd">
<td>0.6578883627962699</td>
</tr>
<tr class="even">
<td>1.1377610134374765</td>
</tr>
<tr class="odd">
<td>-0.6323774087781868</td>
</tr>
<tr class="even">
<td>0.46007501303967147</td>
</tr>
<tr class="odd">
<td>2.6521967942692486</td>
</tr>
<tr class="even">
<td>-6.125168548660631e-2</td>
</tr>
<tr class="odd">
<td>2.9103478438885473</td>
</tr>
<tr class="even">
<td>0.39594395800598337</td>
</tr>
<tr class="odd">
<td>2.1923535711428848</td>
</tr>
<tr class="even">
<td>1.4697826622154868</td>
</tr>
<tr class="odd">
<td>0.30222917190196086</td>
</tr>
<tr class="even">
<td>1.459617110508502</td>
</tr>
<tr class="odd">
<td>1.5211379317237608</td>
</tr>
<tr class="even">
<td>0.5572602929344768</td>
</tr>
<tr class="odd">
<td>1.6823380276685338</td>
</tr>
<tr class="even">
<td>1.5547569617336123</td>
</tr>
<tr class="odd">
<td>0.967365035197969</td>
</tr>
<tr class="even">
<td>0.7566178166538748</td>
</tr>
<tr class="odd">
<td>2.1650489378269775</td>
</tr>
<tr class="even">
<td>2.4253722899093866</td>
</tr>
<tr class="odd">
<td>10.23186845160902</td>
</tr>
<tr class="even">
<td>0.1488435276719955</td>
</tr>
<tr class="odd">
<td>1.334317069373473</td>
</tr>
<tr class="even">
<td>0.13187282300981706</td>
</tr>
<tr class="odd">
<td>1.9930419173328975</td>
</tr>
<tr class="even">
<td>0.1443423696606898</td>
</tr>
<tr class="odd">
<td>0.6007539040372134</td>
</tr>
<tr class="even">
<td>1.886587311852184</td>
</tr>
<tr class="odd">
<td>0.28914373993637366</td>
</tr>
<tr class="even">
<td>1.9776682498960527</td>
</tr>
<tr class="odd">
<td>2.4758782746217123</td>
</tr>
<tr class="even">
<td>2.7070897621357446</td>
</tr>
<tr class="odd">
<td>0.9472622505602268</td>
</tr>
<tr class="even">
<td>1.2602098520570666</td>
</tr>
<tr class="odd">
<td>-1.7566407142390892</td>
</tr>
<tr class="even">
<td>1.5745734897235473</td>
</tr>
<tr class="odd">
<td>0.6130201020930863</td>
</tr>
<tr class="even">
<td>1.0358032358478906</td>
</tr>
<tr class="odd">
<td>1.5052778526230153</td>
</tr>
<tr class="even">
<td>-1.0672425439622724</td>
</tr>
<tr class="odd">
<td>1.5281373508721496</td>
</tr>
<tr class="even">
<td>0.5223419811330235</td>
</tr>
<tr class="odd">
<td>1.8542151442789314</td>
</tr>
<tr class="even">
<td>1.2285178570916262</td>
</tr>
<tr class="odd">
<td>2.7988645052766676</td>
</tr>
<tr class="even">
<td>-0.861627034243382</td>
</tr>
<tr class="odd">
<td>0.9294699314786086</td>
</tr>
<tr class="even">
<td>2.2360036137643347</td>
</tr>
<tr class="odd">
<td>0.28408155798843726</td>
</tr>
<tr class="even">
<td>0.943759844028374</td>
</tr>
<tr class="odd">
<td>1.4808042306276197</td>
</tr>
<tr class="even">
<td>8.976182739712016</td>
</tr>
<tr class="odd">
<td>3.5904784799076</td>
</tr>
<tr class="even">
<td>1.244680688295711</td>
</tr>
<tr class="odd">
<td>2.015594144111281</td>
</tr>
<tr class="even">
<td>1.6682081811950065</td>
</tr>
<tr class="odd">
<td>1.3062492721042696</td>
</tr>
<tr class="even">
<td>0.9597597738929083</td>
</tr>
<tr class="odd">
<td>0.14081110195632118</td>
</tr>
<tr class="even">
<td>0.6802144777826231</td>
</tr>
<tr class="odd">
<td>1.7427436989859513</td>
</tr>
<tr class="even">
<td>1.025119809243448</td>
</tr>
<tr class="odd">
<td>2.363808744264097</td>
</tr>
<tr class="even">
<td>1.098939384496553</td>
</tr>
<tr class="odd">
<td>2.365900700802084</td>
</tr>
<tr class="even">
<td>0.9639713759620857</td>
</tr>
<tr class="odd">
<td>1.1879608636926524</td>
</tr>
<tr class="even">
<td>0.2648582754089548</td>
</tr>
<tr class="odd">
<td>1.6006017120486895</td>
</tr>
<tr class="even">
<td>7.519379906201751e-2</td>
</tr>
<tr class="odd">
<td>0.2198949605081273</td>
</tr>
<tr class="even">
<td>1.5190910869919414</td>
</tr>
<tr class="odd">
<td>1.3945275248631226</td>
</tr>
<tr class="even">
<td>0.651205917924697</td>
</tr>
<tr class="odd">
<td>0.6910676581885502</td>
</tr>
<tr class="even">
<td>2.041288605562429</td>
</tr>
<tr class="odd">
<td>1.3322502409533927</td>
</tr>
<tr class="even">
<td>0.8190849792925787</td>
</tr>
<tr class="odd">
<td>0.7731687411115308</td>
</tr>
<tr class="even">
<td>2.052287561083507</td>
</tr>
<tr class="odd">
<td>1.8008966716911172</td>
</tr>
<tr class="even">
<td>1.231841585551883</td>
</tr>
<tr class="odd">
<td>1.6898412909890235</td>
</tr>
<tr class="even">
<td>1.2644139086012807</td>
</tr>
<tr class="odd">
<td>2.7531121025849865</td>
</tr>
<tr class="even">
<td>0.30461789013034024</td>
</tr>
<tr class="odd">
<td>0.7788454265121008</td>
</tr>
<tr class="even">
<td>1.3219507722927721</td>
</tr>
<tr class="odd">
<td>-0.45523491060288057</td>
</tr>
<tr class="even">
<td>1.2677313887765018</td>
</tr>
<tr class="odd">
<td>1.7996640101307269</td>
</tr>
<tr class="even">
<td>0.4670890255653002</td>
</tr>
<tr class="odd">
<td>2.4769073718909094</td>
</tr>
<tr class="even">
<td>0.3494158442146792</td>
</tr>
<tr class="odd">
<td>0.22328815419586</td>
</tr>
<tr class="even">
<td>0.34206270424196084</td>
</tr>
<tr class="odd">
<td>-0.12746179104408784</td>
</tr>
<tr class="even">
<td>2.197149144795371</td>
</tr>
<tr class="odd">
<td>-0.6353823443308804</td>
</tr>
<tr class="even">
<td>1.0875581317673213</td>
</tr>
<tr class="odd">
<td>0.9444545881585366</td>
</tr>
<tr class="even">
<td>1.965966128848457</td>
</tr>
<tr class="odd">
<td>0.5039931206538372</td>
</tr>
<tr class="even">
<td>1.2106483228588576</td>
</tr>
<tr class="odd">
<td>0.6580705742678696</td>
</tr>
<tr class="even">
<td>2.3578096465318747</td>
</tr>
<tr class="odd">
<td>-0.5066449988185571</td>
</tr>
<tr class="even">
<td>1.0762171812349997</td>
</tr>
<tr class="odd">
<td>1.0356862000259204</td>
</tr>
<tr class="even">
<td>-0.6471662591053053</td>
</tr>
<tr class="odd">
<td>1.8235922438459014</td>
</tr>
<tr class="even">
<td>1.0820154631653591</td>
</tr>
<tr class="odd">
<td>2.3564967540496595</td>
</tr>
<tr class="even">
<td>1.6506535694050806</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">dbutils.fs.rm(&quot;/datasets/streamingFilesNormalMixture/&quot;,true) // this is to delete the directory before staring a job
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res2: Boolean = false
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val r = new Random(12345L) // set seed for reproducibility
var a = 0;
// for loop execution to write files to distributed fs
for( a &lt;- 1 to 5){
  // make a DataSet
  val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}) // 100 samples from mixture
               .coalesce(1) // this is to make sure that we have only one partition per dir
               .toDF.as[(String,Double)]
  val minute = (new java.text.SimpleDateFormat(&quot;mm&quot;)).format(new java.util.Date())
  val second = (new java.text.SimpleDateFormat(&quot;ss&quot;)).format(new java.util.Date())
  // write to dbfs
  data.write.mode(SaveMode.Overwrite).csv(&quot;/datasets/streamingFilesNormalMixture/&quot; + minute +&quot;_&quot; + second)
  Thread.sleep(5000L) // sleep 5 seconds
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>r: scala.util.Random = scala.util.Random@5704bfda
a: Int = 0
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFilesNormalMixture/&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_11/</td>
<td>48_11/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_19/</td>
<td>48_19/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_26/</td>
<td>48_26/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_36/</td>
<td>48_36/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/</td>
<td>48_43/</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFilesNormalMixture/48_43/&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/_SUCCESS</td>
<td>_SUCCESS</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/_committed_5911069874541273534</td>
<td>_committed_5911069874541273534</td>
<td>115.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/_started_5911069874541273534</td>
<td>_started_5911069874541273534</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/part-00000-tid-5911069874541273534-d96c7c40-0395-40b6-a223-79c4cdb475c8-35610-1-c000.csv</td>
<td>part-00000-tid-5911069874541273534-d96c7c40-0395-40b6-a223-79c4cdb475c8-35610-1-c000.csv</td>
<td>4310.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Take a peek at what was written.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val df_csv = spark.read.option(&quot;inferSchema&quot;, &quot;true&quot;).csv(&quot;/datasets/streamingFilesNormalMixture/48_43/*.csv&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>df_csv: org.apache.spark.sql.DataFrame = [_c0: string, _c1: double]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">df_csv.count() // 100 samples per file
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res8: Long = 100
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">df_csv.show(10,false) // first 10
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-----------------------+--------------------+
|_c0                    |_c1                 |
+-----------------------+--------------------+
|2020-11-16 10:48:42.690|2.0531657985840983  |
|2020-11-16 10:48:42.696|1.7928797637680196  |
|2020-11-16 10:48:42.701|2.9329556976986013  |
|2020-11-16 10:48:42.706|1.1087520027663345  |
|2020-11-16 10:48:42.711|1.2115868818351045  |
|2020-11-16 10:48:42.716|1.9163661519192294  |
|2020-11-16 10:48:42.722|1.6917128257752045  |
|2020-11-16 10:48:42.727|1.0095879056962782  |
|2020-11-16 10:48:42.732|-0.13611276130309613|
|2020-11-16 10:48:42.737|2.2939319088848023  |
+-----------------------+--------------------+
only showing top 10 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="youtry"><a class="header" href="#youtry">YouTry</a></h1>
<h2 id="write-a-mixture-of-two-random-graph-models-for-file-streaming-later"><a class="header" href="#write-a-mixture-of-two-random-graph-models-for-file-streaming-later">Write a mixture of two random graph models for file streaming later</a></h2>
<h3 id="this-could-turn-into-a-potential-project-whereby-you-develop-a-framework-for-simulating-a-stream-of-random-graphs"><a class="header" href="#this-could-turn-into-a-potential-project-whereby-you-develop-a-framework-for-simulating-a-stream-of-random-graphs">This could turn into a potential project whereby you develop a framework for simulating a stream of random graphs...</a></h3>
<p>We will use it as a basic simulator for timeseries of network data. This can be extended for specific domains like network security where extra fields can be added for protocols, ports, etc.</p>
<p>The raw ingredients are here... more or less.</p>
</div>
<div class="cell markdown">
<p>Read the code from github</p>
<ul>
<li>https://github.com/apache/spark/blob/master/graphx/src/main/scala/org/apache/spark/graphx/util/GraphGenerators.scala</li>
<li>Also check out: https://github.com/graphframes/graphframes/blob/master/src/main/scala/org/graphframes/examples/Graphs.scala</li>
</ul>
</div>
<div class="cell markdown">
<p>Let's focus on the two of the simplest (deterministic) graphs.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.util.Random

import org.apache.spark.graphx.{Graph, VertexId}
import org.apache.spark.graphx.util.GraphGenerators
import org.apache.spark.sql.functions.lit // import the lit function in sql
import org.graphframes._

/*
// A graph with edge attributes containing distances
val graph: Graph[Long, Double] = GraphGenerators.logNormalGraph(sc, numVertices = 50, seed=12345L).mapEdges { e =&gt; 
  // to make things nicer we assign 0 distance to itself
  if (e.srcId == e.dstId) 0.0 else Random.nextDouble()
}
*/

val graph: Graph[(Int,Int), Double] = GraphGenerators.gridGraph(sc, 5,5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.util.Random
import org.apache.spark.graphx.{Graph, VertexId}
import org.apache.spark.graphx.util.GraphGenerators
import org.apache.spark.sql.functions.lit
import org.graphframes._
graph: org.apache.spark.graphx.Graph[(Int, Int),Double] = org.apache.spark.graphx.impl.GraphImpl@2afd1b5c
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val g = GraphFrame.fromGraphX(graph)
val gE= g.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)) // for us the column count is just an edge incidence
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>g: org.graphframes.GraphFrame = GraphFrame(v:[id: bigint, attr: struct&lt;_1: int, _2: int&gt;], e:[src: bigint, dst: bigint ... 1 more field])
gE: org.apache.spark.sql.DataFrame = [src: bigint, dest: bigint ... 1 more field]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<div class="output execute_result plain_result" execution_count="1">
<pre><code>Warning: classes defined within packages cannot be redefined without a cluster restart.
Compilation successful.
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<pre><code class="language-scala">d3.graphs.force(
  height = 500,
  width = 500,
  clicks = gE.as[d3.Edge])
</code></pre>
<div class="output execute_result html_result" execution_count="1">
<style>

.node_circle {
  stroke: #777;
  stroke-width: 1.3px;
}

.node_label {
  pointer-events: none;
}

.link {
  stroke: #777;
  stroke-opacity: .2;
}

.node_count {
  stroke: #777;
  stroke-width: 1.0px;
  fill: #999;
}

text.legend {
  font-family: Verdana;
  font-size: 13px;
  fill: #000;
}

.node text {
  font-family: "Helvetica Neue","Helvetica","Arial",sans-serif;
  font-size: 17px;
  font-weight: 200;
}

</style>
<div id="clicks-graph">
<script src="//d3js.org/d3.v3.min.js"></script>
<script>
<p>var graph = {&quot;nodes&quot;:[{&quot;name&quot;:&quot;12&quot;},{&quot;name&quot;:&quot;8&quot;},{&quot;name&quot;:&quot;19&quot;},{&quot;name&quot;:&quot;23&quot;},{&quot;name&quot;:&quot;4&quot;},{&quot;name&quot;:&quot;15&quot;},{&quot;name&quot;:&quot;11&quot;},{&quot;name&quot;:&quot;9&quot;},{&quot;name&quot;:&quot;22&quot;},{&quot;name&quot;:&quot;13&quot;},{&quot;name&quot;:&quot;24&quot;},{&quot;name&quot;:&quot;16&quot;},{&quot;name&quot;:&quot;5&quot;},{&quot;name&quot;:&quot;10&quot;},{&quot;name&quot;:&quot;21&quot;},{&quot;name&quot;:&quot;6&quot;},{&quot;name&quot;:&quot;1&quot;},{&quot;name&quot;:&quot;17&quot;},{&quot;name&quot;:&quot;14&quot;},{&quot;name&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;20&quot;},{&quot;name&quot;:&quot;2&quot;},{&quot;name&quot;:&quot;18&quot;},{&quot;name&quot;:&quot;7&quot;},{&quot;name&quot;:&quot;3&quot;}],&quot;links&quot;:[{&quot;source&quot;:19,&quot;target&quot;:16,&quot;value&quot;:1},{&quot;source&quot;:19,&quot;target&quot;:12,&quot;value&quot;:1},{&quot;source&quot;:16,&quot;target&quot;:21,&quot;value&quot;:1},{&quot;source&quot;:16,&quot;target&quot;:15,&quot;value&quot;:1},{&quot;source&quot;:21,&quot;target&quot;:24,&quot;value&quot;:1},{&quot;source&quot;:21,&quot;target&quot;:23,&quot;value&quot;:1},{&quot;source&quot;:24,&quot;target&quot;:4,&quot;value&quot;:1},{&quot;source&quot;:24,&quot;target&quot;:1,&quot;value&quot;:1},{&quot;source&quot;:4,&quot;target&quot;:7,&quot;value&quot;:1},{&quot;source&quot;:12,&quot;target&quot;:15,&quot;value&quot;:1},{&quot;source&quot;:12,&quot;target&quot;:13,&quot;value&quot;:1},{&quot;source&quot;:15,&quot;target&quot;:23,&quot;value&quot;:1},{&quot;source&quot;:15,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:23,&quot;target&quot;:1,&quot;value&quot;:1},{&quot;source&quot;:23,&quot;target&quot;:0,&quot;value&quot;:1},{&quot;source&quot;:1,&quot;target&quot;:7,&quot;value&quot;:1},{&quot;source&quot;:1,&quot;target&quot;:9,&quot;value&quot;:1},{&quot;source&quot;:7,&quot;target&quot;:18,&quot;value&quot;:1},{&quot;source&quot;:13,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:13,&quot;target&quot;:5,&quot;value&quot;:1},{&quot;source&quot;:6,&quot;target&quot;:0,&quot;value&quot;:1},{&quot;source&quot;:6,&quot;target&quot;:11,&quot;value&quot;:1},{&quot;source&quot;:0,&quot;target&quot;:9,&quot;value&quot;:1},{&quot;source&quot;:0,&quot;target&quot;:17,&quot;value&quot;:1},{&quot;source&quot;:9,&quot;target&quot;:18,&quot;value&quot;:1},{&quot;source&quot;:9,&quot;target&quot;:22,&quot;value&quot;:1},{&quot;source&quot;:18,&quot;target&quot;:2,&quot;value&quot;:1},{&quot;source&quot;:5,&quot;target&quot;:11,&quot;value&quot;:1},{&quot;source&quot;:5,&quot;target&quot;:20,&quot;value&quot;:1},{&quot;source&quot;:11,&quot;target&quot;:17,&quot;value&quot;:1},{&quot;source&quot;:11,&quot;target&quot;:14,&quot;value&quot;:1},{&quot;source&quot;:17,&quot;target&quot;:22,&quot;value&quot;:1},{&quot;source&quot;:17,&quot;target&quot;:8,&quot;value&quot;:1},{&quot;source&quot;:22,&quot;target&quot;:2,&quot;value&quot;:1},{&quot;source&quot;:22,&quot;target&quot;:3,&quot;value&quot;:1},{&quot;source&quot;:2,&quot;target&quot;:10,&quot;value&quot;:1},{&quot;source&quot;:20,&quot;target&quot;:14,&quot;value&quot;:1},{&quot;source&quot;:14,&quot;target&quot;:8,&quot;value&quot;:1},{&quot;source&quot;:8,&quot;target&quot;:3,&quot;value&quot;:1},{&quot;source&quot;:3,&quot;target&quot;:10,&quot;value&quot;:1}]};</p>
<p>var width = 500,
height = 500;</p>
<p>var color = d3.scale.category20();</p>
<p>var force = d3.layout.force()
.charge(-700)
.linkDistance(180)
.size([width, height]);</p>
<p>var svg = d3.select(&quot;#clicks-graph&quot;).append(&quot;svg&quot;)
.attr(&quot;width&quot;, width)
.attr(&quot;height&quot;, height);</p>
<p>force
.nodes(graph.nodes)
.links(graph.links)
.start();</p>
<p>var link = svg.selectAll(&quot;.link&quot;)
.data(graph.links)
.enter().append(&quot;line&quot;)
.attr(&quot;class&quot;, &quot;link&quot;)
.style(&quot;stroke-width&quot;, function(d) { return Math.sqrt(d.value); });</p>
<p>var node = svg.selectAll(&quot;.node&quot;)
.data(graph.nodes)
.enter().append(&quot;g&quot;)
.attr(&quot;class&quot;, &quot;node&quot;)
.call(force.drag);</p>
<p>node.append(&quot;circle&quot;)
.attr(&quot;r&quot;, 10)
.style(&quot;fill&quot;, function (d) {
if (d.name.startsWith(&quot;other&quot;)) { return color(1); } else { return color(2); };
})</p>
<p>node.append(&quot;text&quot;)
.attr(&quot;dx&quot;, 10)
.attr(&quot;dy&quot;, &quot;.35em&quot;)
.text(function(d) { return d.name });</p>
<p>//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements
force.on(&quot;tick&quot;, function () {
link.attr(&quot;x1&quot;, function (d) {
return d.source.x;
})
.attr(&quot;y1&quot;, function (d) {
return d.source.y;
})
.attr(&quot;x2&quot;, function (d) {
return d.target.x;
})
.attr(&quot;y2&quot;, function (d) {
return d.target.y;
});
d3.selectAll(&quot;circle&quot;).attr(&quot;cx&quot;, function (d) {
return d.x;
})
.attr(&quot;cy&quot;, function (d) {
return d.y;
});
d3.selectAll(&quot;text&quot;).attr(&quot;x&quot;, function (d) {
return d.x;
})
.attr(&quot;y&quot;, function (d) {
return d.y;
});
});
</script></p>
</div>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<pre><code class="language-scala">val graphStar: Graph[Int, Int] = GraphGenerators.starGraph(sc, 10)
val gS = GraphFrame.fromGraphX(graphStar)
val gSE= gS.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)) // for us the column count is just an edge incidence
d3.graphs.force(
  height = 500,
  width = 500,
  clicks = gSE.as[d3.Edge])
</code></pre>
<div class="output execute_result html_result" execution_count="1">
<style>

.node_circle {
  stroke: #777;
  stroke-width: 1.3px;
}

.node_label {
  pointer-events: none;
}

.link {
  stroke: #777;
  stroke-opacity: .2;
}

.node_count {
  stroke: #777;
  stroke-width: 1.0px;
  fill: #999;
}

text.legend {
  font-family: Verdana;
  font-size: 13px;
  fill: #000;
}

.node text {
  font-family: "Helvetica Neue","Helvetica","Arial",sans-serif;
  font-size: 17px;
  font-weight: 200;
}

</style>
<div id="clicks-graph">
<script src="//d3js.org/d3.v3.min.js"></script>
<script>
<p>var graph = {&quot;nodes&quot;:[{&quot;name&quot;:&quot;8&quot;},{&quot;name&quot;:&quot;4&quot;},{&quot;name&quot;:&quot;9&quot;},{&quot;name&quot;:&quot;5&quot;},{&quot;name&quot;:&quot;6&quot;},{&quot;name&quot;:&quot;1&quot;},{&quot;name&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;2&quot;},{&quot;name&quot;:&quot;7&quot;},{&quot;name&quot;:&quot;3&quot;}],&quot;links&quot;:[{&quot;source&quot;:5,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:7,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:9,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:1,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:3,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:4,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:8,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:0,&quot;target&quot;:6,&quot;value&quot;:1},{&quot;source&quot;:2,&quot;target&quot;:6,&quot;value&quot;:1}]};</p>
<p>var width = 500,
height = 500;</p>
<p>var color = d3.scale.category20();</p>
<p>var force = d3.layout.force()
.charge(-700)
.linkDistance(180)
.size([width, height]);</p>
<p>var svg = d3.select(&quot;#clicks-graph&quot;).append(&quot;svg&quot;)
.attr(&quot;width&quot;, width)
.attr(&quot;height&quot;, height);</p>
<p>force
.nodes(graph.nodes)
.links(graph.links)
.start();</p>
<p>var link = svg.selectAll(&quot;.link&quot;)
.data(graph.links)
.enter().append(&quot;line&quot;)
.attr(&quot;class&quot;, &quot;link&quot;)
.style(&quot;stroke-width&quot;, function(d) { return Math.sqrt(d.value); });</p>
<p>var node = svg.selectAll(&quot;.node&quot;)
.data(graph.nodes)
.enter().append(&quot;g&quot;)
.attr(&quot;class&quot;, &quot;node&quot;)
.call(force.drag);</p>
<p>node.append(&quot;circle&quot;)
.attr(&quot;r&quot;, 10)
.style(&quot;fill&quot;, function (d) {
if (d.name.startsWith(&quot;other&quot;)) { return color(1); } else { return color(2); };
})</p>
<p>node.append(&quot;text&quot;)
.attr(&quot;dx&quot;, 10)
.attr(&quot;dy&quot;, &quot;.35em&quot;)
.text(function(d) { return d.name });</p>
<p>//Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements
force.on(&quot;tick&quot;, function () {
link.attr(&quot;x1&quot;, function (d) {
return d.source.x;
})
.attr(&quot;y1&quot;, function (d) {
return d.source.y;
})
.attr(&quot;x2&quot;, function (d) {
return d.target.x;
})
.attr(&quot;y2&quot;, function (d) {
return d.target.y;
});
d3.selectAll(&quot;circle&quot;).attr(&quot;cx&quot;, function (d) {
return d.x;
})
.attr(&quot;cy&quot;, function (d) {
return d.y;
});
d3.selectAll(&quot;text&quot;).attr(&quot;x&quot;, function (d) {
return d.x;
})
.attr(&quot;y&quot;, function (d) {
return d.y;
});
});
</script></p>
</div>
</div>
</div>
<div class="cell markdown">
<h1 id="now-write-code-to-simulate-from-a-mixture-of-graphs-models"><a class="header" href="#now-write-code-to-simulate-from-a-mixture-of-graphs-models">Now, write code to simulate from a mixture of graphs models</a></h1>
<ul>
<li>See <code>037a_...</code> and <code>037b_...</code> notebooks for the file writing pattern.</li>
<li>First try, grid and star with 98%-2% mixture, respectively</li>
<li>Second, try a truly random graph like lognormal degree distributed random graph and star</li>
<li>Try to make a simulation of random networks that is closer to your domain of application (you can always drop in to python and R for this part - even using non-distributed algorithms for simulating large enough networks per burst).</li>
</ul>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val graphGrid: Graph[(Int,Int), Double] = GraphGenerators.gridGraph(sc, 50,50)
val gG = GraphFrame.fromGraphX(graphGrid)
gG.edges.count
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>graphGrid: org.apache.spark.graphx.Graph[(Int, Int),Double] = org.apache.spark.graphx.impl.GraphImpl@160a43de
gG: org.graphframes.GraphFrame = GraphFrame(v:[id: bigint, attr: struct&lt;_1: int, _2: int&gt;], e:[src: bigint, dst: bigint ... 1 more field])
res10: Long = 4900
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val graphStar: Graph[Int, Int] = GraphGenerators.starGraph(sc, 101)
val gS = GraphFrame.fromGraphX(graphStar)
gS.edges.count
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>graphStar: org.apache.spark.graphx.Graph[Int,Int] = org.apache.spark.graphx.impl.GraphImpl@4395a75
gS: org.graphframes.GraphFrame = GraphFrame(v:[id: bigint, attr: int], e:[src: bigint, dst: bigint ... 1 more field])
res13: Long = 100
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val gAllEdges = gS.edges.union(gG.edges)
gAllEdges.count
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>gAllEdges: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [src: bigint, dst: bigint ... 1 more field]
res16: Long = 5000
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">100.0/5000.0
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res20: Double = 0.02
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="structured-streaming---a-programming-guide-walkthrough"><a class="header" href="#structured-streaming---a-programming-guide-walkthrough">Structured Streaming - A Programming Guide Walkthrough</a></h1>
<ul>
<li><a href="https://spark.apache.org/docs/3.0.1/structured-streaming-programming-guide.html">Structured Streaming Programming Guide</a></li>
</ul>
</div>
<div class="cell markdown">
<h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>Structured Streaming is a scalable and fault-tolerant stream processing engine built on the Spark SQL engine. You can express your streaming computation the same way you would express a batch computation on static data. The Spark SQL engine will take care of running it incrementally and continuously and updating the final result as streaming data continues to arrive. You can use the <a href="https://spark.apache.org/docs/3.0.1/sql-programming-guide.html">Dataset/DataFrame API</a> in Scala, Java, Python or R to express streaming aggregations, event-time windows, stream-to-batch joins, etc. The computation is executed on the same optimized Spark SQL engine. Finally, the system ensures end-to-end exactly-once fault-tolerance guarantees through checkpointing and Write Ahead Logs. In short, <em>Structured Streaming provides fast, scalable, fault-tolerant, end-to-end exactly-once stream processing without the user having to reason about streaming.</em></p>
<p>In this guide, we are going to walk you through the programming model and the APIs. First, let’s start with a simple example - a streaming word count.</p>
</div>
<div class="cell markdown">
<h1 id="programming-model"><a class="header" href="#programming-model">Programming Model</a></h1>
<p>The key idea in Structured Streaming is to treat a live data stream as a table that is being continuously appended. This leads to a new stream processing model that is very similar to a batch processing model. You will express your streaming computation as standard batch-like query as on a static table, and Spark runs it as an <em>incremental</em> query on the <em>unbounded</em> input table. Let’s understand this model in more detail.</p>
<h2 id="basic-concepts"><a class="header" href="#basic-concepts">Basic Concepts</a></h2>
<p>Consider the input data stream as the “Input Table”. Every data item that is arriving on the stream is like a new row being appended to the Input Table.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-stream-as-a-table.png" alt="Stream as a Table" title="Stream as a Table" /></p>
<p>A query on the input will generate the “Result Table”. Every trigger interval (say, every 1 second), new rows get appended to the Input Table, which eventually updates the Result Table. Whenever the result table gets updated, we would want to write the changed result rows to an external sink.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-model.png" alt="Model" /></p>
<p>The “Output” is defined as what gets written out to the external storage. The output can be defined in a different mode:</p>
<ul>
<li>
<p><em>Complete Mode</em> - The entire updated Result Table will be written to the external storage. It is up to the storage connector to decide how to handle writing of the entire table.</p>
</li>
<li>
<p><em>Append Mode</em> - Only the new rows appended in the Result Table since the last trigger will be written to the external storage. This is applicable only on the queries where existing rows in the Result Table are not expected to change.</p>
</li>
<li>
<p><em>Update Mode</em> - Only the rows that were updated in the Result Table since the last trigger will be written to the external storage (available since Spark 2.1.1). Note that this is different from the Complete Mode in that this mode only outputs the rows that have changed since the last trigger. If the query doesn’t contain aggregations, it will be equivalent to Append mode.</p>
</li>
</ul>
<p>Note that each mode is applicable on certain types of queries. This is discussed in detail later on <em>output-modes</em>. To illustrate the use of this model, let’s understand the model in context of the <strong>Quick Example</strong> above.</p>
<p>The first <code>streamingLines</code> DataFrame is the input table, and the final <code>wordCounts</code> DataFrame is the result table. Note that the query on <code>streamingLines</code> DataFrame to generate <code>wordCounts</code> is <em>exactly the same</em> as it would be a static DataFrame. However, when this query is started, Spark will continuously check for new data from the directory. If there is new data, Spark will run an “incremental” query that combines the previous running counts with the new data to compute updated counts, as shown below.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-example-model.png" alt="Model" /></p>
<p>This model is significantly different from many other stream processing engines. Many streaming systems require the user to maintain running aggregations themselves, thus having to reason about fault-tolerance, and data consistency (at-least-once, or at-most-once, or exactly-once). In this model, Spark is responsible for updating the Result Table when there is new data, thus relieving the users from reasoning about it. As an example, let’s see how this model handles event-time based processing and late arriving data.</p>
</div>
<div class="cell markdown">
<h1 id="quick-example"><a class="header" href="#quick-example">Quick Example</a></h1>
<p>Let’s say you want to maintain a running word count of text data received from a file writer that is writing files into a directory <code>datasets/streamingFiles</code> in the distributed file system. Let’s see how you can express this using Structured Streaming.</p>
<p>Let’s walk through the example step-by-step and understand how it works.</p>
<p><strong>First</strong> we need to start a file writing job in the companion notebook <code>037a_AnimalNamesStructStreamingFiles</code> and then return here.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFiles&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_10.log</td>
<td>20_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_12.log</td>
<td>20_12.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_14.log</td>
<td>20_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_16.log</td>
<td>20_16.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_18.log</td>
<td>20_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_20.log</td>
<td>20_20.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_22.log</td>
<td>20_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_24.log</td>
<td>20_24.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_26.log</td>
<td>20_26.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_28.log</td>
<td>20_28.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_30.log</td>
<td>20_30.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_32.log</td>
<td>20_32.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_34.log</td>
<td>20_34.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_36.log</td>
<td>20_36.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_38.log</td>
<td>20_38.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_40.log</td>
<td>20_40.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_42.log</td>
<td>20_42.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_44.log</td>
<td>20_44.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_46.log</td>
<td>20_46.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_47.log</td>
<td>20_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_48.log</td>
<td>20_48.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_49.log</td>
<td>20_49.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_50.log</td>
<td>20_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_51.log</td>
<td>20_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_52.log</td>
<td>20_52.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_53.log</td>
<td>20_53.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_54.log</td>
<td>20_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_55.log</td>
<td>20_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_56.log</td>
<td>20_56.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_57.log</td>
<td>20_57.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/20_58.log</td>
<td>20_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/20_59.log</td>
<td>20_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_00.log</td>
<td>21_00.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_01.log</td>
<td>21_01.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_02.log</td>
<td>21_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_03.log</td>
<td>21_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_04.log</td>
<td>21_04.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_05.log</td>
<td>21_05.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_06.log</td>
<td>21_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_07.log</td>
<td>21_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_08.log</td>
<td>21_08.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_09.log</td>
<td>21_09.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_10.log</td>
<td>21_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_11.log</td>
<td>21_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_12.log</td>
<td>21_12.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_13.log</td>
<td>21_13.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_14.log</td>
<td>21_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_15.log</td>
<td>21_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_16.log</td>
<td>21_16.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_17.log</td>
<td>21_17.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_18.log</td>
<td>21_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_19.log</td>
<td>21_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_20.log</td>
<td>21_20.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_21.log</td>
<td>21_21.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_22.log</td>
<td>21_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_23.log</td>
<td>21_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_24.log</td>
<td>21_24.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_25.log</td>
<td>21_25.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_26.log</td>
<td>21_26.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_27.log</td>
<td>21_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_28.log</td>
<td>21_28.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_29.log</td>
<td>21_29.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_30.log</td>
<td>21_30.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_31.log</td>
<td>21_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_32.log</td>
<td>21_32.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_33.log</td>
<td>21_33.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_34.log</td>
<td>21_34.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_35.log</td>
<td>21_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_36.log</td>
<td>21_36.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_37.log</td>
<td>21_37.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_38.log</td>
<td>21_38.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_39.log</td>
<td>21_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_40.log</td>
<td>21_40.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_41.log</td>
<td>21_41.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_42.log</td>
<td>21_42.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_43.log</td>
<td>21_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_44.log</td>
<td>21_44.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_45.log</td>
<td>21_45.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_46.log</td>
<td>21_46.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_47.log</td>
<td>21_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_48.log</td>
<td>21_48.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_49.log</td>
<td>21_49.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_50.log</td>
<td>21_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_51.log</td>
<td>21_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_52.log</td>
<td>21_52.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_53.log</td>
<td>21_53.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_54.log</td>
<td>21_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_55.log</td>
<td>21_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_56.log</td>
<td>21_56.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_57.log</td>
<td>21_57.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/21_58.log</td>
<td>21_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/21_59.log</td>
<td>21_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_00.log</td>
<td>22_00.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_01.log</td>
<td>22_01.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_02.log</td>
<td>22_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_03.log</td>
<td>22_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_04.log</td>
<td>22_04.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_05.log</td>
<td>22_05.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_06.log</td>
<td>22_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_07.log</td>
<td>22_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_08.log</td>
<td>22_08.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_09.log</td>
<td>22_09.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_10.log</td>
<td>22_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_11.log</td>
<td>22_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_12.log</td>
<td>22_12.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_13.log</td>
<td>22_13.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_14.log</td>
<td>22_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_15.log</td>
<td>22_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_16.log</td>
<td>22_16.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_17.log</td>
<td>22_17.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_18.log</td>
<td>22_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_19.log</td>
<td>22_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_20.log</td>
<td>22_20.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_21.log</td>
<td>22_21.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_22.log</td>
<td>22_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_23.log</td>
<td>22_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_24.log</td>
<td>22_24.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_25.log</td>
<td>22_25.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_26.log</td>
<td>22_26.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_27.log</td>
<td>22_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_28.log</td>
<td>22_28.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_29.log</td>
<td>22_29.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_30.log</td>
<td>22_30.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_31.log</td>
<td>22_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_32.log</td>
<td>22_32.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_33.log</td>
<td>22_33.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_34.log</td>
<td>22_34.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_35.log</td>
<td>22_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_36.log</td>
<td>22_36.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_37.log</td>
<td>22_37.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_38.log</td>
<td>22_38.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_39.log</td>
<td>22_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_40.log</td>
<td>22_40.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_41.log</td>
<td>22_41.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_42.log</td>
<td>22_42.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_43.log</td>
<td>22_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_44.log</td>
<td>22_44.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_45.log</td>
<td>22_45.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_46.log</td>
<td>22_46.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_47.log</td>
<td>22_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_48.log</td>
<td>22_48.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_49.log</td>
<td>22_49.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_50.log</td>
<td>22_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_51.log</td>
<td>22_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_52.log</td>
<td>22_52.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_53.log</td>
<td>22_53.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_54.log</td>
<td>22_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_55.log</td>
<td>22_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_56.log</td>
<td>22_56.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_57.log</td>
<td>22_57.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/22_58.log</td>
<td>22_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/22_59.log</td>
<td>22_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_00.log</td>
<td>23_00.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_01.log</td>
<td>23_01.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_02.log</td>
<td>23_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_03.log</td>
<td>23_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_04.log</td>
<td>23_04.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_05.log</td>
<td>23_05.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_06.log</td>
<td>23_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_07.log</td>
<td>23_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_08.log</td>
<td>23_08.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_09.log</td>
<td>23_09.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_10.log</td>
<td>23_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_11.log</td>
<td>23_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_12.log</td>
<td>23_12.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_13.log</td>
<td>23_13.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_14.log</td>
<td>23_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_15.log</td>
<td>23_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_16.log</td>
<td>23_16.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_17.log</td>
<td>23_17.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_18.log</td>
<td>23_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_19.log</td>
<td>23_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_20.log</td>
<td>23_20.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_21.log</td>
<td>23_21.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_22.log</td>
<td>23_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_23.log</td>
<td>23_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_24.log</td>
<td>23_24.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_25.log</td>
<td>23_25.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_26.log</td>
<td>23_26.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_27.log</td>
<td>23_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_28.log</td>
<td>23_28.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_29.log</td>
<td>23_29.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_30.log</td>
<td>23_30.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_31.log</td>
<td>23_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_32.log</td>
<td>23_32.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_33.log</td>
<td>23_33.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_34.log</td>
<td>23_34.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_35.log</td>
<td>23_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_36.log</td>
<td>23_36.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_37.log</td>
<td>23_37.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_38.log</td>
<td>23_38.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_39.log</td>
<td>23_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_40.log</td>
<td>23_40.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_41.log</td>
<td>23_41.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_42.log</td>
<td>23_42.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_43.log</td>
<td>23_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_44.log</td>
<td>23_44.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_45.log</td>
<td>23_45.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_46.log</td>
<td>23_46.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_47.log</td>
<td>23_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_48.log</td>
<td>23_48.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_49.log</td>
<td>23_49.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_50.log</td>
<td>23_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_51.log</td>
<td>23_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_52.log</td>
<td>23_52.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_53.log</td>
<td>23_53.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_54.log</td>
<td>23_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_55.log</td>
<td>23_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_56.log</td>
<td>23_56.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_57.log</td>
<td>23_57.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/23_58.log</td>
<td>23_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/23_59.log</td>
<td>23_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_00.log</td>
<td>24_00.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_01.log</td>
<td>24_01.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_02.log</td>
<td>24_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_03.log</td>
<td>24_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_04.log</td>
<td>24_04.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_05.log</td>
<td>24_05.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_06.log</td>
<td>24_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_07.log</td>
<td>24_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_08.log</td>
<td>24_08.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_09.log</td>
<td>24_09.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_10.log</td>
<td>24_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_11.log</td>
<td>24_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_12.log</td>
<td>24_12.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_13.log</td>
<td>24_13.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_14.log</td>
<td>24_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_15.log</td>
<td>24_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_16.log</td>
<td>24_16.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_17.log</td>
<td>24_17.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_18.log</td>
<td>24_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_19.log</td>
<td>24_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_20.log</td>
<td>24_20.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_21.log</td>
<td>24_21.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_22.log</td>
<td>24_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_23.log</td>
<td>24_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_24.log</td>
<td>24_24.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_25.log</td>
<td>24_25.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_27.log</td>
<td>24_27.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_29.log</td>
<td>24_29.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_31.log</td>
<td>24_31.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_33.log</td>
<td>24_33.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_35.log</td>
<td>24_35.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_37.log</td>
<td>24_37.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_39.log</td>
<td>24_39.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_41.log</td>
<td>24_41.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_43.log</td>
<td>24_43.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_45.log</td>
<td>24_45.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_47.log</td>
<td>24_47.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_49.log</td>
<td>24_49.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_50.log</td>
<td>24_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_51.log</td>
<td>24_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_53.log</td>
<td>24_53.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_55.log</td>
<td>24_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/24_57.log</td>
<td>24_57.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/24_59.log</td>
<td>24_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_01.log</td>
<td>25_01.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_03.log</td>
<td>25_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_05.log</td>
<td>25_05.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_07.log</td>
<td>25_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_09.log</td>
<td>25_09.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_11.log</td>
<td>25_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_13.log</td>
<td>25_13.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_15.log</td>
<td>25_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_17.log</td>
<td>25_17.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_19.log</td>
<td>25_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_21.log</td>
<td>25_21.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_23.log</td>
<td>25_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_25.log</td>
<td>25_25.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_27.log</td>
<td>25_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_29.log</td>
<td>25_29.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_31.log</td>
<td>25_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_33.log</td>
<td>25_33.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_35.log</td>
<td>25_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_37.log</td>
<td>25_37.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_39.log</td>
<td>25_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_41.log</td>
<td>25_41.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_43.log</td>
<td>25_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_45.log</td>
<td>25_45.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_47.log</td>
<td>25_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_49.log</td>
<td>25_49.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_51.log</td>
<td>25_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_53.log</td>
<td>25_53.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_55.log</td>
<td>25_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/25_57.log</td>
<td>25_57.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/25_59.log</td>
<td>25_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_01.log</td>
<td>26_01.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_03.log</td>
<td>26_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_05.log</td>
<td>26_05.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_07.log</td>
<td>26_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_09.log</td>
<td>26_09.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_11.log</td>
<td>26_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_13.log</td>
<td>26_13.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_15.log</td>
<td>26_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_17.log</td>
<td>26_17.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_19.log</td>
<td>26_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_21.log</td>
<td>26_21.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_23.log</td>
<td>26_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_25.log</td>
<td>26_25.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_27.log</td>
<td>26_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_29.log</td>
<td>26_29.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_31.log</td>
<td>26_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_33.log</td>
<td>26_33.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_35.log</td>
<td>26_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_37.log</td>
<td>26_37.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_39.log</td>
<td>26_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_41.log</td>
<td>26_41.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_43.log</td>
<td>26_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_45.log</td>
<td>26_45.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_47.log</td>
<td>26_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_49.log</td>
<td>26_49.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_51.log</td>
<td>26_51.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_53.log</td>
<td>26_53.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_55.log</td>
<td>26_55.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/26_57.log</td>
<td>26_57.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/26_59.log</td>
<td>26_59.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_01.log</td>
<td>27_01.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_03.log</td>
<td>27_03.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_05.log</td>
<td>27_05.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_07.log</td>
<td>27_07.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_09.log</td>
<td>27_09.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_11.log</td>
<td>27_11.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_13.log</td>
<td>27_13.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_15.log</td>
<td>27_15.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_17.log</td>
<td>27_17.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_19.log</td>
<td>27_19.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_21.log</td>
<td>27_21.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_23.log</td>
<td>27_23.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_25.log</td>
<td>27_25.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_27.log</td>
<td>27_27.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_29.log</td>
<td>27_29.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_31.log</td>
<td>27_31.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_33.log</td>
<td>27_33.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_35.log</td>
<td>27_35.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_37.log</td>
<td>27_37.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_39.log</td>
<td>27_39.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_41.log</td>
<td>27_41.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_43.log</td>
<td>27_43.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_45.log</td>
<td>27_45.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_47.log</td>
<td>27_47.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_50.log</td>
<td>27_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_52.log</td>
<td>27_52.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_54.log</td>
<td>27_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/27_56.log</td>
<td>27_56.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/27_58.log</td>
<td>27_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_00.log</td>
<td>28_00.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_02.log</td>
<td>28_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_04.log</td>
<td>28_04.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_06.log</td>
<td>28_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_08.log</td>
<td>28_08.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_10.log</td>
<td>28_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_12.log</td>
<td>28_12.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_14.log</td>
<td>28_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_16.log</td>
<td>28_16.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_18.log</td>
<td>28_18.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_20.log</td>
<td>28_20.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_22.log</td>
<td>28_22.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_24.log</td>
<td>28_24.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_26.log</td>
<td>28_26.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_28.log</td>
<td>28_28.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_30.log</td>
<td>28_30.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_32.log</td>
<td>28_32.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_34.log</td>
<td>28_34.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_36.log</td>
<td>28_36.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_38.log</td>
<td>28_38.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_40.log</td>
<td>28_40.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_42.log</td>
<td>28_42.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_44.log</td>
<td>28_44.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_46.log</td>
<td>28_46.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_48.log</td>
<td>28_48.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_50.log</td>
<td>28_50.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_52.log</td>
<td>28_52.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_54.log</td>
<td>28_54.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/28_56.log</td>
<td>28_56.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/28_58.log</td>
<td>28_58.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/29_00.log</td>
<td>29_00.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/29_02.log</td>
<td>29_02.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/29_04.log</td>
<td>29_04.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/29_06.log</td>
<td>29_06.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/29_08.log</td>
<td>29_08.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/29_10.log</td>
<td>29_10.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/29_12.log</td>
<td>29_12.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/29_14.log</td>
<td>29_14.log</td>
<td>35.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/29_16.log</td>
<td>29_16.log</td>
<td>35.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/29_28.log</td>
<td>29_28.log</td>
<td>35.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">dbutils.fs.head(&quot;/datasets/streamingFiles/20_16.log&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res1: String =
&quot;2020-11-20 13:20:16+00:00; cat pig
&quot;
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Next, let’s create a streaming DataFrame that represents text data received from the directory, and transform the DataFrame to calculate word counts.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.types._

// Create DataFrame representing the stream of input lines from files in distributed file store
//val textFileSchema = new StructType().add(&quot;line&quot;, &quot;string&quot;) // for a custom schema

val streamingLines = spark
  .readStream
  //.schema(textFileSchema) // using default -&gt; makes a column of String named value
  .option(&quot;MaxFilesPerTrigger&quot;, 1) //  maximum number of new files to be considered in every trigger (default: no max) 
  .format(&quot;text&quot;)
  .load(&quot;/datasets/streamingFiles&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
streamingLines: org.apache.spark.sql.DataFrame = [value: string]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>This <code>streamingLines</code> DataFrame represents an unbounded table containing the streaming text data. This table contains one column of strings named “value”, and each line in the streaming text data becomes a row in the table. Note, that this is not currently receiving any data as we are just setting up the transformation, and have not yet started it.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(streamingLines)  // display will show you the contents of the DF
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2020-11-20 13:26:26+00:00; bat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:28:23+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:29:31+00:00; dog rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:19+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:01+00:00; bat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:11+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:07+00:00; cat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:48+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:22+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:15+00:00; dog cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:29:47+00:00; dog cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:09+00:00; cat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:45+00:00; bat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:30+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:42+00:00; bat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:50+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:14+00:00; bat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:25+00:00; dog owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:17+00:00; rat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:57+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:19+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:13+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:07+00:00; pig dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:04+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:58+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:49+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:22+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:35+00:00; dog owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:01+00:00; owl rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:32+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:12+00:00; bat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:26+00:00; owl dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:13+00:00; owl dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:12+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:00+00:00; owl dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:22+00:00; bat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:34+00:00; bat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:36+00:00; owl bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:04+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:54+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:30+00:00; owl dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:58+00:00; pig bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:01+00:00; dog rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:16+00:00; pig cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:20:53+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:21+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:30+00:00; owl dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:07+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:39+00:00; rat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:59+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:42+00:00; bat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:09+00:00; pig cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:08+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:58+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:29:23+00:00; rat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:27+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:50+00:00; rat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:42+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:21+00:00; cat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:52+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:15+00:00; pig owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:46+00:00; pig rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:32+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:13+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:20:49+00:00; owl dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:37+00:00; pig bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:56+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:10+00:00; bat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:07+00:00; dog pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:36+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:24+00:00; pig rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:24+00:00; pig cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:55+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:20:55+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:26+00:00; bat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:25+00:00; owl dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:38+00:00; bat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:19+00:00; pig cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:52+00:00; bat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:03+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:20:57+00:00; bat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:09+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:05+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:23+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:11+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:29+00:00; owl dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:31+00:00; dog owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:41+00:00; dog owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:35+00:00; rat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:28:09+00:00; rat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:55+00:00; pig rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:51+00:00; owl pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:10+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:36+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:03+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:46+00:00; rat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:17+00:00; rat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:28:53+00:00; bat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:47+00:00; owl rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:16+00:00; cat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:49+00:00; cat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:44+00:00; cat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:05+00:00; owl cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:28+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:46+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:27+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:53+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:10+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:16+00:00; pig rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:22+00:00; pig rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:34+00:00; pig rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:42+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:28+00:00; pig dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:20:47+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:18+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:28+00:00; pig rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:56+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:30+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:23+00:00; rat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:32:37+00:00; rat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:29+00:00; cat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:32:41+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:02+00:00; rat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:00+00:00; dog owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:59+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:09+00:00; cat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:24+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:46+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:43+00:00; dog rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:53+00:00; owl dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:27+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:38+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:20:59+00:00; rat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:19+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:15+00:00; bat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:23+00:00; owl pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:25+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:44+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:57+00:00; cat dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:40+00:00; pig rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:45+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:28:39+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:47+00:00; pig owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:17+00:00; bat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:12+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:15+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:11+00:00; pig rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:40+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:01+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:50+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:06+00:00; dog rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:38+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:14+00:00; cat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:36+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:56+00:00; dog rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:38+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:57+00:00; cat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:30+00:00; owl bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:06+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:17+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:29+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:40+00:00; dog owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:42+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:25+00:00; pig owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:35+00:00; pig owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:32+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:40+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:16+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:29+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:51+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:13+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:04+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:08+00:00; rat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:27+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:56+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:40+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:48+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:34:14+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:30+00:00; bat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:38+00:00; owl pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:24+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:34:08+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:10+00:00; dog pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:32+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:33:44+00:00; bat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:03+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:31+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:32:33+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:40+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:22+00:00; owl bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:05+00:00; cat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:11+00:00; owl cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:58+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:06+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:23+00:00; rat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:48+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:52+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:36+00:00; owl rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:51+00:00; rat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:43+00:00; bat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:32:49+00:00; owl bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:20+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:53+00:00; bat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:46+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:31+00:00; cat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:28:43+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:29+00:00; owl cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:22+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:21+00:00; bat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:32:39+00:00; pig dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:21:41+00:00; pig dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:26:10+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:00+00:00; pig owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:22:03+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:22:21+00:00; dog pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:05+00:00; bat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:02+00:00; cat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:02+00:00; pig bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:27:18+00:00; cat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:08+00:00; cat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:03+00:00; pig cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:05+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:26:18+00:00; owl rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:23:42+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:24+00:00; bat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:14+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:24+00:00; dog bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:40+00:00; dog rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:23:50+00:00; cat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:48+00:00; rat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:25+00:00; dog bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:21+00:00; dog bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:30:35+00:00; cat owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:38+00:00; owl rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:01+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:21:33+00:00; rat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:59+00:00; owl cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:33:16+00:00; cat owl</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:35:36+00:00; dog bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:34:36+00:00; rat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:34:34+00:00; pig dog</td>
</tr>
<tr class="even">
<td>2020-11-20 13:35:26+00:00; owl rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:34:58+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:35:24+00:00; cat bat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:35:22+00:00; dog pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:35:44+00:00; dog pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:34:26+00:00; cat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:35:18+00:00; bat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:29:43+00:00; owl cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:31:39+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:25:48+00:00; bat pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:27:08+00:00; cat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:47+00:00; pig bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:03+00:00; bat rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:55+00:00; bat cat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:32:43+00:00; cat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:35:34+00:00; cat bat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:24:52+00:00; cat pig</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:28:15+00:00; cat rat</td>
</tr>
<tr class="even">
<td>2020-11-20 13:30:37+00:00; bat cat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:10+00:00; owl pig</td>
</tr>
<tr class="even">
<td>2020-11-20 13:25:34+00:00; pig rat</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:31:51+00:00; dog owl</td>
</tr>
<tr class="even">
<td>2020-11-20 13:29:39+00:00; rat dog</td>
</tr>
<tr class="odd">
<td>2020-11-20 13:24:32+00:00; bat owl</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Next, we will convert the DataFrame to a Dataset of String using <code>.as[String]</code>, so that we can apply the <code>flatMap</code> operation to split each line into multiple words. The resultant <code>words</code> Dataset contains all the words.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val words = streamingLines.as[String]
                          .map(line =&gt; line.split(&quot;;&quot;).drop(1)(0)) // this is to simply cut out the timestamp from this stream
                          .flatMap(_.split(&quot; &quot;)) // flat map by splitting the animal words separated by whitespace
                          .filter( _ != &quot;&quot;) // remove empty words that may be artifacts of opening whitespace
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>words: org.apache.spark.sql.Dataset[String] = [value: string]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Finally, we define the <code>wordCounts</code> DataFrame by grouping by the unique values in the Dataset and counting them. Note that this is a streaming DataFrame which represents the <strong>running word counts of the stream</strong>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Generate running word count
val wordCounts = words
                  .groupBy(&quot;value&quot;).count() // this does the word count
                  .orderBy($&quot;count&quot;.desc) // we are simply sorting by the most frequent words
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>wordCounts: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [value: string, count: bigint]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We have now set up the query on the streaming data. All that is left is to actually start receiving data and computing the counts. To do this, we set it up to print the complete set of counts (specified by <code>outputMode(&quot;complete&quot;)</code>) to the console every time they are updated. And then start the streaming computation using <code>start()</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">// Start running the query that prints the running counts to the console
val query = wordCounts.writeStream
      .outputMode(&quot;complete&quot;)
      .format(&quot;console&quot;)
      .start()

query.awaitTermination() // hit cancel to terminate - killall the bash script in 037a_AnimalNamesStructStreamingFiles
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  cat|    1|
|  owl|    1|
+-----+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  cat|    2|
|  pig|    1|
|  owl|    1|
+-----+-----+

-------------------------------------------
Batch: 2
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  cat|    2|
|  pig|    2|
|  owl|    1|
|  dog|    1|
+-----+-----+

-------------------------------------------
Batch: 3
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  cat|    3|
|  dog|    2|
|  pig|    2|
|  owl|    1|
+-----+-----+

-------------------------------------------
Batch: 4
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  cat|    4|
|  pig|    3|
|  dog|    2|
|  owl|    1|
+-----+-----+

-------------------------------------------
Batch: 5
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  pig|    4|
|  cat|    4|
|  dog|    2|
|  owl|    1|
|  rat|    1|
+-----+-----+

-------------------------------------------
Batch: 6
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  pig|    5|
|  cat|    4|
|  dog|    2|
|  owl|    2|
|  rat|    1|
+-----+-----+

-------------------------------------------
Batch: 7
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  pig|    5|
|  cat|    4|
|  owl|    3|
|  dog|    2|
|  rat|    1|
|  bat|    1|
+-----+-----+

-------------------------------------------
Batch: 8
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  pig|    5|
|  cat|    4|
|  owl|    4|
|  dog|    2|
|  bat|    2|
|  rat|    1|
+-----+-----+

-------------------------------------------
Batch: 9
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  pig|    5|
|  owl|    5|
|  cat|    4|
|  bat|    3|
|  dog|    2|
|  rat|    1|
+-----+-----+

-------------------------------------------
Batch: 10
-------------------------------------------
+-----+-----+
|value|count|
+-----+-----+
|  owl|    5|
|  pig|    5|
|  bat|    4|
|  cat|    4|
|  dog|    2|
|  rat|    2|
+-----+-----+
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>After this code is executed, the streaming computation will have started in the background. The <code>query</code> object is a handle to that active streaming query, and we have decided to wait for the termination of the query using <code>awaitTermination()</code> to prevent the process from exiting while the query is active.</p>
</div>
<div class="cell markdown">
<h2 id="handling-event-time-and-late-data"><a class="header" href="#handling-event-time-and-late-data">Handling Event-time and Late Data</a></h2>
<p>Event-time is the time embedded in the data itself. For many applications, you may want to operate on this event-time. For example, if you want to get the number of events generated by IoT devices every minute, then you probably want to use the time when the data was generated (that is, event-time in the data), rather than the time Spark receives them. This event-time is very naturally expressed in this model – each event from the devices is a row in the table, and event-time is a column value in the row. This allows window-based aggregations (e.g. number of events every minute) to be just a special type of grouping and aggregation on the event-time column – each time window is a group and each row can belong to multiple windows/groups. Therefore, such event-time-window-based aggregation queries can be defined consistently on both a static dataset (e.g. from collected device events logs) as well as on a data stream, making the life of the user much easier.</p>
<p>Furthermore, this model naturally handles data that has arrived later than expected based on its event-time. Since Spark is updating the Result Table, it has full control over updating old aggregates when there is late data, as well as cleaning up old aggregates to limit the size of intermediate state data. Since Spark 2.1, we have support for watermarking which allows the user to specify the threshold of late data, and allows the engine to accordingly clean up old state. These are explained later in more detail in the <strong>Window Operations</strong> section below.</p>
<h2 id="fault-tolerance-semantics"><a class="header" href="#fault-tolerance-semantics">Fault Tolerance Semantics</a></h2>
<p>Delivering end-to-end exactly-once semantics was one of key goals behind the design of Structured Streaming. To achieve that, we have designed the Structured Streaming sources, the sinks and the execution engine to reliably track the exact progress of the processing so that it can handle any kind of failure by restarting and/or reprocessing. Every streaming source is assumed to have offsets (similar to Kafka offsets, or Kinesis sequence numbers) to track the read position in the stream. The engine uses checkpointing and write ahead logs to record the offset range of the data being processed in each trigger. The streaming sinks are designed to be idempotent for handling reprocessing. Together, using replayable sources and idempotent sinks, Structured Streaming can ensure <strong>end-to-end exactly-once semantics</strong> under any failure.</p>
<h1 id="api-using-datasets-and-dataframes"><a class="header" href="#api-using-datasets-and-dataframes">API using Datasets and DataFrames</a></h1>
<p>Since Spark 2.0, DataFrames and Datasets can represent static, bounded data, as well as streaming, unbounded data. Similar to static Datasets/DataFrames, you can use the common entry point <code>SparkSession</code> (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.SparkSession">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/SparkSession.html">Java</a>/<a href="https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.SparkSession">Python</a>/<a href="https://spark.apache.org/docs/2.2.0/api/R/sparkR.session.html">R</a> docs) to create streaming DataFrames/Datasets from streaming sources, and apply the same operations on them as static DataFrames/Datasets. If you are not familiar with Datasets/DataFrames, you are strongly advised to familiarize yourself with them using the <a href="https://spark.apache.org/docs/2.2.0/sql-programming-guide.html">DataFrame/Dataset Programming Guide</a>.</p>
<h2 id="creating-streaming-dataframes-and-streaming-datasets"><a class="header" href="#creating-streaming-dataframes-and-streaming-datasets">Creating streaming DataFrames and streaming Datasets</a></h2>
<p>Streaming DataFrames can be created through the <code>DataStreamReader</code> interface (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.DataStreamReader">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/DataStreamReader.html">Java</a>/<a href="https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.streaming.DataStreamReader">Python</a> docs) returned by <code>SparkSession.readStream()</code>. In <a href="https://spark.apache.org/docs/2.2.0/api/R/read.stream.html">R</a>, with the <code>read.stream()</code> method. Similar to the read interface for creating static DataFrame, you can specify the details of the source – data format, schema, options, etc.</p>
<h4 id="input-sources"><a class="header" href="#input-sources">Input Sources</a></h4>
<p>In Spark 2.0, there are a few built-in sources.</p>
<ul>
<li>
<p><strong>File source</strong> - Reads files written in a directory as a stream of data. Supported file formats are text, csv, json, parquet. See the docs of the DataStreamReader interface for a more up-to-date list, and supported options for each file format. Note that the files must be atomically placed in the given directory, which in most file systems, can be achieved by file move operations.</p>
</li>
<li>
<p><strong>Kafka source</strong> - Poll data from Kafka. It’s compatible with Kafka broker versions 0.10.0 or higher. See the <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-kafka-integration.html">Kafka Integration Guide</a> for more details.</p>
</li>
<li>
<p><strong>Socket source (for testing)</strong> - Reads UTF8 text data from a socket connection. The listening server socket is at the driver. Note that this should be used only for testing as this does not provide end-to-end fault-tolerance guarantees.</p>
</li>
</ul>
<p>Some sources are not fault-tolerant because they do not guarantee that data can be replayed using checkpointed offsets after a failure. See the earlier section on <a href="contents/000_4-sds-3-x-ss/structured-streaming-programming-guide.html#fault-tolerance-semantics">fault-tolerance semantics</a>. Here are the details of all the sources in Spark.</p>
<table class="table">
  <tr>
    <th>Source</th>
    <th>Options</th>
    <th>Fault-tolerant</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td><b>File source</b></td>
    <td>
        <code>path</code>: path to the input directory, and common to all file formats.
        <br />
        <code>maxFilesPerTrigger</code>: maximum number of new files to be considered in every trigger (default: no max)
        <br />
        <code>latestFirst</code>: whether to processs the latest new files first, useful when there is a large backlog of files (default: false)
        <br />
        <code>fileNameOnly</code>: whether to check new files based on only the filename instead of on the full path (default: false). With this set to `true`, the following files would be considered as the same file, because their filenames, "dataset.txt", are the same:
        <br />
        · "file:///dataset.txt"<br />
        · "s3://a/dataset.txt"<br />
        · "s3n://a/b/dataset.txt"<br />
        · "s3a://a/b/c/dataset.txt"<br />
        <br />
<pre><code>    &lt;br /&gt;
    For file-format-specific options, see the related methods in &lt;code&gt;DataStreamReader&lt;/code&gt;
    (&lt;a href=&quot;https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.DataStreamReader&quot;&gt;Scala&lt;/a&gt;/&lt;a href=&quot;https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/DataStreamReader.html&quot;&gt;Java&lt;/a&gt;/&lt;a href=&quot;https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.streaming.DataStreamReader&quot;&gt;Python&lt;/a&gt;/&lt;a href=&quot;https://spark.apache.org/docs/2.2.0/api/R/read.stream.html&quot;&gt;R&lt;/a&gt;).
    E.g. for &quot;parquet&quot; format options see &lt;code&gt;DataStreamReader.parquet()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Yes&lt;/td&gt;
&lt;td&gt;Supports glob paths, but does not support multiple comma-separated paths/globs.&lt;/td&gt;
</code></pre>
</tr>
  <tr>
    <td><b>Socket Source</b></td>
    <td>
        <code>host</code>: host to connect to, must be specified<br />
        <code>port</code>: port to connect to, must be specified
    </td>
    <td>No</td>
    <td></td>
  </tr>
  <tr>
    <td><b>Kafka Source</b></td>
    <td>
        See the <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-kafka-integration.html">Kafka Integration Guide</a>.
    </td>
    <td>Yes</td>
    <td></td>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</table>
<p>See <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html#input-sources">https://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html#input-sources</a>.</p>
<h3 id="schema-inference-and-partition-of-streaming-dataframesdatasets"><a class="header" href="#schema-inference-and-partition-of-streaming-dataframesdatasets">Schema inference and partition of streaming DataFrames/Datasets</a></h3>
<p>By default, Structured Streaming from file based sources requires you to specify the schema, rather than rely on Spark to infer it automatically (<em>this is what we did with <code>userSchema</code> above</em>). This restriction ensures a consistent schema will be used for the streaming query, even in the case of failures. For ad-hoc use cases, you can reenable schema inference by setting <code>spark.sql.streaming.schemaInference</code> to <code>true</code>.</p>
<p>Partition discovery does occur when subdirectories that are named <code>/key=value/</code> are present and listing will automatically recurse into these directories. If these columns appear in the user provided schema, they will be filled in by Spark based on the path of the file being read. The directories that make up the partitioning scheme must be present when the query starts and must remain static. For example, it is okay to add <code>/data/year=2016/</code> when <code>/data/year=2015/</code> was present, but it is invalid to change the partitioning column (i.e. by creating the directory <code>/data/date=2016-04-17/</code>).</p>
<h2 id="operations-on-streaming-dataframesdatasets"><a class="header" href="#operations-on-streaming-dataframesdatasets">Operations on streaming DataFrames/Datasets</a></h2>
<p>You can apply all kinds of operations on streaming DataFrames/Datasets – ranging from untyped, SQL-like operations (e.g. <code>select</code>, <code>where</code>, <code>groupBy</code>), to typed RDD-like operations (e.g. <code>map</code>, <code>filter</code>, <code>flatMap</code>). See the <a href="https://spark.apache.org/docs/2.2.0/sql-programming-guide.html">SQL programming guide</a> for more details. Let’s take a look at a few example operations that you can use.</p>
<h3 id="basic-operations---selection-projection-aggregation"><a class="header" href="#basic-operations---selection-projection-aggregation">Basic Operations - Selection, Projection, Aggregation</a></h3>
<p>Most of the common operations on DataFrame/Dataset are supported for streaming. The few operations that are not supported are discussed later in <strong>unsupported-operations</strong> section.</p>
<pre><code class="language-%scala">    case class DeviceData(device: String, deviceType: String, signal: Double, time: DateTime)

    val df: DataFrame = ... // streaming DataFrame with IOT device data with schema { device: string, deviceType: string, signal: double, time: string }
    val ds: Dataset[DeviceData] = df.as[DeviceData]    // streaming Dataset with IOT device data

    // Select the devices which have signal more than 10
    df.select(&quot;device&quot;).where(&quot;signal &gt; 10&quot;)      // using untyped APIs
    ds.filter(_.signal &gt; 10).map(_.device)         // using typed APIs

    // Running count of the number of updates for each device type
    df.groupBy(&quot;deviceType&quot;).count()                          // using untyped API

    // Running average signal for each device type
    import org.apache.spark.sql.expressions.scalalang.typed
    ds.groupByKey(_.deviceType).agg(typed.avg(_.signal))    // using typed API
</code></pre>
<h2 id="a-quick-mixture-example"><a class="header" href="#a-quick-mixture-example">A Quick Mixture Example</a></h2>
<p>We will work below with a file stream that simulates random animal names or a simple mixture of two Normal Random Variables.</p>
<p>The two file streams can be acieved by running the codes in the following two databricks notebooks in the same cluster:</p>
<ul>
<li><code>037a_AnimalNamesStructStreamingFiles</code></li>
<li><code>037b_Mix2NormalsStructStreamingFiles</code></li>
</ul>
</div>
<div class="cell markdown">
<p>You should have the following set of csv files (it won't be exactly the same names depending on when you start the stream of files).</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFilesNormalMixture/&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_11/</td>
<td>48_11/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_19/</td>
<td>48_19/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_26/</td>
<td>48_26/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_36/</td>
<td>48_36/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/streamingFilesNormalMixture/48_43/</td>
<td>48_43/</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<h2 id="static-and-streaming-dataframes"><a class="header" href="#static-and-streaming-dataframes">Static and Streaming DataFrames</a></h2>
<p>Let's check out the files and their contents both via static as well as streaming DataFrames.</p>
<p>This will also cement the fact that structured streaming allows interoperability between static and streaming data and can be useful for debugging.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val peekIn = spark.read.format(&quot;csv&quot;).load(&quot;/datasets/streamingFilesNormalMixture/*/*.csv&quot;)
peekIn.count() // total count of all the samples in all the files
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>peekIn: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string]
res8: Long = 500
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">peekIn.show(5, false) // let's take a quick peek at what's in the CSV files
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-----------------------+--------------------+
|_c0                    |_c1                 |
+-----------------------+--------------------+
|2020-11-16 10:48:25.294|0.21791376679544772 |
|2020-11-16 10:48:25.299|0.011291967445604012|
|2020-11-16 10:48:25.304|-0.30293144696154806|
|2020-11-16 10:48:25.309|0.4303254534802833  |
|2020-11-16 10:48:25.314|1.5521304466388752  |
+-----------------------+--------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Read all the csv files written atomically from a directory
import org.apache.spark.sql.types._

//make a user-specified schema - this is needed for structured streaming from files
val userSchema = new StructType()
                      .add(&quot;time&quot;, &quot;timestamp&quot;)
                      .add(&quot;score&quot;, &quot;Double&quot;)

// a static DF is convenient 
val csvStaticDF = spark
  .read
  .option(&quot;sep&quot;, &quot;,&quot;) // delimiter is ','
  .schema(userSchema) // Specify schema of the csv files as pre-defined by user
  .csv(&quot;/datasets/streamingFilesNormalMixture/*/*.csv&quot;)    // Equivalent to format(&quot;csv&quot;).load(&quot;/path/to/directory&quot;)

// streaming DF
val csvStreamingDF = spark
  .readStream
  .option(&quot;sep&quot;, &quot;,&quot;) // delimiter is ','
  .schema(userSchema) // Specify schema of the csv files as pre-defined by user
  .option(&quot;MaxFilesPerTrigger&quot;, 1) //  maximum number of new files to be considered in every trigger (default: no max) 
  .csv(&quot;/datasets/streamingFilesNormalMixture/*/*.csv&quot;)    // Equivalent to format(&quot;csv&quot;).load(&quot;/path/to/directory&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
userSchema: org.apache.spark.sql.types.StructType = StructType(StructField(time,TimestampType,true), StructField(score,DoubleType,true))
csvStaticDF: org.apache.spark.sql.DataFrame = [time: timestamp, score: double]
csvStreamingDF: org.apache.spark.sql.DataFrame = [time: timestamp, score: double]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">csvStreamingDF.isStreaming    // Returns True for DataFrames that have streaming sources
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res12: Boolean = true
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">csvStreamingDF.printSchema
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>root
 |-- time: timestamp (nullable = true)
 |-- score: double (nullable = true)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(csvStreamingDF) // if you want to see the stream coming at you as csvDF
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2020-11-16T10:48:11.194+0000</td>
<td>0.2576188264990721</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.199+0000</td>
<td>-0.13149698512045327</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.204+0000</td>
<td>1.4139063973267458</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.209+0000</td>
<td>-2.3833875968513496e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.215+0000</td>
<td>0.7274784426774964</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.220+0000</td>
<td>-1.0658630481235276</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.225+0000</td>
<td>0.746959841932221</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.230+0000</td>
<td>0.30477096247050206</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.235+0000</td>
<td>-6.407620682061621e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.241+0000</td>
<td>1.8464307210258604</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.246+0000</td>
<td>2.0786529531264355</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.251+0000</td>
<td>0.685838993990332</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.256+0000</td>
<td>2.3056211153362485</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.261+0000</td>
<td>-0.7435548094085835</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.267+0000</td>
<td>-0.36946067155650786</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.272+0000</td>
<td>1.1178132434092503</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.277+0000</td>
<td>1.0672400098827672</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.282+0000</td>
<td>2.403799182291664</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.287+0000</td>
<td>2.7905949803662926</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.293+0000</td>
<td>2.3901047303648846</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.298+0000</td>
<td>2.2391322699010967</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.303+0000</td>
<td>0.7102559487906945</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.308+0000</td>
<td>-0.1875570296359037</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.313+0000</td>
<td>2.0036998039560725</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.318+0000</td>
<td>2.028162246705019</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.324+0000</td>
<td>-1.1084782237141253</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.329+0000</td>
<td>2.7320985336302965</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.334+0000</td>
<td>1.7953021498619885</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.339+0000</td>
<td>1.3332433299615185</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.344+0000</td>
<td>1.2842120504662247</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.349+0000</td>
<td>2.0013530061962186</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.355+0000</td>
<td>1.2596569236824775</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.360+0000</td>
<td>2.46479668588018</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.365+0000</td>
<td>-0.7015927727061835</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.370+0000</td>
<td>-0.510611131534981</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.375+0000</td>
<td>0.9403812557496112</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.381+0000</td>
<td>2.2306482205877427</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.386+0000</td>
<td>-0.29781070820511246</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.391+0000</td>
<td>4.107241990001628</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.396+0000</td>
<td>0.7420568724108764</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.401+0000</td>
<td>1.4652231673746594</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.407+0000</td>
<td>0.8793849318247119</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.412+0000</td>
<td>1.7671614106752898</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.417+0000</td>
<td>1.1995772213743607</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.422+0000</td>
<td>1.1351566745099897</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.427+0000</td>
<td>0.16150528245701323</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.432+0000</td>
<td>2.459849452657596</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.438+0000</td>
<td>1.0796739450956971</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.443+0000</td>
<td>-1.2079899446434252</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.448+0000</td>
<td>0.7019279468450133</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.453+0000</td>
<td>-2.5906759976580096e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.458+0000</td>
<td>1.025799236502406</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.463+0000</td>
<td>2.423754193708396</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.469+0000</td>
<td>1.0100073192180106</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.474+0000</td>
<td>1.2308412912433588</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.479+0000</td>
<td>2.2142939785873326</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.484+0000</td>
<td>9.639219241219372</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.489+0000</td>
<td>0.8964067897832677</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.494+0000</td>
<td>2.583753664296168</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.499+0000</td>
<td>1.7326439212827238</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.505+0000</td>
<td>0.7516388863094139</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.510+0000</td>
<td>0.8725633940449549</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.515+0000</td>
<td>-0.9407676766254014</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.520+0000</td>
<td>1.0542712925875175</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.525+0000</td>
<td>0.794535189312687</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.530+0000</td>
<td>0.5813794557982226</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.536+0000</td>
<td>0.4891368786472011</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.541+0000</td>
<td>2.3296394918008474</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.546+0000</td>
<td>1.425296303524094</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.551+0000</td>
<td>1.9276679925454094</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.556+0000</td>
<td>0.6178050147872097</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.561+0000</td>
<td>1.135269636375052</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.567+0000</td>
<td>1.3074367248762568</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.572+0000</td>
<td>0.6105659268751382</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.577+0000</td>
<td>1.7812955395572572</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.582+0000</td>
<td>-1.3547368916771827</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.587+0000</td>
<td>1.580412775615275</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.592+0000</td>
<td>1.5731144914401023</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.597+0000</td>
<td>-5.725067553082108e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.603+0000</td>
<td>0.19580347035995105</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.608+0000</td>
<td>-2.1501122555202867e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.613+0000</td>
<td>1.5783579658949254</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.618+0000</td>
<td>1.371796305513024</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.623+0000</td>
<td>0.648919899258448</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.628+0000</td>
<td>-0.7875773550339058</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.633+0000</td>
<td>1.3233945353130716</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.639+0000</td>
<td>2.5685224032022127</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.644+0000</td>
<td>2.7331317575905807</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.649+0000</td>
<td>0.2521381731074053</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.654+0000</td>
<td>2.2408918489807905</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.659+0000</td>
<td>1.4924862197354933</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.664+0000</td>
<td>1.194657083531184</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.670+0000</td>
<td>0.7067352811215412</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.675+0000</td>
<td>2.7701718519244745e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.681+0000</td>
<td>0.279797547315617</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.686+0000</td>
<td>-0.21953266770586133</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.691+0000</td>
<td>1.1402931320647434</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.696+0000</td>
<td>0.904724947360263</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:11.702+0000</td>
<td>0.6677145203694429</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:11.707+0000</td>
<td>2.019977647420342</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.539+0000</td>
<td>-0.5190278662580565</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.545+0000</td>
<td>1.2549405940975034</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.550+0000</td>
<td>2.4267606721380233</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.555+0000</td>
<td>0.21858105660909444</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.560+0000</td>
<td>1.7701229392924476</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.566+0000</td>
<td>8.326770280505069e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.571+0000</td>
<td>11.539205812425335</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.576+0000</td>
<td>0.612370126029857</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.581+0000</td>
<td>1.299073306785623</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.586+0000</td>
<td>2.6939073650678083</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.592+0000</td>
<td>2.5320627406973344</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.597+0000</td>
<td>2.781337457744293e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.602+0000</td>
<td>0.3272489908510584</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.607+0000</td>
<td>-0.9427386544836929</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.613+0000</td>
<td>0.9364640268126377</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.618+0000</td>
<td>1.919225736153371</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.623+0000</td>
<td>0.38826998132506296</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.628+0000</td>
<td>-0.38655650387475715</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.633+0000</td>
<td>1.0433731216978939</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.638+0000</td>
<td>1.1500718903613745</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.644+0000</td>
<td>-0.3661280681150447</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.649+0000</td>
<td>0.883444064705467</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.654+0000</td>
<td>-0.9126173899348853</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.659+0000</td>
<td>0.3838114564837034</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.665+0000</td>
<td>0.7935189081504388</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.670+0000</td>
<td>1.928137393349846</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.675+0000</td>
<td>4.7092811957255676e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.680+0000</td>
<td>0.4684849965794433</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.685+0000</td>
<td>0.6745536358089256</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.691+0000</td>
<td>2.100439331925503</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.696+0000</td>
<td>1.0053957395581328</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.701+0000</td>
<td>1.1651633690031988</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.706+0000</td>
<td>1.1620631665685186</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.711+0000</td>
<td>0.5686294459758102</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.717+0000</td>
<td>5.4695916815372114e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.722+0000</td>
<td>0.3673527645506809</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.727+0000</td>
<td>1.1825682382920246</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.732+0000</td>
<td>2.590900208851957</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.738+0000</td>
<td>0.9580677196122074</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.743+0000</td>
<td>0.14058634902492095</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.748+0000</td>
<td>1.835715236145623</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.753+0000</td>
<td>1.0262133311924941</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.758+0000</td>
<td>2.3956360313411276</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.763+0000</td>
<td>-0.42622276533874537</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.769+0000</td>
<td>1.532866051791267</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.774+0000</td>
<td>0.33837135147986275</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.779+0000</td>
<td>0.5993221970260502</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.784+0000</td>
<td>0.5268259369536397</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.789+0000</td>
<td>0.9338448405595184</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.795+0000</td>
<td>1.5020324977316601</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.800+0000</td>
<td>-0.21633343524824378</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.805+0000</td>
<td>0.8387080531274844</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.810+0000</td>
<td>1.3278878139665884e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.815+0000</td>
<td>1.3291762275434373</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.820+0000</td>
<td>0.4837833343304839</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.826+0000</td>
<td>0.4918446444728072</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.831+0000</td>
<td>1.354678573169704</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.836+0000</td>
<td>0.2524216007924791</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.841+0000</td>
<td>0.5965026762340784</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.846+0000</td>
<td>2.000850130836448</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.851+0000</td>
<td>2.217169275505519</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.857+0000</td>
<td>0.6876140376775531</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.862+0000</td>
<td>1.0508210912529563</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.867+0000</td>
<td>1.65676102704454</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.872+0000</td>
<td>2.155047641017994</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.877+0000</td>
<td>1.0866488363653375</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.882+0000</td>
<td>1.0691398773308363</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.888+0000</td>
<td>0.6120836384011098</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.893+0000</td>
<td>0.24914099314834415</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.898+0000</td>
<td>2.8691481936548744</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.903+0000</td>
<td>0.7633561289177443</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.908+0000</td>
<td>1.4483835248568062</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.913+0000</td>
<td>2.6108825545691863</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.918+0000</td>
<td>1.2751533422561458</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.924+0000</td>
<td>1.0131179898567302</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.929+0000</td>
<td>0.46308679994249036</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.935+0000</td>
<td>0.7793261962344651</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.940+0000</td>
<td>1.1671037114122738</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.945+0000</td>
<td>2.143874895015684</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.950+0000</td>
<td>1.2344250301306705</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.955+0000</td>
<td>1.7402355361851662</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.960+0000</td>
<td>1.0396911219696297</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.966+0000</td>
<td>1.8089030277370215</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.971+0000</td>
<td>2.1235708326267533</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.976+0000</td>
<td>-0.33938888075466234</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.981+0000</td>
<td>1.090463095441436</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.986+0000</td>
<td>1.3101016219338661</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:18.992+0000</td>
<td>-0.6251493773996968</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:18.998+0000</td>
<td>1.7223308331307168</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.003+0000</td>
<td>1.0299845635585438</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:19.009+0000</td>
<td>1.962846046162154</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.014+0000</td>
<td>-1.8537289273720337e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:19.019+0000</td>
<td>0.7977254725466605</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.024+0000</td>
<td>-0.21427479370557312</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:19.029+0000</td>
<td>-1.6661289018266037</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.034+0000</td>
<td>1.144457447997468</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:19.043+0000</td>
<td>0.6503516296653954</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.048+0000</td>
<td>6.581335919503728e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:19.053+0000</td>
<td>1.5478749815243467</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:19.058+0000</td>
<td>1.5497411627601851</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.294+0000</td>
<td>0.21791376679544772</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.299+0000</td>
<td>1.1291967445604012e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.304+0000</td>
<td>-0.30293144696154806</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.309+0000</td>
<td>0.4303254534802833</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.314+0000</td>
<td>1.5521304466388752</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.319+0000</td>
<td>2.2910302464408394</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.325+0000</td>
<td>0.4374695472538803</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.330+0000</td>
<td>0.4085186427342812</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.335+0000</td>
<td>-6.531316403553289e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.340+0000</td>
<td>6.39812257122474e-3</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.345+0000</td>
<td>0.24840501087934996</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.350+0000</td>
<td>-1.021974709142702</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.355+0000</td>
<td>-9.233941622902653e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.361+0000</td>
<td>0.41027379764960337</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.366+0000</td>
<td>1.864567223228712</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.371+0000</td>
<td>1.5393474896194466</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.376+0000</td>
<td>1.124907339909468</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.381+0000</td>
<td>2.0206475875654997</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.386+0000</td>
<td>-0.7058862229186389</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.392+0000</td>
<td>1.2344926787652002</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.397+0000</td>
<td>1.1406194673922239</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.402+0000</td>
<td>1.4084552620839659</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.407+0000</td>
<td>0.739931161380885</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.412+0000</td>
<td>0.29958396894640427</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.417+0000</td>
<td>-0.9379262816791101</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.422+0000</td>
<td>0.8259556704405835</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.428+0000</td>
<td>-0.3199802616466474</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.433+0000</td>
<td>1.9656420693625898</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.438+0000</td>
<td>0.8789984776053141</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.443+0000</td>
<td>2.4965042040211793</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.448+0000</td>
<td>1.714778861431627</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.454+0000</td>
<td>0.8669641143187272</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.459+0000</td>
<td>1.0757413525008879</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.464+0000</td>
<td>1.9658378382249264e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.469+0000</td>
<td>0.7165095911306543</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.474+0000</td>
<td>1.2251547673860115</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.479+0000</td>
<td>1.5869187313570912</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.485+0000</td>
<td>0.3928727449886338</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.490+0000</td>
<td>1.7722759642539445</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.495+0000</td>
<td>1.0350331272239843</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.500+0000</td>
<td>-1.4234008750858624</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.505+0000</td>
<td>0.6054572828043063</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.511+0000</td>
<td>0.3024585268617903</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.516+0000</td>
<td>2.9432999768948087e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.521+0000</td>
<td>0.9382472473173075</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.526+0000</td>
<td>2.11287419383702</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.531+0000</td>
<td>1.0876022969280528</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.536+0000</td>
<td>0.36548993902899596</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.542+0000</td>
<td>-2.005053653271253</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.547+0000</td>
<td>2.0367928918435894</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.552+0000</td>
<td>9.261254419611942e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.557+0000</td>
<td>2.156248406806113</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.562+0000</td>
<td>-0.5295405173638772</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.568+0000</td>
<td>2.452318995994742</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.573+0000</td>
<td>0.8636413385915132</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.578+0000</td>
<td>0.31460938814139794</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.583+0000</td>
<td>-2.0257131370059023e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.588+0000</td>
<td>1.3213739526626505</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.593+0000</td>
<td>0.9463001869917488</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.599+0000</td>
<td>0.986171393681171</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.604+0000</td>
<td>0.12492672949874628</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.609+0000</td>
<td>0.9908400692267174</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.614+0000</td>
<td>1.0695623856543282</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.621+0000</td>
<td>1.0221220766637027</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.627+0000</td>
<td>2.8492797946693904</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.632+0000</td>
<td>1.0609742751901396</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.637+0000</td>
<td>1.6409490831011158</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.642+0000</td>
<td>1.5427085071446491</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.647+0000</td>
<td>1.7312859942989034</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.653+0000</td>
<td>1.2947069326850533</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.658+0000</td>
<td>0.3756138591369289</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.663+0000</td>
<td>1.4349084022701803</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.668+0000</td>
<td>0.37649651121290106</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.673+0000</td>
<td>0.7071860096564935</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.679+0000</td>
<td>1.5065536846394356</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.684+0000</td>
<td>0.15009861698305105</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.689+0000</td>
<td>3.5084734586888766e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.695+0000</td>
<td>1.9474563946729155</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.700+0000</td>
<td>9.423175513609095</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.705+0000</td>
<td>2.4871634825039015</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.710+0000</td>
<td>2.8472676324820685</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.715+0000</td>
<td>1.5999488876250578</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.720+0000</td>
<td>-0.2693864675719999</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.725+0000</td>
<td>1.6304414331783441</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.731+0000</td>
<td>0.39324529792831353</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.736+0000</td>
<td>0.4053253263569069</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.741+0000</td>
<td>0.9270234970247857</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.746+0000</td>
<td>1.4509585503273819</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.751+0000</td>
<td>0.8878267401905819</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.756+0000</td>
<td>1.1883024549090635</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.761+0000</td>
<td>1.0163155722641077</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.767+0000</td>
<td>-0.8003099498427713</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.772+0000</td>
<td>-0.9483216075980454</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.777+0000</td>
<td>1.0437451610964232</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.782+0000</td>
<td>2.19837214407137</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.787+0000</td>
<td>2.070797890483533</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.792+0000</td>
<td>1.2067096088561005</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.798+0000</td>
<td>0.5043809533024068</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:25.803+0000</td>
<td>0.3683130512293926</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:25.808+0000</td>
<td>1.0968506619209946</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.887+0000</td>
<td>-0.6602896123630477</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.892+0000</td>
<td>6.829641971377687e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.898+0000</td>
<td>1.5578597945995134</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.903+0000</td>
<td>0.9822629073468155</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.908+0000</td>
<td>-0.7900771590527182</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.913+0000</td>
<td>1.1194124344742182</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.918+0000</td>
<td>1.1239015052468448</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.924+0000</td>
<td>1.9447892371838207</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.929+0000</td>
<td>2.0854603958592985</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.934+0000</td>
<td>0.17341117815802976</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.939+0000</td>
<td>1.5971150699056031</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.944+0000</td>
<td>0.35646629992342993</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.950+0000</td>
<td>1.8107324499508701</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.955+0000</td>
<td>3.463539114641669</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.960+0000</td>
<td>0.8683263379823365</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.965+0000</td>
<td>1.2642821462325637</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.970+0000</td>
<td>1.0099560176390794</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.975+0000</td>
<td>1.1930381560126895</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.981+0000</td>
<td>0.5433757598192581</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.986+0000</td>
<td>1.0213782743479625</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:35.991+0000</td>
<td>1.5049231054950472</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:35.996+0000</td>
<td>0.22101559200796428</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.001+0000</td>
<td>1.8743753391414122</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.006+0000</td>
<td>0.6050230742039573</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.012+0000</td>
<td>0.6939669876285336</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.017+0000</td>
<td>1.5379566524515602</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.022+0000</td>
<td>-0.6869579758877387</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.027+0000</td>
<td>-0.4823865565169676</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.032+0000</td>
<td>2.577388594447341</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.037+0000</td>
<td>0.9323745950234809</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.043+0000</td>
<td>-0.25032440836547454</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.048+0000</td>
<td>1.1141701800611599</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.053+0000</td>
<td>1.1577408343996396</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.058+0000</td>
<td>0.4735089125920344</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.063+0000</td>
<td>-1.5559289264558278</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.068+0000</td>
<td>-0.11080485473390023</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.073+0000</td>
<td>0.1536430200356127</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.079+0000</td>
<td>1.2851073161790278</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.084+0000</td>
<td>-0.9717966387140513</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.089+0000</td>
<td>0.4604981927819666</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.094+0000</td>
<td>0.4825924627571432</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.099+0000</td>
<td>1.8907687599342153</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.104+0000</td>
<td>1.5027092114554406</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.110+0000</td>
<td>0.4892227077808574</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.115+0000</td>
<td>2.2742380779964306</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.120+0000</td>
<td>5.93203161994782e-3</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.125+0000</td>
<td>0.9357077683018076</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.130+0000</td>
<td>1.6452901327178684</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.136+0000</td>
<td>2.5989481778450294</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.141+0000</td>
<td>3.1233030636814103</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.146+0000</td>
<td>2.14412876458466</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.151+0000</td>
<td>0.8645332371791754</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.157+0000</td>
<td>1.7396751361758789</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.163+0000</td>
<td>3.406726808728102</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.169+0000</td>
<td>0.27592904706426413</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.174+0000</td>
<td>-0.47288172874607715</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.179+0000</td>
<td>3.1581200247451022</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.184+0000</td>
<td>2.3502844371874003</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.190+0000</td>
<td>2.3604518998272104</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.195+0000</td>
<td>2.875582435906723</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.200+0000</td>
<td>1.802101533727158</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.205+0000</td>
<td>2.158082491464444</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.210+0000</td>
<td>-0.5284223682158626</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.216+0000</td>
<td>1.929919317533868e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.221+0000</td>
<td>1.948485504832782</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.226+0000</td>
<td>0.49379467644006303</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.231+0000</td>
<td>0.33811694243690293</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.236+0000</td>
<td>1.332171769010618</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.242+0000</td>
<td>0.6994701270153069</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.247+0000</td>
<td>-0.413721820026016</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.252+0000</td>
<td>-1.5522089380783108</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.257+0000</td>
<td>2.161396170492705</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.262+0000</td>
<td>2.333496950423164e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.268+0000</td>
<td>-0.10913840839170796</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.273+0000</td>
<td>1.1299228472291496</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.278+0000</td>
<td>2.4274358384176584</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.283+0000</td>
<td>1.9359707345891741</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.288+0000</td>
<td>3.487722218477596</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.294+0000</td>
<td>0.9990127159196325</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.299+0000</td>
<td>-1.0398429191328207</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.304+0000</td>
<td>0.3005833334887211</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.309+0000</td>
<td>-0.7334628100431295</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.314+0000</td>
<td>0.4835865602253189</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.320+0000</td>
<td>0.5246945471836175</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.325+0000</td>
<td>0.8469783573593253</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.330+0000</td>
<td>0.8359162587262456</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.335+0000</td>
<td>0.7772016511976113</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.340+0000</td>
<td>-0.39849883029666944</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.345+0000</td>
<td>1.8703097604547239</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.350+0000</td>
<td>2.682932324516024</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.356+0000</td>
<td>0.46996888720103236</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.361+0000</td>
<td>-7.881388366585762e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.366+0000</td>
<td>2.1043645061434084</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.371+0000</td>
<td>0.6195230903468327</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.376+0000</td>
<td>-0.23170755440676594</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.381+0000</td>
<td>0.3918168388047796</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.386+0000</td>
<td>0.22086080450987344</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.392+0000</td>
<td>1.5182059037248368</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:36.397+0000</td>
<td>1.6442851975073318</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:36.402+0000</td>
<td>0.3979663516003099</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.690+0000</td>
<td>2.0531657985840983</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.696+0000</td>
<td>1.7928797637680196</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.701+0000</td>
<td>2.9329556976986013</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.706+0000</td>
<td>1.1087520027663345</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.711+0000</td>
<td>1.2115868818351045</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.716+0000</td>
<td>1.9163661519192294</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.722+0000</td>
<td>1.6917128257752045</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.727+0000</td>
<td>1.0095879056962782</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.732+0000</td>
<td>-0.13611276130309613</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.737+0000</td>
<td>2.2939319088848023</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.742+0000</td>
<td>1.0723690693732042</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.748+0000</td>
<td>2.1452154961792393</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.753+0000</td>
<td>0.7259078662420231</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.758+0000</td>
<td>2.6599123456452727</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.763+0000</td>
<td>0.2519779820647646</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.768+0000</td>
<td>2.1670014817546175</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.773+0000</td>
<td>0.10506784220981513</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.779+0000</td>
<td>2.018185302480656</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.784+0000</td>
<td>1.1665983169452525</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.789+0000</td>
<td>0.33284879429952463</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.794+0000</td>
<td>0.3531339079979545</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.799+0000</td>
<td>2.1004784012229245</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.805+0000</td>
<td>1.282680965361929</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.810+0000</td>
<td>1.2270715852857979</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.815+0000</td>
<td>0.858598096986649</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.820+0000</td>
<td>2.5040344133072407</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.825+0000</td>
<td>1.6541952933075013</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.831+0000</td>
<td>0.5329588210461834</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.836+0000</td>
<td>2.1274892552565134</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.841+0000</td>
<td>1.4668875035709574</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.846+0000</td>
<td>1.5382758818248594</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.851+0000</td>
<td>1.7428172106530586</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.856+0000</td>
<td>1.4727771685178368</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.861+0000</td>
<td>1.6023481462981235</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.867+0000</td>
<td>1.6577898477375492</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.872+0000</td>
<td>5.892056976555449e-2</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.877+0000</td>
<td>2.7754262543475523</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.882+0000</td>
<td>1.2200523142327606</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.887+0000</td>
<td>1.5903756890326521</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.893+0000</td>
<td>-1.49547625208842</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.898+0000</td>
<td>0.8523817097750093</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.903+0000</td>
<td>0.5057853403549346</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.908+0000</td>
<td>0.5683629007876065</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.913+0000</td>
<td>1.6479513379049497</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.918+0000</td>
<td>1.2148679515188867</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.924+0000</td>
<td>0.6222019509815193</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.929+0000</td>
<td>1.3255067306263184</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.934+0000</td>
<td>0.4983375954130155</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.939+0000</td>
<td>-8.802709440091383e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.944+0000</td>
<td>0.13831985322805507</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.949+0000</td>
<td>-0.5487242466777436</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.954+0000</td>
<td>-0.32058114510029334</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.960+0000</td>
<td>1.8950590840214767</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.965+0000</td>
<td>1.0062190610750874</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.971+0000</td>
<td>-0.9934439161367286</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.976+0000</td>
<td>0.3671557383587293</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.981+0000</td>
<td>0.19986189782147756</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.986+0000</td>
<td>-0.49653972053539497</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:42.991+0000</td>
<td>0.6848255848767759</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:42.996+0000</td>
<td>1.5219606199148406</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.002+0000</td>
<td>1.455086538348867</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.007+0000</td>
<td>2.883109155648917</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.012+0000</td>
<td>1.8164694435868296</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.017+0000</td>
<td>0.6742710281863775</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.022+0000</td>
<td>0.5441958963393487</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.027+0000</td>
<td>1.0517397813571259</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.033+0000</td>
<td>0.8356831003190489</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.038+0000</td>
<td>0.8227690076487093</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.043+0000</td>
<td>1.4570119880481842</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.048+0000</td>
<td>-0.297581775651637</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.053+0000</td>
<td>-7.206180041345078e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.059+0000</td>
<td>-0.8739444049086391</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.064+0000</td>
<td>2.2604530979343074</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.069+0000</td>
<td>2.3872947344763027</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.074+0000</td>
<td>3.3685772895980124</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.079+0000</td>
<td>2.013534739447639</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.085+0000</td>
<td>3.368251328412311</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.090+0000</td>
<td>0.8953451648220483</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.095+0000</td>
<td>9.545874578601765e-2</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.100+0000</td>
<td>0.7718477167244377</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.105+0000</td>
<td>1.0629106168204554</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.110+0000</td>
<td>0.5518190802821734</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.116+0000</td>
<td>2.9939679918505853</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.121+0000</td>
<td>1.8726021041818661</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.126+0000</td>
<td>0.2653885457840085</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.131+0000</td>
<td>1.9872672471653996</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.136+0000</td>
<td>-0.553166557898946</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.141+0000</td>
<td>1.5640591286122745</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.147+0000</td>
<td>2.52680639118602</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.152+0000</td>
<td>1.80742439492357</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.157+0000</td>
<td>2.1955997975781347</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.162+0000</td>
<td>0.5980285235875027</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.167+0000</td>
<td>-0.2658797956060317</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.172+0000</td>
<td>-0.49719135472382137</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.178+0000</td>
<td>1.180607461695498</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.183+0000</td>
<td>-0.10430878902480734</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.188+0000</td>
<td>0.823892717854915</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.193+0000</td>
<td>1.666382974377688</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:48:43.198+0000</td>
<td>3.748395965408928</td>
</tr>
<tr class="even">
<td>2020-11-16T10:48:43.204+0000</td>
<td>1.7921581120532326e-2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">import org.apache.spark.sql.functions._

// Start running the query that prints the running counts to the console
val query = csvStreamingDF
                 // bround simply rounds the double to the desired decimal place - 0 in our case here. 
                   // see https://spark.apache.org/docs/latest/api/java/org/apache/spark/sql/functions.html#bround-org.apache.spark.sql.Column-
                   // we are using bround to simply coarsen out data into bins for counts
                 .select(bround($&quot;score&quot;, 0).as(&quot;binnedScore&quot;)) 
                 .groupBy($&quot;binnedScore&quot;)
                 .agg(count($&quot;binnedScore&quot;) as &quot;binnedScoreCounts&quot;)
                 .orderBy($&quot;binnedScore&quot;)
                 .writeStream
                 .outputMode(&quot;complete&quot;)
                 .format(&quot;console&quot;)
                 .start()
                 
query.awaitTermination() // hit cancel to terminate
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -1.0|                9|
|        0.0|               18|
|        1.0|               41|
|        2.0|               25|
|        3.0|                5|
|        4.0|                1|
|       10.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                1|
|       -1.0|               13|
|        0.0|               44|
|        1.0|               83|
|        2.0|               46|
|        3.0|               10|
|        4.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                2|
|       -1.0|               20|
|        0.0|               74|
|        1.0|              118|
|        2.0|               70|
|        3.0|               12|
|        4.0|                1|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                4|
|       -1.0|               27|
|        0.0|              104|
|        1.0|              144|
|        2.0|               96|
|        3.0|               21|
|        4.0|                1|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                4|
|       -1.0|               32|
|        0.0|              125|
|        1.0|              179|
|        2.0|              125|
|        3.0|               30|
|        4.0|                2|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Once the above streaming job has processed all the files in the directory, it will continue to &quot;listen&quot; in for new files in the directory. You could for example return to the other notebook <code>037b_Mix2NormalsStructStreamingFiles</code> and rerun the cell that writes another lot of newer files into the directory and return to this notebook to watch the above streaming job continue with additional batches.</p>
</div>
<div class="cell markdown">
<h2 id="static-and-streaming-datasets"><a class="header" href="#static-and-streaming-datasets">Static and Streaming DataSets</a></h2>
<p>These examples generate streaming DataFrames that are untyped, meaning that the schema of the DataFrame is not checked at compile time, only checked at runtime when the query is submitted. Some operations like <code>map</code>, <code>flatMap</code>, etc. need the type to be known at compile time. To do those, you can convert these untyped streaming DataFrames to typed streaming Datasets using the same methods as static DataFrame. See the <a href="https://spark.apache.org/docs/2.2.0/sql-programming-guide.html">SQL Programming Guide</a> for more details. Additionally, more details on the supported streaming sources are discussed later in the document.</p>
<p>Let us make a <code>dataset</code> version of the streaming dataframe.</p>
<p>But first let us try it make the datset from the static dataframe and then apply it to the streming dataframe.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">csvStaticDF.printSchema // schema of the static DF
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>root
 |-- time: timestamp (nullable = true)
 |-- score: double (nullable = true)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.types._
import java.sql.Timestamp

// create a case class to make the datset
case class timedScores(time: Timestamp, score: Double)

val csvStaticDS = csvStaticDF.as[timedScores] // create a dataset from the dataframe
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
import java.sql.Timestamp
defined class timedScores
csvStaticDS: org.apache.spark.sql.Dataset[timedScores] = [time: timestamp, score: double]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">csvStaticDS.show(5,false) // looks like we got the dataset we want with strong typing
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-----------------------+--------------------+
|time                   |score               |
+-----------------------+--------------------+
|2020-11-16 10:48:25.294|0.21791376679544772 |
|2020-11-16 10:48:25.299|0.011291967445604012|
|2020-11-16 10:48:25.304|-0.30293144696154806|
|2020-11-16 10:48:25.309|0.4303254534802833  |
|2020-11-16 10:48:25.314|1.5521304466388752  |
+-----------------------+--------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Now let us use the same code for making a streaming dataset.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">import org.apache.spark.sql.functions._
import org.apache.spark.sql.types._
import java.sql.Timestamp

// create a case class to make the datset
case class timedScores(time: Timestamp, score: Double)

val csvStreamingDS = csvStreamingDF.as[timedScores] // create a dataset from the dataframe

// Start running the query that prints the running counts to the console
val query = csvStreamingDS
                  // bround simply rounds the double to the desired decimal place - 0 in our case here. 
                   // see https://spark.apache.org/docs/latest/api/java/org/apache/spark/sql/functions.html#bround-org.apache.spark.sql.Column-
                   // we are using bround to simply coarsen out data into bins for counts
                 .select(bround($&quot;score&quot;, 0).as(&quot;binnedScore&quot;)) 
                 .groupBy($&quot;binnedScore&quot;)
                 .agg(count($&quot;binnedScore&quot;) as &quot;binnedScoreCounts&quot;)
                 .orderBy($&quot;binnedScore&quot;)
                 .writeStream
                 .outputMode(&quot;complete&quot;)
                 .format(&quot;console&quot;)
                 .start()

query.awaitTermination() // hit cancel to terminate
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -1.0|                9|
|        0.0|               18|
|        1.0|               41|
|        2.0|               25|
|        3.0|                5|
|        4.0|                1|
|       10.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                1|
|       -1.0|               13|
|        0.0|               44|
|        1.0|               83|
|        2.0|               46|
|        3.0|               10|
|        4.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                2|
|       -1.0|               20|
|        0.0|               74|
|        1.0|              118|
|        2.0|               70|
|        3.0|               12|
|        4.0|                1|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                4|
|       -1.0|               27|
|        0.0|              104|
|        1.0|              144|
|        2.0|               96|
|        3.0|               21|
|        4.0|                1|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+-----------+-----------------+
|binnedScore|binnedScoreCounts|
+-----------+-----------------+
|       -2.0|                4|
|       -1.0|               32|
|        0.0|              125|
|        1.0|              179|
|        2.0|              125|
|        3.0|               30|
|        4.0|                2|
|        9.0|                1|
|       10.0|                1|
|       12.0|                1|
+-----------+-----------------+
</code></pre>
</div>
</div>
<div class="cell markdown">
<h3 id="window-operations-on-event-time"><a class="header" href="#window-operations-on-event-time">Window Operations on Event Time</a></h3>
<p>Aggregations over a sliding event-time window are straightforward with Structured Streaming and are very similar to grouped aggregations. In a grouped aggregation, aggregate values (e.g. counts) are maintained for each unique value in the user-specified grouping column. In case of window-based aggregations, aggregate values are maintained for each window the event-time of a row falls into. Let’s understand this with an illustration.</p>
<p>Imagine our <strong>quick example</strong> is modified and the stream now contains lines along with the time when the line was generated. Instead of running word counts, we want to count words within 10 minute windows, updating every 5 minutes. That is, word counts in words received between 10 minute windows 12:00 - 12:10, 12:05 - 12:15, 12:10 - 12:20, etc. Note that 12:00 - 12:10 means data that arrived after 12:00 but before 12:10. Now, consider a word that was received at 12:07. This word should increment the counts corresponding to two windows 12:00 - 12:10 and 12:05 - 12:15. So the counts will be indexed by both, the grouping key (i.e. the word) and the window (can be calculated from the event-time).</p>
<p>The result tables would look something like the following.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-window.png" alt="Window Operations" /></p>
<p>Since this windowing is similar to grouping, in code, you can use <code>groupBy()</code> and <code>window()</code> operations to express windowed aggregations. You can see the full code for the below examples in <a href="https://github.com/apache/spark/blob/v2.2.0/examples/src/main/scala/org/apache/spark/examples/sql/streaming/StructuredNetworkWordCountWindowed.scala">Scala</a>/<a href="https://github.com/apache/spark/blob/v2.2.0/examples/src/main/java/org/apache/spark/examples/sql/streaming/JavaStructuredNetworkWordCountWindowed.java">Java</a>/<a href="https://github.com/apache/spark/blob/v2.2.0/examples/src/main/python/sql/streaming/structured_network_wordcount_windowed.py">Python</a>.</p>
</div>
<div class="cell markdown">
<p>Make sure the streaming job with animal names is running (or finished running) with files in <code>/datasets/streamingFiles</code> directory - this is the Quick Example in <code>037a_FilesForStructuredStreaming</code> notebook.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFiles&quot;))
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">spark.read.format(&quot;text&quot;).load(&quot;/datasets/streamingFiles&quot;).show(5,false) // let's just read five  entries
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+----------------------------------+
|value                             |
+----------------------------------+
|2020-11-16 10:30:04+00:00; bat rat|
|2020-11-16 10:30:06+00:00; rat bat|
|2020-11-16 10:30:08+00:00; rat dog|
|2020-11-16 10:30:10+00:00; rat cat|
|2020-11-16 10:30:12+00:00; cat bat|
+----------------------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import spark.implicits._
import org.apache.spark.sql.types._
import org.apache.spark.sql.functions._
import java.sql.Timestamp
spark.sql(&quot;set spark.sql.legacy.timeParserPolicy=LEGACY&quot;)

// a static DS is convenient to work with
val csvStaticDS = spark
   .read
   .option(&quot;sep&quot;, &quot;;&quot;) // delimiter is ';'
   .csv(&quot;/datasets/streamingFiles/*.log&quot;)    // Equivalent to format(&quot;csv&quot;).load(&quot;/path/to/directory&quot;)
   .toDF(&quot;time&quot;,&quot;animals&quot;)
   .select(unix_timestamp($&quot;time&quot;, &quot;yyyy-MM-dd HH:mm:ss&quot;).cast(TimestampType).as(&quot;timestamp&quot;), $&quot;animals&quot;)
   .as[(Timestamp, String)]
   .flatMap(
     line =&gt; line._2.split(&quot; &quot;)
                 .filter(_ != &quot;&quot;) // remove empty string from leading whitespace
                 .map(animal =&gt; (line._1, animal))
    )
   .toDF(&quot;timestamp&quot;, &quot;animal&quot;)
   .as[(Timestamp, String)]
   
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import spark.implicits._
import org.apache.spark.sql.types._
import org.apache.spark.sql.functions._
import java.sql.Timestamp
csvStaticDS: org.apache.spark.sql.Dataset[(java.sql.Timestamp, String)] = [timestamp: timestamp, animal: string]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">csvStaticDS.show(5,false)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-------------------+------+
|timestamp          |animal|
+-------------------+------+
|2020-11-16 11:00:01|owl   |
|2020-11-16 11:00:01|cat   |
|2020-11-16 11:00:03|dog   |
|2020-11-16 11:00:03|pig   |
|2020-11-16 11:00:05|rat   |
+-------------------+------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">//make a user-specified schema for structured streaming
val userSchema = new StructType()
                      .add(&quot;time&quot;, &quot;String&quot;) // we will read it as String and then convert into timestamp later
                      .add(&quot;animals&quot;, &quot;String&quot;)

// streaming DS
val csvStreamingDS = spark
// the next three lines are needed for structured streaming from file streams
  .readStream // for streaming
  .option(&quot;MaxFilesPerTrigger&quot;, 1) //  for streaming
  .schema(userSchema) // for streaming
  .option(&quot;sep&quot;, &quot;;&quot;) // delimiter is ';'
  .csv(&quot;/datasets/streamingFiles/*.log&quot;)    // Equivalent to format(&quot;csv&quot;).load(&quot;/path/to/directory&quot;)
  .toDF(&quot;time&quot;,&quot;animals&quot;)
  .select(unix_timestamp($&quot;time&quot;, &quot;yyyy-MM-dd HH:mm:ss&quot;).cast(TimestampType).as(&quot;timestamp&quot;), $&quot;animals&quot;)
  //.toDF(&quot;time&quot;,&quot;animals&quot;)
  .as[(Timestamp, String)]
  .flatMap(
     line =&gt; line._2.split(&quot; &quot;).map(animal =&gt; (line._1, animal))
    )
  .filter(_._2 != &quot;&quot;)
  .toDF(&quot;timestamp&quot;, &quot;animal&quot;)
  .as[(Timestamp, String)]
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>userSchema: org.apache.spark.sql.types.StructType = StructType(StructField(time,StringType,true), StructField(animals,StringType,true))
csvStreamingDS: org.apache.spark.sql.Dataset[(java.sql.Timestamp, String)] = [timestamp: timestamp, animal: string]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(csvStreamingDS) // evaluate to see the animal words with timestamps streaming in
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>timestamp</th>
<th>animal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2020-11-16T10:30:08.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:30:08.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:34:23.000+0000</td>
<td>bat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:34:23.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:45:59.000+0000</td>
<td>cat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:45:59.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:47:54.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:47:54.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:50:05.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:50:05.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:54:10.000+0000</td>
<td>bat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:54:10.000+0000</td>
<td>rat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:58:06.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:58:06.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:30:54.000+0000</td>
<td>cat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:30:54.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:31:17.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:31:17.000+0000</td>
<td>rat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:32:05.000+0000</td>
<td>cat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:32:05.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:35:07.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:35:07.000+0000</td>
<td>rat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:35:55.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:35:55.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:37:10.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:37:10.000+0000</td>
<td>cat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:38:58.000+0000</td>
<td>owl</td>
</tr>
<tr class="even">
<td>2020-11-16T10:38:58.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:41:57.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:41:57.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:45:25.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:45:25.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:45:43.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:45:43.000+0000</td>
<td>owl</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:47:16.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:47:16.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:53:52.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:53:52.000+0000</td>
<td>dog</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:55:12.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:55:12.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:32:01.000+0000</td>
<td>owl</td>
</tr>
<tr class="even">
<td>2020-11-16T10:32:01.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:32:25.000+0000</td>
<td>cat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:32:25.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:33:29.000+0000</td>
<td>rat</td>
</tr>
<tr class="even">
<td>2020-11-16T10:33:29.000+0000</td>
<td>bat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:34:01.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:34:01.000+0000</td>
<td>cat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:34:37.000+0000</td>
<td>dog</td>
</tr>
<tr class="even">
<td>2020-11-16T10:34:37.000+0000</td>
<td>pig</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:42:11.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:42:11.000+0000</td>
<td>cat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:42:51.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:42:51.000+0000</td>
<td>rat</td>
</tr>
<tr class="odd">
<td>2020-11-16T10:49:06.000+0000</td>
<td>pig</td>
</tr>
<tr class="even">
<td>2020-11-16T10:49:06.000+0000</td>
<td>cat</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">// Group the data by window and word and compute the count of each group
val windowDuration = &quot;180 seconds&quot;
val slideDuration = &quot;90 seconds&quot;
val windowedCounts = csvStreamingDS.groupBy(
      window($&quot;timestamp&quot;, windowDuration, slideDuration), $&quot;animal&quot;
    ).count().orderBy(&quot;window&quot;)

// Start running the query that prints the windowed word counts to the console
val query = windowedCounts.writeStream
      .outputMode(&quot;complete&quot;)
      .format(&quot;console&quot;)
      .option(&quot;truncate&quot;, &quot;false&quot;)
      .start()

query.awaitTermination()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 2
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 3
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 4
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 5
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 6
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 7
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|pig   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|cat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|cat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|pig   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows
</code></pre>
</div>
</div>
<div class="cell markdown">
<h3 id="handling-late-data-and-watermarking"><a class="header" href="#handling-late-data-and-watermarking">Handling Late Data and Watermarking</a></h3>
<p>Now consider what happens if one of the events arrives late to the application. For example, say, a word generated at 12:04 (i.e. event time) could be received by the application at 12:11. The application should use the time 12:04 instead of 12:11 to update the older counts for the window <code>12:00 - 12:10</code>. This occurs naturally in our window-based grouping – Structured Streaming can maintain the intermediate state for partial aggregates for a long period of time such that late data can update aggregates of old windows correctly, as illustrated below.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-late-data.png" alt="Handling Late Data" /></p>
<p>However, to run this query for days, it’s necessary for the system to bound the amount of intermediate in-memory state it accumulates. This means the system needs to know when an old aggregate can be dropped from the in-memory state because the application is not going to receive late data for that aggregate any more. To enable this, in Spark 2.1, we have introduced <strong>watermarking</strong>, which lets the engine automatically track the current event time in the data and attempt to clean up old state accordingly. You can define the watermark of a query by specifying the event time column and the threshold on how late the data is expected to be in terms of event time. For a specific window starting at time <code>T</code>, the engine will maintain state and allow late data to update the state until <code>(max event time seen by the engine - late threshold &gt; T)</code>. In other words, late data within the threshold will be aggregated, but data later than the threshold will be dropped. Let’s understand this with an example. We can easily define watermarking on the previous example using <code>withWatermark()</code> as shown below.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">// Group the data by window and word and compute the count of each group
val windowDuration = &quot;180 seconds&quot;
val slideDuration = &quot;90 seconds&quot;
val watermarkDuration = &quot;10 minutes&quot;
val windowedCounts = csvStreamingDS
     .withWatermark(&quot;timestamp&quot;, watermarkDuration)
     .groupBy(
      window($&quot;timestamp&quot;, windowDuration, slideDuration), $&quot;animal&quot;
    ).count().orderBy(&quot;window&quot;)

// Start running the query that prints the windowed word counts to the console
val query = windowedCounts.writeStream
      .outputMode(&quot;complete&quot;)
      .format(&quot;console&quot;)
      .option(&quot;truncate&quot;, &quot;false&quot;)
      .start()

query.awaitTermination()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 2
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 3
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 4
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
+------------------------------------------+------+-----+

-------------------------------------------
Batch: 5
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 6
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|pig   |1    |
|[2020-11-16 10:48:00, 2020-11-16 10:51:00]|dog   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|pig   |1    |
|[2020-11-16 10:49:30, 2020-11-16 10:52:30]|dog   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 7
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|pig   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|cat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|cat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 8
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|pig   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|cat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|cat   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |2    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |2    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|dog   |1    |
|[2020-11-16 10:46:30, 2020-11-16 10:49:30]|pig   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 9
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|cat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|cat   |2    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |2    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |3    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|dog   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|cat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|bat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|dog   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|cat   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows

-------------------------------------------
Batch: 10
-------------------------------------------
+------------------------------------------+------+-----+
|window                                    |animal|count|
+------------------------------------------+------+-----+
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|dog   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|rat   |2    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|cat   |1    |
|[2020-11-16 10:28:30, 2020-11-16 10:31:30]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|cat   |2    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|pig   |1    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|rat   |2    |
|[2020-11-16 10:30:00, 2020-11-16 10:33:00]|dog   |3    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|bat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|pig   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|cat   |1    |
|[2020-11-16 10:31:30, 2020-11-16 10:34:30]|dog   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|bat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|rat   |1    |
|[2020-11-16 10:33:00, 2020-11-16 10:36:00]|pig   |2    |
|[2020-11-16 10:34:30, 2020-11-16 10:37:30]|rat   |1    |
|[2020-11-16 10:34:30, 2020-11-16 10:37:30]|pig   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|bat   |1    |
|[2020-11-16 10:43:30, 2020-11-16 10:46:30]|cat   |1    |
|[2020-11-16 10:45:00, 2020-11-16 10:48:00]|pig   |1    |
+------------------------------------------+------+-----+
only showing top 20 rows
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>In this example, we are defining the watermark of the query on the value of the column “timestamp”, and also defining “10 minutes” as the threshold of how late is the data allowed to be. If this query is run in Update output mode (discussed later in <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html#output-modes">Output Modes</a> section), the engine will keep updating counts of a window in the Result Table until the window is older than the watermark, which lags behind the current event time in column “timestamp” by 10 minutes. Here is an illustration.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-watermark-update-mode.png" alt="Watermarking in Update Mode" /></p>
<p>As shown in the illustration, the maximum event time tracked by the engine is the <em>blue dashed line</em>, and the watermark set as <code>(max event time - '10 mins')</code> at the beginning of every trigger is the red line For example, when the engine observes the data <code>(12:14, dog)</code>, it sets the watermark for the next trigger as <code>12:04</code>. This watermark lets the engine maintain intermediate state for additional 10 minutes to allow late data to be counted. For example, the data <code>(12:09, cat)</code> is out of order and late, and it falls in windows <code>12:05 - 12:15</code> and <code>12:10 - 12:20</code>. Since, it is still ahead of the watermark <code>12:04</code> in the trigger, the engine still maintains the intermediate counts as state and correctly updates the counts of the related windows. However, when the watermark is updated to <code>12:11</code>, the intermediate state for window <code>(12:00 - 12:10)</code> is cleared, and all subsequent data (e.g. <code>(12:04, donkey)</code>) is considered “too late” and therefore ignored. Note that after every trigger, the updated counts (i.e. purple rows) are written to sink as the trigger output, as dictated by the Update mode.</p>
<p>Some sinks (e.g. files) may not supported fine-grained updates that Update Mode requires. To work with them, we have also support Append Mode, where only the <em>final counts</em> are written to sink. This is illustrated below.</p>
<p>Note that using <code>withWatermark</code> on a non-streaming Dataset is no-op. As the watermark should not affect any batch query in any way, we will ignore it directly.</p>
<p><img src="https://spark.apache.org/docs/2.2.0/img/structured-streaming-watermark-append-mode.png" alt="Watermarking in Append Mode" /></p>
<p>Similar to the Update Mode earlier, the engine maintains intermediate counts for each window. However, the partial counts are not updated to the Result Table and not written to sink. The engine waits for “10 mins” for late date to be counted, then drops intermediate state of a window &lt; watermark, and appends the final counts to the Result Table/sink. For example, the final counts of window <code>12:00 - 12:10</code> is appended to the Result Table only after the watermark is updated to <code>12:11</code>.</p>
<p><strong>Conditions for watermarking to clean aggregation state</strong> It is important to note that the following conditions must be satisfied for the watermarking to clean the state in aggregation queries <em>(as of Spark 2.1.1, subject to change in the future)</em>.</p>
<ul>
<li>
<p><strong>Output mode must be Append or Update.</strong> Complete mode requires all aggregate data to be preserved, and hence cannot use watermarking to drop intermediate state. See the <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html#output-modes">Output Modes</a> section for detailed explanation of the semantics of each output mode.</p>
</li>
<li>
<p>The aggregation must have either the event-time column, or a <code>window</code> on the event-time column.</p>
</li>
<li>
<p><code>withWatermark</code> must be called on the same column as the timestamp column used in the aggregate. For example, <code>df.withWatermark(&quot;time&quot;, &quot;1 min&quot;).groupBy(&quot;time2&quot;).count()</code> is invalid in Append output mode, as watermark is defined on a different column from the aggregation column.</p>
</li>
<li>
<p><code>withWatermark</code> must be called before the aggregation for the watermark details to be used. For example, <code>df.groupBy(&quot;time&quot;).count().withWatermark(&quot;time&quot;, &quot;1 min&quot;)</code> is invalid in Append output mode.</p>
</li>
</ul>
</div>
<div class="cell markdown">
<h3 id="join-operations"><a class="header" href="#join-operations">Join Operations</a></h3>
<p>Streaming DataFrames can be joined with static DataFrames to create new streaming DataFrames. Here are a few examples.</p>
</div>
<div class="cell markdown">
<pre><code>val staticDf = spark.read. ...
val streamingDf = spark.readStream. ...

streamingDf.join(staticDf, &quot;type&quot;)          // inner equi-join with a static DF
streamingDf.join(staticDf, &quot;type&quot;, &quot;right_join&quot;)  // right outer join with a static DF
</code></pre>
</div>
<div class="cell markdown">
<h3 id="streaming-deduplication"><a class="header" href="#streaming-deduplication">Streaming Deduplication</a></h3>
<p>You can deduplicate records in data streams using a unique identifier in the events. This is exactly same as deduplication on static using a unique identifier column. The query will store the necessary amount of data from previous records such that it can filter duplicate records. Similar to aggregations, you can use deduplication with or without watermarking.</p>
<ul>
<li>
<p><em>With watermark</em> - If there is a upper bound on how late a duplicate record may arrive, then you can define a watermark on a event time column and deduplicate using both the guid and the event time columns. The query will use the watermark to remove old state data from past records that are not expected to get any duplicates any more. This bounds the amount of the state the query has to maintain.</p>
</li>
<li>
<p><em>Without watermark</em> - Since there are no bounds on when a duplicate record may arrive, the query stores the data from all the past records as state.</p>
</li>
</ul>
<!-- -->
<pre><code>    val streamingDf = spark.readStream. ...  // columns: guid, eventTime, ...

    // Without watermark using guid column
    streamingDf.dropDuplicates(&quot;guid&quot;)

    // With watermark using guid and eventTime columns
    streamingDf
      .withWatermark(&quot;eventTime&quot;, &quot;10 seconds&quot;)
      .dropDuplicates(&quot;guid&quot;, &quot;eventTime&quot;)
</code></pre>
</div>
<div class="cell markdown">
<h3 id="arbitrary-stateful-operations"><a class="header" href="#arbitrary-stateful-operations">Arbitrary Stateful Operations</a></h3>
<p>Many uscases require more advanced stateful operations than aggregations. For example, in many usecases, you have to track sessions from data streams of events. For doing such sessionization, you will have to save arbitrary types of data as state, and perform arbitrary operations on the state using the data stream events in every trigger. Since Spark 2.2, this can be done using the operation <code>mapGroupsWithState</code> and the more powerful operation <code>flatMapGroupsWithState</code>. Both operations allow you to apply user-defined code on grouped Datasets to update user-defined state. For more concrete details, take a look at the API documentation (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.GroupState">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/GroupState.html">Java</a>) and the examples (<a href="https://github.com/apache/spark/blob/v2.2.0/examples/src/main/scala/org/apache/spark/examples/sql/streaming/StructuredSessionization.scala">Scala</a>/<a href="https://github.com/apache/spark/blob/v2.2.0/examples/src/main/java/org/apache/spark/examples/sql/streaming/JavaStructuredSessionization.java">Java</a>).</p>
<h3 id="unsupported-operations"><a class="header" href="#unsupported-operations">Unsupported Operations</a></h3>
<p>There are a few DataFrame/Dataset operations that are not supported with streaming DataFrames/Datasets. Some of them are as follows.</p>
<ul>
<li>
<p>Multiple streaming aggregations (i.e. a chain of aggregations on a streaming DF) are not yet supported on streaming Datasets.</p>
</li>
<li>
<p>Limit and take first N rows are not supported on streaming Datasets.</p>
</li>
<li>
<p>Distinct operations on streaming Datasets are not supported.</p>
</li>
<li>
<p>Sorting operations are supported on streaming Datasets only after an aggregation and in Complete Output Mode.</p>
</li>
<li>
<p>Outer joins between a streaming and a static Datasets are conditionally supported.</p>
<ul>
<li>
<p>Full outer join with a streaming Dataset is not supported</p>
</li>
<li>
<p>Left outer join with a streaming Dataset on the right is not supported</p>
</li>
<li>
<p>Right outer join with a streaming Dataset on the left is not supported</p>
</li>
</ul>
</li>
<li>
<p>Any kind of joins between two streaming Datasets is not yet supported.</p>
</li>
</ul>
<p>In addition, there are some Dataset methods that will not work on streaming Datasets. They are actions that will immediately run queries and return results, which does not make sense on a streaming Dataset. Rather, those functionalities can be done by explicitly starting a streaming query (see the next section regarding that).</p>
<ul>
<li>
<p><code>count()</code> - Cannot return a single count from a streaming Dataset. Instead, use <code>ds.groupBy().count()</code> which returns a streaming Dataset containing a running count.</p>
</li>
<li>
<p><code>foreach()</code> - Instead use <code>ds.writeStream.foreach(...)</code> (see next section).</p>
</li>
<li>
<p><code>show()</code> - Instead use the console sink (see next section).</p>
</li>
</ul>
<p>If you try any of these operations, you will see an <code>AnalysisException</code> like “operation XYZ is not supported with streaming DataFrames/Datasets”. While some of them may be supported in future releases of Spark, there are others which are fundamentally hard to implement on streaming data efficiently. For example, sorting on the input stream is not supported, as it requires keeping track of all the data received in the stream. This is therefore fundamentally hard to execute efficiently.</p>
<h2 id="starting-streaming-queries"><a class="header" href="#starting-streaming-queries">Starting Streaming Queries</a></h2>
<p>Once you have defined the final result DataFrame/Dataset, all that is left is for you to start the streaming computation. To do that, you have to use the <code>DataStreamWriter</code> (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.DataStreamWriter">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/DataStreamWriter.html">Java</a>/<a href="https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.streaming.DataStreamWriter">Python</a> docs) returned through <code>Dataset.writeStream()</code>. You will have to specify one or more of the following in this interface.</p>
<ul>
<li>
<p><em>Details of the output sink:</em> Data format, location, etc.</p>
</li>
<li>
<p><em>Output mode:</em> Specify what gets written to the output sink.</p>
</li>
<li>
<p><em>Query name:</em> Optionally, specify a unique name of the query for identification.</p>
</li>
<li>
<p><em>Trigger interval:</em> Optionally, specify the trigger interval. If it is not specified, the system will check for availability of new data as soon as the previous processing has completed. If a trigger time is missed because the previous processing has not completed, then the system will attempt to trigger at the next trigger point, not immediately after the processing has completed.</p>
</li>
<li>
<p><em>Checkpoint location:</em> For some output sinks where the end-to-end fault-tolerance can be guaranteed, specify the location where the system will write all the checkpoint information. This should be a directory in an HDFS-compatible fault-tolerant file system. The semantics of checkpointing is discussed in more detail in the next section.</p>
</li>
</ul>
<h4 id="output-modes"><a class="header" href="#output-modes">Output Modes</a></h4>
<p>There are a few types of output modes.</p>
<ul>
<li>
<p><strong>Append mode (default)</strong> - This is the default mode, where only the new rows added to the Result Table since the last trigger will be outputted to the sink. This is supported for only those queries where rows added to the Result Table is never going to change. Hence, this mode guarantees that each row will be output only once (assuming fault-tolerant sink). For example, queries with only <code>select</code>, <code>where</code>, <code>map</code>, <code>flatMap</code>, <code>filter</code>, <code>join</code>, etc. will support Append mode.</p>
</li>
<li>
<p><strong>Complete mode</strong> - The whole Result Table will be outputted to the sink after every trigger. This is supported for aggregation queries.</p>
</li>
<li>
<p><strong>Update mode</strong> - (<em>Available since Spark 2.1.1</em>) Only the rows in the Result Table that were updated since the last trigger will be outputted to the sink. More information to be added in future releases.</p>
</li>
</ul>
<p>Different types of streaming queries support different output modes. Here is the compatibility matrix.</p>
<table class="table">
  <tr>
    <th>Query Type</th>
    <th></th>
    <th>Supported Output Modes</th>
    <th>Notes</th>        
  </tr>
  <tr>
    <td rowspan="2" style="vertical-align: middle;">Queries with aggregation</td>
    <td style="vertical-align: middle;">Aggregation on event-time with watermark</td>
    <td style="vertical-align: middle;">Append, Update, Complete</td>
    <td>
        Append mode uses watermark to drop old aggregation state. But the output of a 
        windowed aggregation is delayed the late threshold specified in `withWatermark()` as by
        the modes semantics, rows can be added to the Result Table only once after they are 
        finalized (i.e. after watermark is crossed). See the
        <a href="contents/000_4-sds-3-x-ss/structured-streaming-programming-guide.html#handling-late-data-and-watermarking">Late Data</a> section for more details.
        <br /><br />
        Update mode uses watermark to drop old aggregation state.
        <br /><br />
        Complete mode does not drop old aggregation state since by definition this mode
        preserves all data in the Result Table.
    </td>    
  </tr>
  <tr>
    <td style="vertical-align: middle;">Other aggregations</td>
    <td style="vertical-align: middle;">Complete, Update</td>
    <td>
        Since no watermark is defined (only defined in other category), 
        old aggregation state is not dropped.
        <br /><br />
        Append mode is not supported as aggregates can update thus violating the semantics of 
        this mode.
    </td>  
  </tr>
  <tr>
    <td colspan="2" style="vertical-align: middle;">Queries with <code>mapGroupsWithState</code></td>
    <td style="vertical-align: middle;">Update</td>
    <td style="vertical-align: middle;"></td>
  </tr>
  <tr>
    <td rowspan="2" style="vertical-align: middle;">Queries with <code>flatMapGroupsWithState</code></td>
    <td style="vertical-align: middle;">Append operation mode</td>
    <td style="vertical-align: middle;">Append</td>
    <td style="vertical-align: middle;">
      Aggregations are allowed after <code>flatMapGroupsWithState</code>.
    </td>
  </tr>
  <tr>
    <td style="vertical-align: middle;">Update operation mode</td>
    <td style="vertical-align: middle;">Update</td>
    <td style="vertical-align: middle;">
      Aggregations not allowed after <code>flatMapGroupsWithState</code>.
    </td>
  </tr>
  <tr>
    <td colspan="2" style="vertical-align: middle;">Other queries</td>
    <td style="vertical-align: middle;">Append, Update</td>
    <td style="vertical-align: middle;">
      Complete mode not supported as it is infeasible to keep all unaggregated data in the Result Table.
    </td>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</table>
</div>
<div class="cell markdown">
<h4 id="output-sinks"><a class="header" href="#output-sinks">Output Sinks</a></h4>
<p>There are a few types of built-in output sinks.</p>
<ul>
<li><strong>File sink</strong> - Stores the output to a directory.</li>
</ul>
<!-- -->
<pre><code>    writeStream
        .format(&quot;parquet&quot;)        // can be &quot;orc&quot;, &quot;json&quot;, &quot;csv&quot;, etc.
        .option(&quot;path&quot;, &quot;path/to/destination/dir&quot;)
        .start()
</code></pre>
<ul>
<li><strong>Foreach sink</strong> - Runs arbitrary computation on the records in the output. See later in the section for more details.</li>
</ul>
<!-- -->
<pre><code>    writeStream
        .foreach(...)
        .start()
</code></pre>
<ul>
<li><strong>Console sink (for debugging)</strong> - Prints the output to the console/stdout every time there is a trigger. Both, Append and Complete output modes, are supported. This should be used for debugging purposes on low data volumes as the entire output is collected and stored in the driver’s memory after every trigger.</li>
</ul>
<!-- -->
<pre><code>    writeStream
        .format(&quot;console&quot;)
        .start()
</code></pre>
<ul>
<li><strong>Memory sink (for debugging)</strong> - The output is stored in memory as an in-memory table. Both, Append and Complete output modes, are supported. This should be used for debugging purposes on low data volumes as the entire output is collected and stored in the driver’s memory. Hence, use it with caution.</li>
</ul>
<!-- -->
<pre><code>    writeStream
        .format(&quot;memory&quot;)
        .queryName(&quot;tableName&quot;)
        .start()
</code></pre>
<p>Some sinks are not fault-tolerant because they do not guarantee persistence of the output and are meant for debugging purposes only. See the earlier section on <a href="https://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html#fault-tolerance-semantics">fault-tolerance semantics</a>. Here are the details of all the sinks in Spark.</p>
<table class="table">
  <tr>
    <th>Sink</th>
    <th>Supported Output Modes</th>
    <th>Options</th>
    <th>Fault-tolerant</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td><b>File Sink</b></td>
    <td>Append</td>
    <td>
        <code>path</code>: path to the output directory, must be specified.
        <br /><br />
        For file-format-specific options, see the related methods in DataFrameWriter
        (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.DataFrameWriter">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/DataFrameWriter.html">Java</a>/<a href="https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.DataFrameWriter">Python</a>/<a href="https://spark.apache.org/docs/2.2.0/api/R/write.stream.html">R</a>).
        E.g. for "parquet" format options see <code>DataFrameWriter.parquet()</code>
    </td>
    <td>Yes</td>
    <td>Supports writes to partitioned tables. Partitioning by time may be useful.</td>
  </tr>
  <tr>
    <td><b>Foreach Sink</b></td>
    <td>Append, Update, Compelete</td>
    <td>None</td>
    <td>Depends on ForeachWriter implementation</td>
    <td>More details in the <a href="contents/000_4-sds-3-x-ss/structured-streaming-programming-guide.html#using-foreach">next section</a></td>
  </tr>
  <tr>
    <td><b>Console Sink</b></td>
    <td>Append, Update, Complete</td>
    <td>
        <code>numRows</code>: Number of rows to print every trigger (default: 20)
        <br />
        <code>truncate</code>: Whether to truncate the output if too long (default: true)
    </td>
    <td>No</td>
    <td></td>
  </tr>
  <tr>
    <td><b>Memory Sink</b></td>
    <td>Append, Complete</td>
    <td>None</td>
    <td>No. But in Complete Mode, restarted query will recreate the full table.</td>
    <td>Table name is the query name.</td>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</table>
</div>
<div class="cell markdown">
<p>Note that you have to call <code>start()</code> to actually start the execution of the query. This returns a StreamingQuery object which is a handle to the continuously running execution. You can use this object to manage the query, which we will discuss in the next subsection. For now, let’s understand all this with a few examples.</p>
<p>``` // ========== DF with no aggregations ========== val noAggDF = deviceDataDf.select(&quot;device&quot;).where(&quot;signal &gt; 10&quot;)</p>
<pre><code>// Print new data to console
noAggDF
  .writeStream
  .format(&quot;console&quot;)
  .start()

// Write new data to Parquet files
noAggDF
  .writeStream
  .format(&quot;parquet&quot;)
  .option(&quot;checkpointLocation&quot;, &quot;path/to/checkpoint/dir&quot;)
  .option(&quot;path&quot;, &quot;path/to/destination/dir&quot;)
  .start()

// ========== DF with aggregation ==========
val aggDF = df.groupBy(&quot;device&quot;).count()

// Print updated aggregations to console
aggDF
  .writeStream
  .outputMode(&quot;complete&quot;)
  .format(&quot;console&quot;)
  .start()

// Have all the aggregates in an in-memory table
aggDF
  .writeStream
  .queryName(&quot;aggregates&quot;)    // this query name will be the table name
  .outputMode(&quot;complete&quot;)
  .format(&quot;memory&quot;)
  .start()

spark.sql(&quot;select * from aggregates&quot;).show()   // interactively query in-memory table
```
</code></pre>
</div>
<div class="cell markdown">
<h4 id="using-foreach"><a class="header" href="#using-foreach">Using Foreach</a></h4>
<p>The <code>foreach</code> operation allows arbitrary operations to be computed on the output data. As of Spark 2.1, this is available only for Scala and Java. To use this, you will have to implement the interface <code>ForeachWriter</code> (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.ForeachWriter">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/ForeachWriter.html">Java</a> docs), which has methods that get called whenever there is a sequence of rows generated as output after a trigger. Note the following important points.</p>
<ul>
<li>
<p>The writer must be serializable, as it will be serialized and sent to the executors for execution.</p>
</li>
<li>
<p>All the three methods, <code>open</code>, <code>process</code> and <code>close</code> will be called on the executors.</p>
</li>
<li>
<p>The writer must do all the initialization (e.g. opening connections, starting a transaction, etc.) only when the <code>open</code> method is called. Be aware that, if there is any initialization in the class as soon as the object is created, then that initialization will happen in the driver (because that is where the instance is being created), which may not be what you intend.</p>
</li>
<li>
<p><code>version</code> and <code>partition</code> are two parameters in <code>open</code> that uniquely represent a set of rows that needs to be pushed out. <code>version</code> is a monotonically increasing id that increases with every trigger. <code>partition</code> is an id that represents a partition of the output, since the output is distributed and will be processed on multiple executors.</p>
</li>
<li>
<p><code>open</code> can use the <code>version</code> and <code>partition</code> to choose whether it needs to write the sequence of rows. Accordingly, it can return <code>true</code> (proceed with writing), or <code>false</code> (no need to write). If <code>false</code> is returned, then <code>process</code> will not be called on any row. For example, after a partial failure, some of the output partitions of the failed trigger may have already been committed to a database. Based on metadata stored in the database, the writer can identify partitions that have already been committed and accordingly return false to skip committing them again.</p>
</li>
<li>
<p>Whenever <code>open</code> is called, <code>close</code> will also be called (unless the JVM exits due to some error). This is true even if <code>open</code> returns false. If there is any error in processing and writing the data, <code>close</code> will be called with the error. It is your responsibility to clean up state (e.g. connections, transactions, etc.) that have been created in <code>open</code> such that there are no resource leaks.</p>
</li>
</ul>
<h2 id="managing-streaming-queries"><a class="header" href="#managing-streaming-queries">Managing Streaming Queries</a></h2>
<p>The <code>StreamingQuery</code> object created when a query is started can be used to monitor and manage the query.</p>
<pre><code>    val query = df.writeStream.format(&quot;console&quot;).start()   // get the query object

    query.id          // get the unique identifier of the running query that persists across restarts from checkpoint data

    query.runId       // get the unique id of this run of the query, which will be generated at every start/restart

    query.name        // get the name of the auto-generated or user-specified name

    query.explain()   // print detailed explanations of the query

    query.stop()      // stop the query

    query.awaitTermination()   // block until query is terminated, with stop() or with error

    query.exception       // the exception if the query has been terminated with error

    query.recentProgress  // an array of the most recent progress updates for this query

    query.lastProgress    // the most recent progress update of this streaming query
</code></pre>
</div>
<div class="cell markdown">
<p>You can start any number of queries in a single SparkSession. They will all be running concurrently sharing the cluster resources. You can use <code>sparkSession.streams()</code> to get the <code>StreamingQueryManager</code> (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.StreamingQueryManager">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/StreamingQueryManager.html">Java</a>/<a href="https://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.streaming.StreamingQueryManager">Python</a> docs) that can be used to manage the currently active queries.</p>
<pre><code>    val spark: SparkSession = ...

    spark.streams.active    // get the list of currently active streaming queries

    spark.streams.get(id)   // get a query object by its unique id

    spark.streams.awaitAnyTermination()   // block until any one of them terminates
</code></pre>
<h2 id="monitoring-streaming-queries"><a class="header" href="#monitoring-streaming-queries">Monitoring Streaming Queries</a></h2>
<p>There are two APIs for monitoring and debugging active queries - interactively and asynchronously.</p>
<h3 id="interactive-apis"><a class="header" href="#interactive-apis">Interactive APIs</a></h3>
<p>You can directly get the current status and metrics of an active query using <code>streamingQuery.lastProgress()</code> and <code>streamingQuery.status()</code>. <code>lastProgress()</code> returns a <code>StreamingQueryProgress</code> object in <a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.StreamingQueryProgress">Scala</a> and <a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/StreamingQueryProgress.html">Java</a> and a dictionary with the same fields in Python. It has all the information about the progress made in the last trigger of the stream - what data was processed, what were the processing rates, latencies, etc. There is also <code>streamingQuery.recentProgress</code> which returns an array of last few progresses.</p>
<p>In addition, <code>streamingQuery.status()</code> returns a <code>StreamingQueryStatus</code> object in <a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.StreamingQueryStatus">Scala</a> and <a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/StreamingQueryStatus.html">Java</a> and a dictionary with the same fields in Python. It gives information about what the query is immediately doing - is a trigger active, is data being processed, etc.</p>
<p>Here are a few examples.</p>
<pre><code>    val query: StreamingQuery = ...

    println(query.lastProgress)

    /* Will print something like the following.

    {
      &quot;id&quot; : &quot;ce011fdc-8762-4dcb-84eb-a77333e28109&quot;,
      &quot;runId&quot; : &quot;88e2ff94-ede0-45a8-b687-6316fbef529a&quot;,
      &quot;name&quot; : &quot;MyQuery&quot;,
      &quot;timestamp&quot; : &quot;2016-12-14T18:45:24.873Z&quot;,
      &quot;numInputRows&quot; : 10,
      &quot;inputRowsPerSecond&quot; : 120.0,
      &quot;processedRowsPerSecond&quot; : 200.0,
      &quot;durationMs&quot; : {
        &quot;triggerExecution&quot; : 3,
        &quot;getOffset&quot; : 2
      },
      &quot;eventTime&quot; : {
        &quot;watermark&quot; : &quot;2016-12-14T18:45:24.873Z&quot;
      },
      &quot;stateOperators&quot; : [ ],
      &quot;sources&quot; : [ {
        &quot;description&quot; : &quot;KafkaSource[Subscribe[topic-0]]&quot;,
        &quot;startOffset&quot; : {
          &quot;topic-0&quot; : {
            &quot;2&quot; : 0,
            &quot;4&quot; : 1,
            &quot;1&quot; : 1,
            &quot;3&quot; : 1,
            &quot;0&quot; : 1
          }
        },
        &quot;endOffset&quot; : {
          &quot;topic-0&quot; : {
            &quot;2&quot; : 0,
            &quot;4&quot; : 115,
            &quot;1&quot; : 134,
            &quot;3&quot; : 21,
            &quot;0&quot; : 534
          }
        },
        &quot;numInputRows&quot; : 10,
        &quot;inputRowsPerSecond&quot; : 120.0,
        &quot;processedRowsPerSecond&quot; : 200.0
      } ],
      &quot;sink&quot; : {
        &quot;description&quot; : &quot;MemorySink&quot;
      }
    }
    */


    println(query.status)

    /*  Will print something like the following.
    {
      &quot;message&quot; : &quot;Waiting for data to arrive&quot;,
      &quot;isDataAvailable&quot; : false,
      &quot;isTriggerActive&quot; : false
    }
    */
</code></pre>
<h3 id="asynchronous-api"><a class="header" href="#asynchronous-api">Asynchronous API</a></h3>
<p>You can also asynchronously monitor all queries associated with a <code>SparkSession</code> by attaching a <code>StreamingQueryListener</code> (<a href="https://spark.apache.org/docs/2.2.0/api/scala/index.html#org.apache.spark.sql.streaming.StreamingQueryListener">Scala</a>/<a href="https://spark.apache.org/docs/2.2.0/api/java/org/apache/spark/sql/streaming/StreamingQueryListener.html">Java</a> docs). Once you attach your custom <code>StreamingQueryListener</code> object with <code>sparkSession.streams.attachListener()</code>, you will get callbacks when a query is started and stopped and when there is progress made in an active query. Here is an example,</p>
<pre><code>    val spark: SparkSession = ...

    spark.streams.addListener(new StreamingQueryListener() {
        override def onQueryStarted(queryStarted: QueryStartedEvent): Unit = {
            println(&quot;Query started: &quot; + queryStarted.id)
        }
        override def onQueryTerminated(queryTerminated: QueryTerminatedEvent): Unit = {
            println(&quot;Query terminated: &quot; + queryTerminated.id)
        }
        override def onQueryProgress(queryProgress: QueryProgressEvent): Unit = {
            println(&quot;Query made progress: &quot; + queryProgress.progress)
        }
    })
</code></pre>
<h2 id="recovering-from-failures-with-checkpointing"><a class="header" href="#recovering-from-failures-with-checkpointing">Recovering from Failures with Checkpointing</a></h2>
<p>In case of a failure or intentional shutdown, you can recover the previous progress and state of a previous query, and continue where it left off. This is done using checkpointing and write ahead logs. You can configure a query with a checkpoint location, and the query will save all the progress information (i.e. range of offsets processed in each trigger) and the running aggregates (e.g. word counts in the <em>quick example</em> to the checkpoint location. This checkpoint location has to be a path in an HDFS compatible file system, and can be set as an option in the DataStreamWriter when <em>starting a query</em>.</p>
<pre><code>    aggDF
      .writeStream
      .outputMode(&quot;complete&quot;)
      .option(&quot;checkpointLocation&quot;, &quot;path/to/HDFS/dir&quot;)
      .format(&quot;memory&quot;)
      .start()
</code></pre>
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="structured-streaming-using-scala-dataframes-api---exercise"><a class="header" href="#structured-streaming-using-scala-dataframes-api---exercise">Structured Streaming using Scala DataFrames API - Exercise</a></h1>
<p>Apache Spark 2.0+ adds the first version of a new higher-level stream processing API, Structured Streaming. In this notebook we are going to take a quick look at how to use DataFrame API to build Structured Streaming applications. We want to compute real-time metrics like running counts and windowed counts on a stream of timestamped actions (e.g. Open, Close, etc).</p>
<p>This is built on the public databricks notebook <a href="https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/4012078893478893/295447656425301/5985939988045659/latest.html">importable from here</a>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Spark 3.0.1 scala 2.12
spark.version
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res1: String = 3.0.1
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2 id="sample-data"><a class="header" href="#sample-data">Sample Data</a></h2>
<p>We have some sample action data as files in <code>/databricks-datasets/structured-streaming/events/</code> which we are going to use to build this appication. Let's take a look at the contents of this directory.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-fs">ls /databricks-datasets/structured-streaming/events/
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-0.json</td>
<td>file-0.json</td>
<td>72530.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-1.json</td>
<td>file-1.json</td>
<td>72961.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-10.json</td>
<td>file-10.json</td>
<td>73025.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-11.json</td>
<td>file-11.json</td>
<td>72999.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-12.json</td>
<td>file-12.json</td>
<td>72987.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-13.json</td>
<td>file-13.json</td>
<td>73006.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-14.json</td>
<td>file-14.json</td>
<td>73003.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-15.json</td>
<td>file-15.json</td>
<td>73007.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-16.json</td>
<td>file-16.json</td>
<td>72978.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-17.json</td>
<td>file-17.json</td>
<td>73008.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-18.json</td>
<td>file-18.json</td>
<td>73002.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-19.json</td>
<td>file-19.json</td>
<td>73014.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-2.json</td>
<td>file-2.json</td>
<td>73007.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-20.json</td>
<td>file-20.json</td>
<td>72987.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-21.json</td>
<td>file-21.json</td>
<td>72983.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-22.json</td>
<td>file-22.json</td>
<td>73009.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-23.json</td>
<td>file-23.json</td>
<td>72985.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-24.json</td>
<td>file-24.json</td>
<td>73020.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-25.json</td>
<td>file-25.json</td>
<td>72980.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-26.json</td>
<td>file-26.json</td>
<td>73002.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-27.json</td>
<td>file-27.json</td>
<td>73013.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-28.json</td>
<td>file-28.json</td>
<td>73005.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-29.json</td>
<td>file-29.json</td>
<td>72977.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-3.json</td>
<td>file-3.json</td>
<td>72996.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-30.json</td>
<td>file-30.json</td>
<td>73009.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-31.json</td>
<td>file-31.json</td>
<td>73008.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-32.json</td>
<td>file-32.json</td>
<td>72982.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-33.json</td>
<td>file-33.json</td>
<td>73033.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-34.json</td>
<td>file-34.json</td>
<td>72985.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-35.json</td>
<td>file-35.json</td>
<td>72974.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-36.json</td>
<td>file-36.json</td>
<td>73013.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-37.json</td>
<td>file-37.json</td>
<td>72989.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-38.json</td>
<td>file-38.json</td>
<td>72999.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-39.json</td>
<td>file-39.json</td>
<td>73013.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-4.json</td>
<td>file-4.json</td>
<td>72992.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-40.json</td>
<td>file-40.json</td>
<td>72986.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-41.json</td>
<td>file-41.json</td>
<td>73019.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-42.json</td>
<td>file-42.json</td>
<td>72986.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-43.json</td>
<td>file-43.json</td>
<td>72990.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-44.json</td>
<td>file-44.json</td>
<td>73018.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-45.json</td>
<td>file-45.json</td>
<td>72997.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-46.json</td>
<td>file-46.json</td>
<td>72991.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-47.json</td>
<td>file-47.json</td>
<td>73009.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-48.json</td>
<td>file-48.json</td>
<td>72993.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-49.json</td>
<td>file-49.json</td>
<td>73496.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-5.json</td>
<td>file-5.json</td>
<td>72998.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-6.json</td>
<td>file-6.json</td>
<td>72997.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-7.json</td>
<td>file-7.json</td>
<td>73022.0</td>
</tr>
<tr class="odd">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-8.json</td>
<td>file-8.json</td>
<td>72997.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/structured-streaming/events/file-9.json</td>
<td>file-9.json</td>
<td>72970.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>There are about 50 JSON files in the directory. Let's see what each JSON file contains.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-fs">head /databricks-datasets/structured-streaming/events/file-0.json
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>[Truncated to first 65536 bytes]
{&quot;time&quot;:1469501107,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501147,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501202,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501219,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501225,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501234,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501245,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501246,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501248,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501256,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501264,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501266,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501267,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501269,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501271,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501282,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501285,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501291,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501297,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501303,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501322,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501335,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501344,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501346,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501349,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501357,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501366,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501371,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501375,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501375,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501381,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501392,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501402,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501407,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501410,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501420,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501424,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501438,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501442,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501462,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501480,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501488,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501489,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501491,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501503,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501505,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501509,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501513,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501517,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501520,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501525,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501533,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501539,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501540,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501541,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501543,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501544,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501545,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501545,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501547,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501552,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501557,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501559,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501560,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501560,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501565,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501566,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501574,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501575,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501575,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501578,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501581,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501584,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501600,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501601,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501603,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501610,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501620,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501621,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501625,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501625,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501626,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501631,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501632,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501632,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501638,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501643,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501646,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501662,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501662,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501662,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501663,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501667,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501674,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501675,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501678,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501680,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501685,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501686,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501689,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501691,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501694,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501696,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501702,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501703,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501704,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501706,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501706,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501710,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501715,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501717,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501719,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501719,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501734,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501739,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501740,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501747,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501749,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501749,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501754,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501755,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501756,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501756,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501757,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501758,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501759,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501761,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501764,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501772,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501772,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501776,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501780,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501782,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501783,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501785,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501789,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501795,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501802,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501802,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501806,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501813,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501817,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501818,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501819,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501828,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501829,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501830,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501833,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501835,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501837,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501838,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501840,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501845,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501848,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501853,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501855,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501861,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501861,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501862,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501863,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501865,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501873,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501884,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501895,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501904,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501907,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501909,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501909,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501911,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501929,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501930,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501930,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501931,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501935,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501935,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501946,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501946,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501959,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501967,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501972,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469501976,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501978,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501978,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501978,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501980,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501980,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501985,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501988,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501992,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469501996,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502005,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502010,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502014,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502020,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502022,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502022,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502031,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502031,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502033,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502035,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502038,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502044,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502054,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502054,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502054,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502057,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502060,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502065,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502067,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502071,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502071,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502072,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502073,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502077,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502080,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502092,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502097,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502105,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502109,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502118,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502126,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502127,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502132,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502135,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502144,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502145,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502147,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502148,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502154,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502157,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502165,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502177,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502181,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502181,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502182,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502184,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502184,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502190,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502194,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502201,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502202,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502205,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502206,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502211,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502217,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502218,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502229,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502231,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502231,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502234,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502236,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502241,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502244,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502245,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502246,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502253,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502257,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502258,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502259,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502259,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502261,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502267,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502269,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502269,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502270,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502272,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502272,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502273,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502273,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502275,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502277,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502279,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502279,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502282,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502285,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502286,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502292,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502294,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502298,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502301,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502302,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502304,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502308,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502318,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502323,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502328,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502333,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502336,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502338,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502346,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502348,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502350,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502351,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502357,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502361,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502361,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502364,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502365,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502367,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502369,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502372,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502374,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502377,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502379,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502379,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502382,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502385,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502388,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502404,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502411,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502416,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502416,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502417,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502422,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502429,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502430,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502430,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502432,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502432,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502433,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502444,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502445,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502446,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502446,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502453,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502456,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502464,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502470,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502471,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502472,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502474,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502475,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502480,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502481,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502490,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502497,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502497,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502497,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502500,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502500,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502501,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502507,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502507,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502508,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502512,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502514,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502515,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502517,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502527,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502527,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502529,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502538,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502549,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502553,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502555,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502560,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502561,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502561,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502562,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502564,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502573,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502575,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502583,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502585,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502587,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502590,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502593,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502595,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502596,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502609,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502609,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502611,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502612,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502613,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502614,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502619,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502626,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502626,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502627,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502629,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502635,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502641,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502641,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502643,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502647,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502649,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502654,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502655,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502656,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502660,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502661,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502663,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502668,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502675,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502678,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502683,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502686,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502687,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502688,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502693,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502695,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502704,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502708,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502716,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502717,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502726,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502727,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502729,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502732,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502733,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502735,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502736,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502742,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502745,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502746,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502752,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502753,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502754,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502757,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502757,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502771,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502778,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502782,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502783,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502783,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502789,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502800,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502800,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502801,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502809,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502811,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502813,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502814,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502817,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502820,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502822,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502822,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502831,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502831,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502832,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502833,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502839,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502842,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502844,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502849,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502850,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502851,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502851,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502852,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502853,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502855,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502856,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502857,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502857,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502858,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502861,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502861,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502863,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502865,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502867,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502867,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502868,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502873,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502880,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502881,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502886,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502887,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502887,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502893,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502897,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502907,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502907,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502911,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502912,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502913,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502919,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502920,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502922,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502922,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502925,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502927,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502931,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502932,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502941,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502941,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502942,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502945,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502946,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502947,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502954,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502959,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502964,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502964,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502969,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502972,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502973,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502973,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502974,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502975,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502984,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502985,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502986,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469502988,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502988,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502992,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469502997,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503000,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503005,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503007,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503014,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503014,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503021,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503024,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503025,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503025,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503030,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503036,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503039,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503039,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503042,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503043,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503048,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503060,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503065,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503065,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503066,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503067,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503071,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503074,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503075,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503075,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503082,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503082,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503086,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503088,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503088,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503088,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503097,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503105,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503106,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503109,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503109,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503110,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503116,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503120,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503125,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503125,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503126,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503128,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503128,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503133,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503135,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503136,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503136,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503139,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503140,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503140,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503140,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503143,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503150,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503151,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503154,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503158,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503159,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503160,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503160,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503161,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503162,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503166,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503169,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503173,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503176,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503184,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503190,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503190,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503195,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503195,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503196,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503198,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503203,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503206,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503209,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503211,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503215,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503224,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503229,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503231,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503231,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503231,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503231,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503234,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503236,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503246,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503246,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503248,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503250,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503255,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503255,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503259,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503261,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503262,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503270,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503277,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503280,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503281,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503283,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503287,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503291,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503291,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503291,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503292,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503299,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503301,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503302,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503305,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503309,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503316,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503319,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503319,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503321,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503325,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503325,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503328,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503330,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503334,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503335,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503335,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503337,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503344,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503347,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503348,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503355,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503356,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503357,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503359,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503362,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503362,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503363,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503365,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503374,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503377,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503378,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503378,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503382,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503383,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503385,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503386,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503387,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503392,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503393,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503398,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503403,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503406,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503406,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503407,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503407,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503408,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503409,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503411,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503411,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503415,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503418,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503418,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503425,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503426,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503429,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503430,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503432,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503437,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503438,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503445,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503448,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503449,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503450,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503455,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503460,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503463,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503463,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503466,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503471,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503474,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503475,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503477,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503478,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503482,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469503487,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469503490,&quot;action&quot;:&quot;Open&quot;}

*** WARNING: skipped 15627 bytes of output ***

{&quot;time&quot;:1469504646,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504648,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504653,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504658,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504658,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504658,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504661,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504662,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504662,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504665,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504668,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504672,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504675,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504679,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504686,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504687,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504696,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504703,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504710,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504710,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504710,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504710,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504717,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504724,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504731,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504736,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504739,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504741,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504742,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504742,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504743,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504744,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504745,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504747,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504748,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504748,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504748,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504751,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504752,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504753,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504754,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504757,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504757,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504761,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504762,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504765,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504765,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504768,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504779,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504779,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504780,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504781,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504782,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504784,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504786,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504789,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504789,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504791,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504792,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504792,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504793,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504797,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504802,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504803,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504803,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504805,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504807,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504808,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504809,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504810,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504811,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504811,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504815,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504818,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504819,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504820,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504820,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504824,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504825,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504829,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504834,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504836,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504840,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504848,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504853,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504854,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504855,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504859,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504860,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504866,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504873,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504875,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504881,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504882,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504886,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504889,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504890,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504892,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504897,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504901,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504902,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504903,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504903,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504904,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504905,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504909,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504909,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504910,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504911,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504915,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504916,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504922,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504926,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504926,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504929,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504929,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504931,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504933,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504935,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504937,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504937,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504942,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504943,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504944,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504946,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504948,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504958,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504960,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504960,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504963,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504964,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504964,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504967,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504968,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504971,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504972,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504974,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504983,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504983,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504983,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504984,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504987,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469504989,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504991,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504993,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504994,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469504998,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505000,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505005,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505005,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505007,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505008,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505010,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505012,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505013,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505013,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505013,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505017,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505020,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505020,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505021,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505022,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505022,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505023,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505029,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505032,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505033,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505035,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505039,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505040,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505040,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505041,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505046,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505046,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505047,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505049,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505050,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505052,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505057,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505059,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505062,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505064,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505069,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505072,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505072,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505072,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505074,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505075,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505076,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505077,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505081,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505082,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505085,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505086,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505086,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505086,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505098,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505101,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505102,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505102,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505106,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505106,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505111,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505118,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505120,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505126,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505128,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505129,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505129,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505133,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505139,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505140,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505155,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505162,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505163,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505164,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505166,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505169,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505170,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505170,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505172,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505175,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505176,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505180,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505180,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505180,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505183,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505184,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505184,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505185,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505185,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505188,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505191,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505192,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505194,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505200,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505201,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505203,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505204,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505204,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505207,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505209,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505211,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505219,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505222,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505226,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505229,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505235,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505237,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505238,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505239,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505241,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505246,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505250,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505250,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505255,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505255,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505256,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505259,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505261,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505261,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505262,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505263,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505264,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505265,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505266,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505266,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505269,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505269,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505272,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505273,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505278,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505278,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505281,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505283,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505283,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505286,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505289,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505291,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505294,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505295,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505296,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505300,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505300,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505301,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505301,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505303,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505307,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505307,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505312,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505320,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505321,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505328,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505330,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505332,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505333,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505335,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505336,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505336,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505343,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505344,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505346,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505349,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505349,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505351,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505353,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505353,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505361,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505363,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505363,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505370,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505371,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505372,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505372,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505375,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505377,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505378,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505380,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505384,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505387,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505389,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505393,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505393,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505397,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505406,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505413,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505414,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505414,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505414,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505415,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505416,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505418,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505421,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505424,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505428,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505430,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505443,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505451,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505460,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505460,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505462,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505463,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505464,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505465,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505465,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505473,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505474,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505478,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505480,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505482,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505484,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505487,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505488,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505490,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505498,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505499,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505504,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505505,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505509,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505514,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505515,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505517,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505523,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505524,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505524,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505525,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505526,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505526,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505527,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505528,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505531,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505533,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505534,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505534,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505535,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505538,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505538,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505539,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505539,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505540,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505542,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505543,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505544,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505545,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505550,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505550,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505551,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505553,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505555,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505556,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505557,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505558,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505558,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505561,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505563,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505563,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505564,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505566,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505567,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505573,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505574,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505579,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505582,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505586,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505588,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505589,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505590,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505591,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505591,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505597,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505597,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505599,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505601,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505602,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505612,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505616,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505616,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505617,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505619,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505621,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505624,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505625,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505626,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505628,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505629,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505638,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505640,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505640,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505650,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505653,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505661,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505661,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505663,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505665,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505668,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505682,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505686,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505694,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505695,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505696,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505700,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505708,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505711,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505713,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505715,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505715,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505718,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505719,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505723,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505725,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505728,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505731,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505733,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505733,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505735,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505735,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505736,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505739,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505739,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505741,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505741,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505748,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505748,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505748,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505749,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505753,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505754,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505758,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505758,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505759,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505759,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505769,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505770,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505770,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505775,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505783,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505787,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505788,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505793,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505794,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505797,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505800,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505801,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505802,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505803,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505811,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505812,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505815,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505820,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505820,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505824,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505830,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505832,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505834,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505835,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505835,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505836,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505838,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505839,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505841,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505842,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505844,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505851,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505851,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505854,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505860,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505863,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505867,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505873,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505875,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505875,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505875,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505877,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505882,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505886,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505890,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505892,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505897,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505902,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505903,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505904,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505904,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505905,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505905,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505905,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505907,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505907,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505910,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505913,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505918,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505919,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505920,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505922,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505923,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505924,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505927,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505927,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505929,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505933,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505935,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505936,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505937,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505937,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505938,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505939,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505941,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505942,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505944,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505947,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505954,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505954,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505955,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505958,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505959,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505961,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505966,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505966,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505967,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505969,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505970,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505970,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505972,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505972,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505975,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505977,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469505977,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505979,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505980,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505986,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505987,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505987,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505990,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505990,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505990,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505991,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505992,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469505998,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506000,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506002,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506004,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506005,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506005,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506005,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506006,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506006,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506006,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506010,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506012,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506022,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506022,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506025,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506028,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506030,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506030,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506032,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506032,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506033,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506033,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506035,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506036,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506038,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506041,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506044,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506046,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506046,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506047,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506047,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506049,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506050,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506051,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506053,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506055,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506056,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506056,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506058,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506060,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506063,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506070,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506070,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506072,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506074,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506081,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506081,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506081,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506083,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506083,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506085,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506085,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506091,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506095,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506096,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506097,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506099,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506107,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506109,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506110,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506110,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506111,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506113,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506114,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506114,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506115,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506116,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506124,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506125,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506129,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506130,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506133,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506135,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506135,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506137,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506140,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506144,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506148,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506150,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506153,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506154,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506155,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506159,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506160,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506161,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506165,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506166,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506167,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506173,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506174,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506176,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506178,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506180,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506186,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506186,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506187,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506189,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506207,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506207,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506216,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506218,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506220,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506220,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506221,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506225,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506227,&quot;action&quot;:&quot;Close&quot;}
{&quot;time&quot;:1469506228,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506233,&quot;action&quot;:&quot;Open&quot;}
{&quot;time&quot;:1469506234,&quot;action&quot;:&quot;O
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Each line in the files contain a JSON record with two fields - <code>time</code> and <code>action</code>. Let's try to analyze these files interactively.</p>
</div>
<div class="cell markdown">
<h2 id="batchinteractive-processing"><a class="header" href="#batchinteractive-processing">Batch/Interactive Processing</a></h2>
<p>The usual first step in attempting to process the data is to interactively query the data. Let's define a static DataFrame on the files, and give it a table name.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">import org.apache.spark.sql.types._

val inputPath = &quot;/databricks-datasets/structured-streaming/events/&quot;

// Since we know the data format already, let's define the schema to speed up processing (no need for Spark to infer schema)
val jsonSchema = new StructType().add(&quot;time&quot;, TimestampType).add(&quot;action&quot;, StringType)

val staticInputDF = 
  spark
    .read
    .schema(jsonSchema)
    .json(inputPath)

display(staticInputDF)
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>time</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2016-07-28T04:19:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:40.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:47.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:48.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:19:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:19:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:13.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:16.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:48.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:20:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:20:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:37.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:21:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:21:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:10.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:22:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:22:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:10.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:17.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:48.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:53.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:23:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:23:55.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:35.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:24:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:24:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:04.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:27.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:25:57.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:25:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:08.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:35.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:45.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:45.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:57.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:58.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:26:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:26:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:27:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:27:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:04.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:40.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:55.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:28:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:28:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:02.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:17.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:57.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:57.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:58.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:29:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:29:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:05.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:08.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:17.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:47.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:30:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:30:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:02.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:05.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:40.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:45.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:31:53.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:31:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:08.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:47.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:57.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:32:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:32:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:02.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:13.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:13.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:40.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:33:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:33:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:05.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:17.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:34:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:34:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:16.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:37.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:51.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:35:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:35:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:05.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:16.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:17.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:51.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:36:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:36:58.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:04.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:37:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:37:58.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:08.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:37.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:53.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:38:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:38:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:10.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:17.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:28.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:51.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:39:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:39:58.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:07.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:55.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:40:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:40:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:14.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:17.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:17.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:20.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:29.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:40.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:43.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:48.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:41:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:41:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:10.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:11.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:42:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:42:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:07.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:43.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:49.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:50.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:43:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:43:59.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:00.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:14.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:15.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:16.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:23.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:53.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:44:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:44:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:04.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:10.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:20.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:31.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:32.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:39.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:45:46.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:45:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:01.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:15.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:18.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:27.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:31.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:33.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:35.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:37.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:45.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:48.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:48.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:51.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:53.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:55.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:46:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:46:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:03.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:06.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:26.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:32.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:38.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:40.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:46.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:47.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:51.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:55.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:47:56.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:47:58.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:02.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:06.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:09.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:12.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:19.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:21.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:33.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:35.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:35.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:35.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:37.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:38.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:42.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:44.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:45.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:53.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:48:56.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:48:59.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:00.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:01.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:05.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:08.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:12.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:22.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:24.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:25.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:30.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:36.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:36.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:51.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:49:52.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:49:57.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:02.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:16.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:18.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:21.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:23.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:24.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:25.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:28.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:30.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:34.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:47.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:49.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:50:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:50:52.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:03.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:09.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:11.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:13.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:16.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:19.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:22.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:26.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:29.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:34.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:39.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:41.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:41.000+0000</td>
<td>Open</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:42.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:44.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:50.000+0000</td>
<td>Close</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:54.000+0000</td>
<td>Close</td>
</tr>
<tr class="odd">
<td>2016-07-28T04:51:54.000+0000</td>
<td>Open</td>
</tr>
<tr class="even">
<td>2016-07-28T04:51:57.000+0000</td>
<td>Close</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Now we can compute the number of &quot;open&quot; and &quot;close&quot; actions with one hour windows. To do this, we will group by the <code>action</code> column and 1 hour windows over the <code>time</code> column.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.functions._

val staticCountsDF = 
  staticInputDF
    .groupBy($&quot;action&quot;, window($&quot;time&quot;, &quot;1 hour&quot;))
    .count()   

// Register the DataFrame as table 'static_counts'
staticCountsDF.createOrReplaceTempView(&quot;static_counts&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.functions._
staticCountsDF: org.apache.spark.sql.DataFrame = [action: string, window: struct&lt;start: timestamp, end: timestamp&gt; ... 1 more field]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Now we can directly use SQL to query the table. For example, here are the total counts across all the hours.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sql">select action, sum(count) as total_count from static_counts group by action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>total_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Open</td>
<td>50000.0</td>
</tr>
<tr class="even">
<td>Close</td>
<td>50000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>How about a timeline of windowed counts?</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sql">select action, date_format(window.end, &quot;MMM-dd HH:mm&quot;) as time, count from static_counts order by time, action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>time</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Close</td>
<td>Jul-26 03:00</td>
<td>11.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 03:00</td>
<td>179.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 04:00</td>
<td>344.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 04:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 05:00</td>
<td>815.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 05:00</td>
<td>999.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 06:00</td>
<td>1003.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 06:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 07:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 07:00</td>
<td>993.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 08:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 08:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 09:00</td>
<td>985.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 09:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 10:00</td>
<td>983.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 10:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 11:00</td>
<td>1022.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 11:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 12:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 12:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 13:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 13:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 14:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 14:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 15:00</td>
<td>994.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 15:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 16:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 16:00</td>
<td>1020.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 17:00</td>
<td>984.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 18:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 18:00</td>
<td>990.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 19:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 19:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 20:00</td>
<td>967.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 20:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 21:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 21:00</td>
<td>1010.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 22:00</td>
<td>995.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 23:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 23:00</td>
<td>997.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 00:00</td>
<td>950.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 00:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 01:00</td>
<td>1008.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 01:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 02:00</td>
<td>1013.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 02:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 03:00</td>
<td>971.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 03:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 04:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 04:00</td>
<td>1014.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 05:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 05:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 06:00</td>
<td>987.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 06:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 07:00</td>
<td>1026.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 07:00</td>
<td>1016.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 08:00</td>
<td>982.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 08:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 09:00</td>
<td>1024.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 09:00</td>
<td>1002.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 10:00</td>
<td>990.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 10:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 11:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 11:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 12:00</td>
<td>1006.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 12:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 13:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 13:00</td>
<td>994.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 14:00</td>
<td>986.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 14:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 15:00</td>
<td>948.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 15:00</td>
<td>984.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 16:00</td>
<td>1018.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 16:00</td>
<td>1017.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 17:00</td>
<td>970.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 18:00</td>
<td>1020.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 18:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 19:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 19:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 20:00</td>
<td>969.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 20:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 21:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 21:00</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 22:00</td>
<td>979.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 23:00</td>
<td>996.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 23:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 00:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 00:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 01:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 01:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 02:00</td>
<td>1010.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 02:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 03:00</td>
<td>1007.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 03:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 04:00</td>
<td>993.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 04:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 05:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 05:00</td>
<td>825.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 06:00</td>
<td>671.0</td>
</tr>
<tr class="even">
<td>Close</td>
<td>Jul-28 07:00</td>
<td>191.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Note the two ends of the graph. The close actions are generated such that they are after the corresponding open actions, so there are more &quot;opens&quot; in the beginning and more &quot;closes&quot; in the end.</p>
</div>
<div class="cell markdown">
<h2 id="stream-processing"><a class="header" href="#stream-processing">Stream Processing</a></h2>
<p>Now that we have analyzed the data interactively, let's convert this to a streaming query that continuously updates as data comes. Since we just have a static set of files, we are going to emulate a stream from them by reading one file at a time, in the chronological order they were created. The query we have to write is pretty much the same as the interactive query above.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.functions._

// Similar to definition of staticInputDF above, just using `readStream` instead of `read`
val streamingInputDF = 
  spark
    .readStream                       // `readStream` instead of `read` for creating streaming DataFrame
    .schema(jsonSchema)               // Set the schema of the JSON data
    .option(&quot;maxFilesPerTrigger&quot;, 1)  // Treat a sequence of files as a stream by picking one file at a time
    .json(inputPath)

// Same query as staticInputDF
val streamingCountsDF = 
  streamingInputDF
    .groupBy($&quot;action&quot;, window($&quot;time&quot;, &quot;1 hour&quot;))
    .count()

// Is this DF actually a streaming DF?
streamingCountsDF.isStreaming
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.functions._
streamingInputDF: org.apache.spark.sql.DataFrame = [time: timestamp, action: string]
streamingCountsDF: org.apache.spark.sql.DataFrame = [action: string, window: struct&lt;start: timestamp, end: timestamp&gt; ... 1 more field]
res9: Boolean = true
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>As you can see, <code>streamingCountsDF</code> is a streaming Dataframe (<code>streamingCountsDF.isStreaming</code> was <code>true</code>). You can start streaming computation, by defining the sink and starting it. In our case, we want to interactively query the counts (same queries as above), so we will set the complete set of 1 hour counts to be a in a in-memory table (note that this for testing purpose only in Spark 2.0).</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">spark.conf.set(&quot;spark.sql.shuffle.partitions&quot;, &quot;1&quot;)  // keep the size of shuffles small

val query =
  streamingCountsDF
    .writeStream
    .format(&quot;memory&quot;)        // memory = store in-memory table (for testing only in Spark 2.0)
    .queryName(&quot;counts&quot;)     // counts = name of the in-memory table
    .outputMode(&quot;complete&quot;)  // complete = all the counts should be in the table
    .start()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>query: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@34d14ed9
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><code>query</code> is a handle to the streaming query that is running in the background. This query is continuously picking up files and updating the windowed counts.</p>
<p>Note the status of query in the above cell. Both the <code>Status: ACTIVE</code> and the progress bar shows that the query is active. Furthermore, if you expand the <code>&gt;Details</code> above, you will find the number of files they have already processed.</p>
<p>Let's wait a bit for a few files to be processed and then query the in-memory <code>counts</code> table.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">Thread.sleep(5000) // wait a bit for computation to start
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sql">select action, date_format(window.end, &quot;MMM-dd HH:mm&quot;) as time, count from counts order by time, action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>time</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Close</td>
<td>Jul-26 03:00</td>
<td>11.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 03:00</td>
<td>179.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 04:00</td>
<td>344.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 04:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 05:00</td>
<td>815.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 05:00</td>
<td>999.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 06:00</td>
<td>1003.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 06:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 07:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 07:00</td>
<td>993.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 08:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 08:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 09:00</td>
<td>985.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 09:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 10:00</td>
<td>983.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 10:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 11:00</td>
<td>1022.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 11:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 12:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 12:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 13:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 13:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 14:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 14:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 15:00</td>
<td>994.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 15:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 16:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 16:00</td>
<td>1020.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 17:00</td>
<td>984.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 18:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 18:00</td>
<td>990.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 19:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 19:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 20:00</td>
<td>967.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 20:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 21:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 21:00</td>
<td>1010.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 22:00</td>
<td>995.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 23:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 23:00</td>
<td>997.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 00:00</td>
<td>950.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 00:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 01:00</td>
<td>1008.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 01:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 02:00</td>
<td>1013.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 02:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 03:00</td>
<td>971.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 03:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 04:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 04:00</td>
<td>1014.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 05:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 05:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 06:00</td>
<td>987.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 06:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 07:00</td>
<td>1026.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 07:00</td>
<td>1016.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 08:00</td>
<td>982.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 08:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 09:00</td>
<td>1024.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 09:00</td>
<td>1002.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 10:00</td>
<td>990.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 10:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 11:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 11:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 12:00</td>
<td>1006.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 12:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 13:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 13:00</td>
<td>994.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 14:00</td>
<td>986.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 14:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 15:00</td>
<td>948.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 15:00</td>
<td>984.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 16:00</td>
<td>1018.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 16:00</td>
<td>1017.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 17:00</td>
<td>970.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 18:00</td>
<td>1020.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 18:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 19:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 19:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 20:00</td>
<td>969.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 20:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 21:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 21:00</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 22:00</td>
<td>979.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 23:00</td>
<td>326.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 23:00</td>
<td>317.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>We see the timeline of windowed counts (similar to the static one ealrier) building up. If we keep running this interactive query repeatedly, we will see the latest updated counts which the streaming query is updating in the background.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">Thread.sleep(5000)  // wait a bit more for more data to be computed
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sql">select action, date_format(window.end, &quot;MMM-dd HH:mm&quot;) as time, count from counts order by time, action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>time</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Close</td>
<td>Jul-26 03:00</td>
<td>11.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 03:00</td>
<td>179.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 04:00</td>
<td>344.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 04:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 05:00</td>
<td>815.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 05:00</td>
<td>999.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 06:00</td>
<td>1003.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 06:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 07:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 07:00</td>
<td>993.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 08:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 08:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 09:00</td>
<td>985.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 09:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 10:00</td>
<td>983.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 10:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 11:00</td>
<td>1022.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 11:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 12:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 12:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 13:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 13:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 14:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 14:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 15:00</td>
<td>994.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 15:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 16:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 16:00</td>
<td>1020.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 17:00</td>
<td>984.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 18:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 18:00</td>
<td>990.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 19:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 19:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 20:00</td>
<td>967.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 20:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 21:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 21:00</td>
<td>1010.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 22:00</td>
<td>995.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 23:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 23:00</td>
<td>997.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 00:00</td>
<td>950.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 00:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 01:00</td>
<td>1008.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 01:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 02:00</td>
<td>1013.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 02:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 03:00</td>
<td>971.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 03:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 04:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 04:00</td>
<td>1014.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 05:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 05:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 06:00</td>
<td>987.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 06:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 07:00</td>
<td>1026.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 07:00</td>
<td>1016.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 08:00</td>
<td>982.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 08:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 09:00</td>
<td>1024.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 09:00</td>
<td>1002.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 10:00</td>
<td>990.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 10:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 11:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 11:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 12:00</td>
<td>1006.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 12:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 13:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 13:00</td>
<td>994.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 14:00</td>
<td>986.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 14:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 15:00</td>
<td>948.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 15:00</td>
<td>984.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 16:00</td>
<td>1018.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 16:00</td>
<td>1017.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 17:00</td>
<td>970.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 18:00</td>
<td>1020.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 18:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 19:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 19:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 20:00</td>
<td>969.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 20:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 21:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 21:00</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 22:00</td>
<td>979.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 23:00</td>
<td>996.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 23:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 00:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 00:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 01:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 01:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 02:00</td>
<td>1010.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 02:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 03:00</td>
<td>1007.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 03:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 04:00</td>
<td>993.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 04:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 05:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 05:00</td>
<td>825.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 06:00</td>
<td>671.0</td>
</tr>
<tr class="even">
<td>Close</td>
<td>Jul-28 07:00</td>
<td>191.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">Thread.sleep(5000)  // wait a bit more for more data to be computed
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sql">select action, date_format(window.end, &quot;MMM-dd HH:mm&quot;) as time, count from counts order by time, action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>time</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Close</td>
<td>Jul-26 03:00</td>
<td>11.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 03:00</td>
<td>179.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 04:00</td>
<td>344.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 04:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 05:00</td>
<td>815.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 05:00</td>
<td>999.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 06:00</td>
<td>1003.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 06:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 07:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 07:00</td>
<td>993.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 08:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 08:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 09:00</td>
<td>985.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 09:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 10:00</td>
<td>983.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 10:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 11:00</td>
<td>1022.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 11:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 12:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 12:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 13:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 13:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 14:00</td>
<td>1028.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 14:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 15:00</td>
<td>994.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 15:00</td>
<td>991.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 16:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 16:00</td>
<td>1020.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 17:00</td>
<td>984.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 18:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 18:00</td>
<td>990.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 19:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 19:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 20:00</td>
<td>967.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 20:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 21:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 21:00</td>
<td>1010.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 22:00</td>
<td>995.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-26 23:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-26 23:00</td>
<td>997.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 00:00</td>
<td>950.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 00:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 01:00</td>
<td>1008.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 01:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 02:00</td>
<td>1013.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 02:00</td>
<td>1004.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 03:00</td>
<td>971.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 03:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 04:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 04:00</td>
<td>1014.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 05:00</td>
<td>989.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 05:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 06:00</td>
<td>987.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 06:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 07:00</td>
<td>1026.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 07:00</td>
<td>1016.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 08:00</td>
<td>982.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 08:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 09:00</td>
<td>1024.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 09:00</td>
<td>1002.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 10:00</td>
<td>990.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 10:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 11:00</td>
<td>1001.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 11:00</td>
<td>1006.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 12:00</td>
<td>1006.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 12:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 13:00</td>
<td>1035.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 13:00</td>
<td>994.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 14:00</td>
<td>986.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 14:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 15:00</td>
<td>948.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 15:00</td>
<td>984.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 16:00</td>
<td>1018.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 16:00</td>
<td>1017.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 17:00</td>
<td>970.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 17:00</td>
<td>992.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 18:00</td>
<td>1020.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 18:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 19:00</td>
<td>1036.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 19:00</td>
<td>995.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 20:00</td>
<td>969.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 20:00</td>
<td>1007.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 21:00</td>
<td>1025.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 21:00</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 22:00</td>
<td>979.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 22:00</td>
<td>998.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-27 23:00</td>
<td>996.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-27 23:00</td>
<td>986.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 00:00</td>
<td>1011.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 00:00</td>
<td>1008.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 01:00</td>
<td>988.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 01:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 02:00</td>
<td>1010.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 02:00</td>
<td>1001.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 03:00</td>
<td>1007.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 03:00</td>
<td>1000.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 04:00</td>
<td>993.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 04:00</td>
<td>996.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 05:00</td>
<td>960.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>Jul-28 05:00</td>
<td>825.0</td>
</tr>
<tr class="odd">
<td>Close</td>
<td>Jul-28 06:00</td>
<td>671.0</td>
</tr>
<tr class="even">
<td>Close</td>
<td>Jul-28 07:00</td>
<td>191.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Also, let's see the total number of &quot;opens&quot; and &quot;closes&quot;.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sql">select action, sum(count) as total_count from counts group by action order by action
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>action</th>
<th>total_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Close</td>
<td>50000.0</td>
</tr>
<tr class="even">
<td>Open</td>
<td>50000.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>If you keep running the above query repeatedly, you will always find that the number of &quot;opens&quot; is more than the number of &quot;closes&quot;, as expected in a data stream where a &quot;close&quot; always appear after corresponding &quot;open&quot;. This shows that Structured Streaming ensures <strong>prefix integrity</strong>. Read the blog posts linked below if you want to know more.</p>
<p>Note that there are only a few files, so consuming all of them there will be no updates to the counts. Rerun the query if you want to interact with the streaming query again.</p>
<p>Finally, you can stop the query running in the background, either by clicking on the 'Cancel' link in the cell of the query, or by executing <code>query.stop()</code>. Either way, when the query is stopped, the status of the corresponding cell above will automatically update to <code>TERMINATED</code>.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="sketching"><a class="header" href="#sketching">Sketching</a></h1>
</div>
<div class="cell markdown">
<ul>
<li>To get an overview of sketching in under 30 minutes see this **Spark-AI 2020 Talk on Apache Sketches by Lee RHodes*:
<ul>
<li>https://databricks.com/session_na20/a-production-quality-sketching-library-for-the-analysis-of-big-data</li>
<li>Watch Video of the Talk Now/Later (29 minutes)
<ul>
<li><a href="https://www.youtube.com/watch?v=WPwCnswDbOU?rel=0&amp;autoplay=1&amp;modestbranding=1"><img src="http://img.youtube.com/vi/WPwCnswDbOU/0.jpg" alt="Spark Transformations by Anthony Joseph in BerkeleyX/CS100.1x" /></a></li>
</ul>
</li>
</ul>
</li>
<li><strong>Other great recent talks:</strong>
<ul>
<li>Yeshwant Vijaykumar of Adobe Inc at Spark+AI Summit 2020:
<ul>
<li><a href="https://databricks.com/session_na20/everyday-probabilistic-data-structures-for-humans">https://databricks.com/session_na20/everyday-probabilistic-data-structures-for-humans</a></li>
</ul>
</li>
<li>Simeon Simeonov of Swoop at Spark+AI Summit 2020:
<ul>
<li><a href="https://databricks.com/session_na20/high-performance-analytics-with-probabilistic-data-structures-the-power-of-hyperloglog">https://databricks.com/session_na20/high-performance-analytics-with-probabilistic-data-structures-the-power-of-hyperloglog</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="cell markdown">
<h2 id="the-challenge-fast-approximate-analysis-of-big-data"><a class="header" href="#the-challenge-fast-approximate-analysis-of-big-data">The Challenge: Fast, Approximate Analysis of Big Data</a></h2>
<ul>
<li><a href="https://datasketches.apache.org/docs/Background/TheChallenge.html">https://datasketches.apache.org/docs/Background/TheChallenge.html</a></li>
</ul>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<div class="output execute_result html_result" execution_count="1">
<iframe 
 src="https://datasketches.apache.org/docs/Background/TheChallenge.html"
 width="95%" height="800"
 sandbox>
  <p>
    <a href="http://spark.apache.org/docs/latest/index.html">
      Fallback link for browsers that, unlikely, don't support frames
    </a>
  </p>
</iframe>
</div>
</div>
<div class="cell markdown">
<h2 id="sketch-origins"><a class="header" href="#sketch-origins">Sketch Origins</a></h2>
<ul>
<li><a href="https://datasketches.apache.org/docs/Background/SketchOrigins.html">https://datasketches.apache.org/docs/Background/SketchOrigins.html</a></li>
</ul>
<p>READ: Philippe Flajolet and Nigel Martin (1985), <em>Probabilistic Counting Algorithms for Data Base Applicaitons</em>, <a href="http://db.cs.berkeley.edu/cs286/papers/flajoletmartin-jcss1985.pdf">http://db.cs.berkeley.edu/cs286/papers/flajoletmartin-jcss1985.pdf</a>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<div class="output execute_result html_result" execution_count="1">
<iframe 
 src="https://datasketches.apache.org/docs/Background/SketchOrigins.html"
 width="95%" height="800"
 sandbox>
  <p>
    <a href="http://spark.apache.org/docs/latest/index.html">
      Fallback link for browsers that, unlikely, don't support frames
    </a>
  </p>
</iframe>
</div>
</div>
<div class="cell markdown">
<h2 id="sketch-elements"><a class="header" href="#sketch-elements">Sketch Elements</a></h2>
<ul>
<li><a href="https://datasketches.apache.org/docs/Background/SketchElements.html">https://datasketches.apache.org/docs/Background/SketchElements.html</a></li>
</ul>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<div class="output execute_result html_result" execution_count="1">
<iframe 
 src="https://datasketches.apache.org/docs/Background/SketchElements.html"
 width="95%" height="800"
 sandbox>
  <p>
    <a href="http://spark.apache.org/docs/latest/index.html">
      Fallback link for browsers that, unlikely, don't support frames
    </a>
  </p>
</iframe>
</div>
</div>
<div class="cell markdown">
<h3 id="apache-sketches"><a class="header" href="#apache-sketches">Apache Sketches</a></h3>
<ul>
<li>
<p>Deep dive into the following three links at <a href="https://datasketches.apache.org/">https://datasketches.apache.org/</a>:</p>
<ul>
<li>Architecture And Design,</li>
<li>Sketch Families and</li>
<li>System Integrations</li>
<li>Community</li>
<li>Research</li>
</ul>
</li>
<li>
<p>Sketcheing in Apache Spark: https://datasketches.apache.org/docs/Theta/ThetaSparkExample.html</p>
</li>
<li>
<p>See docs:</p>
<ul>
<li><a href="https://datasketches.apache.org/docs/Background/Presentations.html">https://datasketches.apache.org/docs/Background/Presentations.html</a></li>
<li></li>
</ul>
</li>
</ul>
<h3 id="some-general-recent-talksblogs-on-various-sketches"><a class="header" href="#some-general-recent-talksblogs-on-various-sketches">Some general recent talks/blogs on various sketches:</a></h3>
<ul>
<li>https://databricks.com/session_na20/high-performance-analytics-with-probabilistic-data-structures-the-power-of-hyperloglog</li>
<li>https://databricks.com/blog/2016/05/19/approximate-algorithms-in-apache-spark-hyperloglog-and-quantiles.html
<ul>
<li>the above has a databricks notebook you can try to self-study</li>
</ul>
</li>
<li></li>
</ul>
<p>We will next focus on a specific sketch called <strong>T-Digest</strong> for approximating extreme quantiles: - https://databricks.com/session/one-pass-data-science-in-apache-spark-with-generative-t-digests - https://databricks.com/session/sketching-data-with-t-digest-in-apache-spark</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// this is a companion notebook that generates a bivariate gaussian mixture file stream

import scala.util.Random
import scala.util.Random._

// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  Thread.sleep(5L) // sleep 5 milliseconds
  val now = (new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;)).format(new java.util.Date())
  return (now,sample)
   }
   
 dbutils.fs.rm(&quot;/datasets/streamingFiles/&quot;,true) // this is to delete the directory before staring a job
 
val r = new Random(12345L)
var a = 0;
// for loop execution to write files to distributed fs
for( a &lt;- 1 to 20){
  val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).coalesce(1).toDF.as[(String,Double)]
  val minute = (new java.text.SimpleDateFormat(&quot;mm&quot;)).format(new java.util.Date())
  val second = (new java.text.SimpleDateFormat(&quot;ss&quot;)).format(new java.util.Date())
  data.write.mode(SaveMode.Overwrite).csv(&quot;/datasets/streamingFiles/&quot; + minute +&quot;_&quot; + second + &quot;.csv&quot;)
  Thread.sleep(5000L) // sleep 5 seconds
}
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-fs">rm -r /datasets/streamingFiles
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res3: Boolean = true
</code></pre>
</div>
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="sketching-with-t-digest-for-quantiles"><a class="header" href="#sketching-with-t-digest-for-quantiles">Sketching with T-digest for quantiles</a></h1>
<h2 id="a-toy-anomaly-detector"><a class="header" href="#a-toy-anomaly-detector">A Toy Anomaly Detector</a></h2>
<p>Fisher noticed the fundamental computational difference between mean, covariance, etc. and median, quantiles, in early 1900s.</p>
<p>The former ones are today called recursively computable statistics. When you take the memory footprint needed to keep these statistics updated then we get into the world of probabilistic datastructures...</p>
<p>The basic idea of sketching is formally conveyed in Chapter 6 of <a href="https://www.cs.cornell.edu/jeh/book.pdf">Foundations of data Science</a>.</p>
<p>Let's get a more informal view form the following sources.</p>
</div>
<div class="cell markdown">
<p>Here we focus on a specific sketch called <strong>T-Digest</strong> for approximating extreme quantiles:</p>
<p><strong>Pointers:</strong></p>
<ul>
<li>READ White Paper: <a href="https://arxiv.org/pdf/1902.04023.pdf">https://arxiv.org/pdf/1902.04023.pdf</a></li>
<li>WATCH Spark/AI/Data Summit Talks:
<ul>
<li><a href="https://databricks.com/session/sketching-data-with-t-digest-in-apache-spark">https://databricks.com/session/sketching-data-with-t-digest-in-apache-spark</a></li>
<li><a href="https://databricks.com/session/one-pass-data-science-in-apache-spark-with-generative-t-digests">https://databricks.com/session/one-pass-data-science-in-apache-spark-with-generative-t-digests</a></li>
</ul>
</li>
<li>GLANCE Blogs:
<ul>
<li><a href="https://medium.com/@muppal/probabilistic-data-structures-in-the-big-data-world-code-b9387cff0c55">https://medium.com/@muppal/probabilistic-data-structures-in-the-big-data-world-code-b9387cff0c55</a></li>
<li><a href="https://medium.com/@mani./t-digest-an-interesting-datastructure-to-estimate-quantiles-accurately-b99a50eaf4f7">https://medium.com/@mani./t-digest-an-interesting-datastructure-to-estimate-quantiles-accurately-b99a50eaf4f7</a></li>
</ul>
</li>
</ul>
<p><strong>NOTE:</strong></p>
<ul>
<li>Once you could see Ted Dunning's explanation of t-digest here:
<ul>
<li>https://www.youtube.com/watch?v=B0dMc0t7K1g</li>
<li>But, unfortunately, since 2020 this video has become a private property with this warning: <em>Private video Sign in if you've been granted access to this video</em></li>
</ul>
</li>
</ul>
</div>
<div class="cell markdown">
<h1 id="demonstration-of-t-digest-to-detect-anomalous-scores"><a class="header" href="#demonstration-of-t-digest-to-detect-anomalous-scores">Demonstration of t-digest to detect anomalous scores</a></h1>
</div>
<div class="cell markdown">
<p>Let us import the following scala implementation of t-digest:</p>
<ul>
<li>for Spark 3.0.1 use maven coordinates: <code>org.isarnproject:isarn-sketches-spark_2.12:0.5.0-sp3.0</code></li>
</ul>
<p>See the library: <a href="https://github.com/isarn/isarn-sketches-spark">https://github.com/isarn/isarn-sketches-spark</a></p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.isarnproject.sketches.java.TDigest
import org.isarnproject.sketches.spark.tdigest._
import scala.util.Random
import scala.util.Random._
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.isarnproject.sketches.java.TDigest
import org.isarnproject.sketches.spark.tdigest._
import scala.util.Random
import scala.util.Random._
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : Double = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  return sample
   }
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>myMixtureOf2Normals: (normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: scala.util.Random)Double
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Here is a quick overview of the simple mixture of two Normal or Gaussian random variables we will be simulating from.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val r = new Random(1L)
println(myMixtureOf2Normals(1.0, 10.0, 0.99, r), myMixtureOf2Normals(1.0, 10.0, 0.99, r))
// should always produce (0.5876430182311466,-0.34037937678788865) when seed = 1L
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>(0.5876430182311466,-0.34037937678788865)
r: scala.util.Random = scala.util.Random@2ac6c652
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val r = new Random(12345L)
val data = sc.parallelize(Vector.fill(10000){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).toDF.as[Double]
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>r: scala.util.Random = scala.util.Random@568f8382
data: org.apache.spark.sql.Dataset[Double] = [value: double]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">data.show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+--------------------+
|               value|
+--------------------+
|  0.2576188264990721|
|-0.13149698512045327|
|  1.4139063973267458|
|-0.02383387596851...|
|  0.7274784426774964|
+--------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(data)
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.2576188264990721</td>
</tr>
<tr class="even">
<td>-0.13149698512045327</td>
</tr>
<tr class="odd">
<td>1.4139063973267458</td>
</tr>
<tr class="even">
<td>-2.3833875968513496e-2</td>
</tr>
<tr class="odd">
<td>0.7274784426774964</td>
</tr>
<tr class="even">
<td>-1.0658630481235276</td>
</tr>
<tr class="odd">
<td>0.746959841932221</td>
</tr>
<tr class="even">
<td>0.30477096247050206</td>
</tr>
<tr class="odd">
<td>-6.407620682061621e-2</td>
</tr>
<tr class="even">
<td>1.8464307210258604</td>
</tr>
<tr class="odd">
<td>2.0786529531264355</td>
</tr>
<tr class="even">
<td>0.685838993990332</td>
</tr>
<tr class="odd">
<td>2.3056211153362485</td>
</tr>
<tr class="even">
<td>-0.7435548094085835</td>
</tr>
<tr class="odd">
<td>-0.36946067155650786</td>
</tr>
<tr class="even">
<td>1.1178132434092503</td>
</tr>
<tr class="odd">
<td>1.0672400098827672</td>
</tr>
<tr class="even">
<td>2.403799182291664</td>
</tr>
<tr class="odd">
<td>2.7905949803662926</td>
</tr>
<tr class="even">
<td>2.3901047303648846</td>
</tr>
<tr class="odd">
<td>2.2391322699010967</td>
</tr>
<tr class="even">
<td>0.7102559487906945</td>
</tr>
<tr class="odd">
<td>-0.1875570296359037</td>
</tr>
<tr class="even">
<td>2.0036998039560725</td>
</tr>
<tr class="odd">
<td>2.028162246705019</td>
</tr>
<tr class="even">
<td>-1.1084782237141253</td>
</tr>
<tr class="odd">
<td>2.7320985336302965</td>
</tr>
<tr class="even">
<td>1.7953021498619885</td>
</tr>
<tr class="odd">
<td>1.3332433299615185</td>
</tr>
<tr class="even">
<td>1.2842120504662247</td>
</tr>
<tr class="odd">
<td>2.0013530061962186</td>
</tr>
<tr class="even">
<td>1.2596569236824775</td>
</tr>
<tr class="odd">
<td>2.46479668588018</td>
</tr>
<tr class="even">
<td>-0.7015927727061835</td>
</tr>
<tr class="odd">
<td>-0.510611131534981</td>
</tr>
<tr class="even">
<td>0.9403812557496112</td>
</tr>
<tr class="odd">
<td>2.2306482205877427</td>
</tr>
<tr class="even">
<td>-0.29781070820511246</td>
</tr>
<tr class="odd">
<td>4.107241990001628</td>
</tr>
<tr class="even">
<td>0.7420568724108764</td>
</tr>
<tr class="odd">
<td>1.4652231673746594</td>
</tr>
<tr class="even">
<td>0.8793849318247119</td>
</tr>
<tr class="odd">
<td>1.7671614106752898</td>
</tr>
<tr class="even">
<td>1.1995772213743607</td>
</tr>
<tr class="odd">
<td>1.1351566745099897</td>
</tr>
<tr class="even">
<td>0.16150528245701323</td>
</tr>
<tr class="odd">
<td>2.459849452657596</td>
</tr>
<tr class="even">
<td>1.0796739450956971</td>
</tr>
<tr class="odd">
<td>-1.2079899446434252</td>
</tr>
<tr class="even">
<td>0.7019279468450133</td>
</tr>
<tr class="odd">
<td>-2.5906759976580096e-2</td>
</tr>
<tr class="even">
<td>1.025799236502406</td>
</tr>
<tr class="odd">
<td>2.423754193708396</td>
</tr>
<tr class="even">
<td>1.0100073192180106</td>
</tr>
<tr class="odd">
<td>1.2308412912433588</td>
</tr>
<tr class="even">
<td>2.2142939785873326</td>
</tr>
<tr class="odd">
<td>9.639219241219372</td>
</tr>
<tr class="even">
<td>0.8964067897832677</td>
</tr>
<tr class="odd">
<td>2.583753664296168</td>
</tr>
<tr class="even">
<td>1.7326439212827238</td>
</tr>
<tr class="odd">
<td>0.7516388863094139</td>
</tr>
<tr class="even">
<td>0.8725633940449549</td>
</tr>
<tr class="odd">
<td>-0.9407676766254014</td>
</tr>
<tr class="even">
<td>1.0542712925875175</td>
</tr>
<tr class="odd">
<td>0.794535189312687</td>
</tr>
<tr class="even">
<td>0.5813794557982226</td>
</tr>
<tr class="odd">
<td>0.4891368786472011</td>
</tr>
<tr class="even">
<td>2.3296394918008474</td>
</tr>
<tr class="odd">
<td>1.425296303524094</td>
</tr>
<tr class="even">
<td>1.9276679925454094</td>
</tr>
<tr class="odd">
<td>0.6178050147872097</td>
</tr>
<tr class="even">
<td>1.135269636375052</td>
</tr>
<tr class="odd">
<td>1.3074367248762568</td>
</tr>
<tr class="even">
<td>0.6105659268751382</td>
</tr>
<tr class="odd">
<td>1.7812955395572572</td>
</tr>
<tr class="even">
<td>-1.3547368916771827</td>
</tr>
<tr class="odd">
<td>1.580412775615275</td>
</tr>
<tr class="even">
<td>1.5731144914401023</td>
</tr>
<tr class="odd">
<td>-5.725067553082108e-2</td>
</tr>
<tr class="even">
<td>0.19580347035995105</td>
</tr>
<tr class="odd">
<td>-2.1501122555202867e-2</td>
</tr>
<tr class="even">
<td>1.5783579658949254</td>
</tr>
<tr class="odd">
<td>1.371796305513024</td>
</tr>
<tr class="even">
<td>0.648919899258448</td>
</tr>
<tr class="odd">
<td>-0.7875773550339058</td>
</tr>
<tr class="even">
<td>1.3233945353130716</td>
</tr>
<tr class="odd">
<td>2.5685224032022127</td>
</tr>
<tr class="even">
<td>2.7331317575905807</td>
</tr>
<tr class="odd">
<td>0.2521381731074053</td>
</tr>
<tr class="even">
<td>2.2408918489807905</td>
</tr>
<tr class="odd">
<td>1.4924862197354933</td>
</tr>
<tr class="even">
<td>1.194657083531184</td>
</tr>
<tr class="odd">
<td>0.7067352811215412</td>
</tr>
<tr class="even">
<td>2.7701718519244745e-2</td>
</tr>
<tr class="odd">
<td>0.279797547315617</td>
</tr>
<tr class="even">
<td>-0.21953266770586133</td>
</tr>
<tr class="odd">
<td>1.1402931320647434</td>
</tr>
<tr class="even">
<td>0.904724947360263</td>
</tr>
<tr class="odd">
<td>0.6677145203694429</td>
</tr>
<tr class="even">
<td>2.019977647420342</td>
</tr>
<tr class="odd">
<td>-0.5190278662580565</td>
</tr>
<tr class="even">
<td>1.2549405940975034</td>
</tr>
<tr class="odd">
<td>2.4267606721380233</td>
</tr>
<tr class="even">
<td>0.21858105660909444</td>
</tr>
<tr class="odd">
<td>1.7701229392924476</td>
</tr>
<tr class="even">
<td>8.326770280505069e-2</td>
</tr>
<tr class="odd">
<td>11.539205812425335</td>
</tr>
<tr class="even">
<td>0.612370126029857</td>
</tr>
<tr class="odd">
<td>1.299073306785623</td>
</tr>
<tr class="even">
<td>2.6939073650678083</td>
</tr>
<tr class="odd">
<td>2.5320627406973344</td>
</tr>
<tr class="even">
<td>2.781337457744293e-2</td>
</tr>
<tr class="odd">
<td>0.3272489908510584</td>
</tr>
<tr class="even">
<td>-0.9427386544836929</td>
</tr>
<tr class="odd">
<td>0.9364640268126377</td>
</tr>
<tr class="even">
<td>1.919225736153371</td>
</tr>
<tr class="odd">
<td>0.38826998132506296</td>
</tr>
<tr class="even">
<td>-0.38655650387475715</td>
</tr>
<tr class="odd">
<td>1.0433731216978939</td>
</tr>
<tr class="even">
<td>1.1500718903613745</td>
</tr>
<tr class="odd">
<td>-0.3661280681150447</td>
</tr>
<tr class="even">
<td>0.883444064705467</td>
</tr>
<tr class="odd">
<td>-0.9126173899348853</td>
</tr>
<tr class="even">
<td>0.3838114564837034</td>
</tr>
<tr class="odd">
<td>0.7935189081504388</td>
</tr>
<tr class="even">
<td>1.928137393349846</td>
</tr>
<tr class="odd">
<td>4.7092811957255676e-2</td>
</tr>
<tr class="even">
<td>0.4684849965794433</td>
</tr>
<tr class="odd">
<td>0.6745536358089256</td>
</tr>
<tr class="even">
<td>2.100439331925503</td>
</tr>
<tr class="odd">
<td>1.0053957395581328</td>
</tr>
<tr class="even">
<td>1.1651633690031988</td>
</tr>
<tr class="odd">
<td>1.1620631665685186</td>
</tr>
<tr class="even">
<td>0.5686294459758102</td>
</tr>
<tr class="odd">
<td>5.4695916815372114e-2</td>
</tr>
<tr class="even">
<td>0.3673527645506809</td>
</tr>
<tr class="odd">
<td>1.1825682382920246</td>
</tr>
<tr class="even">
<td>2.590900208851957</td>
</tr>
<tr class="odd">
<td>0.9580677196122074</td>
</tr>
<tr class="even">
<td>0.14058634902492095</td>
</tr>
<tr class="odd">
<td>1.835715236145623</td>
</tr>
<tr class="even">
<td>1.0262133311924941</td>
</tr>
<tr class="odd">
<td>2.3956360313411276</td>
</tr>
<tr class="even">
<td>-0.42622276533874537</td>
</tr>
<tr class="odd">
<td>1.532866051791267</td>
</tr>
<tr class="even">
<td>0.33837135147986275</td>
</tr>
<tr class="odd">
<td>0.5993221970260502</td>
</tr>
<tr class="even">
<td>0.5268259369536397</td>
</tr>
<tr class="odd">
<td>0.9338448405595184</td>
</tr>
<tr class="even">
<td>1.5020324977316601</td>
</tr>
<tr class="odd">
<td>-0.21633343524824378</td>
</tr>
<tr class="even">
<td>0.8387080531274844</td>
</tr>
<tr class="odd">
<td>1.3278878139665884e-2</td>
</tr>
<tr class="even">
<td>1.3291762275434373</td>
</tr>
<tr class="odd">
<td>0.4837833343304839</td>
</tr>
<tr class="even">
<td>0.4918446444728072</td>
</tr>
<tr class="odd">
<td>1.354678573169704</td>
</tr>
<tr class="even">
<td>0.2524216007924791</td>
</tr>
<tr class="odd">
<td>0.5965026762340784</td>
</tr>
<tr class="even">
<td>2.000850130836448</td>
</tr>
<tr class="odd">
<td>2.217169275505519</td>
</tr>
<tr class="even">
<td>0.6876140376775531</td>
</tr>
<tr class="odd">
<td>1.0508210912529563</td>
</tr>
<tr class="even">
<td>1.65676102704454</td>
</tr>
<tr class="odd">
<td>2.155047641017994</td>
</tr>
<tr class="even">
<td>1.0866488363653375</td>
</tr>
<tr class="odd">
<td>1.0691398773308363</td>
</tr>
<tr class="even">
<td>0.6120836384011098</td>
</tr>
<tr class="odd">
<td>0.24914099314834415</td>
</tr>
<tr class="even">
<td>2.8691481936548744</td>
</tr>
<tr class="odd">
<td>0.7633561289177443</td>
</tr>
<tr class="even">
<td>1.4483835248568062</td>
</tr>
<tr class="odd">
<td>2.6108825545691863</td>
</tr>
<tr class="even">
<td>1.2751533422561458</td>
</tr>
<tr class="odd">
<td>1.0131179898567302</td>
</tr>
<tr class="even">
<td>0.46308679994249036</td>
</tr>
<tr class="odd">
<td>0.7793261962344651</td>
</tr>
<tr class="even">
<td>1.1671037114122738</td>
</tr>
<tr class="odd">
<td>2.143874895015684</td>
</tr>
<tr class="even">
<td>1.2344250301306705</td>
</tr>
<tr class="odd">
<td>1.7402355361851662</td>
</tr>
<tr class="even">
<td>1.0396911219696297</td>
</tr>
<tr class="odd">
<td>1.8089030277370215</td>
</tr>
<tr class="even">
<td>2.1235708326267533</td>
</tr>
<tr class="odd">
<td>-0.33938888075466234</td>
</tr>
<tr class="even">
<td>1.090463095441436</td>
</tr>
<tr class="odd">
<td>1.3101016219338661</td>
</tr>
<tr class="even">
<td>-0.6251493773996968</td>
</tr>
<tr class="odd">
<td>1.7223308331307168</td>
</tr>
<tr class="even">
<td>1.0299845635585438</td>
</tr>
<tr class="odd">
<td>1.962846046162154</td>
</tr>
<tr class="even">
<td>-1.8537289273720337e-2</td>
</tr>
<tr class="odd">
<td>0.7977254725466605</td>
</tr>
<tr class="even">
<td>-0.21427479370557312</td>
</tr>
<tr class="odd">
<td>-1.6661289018266037</td>
</tr>
<tr class="even">
<td>1.144457447997468</td>
</tr>
<tr class="odd">
<td>0.6503516296653954</td>
</tr>
<tr class="even">
<td>6.581335919503728e-2</td>
</tr>
<tr class="odd">
<td>1.5478749815243467</td>
</tr>
<tr class="even">
<td>1.5497411627601851</td>
</tr>
<tr class="odd">
<td>0.21791376679544772</td>
</tr>
<tr class="even">
<td>1.1291967445604012e-2</td>
</tr>
<tr class="odd">
<td>-0.30293144696154806</td>
</tr>
<tr class="even">
<td>0.4303254534802833</td>
</tr>
<tr class="odd">
<td>1.5521304466388752</td>
</tr>
<tr class="even">
<td>2.2910302464408394</td>
</tr>
<tr class="odd">
<td>0.4374695472538803</td>
</tr>
<tr class="even">
<td>0.4085186427342812</td>
</tr>
<tr class="odd">
<td>-6.531316403553289e-2</td>
</tr>
<tr class="even">
<td>6.39812257122474e-3</td>
</tr>
<tr class="odd">
<td>0.24840501087934996</td>
</tr>
<tr class="even">
<td>-1.021974709142702</td>
</tr>
<tr class="odd">
<td>-9.233941622902653e-2</td>
</tr>
<tr class="even">
<td>0.41027379764960337</td>
</tr>
<tr class="odd">
<td>1.864567223228712</td>
</tr>
<tr class="even">
<td>1.5393474896194466</td>
</tr>
<tr class="odd">
<td>1.124907339909468</td>
</tr>
<tr class="even">
<td>2.0206475875654997</td>
</tr>
<tr class="odd">
<td>-0.7058862229186389</td>
</tr>
<tr class="even">
<td>1.2344926787652002</td>
</tr>
<tr class="odd">
<td>1.1406194673922239</td>
</tr>
<tr class="even">
<td>1.4084552620839659</td>
</tr>
<tr class="odd">
<td>0.739931161380885</td>
</tr>
<tr class="even">
<td>0.29958396894640427</td>
</tr>
<tr class="odd">
<td>-0.9379262816791101</td>
</tr>
<tr class="even">
<td>0.8259556704405835</td>
</tr>
<tr class="odd">
<td>-0.3199802616466474</td>
</tr>
<tr class="even">
<td>1.9656420693625898</td>
</tr>
<tr class="odd">
<td>0.8789984776053141</td>
</tr>
<tr class="even">
<td>2.4965042040211793</td>
</tr>
<tr class="odd">
<td>1.714778861431627</td>
</tr>
<tr class="even">
<td>0.8669641143187272</td>
</tr>
<tr class="odd">
<td>1.0757413525008879</td>
</tr>
<tr class="even">
<td>1.9658378382249264e-2</td>
</tr>
<tr class="odd">
<td>0.7165095911306543</td>
</tr>
<tr class="even">
<td>1.2251547673860115</td>
</tr>
<tr class="odd">
<td>1.5869187313570912</td>
</tr>
<tr class="even">
<td>0.3928727449886338</td>
</tr>
<tr class="odd">
<td>1.7722759642539445</td>
</tr>
<tr class="even">
<td>1.0350331272239843</td>
</tr>
<tr class="odd">
<td>-1.4234008750858624</td>
</tr>
<tr class="even">
<td>0.6054572828043063</td>
</tr>
<tr class="odd">
<td>0.3024585268617903</td>
</tr>
<tr class="even">
<td>2.9432999768948087e-2</td>
</tr>
<tr class="odd">
<td>0.9382472473173075</td>
</tr>
<tr class="even">
<td>2.11287419383702</td>
</tr>
<tr class="odd">
<td>1.0876022969280528</td>
</tr>
<tr class="even">
<td>0.36548993902899596</td>
</tr>
<tr class="odd">
<td>-2.005053653271253</td>
</tr>
<tr class="even">
<td>2.0367928918435894</td>
</tr>
<tr class="odd">
<td>9.261254419611942e-2</td>
</tr>
<tr class="even">
<td>2.156248406806113</td>
</tr>
<tr class="odd">
<td>-0.5295405173638772</td>
</tr>
<tr class="even">
<td>2.452318995994742</td>
</tr>
<tr class="odd">
<td>0.8636413385915132</td>
</tr>
<tr class="even">
<td>0.31460938814139794</td>
</tr>
<tr class="odd">
<td>-2.0257131370059023e-2</td>
</tr>
<tr class="even">
<td>1.3213739526626505</td>
</tr>
<tr class="odd">
<td>0.9463001869917488</td>
</tr>
<tr class="even">
<td>0.986171393681171</td>
</tr>
<tr class="odd">
<td>0.12492672949874628</td>
</tr>
<tr class="even">
<td>0.9908400692267174</td>
</tr>
<tr class="odd">
<td>1.0695623856543282</td>
</tr>
<tr class="even">
<td>1.0221220766637027</td>
</tr>
<tr class="odd">
<td>2.8492797946693904</td>
</tr>
<tr class="even">
<td>1.0609742751901396</td>
</tr>
<tr class="odd">
<td>1.6409490831011158</td>
</tr>
<tr class="even">
<td>1.5427085071446491</td>
</tr>
<tr class="odd">
<td>1.7312859942989034</td>
</tr>
<tr class="even">
<td>1.2947069326850533</td>
</tr>
<tr class="odd">
<td>0.3756138591369289</td>
</tr>
<tr class="even">
<td>1.4349084022701803</td>
</tr>
<tr class="odd">
<td>0.37649651121290106</td>
</tr>
<tr class="even">
<td>0.7071860096564935</td>
</tr>
<tr class="odd">
<td>1.5065536846394356</td>
</tr>
<tr class="even">
<td>0.15009861698305105</td>
</tr>
<tr class="odd">
<td>3.5084734586888766e-2</td>
</tr>
<tr class="even">
<td>1.9474563946729155</td>
</tr>
<tr class="odd">
<td>9.423175513609095</td>
</tr>
<tr class="even">
<td>2.4871634825039015</td>
</tr>
<tr class="odd">
<td>2.8472676324820685</td>
</tr>
<tr class="even">
<td>1.5999488876250578</td>
</tr>
<tr class="odd">
<td>-0.2693864675719999</td>
</tr>
<tr class="even">
<td>1.6304414331783441</td>
</tr>
<tr class="odd">
<td>0.39324529792831353</td>
</tr>
<tr class="even">
<td>0.4053253263569069</td>
</tr>
<tr class="odd">
<td>0.9270234970247857</td>
</tr>
<tr class="even">
<td>1.4509585503273819</td>
</tr>
<tr class="odd">
<td>0.8878267401905819</td>
</tr>
<tr class="even">
<td>1.1883024549090635</td>
</tr>
<tr class="odd">
<td>1.0163155722641077</td>
</tr>
<tr class="even">
<td>-0.8003099498427713</td>
</tr>
<tr class="odd">
<td>-0.9483216075980454</td>
</tr>
<tr class="even">
<td>1.0437451610964232</td>
</tr>
<tr class="odd">
<td>2.19837214407137</td>
</tr>
<tr class="even">
<td>2.070797890483533</td>
</tr>
<tr class="odd">
<td>1.2067096088561005</td>
</tr>
<tr class="even">
<td>0.5043809533024068</td>
</tr>
<tr class="odd">
<td>0.3683130512293926</td>
</tr>
<tr class="even">
<td>1.0968506619209946</td>
</tr>
<tr class="odd">
<td>-0.6602896123630477</td>
</tr>
<tr class="even">
<td>6.829641971377687e-2</td>
</tr>
<tr class="odd">
<td>1.5578597945995134</td>
</tr>
<tr class="even">
<td>0.9822629073468155</td>
</tr>
<tr class="odd">
<td>-0.7900771590527182</td>
</tr>
<tr class="even">
<td>1.1194124344742182</td>
</tr>
<tr class="odd">
<td>1.1239015052468448</td>
</tr>
<tr class="even">
<td>1.9447892371838207</td>
</tr>
<tr class="odd">
<td>2.0854603958592985</td>
</tr>
<tr class="even">
<td>0.17341117815802976</td>
</tr>
<tr class="odd">
<td>1.5971150699056031</td>
</tr>
<tr class="even">
<td>0.35646629992342993</td>
</tr>
<tr class="odd">
<td>1.8107324499508701</td>
</tr>
<tr class="even">
<td>3.463539114641669</td>
</tr>
<tr class="odd">
<td>0.8683263379823365</td>
</tr>
<tr class="even">
<td>1.2642821462325637</td>
</tr>
<tr class="odd">
<td>1.0099560176390794</td>
</tr>
<tr class="even">
<td>1.1930381560126895</td>
</tr>
<tr class="odd">
<td>0.5433757598192581</td>
</tr>
<tr class="even">
<td>1.0213782743479625</td>
</tr>
<tr class="odd">
<td>1.5049231054950472</td>
</tr>
<tr class="even">
<td>0.22101559200796428</td>
</tr>
<tr class="odd">
<td>1.8743753391414122</td>
</tr>
<tr class="even">
<td>0.6050230742039573</td>
</tr>
<tr class="odd">
<td>0.6939669876285336</td>
</tr>
<tr class="even">
<td>1.5379566524515602</td>
</tr>
<tr class="odd">
<td>-0.6869579758877387</td>
</tr>
<tr class="even">
<td>-0.4823865565169676</td>
</tr>
<tr class="odd">
<td>2.577388594447341</td>
</tr>
<tr class="even">
<td>0.9323745950234809</td>
</tr>
<tr class="odd">
<td>-0.25032440836547454</td>
</tr>
<tr class="even">
<td>1.1141701800611599</td>
</tr>
<tr class="odd">
<td>1.1577408343996396</td>
</tr>
<tr class="even">
<td>0.4735089125920344</td>
</tr>
<tr class="odd">
<td>-1.5559289264558278</td>
</tr>
<tr class="even">
<td>-0.11080485473390023</td>
</tr>
<tr class="odd">
<td>0.1536430200356127</td>
</tr>
<tr class="even">
<td>1.2851073161790278</td>
</tr>
<tr class="odd">
<td>-0.9717966387140513</td>
</tr>
<tr class="even">
<td>0.4604981927819666</td>
</tr>
<tr class="odd">
<td>0.4825924627571432</td>
</tr>
<tr class="even">
<td>1.8907687599342153</td>
</tr>
<tr class="odd">
<td>1.5027092114554406</td>
</tr>
<tr class="even">
<td>0.4892227077808574</td>
</tr>
<tr class="odd">
<td>2.2742380779964306</td>
</tr>
<tr class="even">
<td>5.93203161994782e-3</td>
</tr>
<tr class="odd">
<td>0.9357077683018076</td>
</tr>
<tr class="even">
<td>1.6452901327178684</td>
</tr>
<tr class="odd">
<td>2.5989481778450294</td>
</tr>
<tr class="even">
<td>3.1233030636814103</td>
</tr>
<tr class="odd">
<td>2.14412876458466</td>
</tr>
<tr class="even">
<td>0.8645332371791754</td>
</tr>
<tr class="odd">
<td>1.7396751361758789</td>
</tr>
<tr class="even">
<td>3.406726808728102</td>
</tr>
<tr class="odd">
<td>0.27592904706426413</td>
</tr>
<tr class="even">
<td>-0.47288172874607715</td>
</tr>
<tr class="odd">
<td>3.1581200247451022</td>
</tr>
<tr class="even">
<td>2.3502844371874003</td>
</tr>
<tr class="odd">
<td>2.3604518998272104</td>
</tr>
<tr class="even">
<td>2.875582435906723</td>
</tr>
<tr class="odd">
<td>1.802101533727158</td>
</tr>
<tr class="even">
<td>2.158082491464444</td>
</tr>
<tr class="odd">
<td>-0.5284223682158626</td>
</tr>
<tr class="even">
<td>1.929919317533868e-2</td>
</tr>
<tr class="odd">
<td>1.948485504832782</td>
</tr>
<tr class="even">
<td>0.49379467644006303</td>
</tr>
<tr class="odd">
<td>0.33811694243690293</td>
</tr>
<tr class="even">
<td>1.332171769010618</td>
</tr>
<tr class="odd">
<td>0.6994701270153069</td>
</tr>
<tr class="even">
<td>-0.413721820026016</td>
</tr>
<tr class="odd">
<td>-1.5522089380783108</td>
</tr>
<tr class="even">
<td>2.161396170492705</td>
</tr>
<tr class="odd">
<td>2.333496950423164e-2</td>
</tr>
<tr class="even">
<td>-0.10913840839170796</td>
</tr>
<tr class="odd">
<td>1.1299228472291496</td>
</tr>
<tr class="even">
<td>2.4274358384176584</td>
</tr>
<tr class="odd">
<td>1.9359707345891741</td>
</tr>
<tr class="even">
<td>3.487722218477596</td>
</tr>
<tr class="odd">
<td>0.9990127159196325</td>
</tr>
<tr class="even">
<td>-1.0398429191328207</td>
</tr>
<tr class="odd">
<td>0.3005833334887211</td>
</tr>
<tr class="even">
<td>-0.7334628100431295</td>
</tr>
<tr class="odd">
<td>0.4835865602253189</td>
</tr>
<tr class="even">
<td>0.5246945471836175</td>
</tr>
<tr class="odd">
<td>0.8469783573593253</td>
</tr>
<tr class="even">
<td>0.8359162587262456</td>
</tr>
<tr class="odd">
<td>0.7772016511976113</td>
</tr>
<tr class="even">
<td>-0.39849883029666944</td>
</tr>
<tr class="odd">
<td>1.8703097604547239</td>
</tr>
<tr class="even">
<td>2.682932324516024</td>
</tr>
<tr class="odd">
<td>0.46996888720103236</td>
</tr>
<tr class="even">
<td>-7.881388366585762e-2</td>
</tr>
<tr class="odd">
<td>2.1043645061434084</td>
</tr>
<tr class="even">
<td>0.6195230903468327</td>
</tr>
<tr class="odd">
<td>-0.23170755440676594</td>
</tr>
<tr class="even">
<td>0.3918168388047796</td>
</tr>
<tr class="odd">
<td>0.22086080450987344</td>
</tr>
<tr class="even">
<td>1.5182059037248368</td>
</tr>
<tr class="odd">
<td>1.6442851975073318</td>
</tr>
<tr class="even">
<td>0.3979663516003099</td>
</tr>
<tr class="odd">
<td>2.0531657985840983</td>
</tr>
<tr class="even">
<td>1.7928797637680196</td>
</tr>
<tr class="odd">
<td>2.9329556976986013</td>
</tr>
<tr class="even">
<td>1.1087520027663345</td>
</tr>
<tr class="odd">
<td>1.2115868818351045</td>
</tr>
<tr class="even">
<td>1.9163661519192294</td>
</tr>
<tr class="odd">
<td>1.6917128257752045</td>
</tr>
<tr class="even">
<td>1.0095879056962782</td>
</tr>
<tr class="odd">
<td>-0.13611276130309613</td>
</tr>
<tr class="even">
<td>2.2939319088848023</td>
</tr>
<tr class="odd">
<td>1.0723690693732042</td>
</tr>
<tr class="even">
<td>2.1452154961792393</td>
</tr>
<tr class="odd">
<td>0.7259078662420231</td>
</tr>
<tr class="even">
<td>2.6599123456452727</td>
</tr>
<tr class="odd">
<td>0.2519779820647646</td>
</tr>
<tr class="even">
<td>2.1670014817546175</td>
</tr>
<tr class="odd">
<td>0.10506784220981513</td>
</tr>
<tr class="even">
<td>2.018185302480656</td>
</tr>
<tr class="odd">
<td>1.1665983169452525</td>
</tr>
<tr class="even">
<td>0.33284879429952463</td>
</tr>
<tr class="odd">
<td>0.3531339079979545</td>
</tr>
<tr class="even">
<td>2.1004784012229245</td>
</tr>
<tr class="odd">
<td>1.282680965361929</td>
</tr>
<tr class="even">
<td>1.2270715852857979</td>
</tr>
<tr class="odd">
<td>0.858598096986649</td>
</tr>
<tr class="even">
<td>2.5040344133072407</td>
</tr>
<tr class="odd">
<td>1.6541952933075013</td>
</tr>
<tr class="even">
<td>0.5329588210461834</td>
</tr>
<tr class="odd">
<td>2.1274892552565134</td>
</tr>
<tr class="even">
<td>1.4668875035709574</td>
</tr>
<tr class="odd">
<td>1.5382758818248594</td>
</tr>
<tr class="even">
<td>1.7428172106530586</td>
</tr>
<tr class="odd">
<td>1.4727771685178368</td>
</tr>
<tr class="even">
<td>1.6023481462981235</td>
</tr>
<tr class="odd">
<td>1.6577898477375492</td>
</tr>
<tr class="even">
<td>5.892056976555449e-2</td>
</tr>
<tr class="odd">
<td>2.7754262543475523</td>
</tr>
<tr class="even">
<td>1.2200523142327606</td>
</tr>
<tr class="odd">
<td>1.5903756890326521</td>
</tr>
<tr class="even">
<td>-1.49547625208842</td>
</tr>
<tr class="odd">
<td>0.8523817097750093</td>
</tr>
<tr class="even">
<td>0.5057853403549346</td>
</tr>
<tr class="odd">
<td>0.5683629007876065</td>
</tr>
<tr class="even">
<td>1.6479513379049497</td>
</tr>
<tr class="odd">
<td>1.2148679515188867</td>
</tr>
<tr class="even">
<td>0.6222019509815193</td>
</tr>
<tr class="odd">
<td>1.3255067306263184</td>
</tr>
<tr class="even">
<td>0.4983375954130155</td>
</tr>
<tr class="odd">
<td>-8.802709440091383e-2</td>
</tr>
<tr class="even">
<td>0.13831985322805507</td>
</tr>
<tr class="odd">
<td>-0.5487242466777436</td>
</tr>
<tr class="even">
<td>-0.32058114510029334</td>
</tr>
<tr class="odd">
<td>1.8950590840214767</td>
</tr>
<tr class="even">
<td>1.0062190610750874</td>
</tr>
<tr class="odd">
<td>-0.9934439161367286</td>
</tr>
<tr class="even">
<td>0.3671557383587293</td>
</tr>
<tr class="odd">
<td>0.19986189782147756</td>
</tr>
<tr class="even">
<td>-0.49653972053539497</td>
</tr>
<tr class="odd">
<td>0.6848255848767759</td>
</tr>
<tr class="even">
<td>1.5219606199148406</td>
</tr>
<tr class="odd">
<td>1.455086538348867</td>
</tr>
<tr class="even">
<td>2.883109155648917</td>
</tr>
<tr class="odd">
<td>1.8164694435868296</td>
</tr>
<tr class="even">
<td>0.6742710281863775</td>
</tr>
<tr class="odd">
<td>0.5441958963393487</td>
</tr>
<tr class="even">
<td>1.0517397813571259</td>
</tr>
<tr class="odd">
<td>0.8356831003190489</td>
</tr>
<tr class="even">
<td>0.8227690076487093</td>
</tr>
<tr class="odd">
<td>1.4570119880481842</td>
</tr>
<tr class="even">
<td>-0.297581775651637</td>
</tr>
<tr class="odd">
<td>-7.206180041345078e-2</td>
</tr>
<tr class="even">
<td>-0.8739444049086391</td>
</tr>
<tr class="odd">
<td>2.2604530979343074</td>
</tr>
<tr class="even">
<td>2.3872947344763027</td>
</tr>
<tr class="odd">
<td>3.3685772895980124</td>
</tr>
<tr class="even">
<td>2.013534739447639</td>
</tr>
<tr class="odd">
<td>3.368251328412311</td>
</tr>
<tr class="even">
<td>0.8953451648220483</td>
</tr>
<tr class="odd">
<td>9.545874578601765e-2</td>
</tr>
<tr class="even">
<td>0.7718477167244377</td>
</tr>
<tr class="odd">
<td>1.0629106168204554</td>
</tr>
<tr class="even">
<td>0.5518190802821734</td>
</tr>
<tr class="odd">
<td>2.9939679918505853</td>
</tr>
<tr class="even">
<td>1.8726021041818661</td>
</tr>
<tr class="odd">
<td>0.2653885457840085</td>
</tr>
<tr class="even">
<td>1.9872672471653996</td>
</tr>
<tr class="odd">
<td>-0.553166557898946</td>
</tr>
<tr class="even">
<td>1.5640591286122745</td>
</tr>
<tr class="odd">
<td>2.52680639118602</td>
</tr>
<tr class="even">
<td>1.80742439492357</td>
</tr>
<tr class="odd">
<td>2.1955997975781347</td>
</tr>
<tr class="even">
<td>0.5980285235875027</td>
</tr>
<tr class="odd">
<td>-0.2658797956060317</td>
</tr>
<tr class="even">
<td>-0.49719135472382137</td>
</tr>
<tr class="odd">
<td>1.180607461695498</td>
</tr>
<tr class="even">
<td>-0.10430878902480734</td>
</tr>
<tr class="odd">
<td>0.823892717854915</td>
</tr>
<tr class="even">
<td>1.666382974377688</td>
</tr>
<tr class="odd">
<td>3.748395965408928</td>
</tr>
<tr class="even">
<td>1.7921581120532326e-2</td>
</tr>
<tr class="odd">
<td>0.7499355222636435</td>
</tr>
<tr class="even">
<td>2.3386705969751205</td>
</tr>
<tr class="odd">
<td>0.4946954139770775</td>
</tr>
<tr class="even">
<td>2.7985296324540565</td>
</tr>
<tr class="odd">
<td>1.5356765186629966</td>
</tr>
<tr class="even">
<td>-0.33706316690289584</td>
</tr>
<tr class="odd">
<td>-1.0348117718002703e-2</td>
</tr>
<tr class="even">
<td>1.8281804903673144</td>
</tr>
<tr class="odd">
<td>0.3172404416132534</td>
</tr>
<tr class="even">
<td>0.5893972598101371</td>
</tr>
<tr class="odd">
<td>1.5326653373112777</td>
</tr>
<tr class="even">
<td>0.8539589801933155</td>
</tr>
<tr class="odd">
<td>2.092892033666929</td>
</tr>
<tr class="even">
<td>0.6296940385798598</td>
</tr>
<tr class="odd">
<td>8.99959554980265</td>
</tr>
<tr class="even">
<td>1.3401791716063445</td>
</tr>
<tr class="odd">
<td>0.1625728478606363</td>
</tr>
<tr class="even">
<td>1.1023716302273685</td>
</tr>
<tr class="odd">
<td>1.3244294511594552</td>
</tr>
<tr class="even">
<td>1.9717106308848458</td>
</tr>
<tr class="odd">
<td>2.0935027130112918</td>
</tr>
<tr class="even">
<td>0.5540124632067691</td>
</tr>
<tr class="odd">
<td>2.8390489237342758</td>
</tr>
<tr class="even">
<td>1.2584888592967522</td>
</tr>
<tr class="odd">
<td>0.8378223664277132</td>
</tr>
<tr class="even">
<td>-3.705953427792741e-2</td>
</tr>
<tr class="odd">
<td>-1.125595126556278e-2</td>
</tr>
<tr class="even">
<td>1.8829278782190024</td>
</tr>
<tr class="odd">
<td>2.0192085492627894</td>
</tr>
<tr class="even">
<td>1.9386320044059204</td>
</tr>
<tr class="odd">
<td>1.651530725699678</td>
</tr>
<tr class="even">
<td>0.8017983775095935</td>
</tr>
<tr class="odd">
<td>-3.514905095054344e-2</td>
</tr>
<tr class="even">
<td>0.8155367784375459</td>
</tr>
<tr class="odd">
<td>-0.5552596097915619</td>
</tr>
<tr class="even">
<td>1.8705605094803621</td>
</tr>
<tr class="odd">
<td>10.174199861232976</td>
</tr>
<tr class="even">
<td>1.4536718681041976</td>
</tr>
<tr class="odd">
<td>2.1062700105302996</td>
</tr>
<tr class="even">
<td>0.475922933272229</td>
</tr>
<tr class="odd">
<td>1.0817390501017392</td>
</tr>
<tr class="even">
<td>2.2796321965842496</td>
</tr>
<tr class="odd">
<td>0.23323897979804842</td>
</tr>
<tr class="even">
<td>1.0183686887164103</td>
</tr>
<tr class="odd">
<td>-0.7554454183477253</td>
</tr>
<tr class="even">
<td>1.3019096488805835</td>
</tr>
<tr class="odd">
<td>0.3374802783657267</td>
</tr>
<tr class="even">
<td>-0.5146418960525585</td>
</tr>
<tr class="odd">
<td>-6.048075364364469e-2</td>
</tr>
<tr class="even">
<td>-5.967451256405276e-2</td>
</tr>
<tr class="odd">
<td>1.233114706332717</td>
</tr>
<tr class="even">
<td>1.7406224225514757</td>
</tr>
<tr class="odd">
<td>0.5238094364159517</td>
</tr>
<tr class="even">
<td>-4.455639893554597e-2</td>
</tr>
<tr class="odd">
<td>0.6178805181179535</td>
</tr>
<tr class="even">
<td>-0.8510251471391128</td>
</tr>
<tr class="odd">
<td>1.308052246786863</td>
</tr>
<tr class="even">
<td>0.3268079413606899</td>
</tr>
<tr class="odd">
<td>-1.3025175142774486</td>
</tr>
<tr class="even">
<td>0.5320039005955481</td>
</tr>
<tr class="odd">
<td>0.12387407754502777</td>
</tr>
<tr class="even">
<td>2.6101947374495293</td>
</tr>
<tr class="odd">
<td>1.5224492462759098</td>
</tr>
<tr class="even">
<td>1.236244816444764</td>
</tr>
<tr class="odd">
<td>1.4954016347946228</td>
</tr>
<tr class="even">
<td>0.5281503216531209</td>
</tr>
<tr class="odd">
<td>0.8463329768741992</td>
</tr>
<tr class="even">
<td>1.1634091418265289</td>
</tr>
<tr class="odd">
<td>1.7554480003839843</td>
</tr>
<tr class="even">
<td>1.8947204310797423</td>
</tr>
<tr class="odd">
<td>0.7506627891160538</td>
</tr>
<tr class="even">
<td>-0.22423697078143956</td>
</tr>
<tr class="odd">
<td>0.927732550621745</td>
</tr>
<tr class="even">
<td>2.784360564469151</td>
</tr>
<tr class="odd">
<td>3.542787218532106</td>
</tr>
<tr class="even">
<td>0.432227325280209</td>
</tr>
<tr class="odd">
<td>-0.9685039345572555</td>
</tr>
<tr class="even">
<td>1.610702352432787</td>
</tr>
<tr class="odd">
<td>0.25225428913555614</td>
</tr>
<tr class="even">
<td>0.6318605835098334</td>
</tr>
<tr class="odd">
<td>0.24784246074544614</td>
</tr>
<tr class="even">
<td>1.3125827737308564</td>
</tr>
<tr class="odd">
<td>1.76027763070149</td>
</tr>
<tr class="even">
<td>1.604542790844651</td>
</tr>
<tr class="odd">
<td>0.9391947816971199</td>
</tr>
<tr class="even">
<td>2.0113202394281036</td>
</tr>
<tr class="odd">
<td>0.6833889165055331</td>
</tr>
<tr class="even">
<td>0.7828049531781445</td>
</tr>
<tr class="odd">
<td>1.525206927196617</td>
</tr>
<tr class="even">
<td>0.4555978800663196</td>
</tr>
<tr class="odd">
<td>2.158504891725925</td>
</tr>
<tr class="even">
<td>0.5497336163750275</td>
</tr>
<tr class="odd">
<td>1.108152719515001</td>
</tr>
<tr class="even">
<td>2.229598024152815</td>
</tr>
<tr class="odd">
<td>-0.30715895940514804</td>
</tr>
<tr class="even">
<td>-0.4963457195725012</td>
</tr>
<tr class="odd">
<td>0.6317891104976874</td>
</tr>
<tr class="even">
<td>0.9404446092196193</td>
</tr>
<tr class="odd">
<td>0.5824240745249956</td>
</tr>
<tr class="even">
<td>0.9522827784866549</td>
</tr>
<tr class="odd">
<td>0.5747278460881767</td>
</tr>
<tr class="even">
<td>2.3228717276929878</td>
</tr>
<tr class="odd">
<td>-0.12232857339482872</td>
</tr>
<tr class="even">
<td>10.442627838980057</td>
</tr>
<tr class="odd">
<td>-0.9613909203767632</td>
</tr>
<tr class="even">
<td>2.360115785393865</td>
</tr>
<tr class="odd">
<td>10.460772141286911</td>
</tr>
<tr class="even">
<td>-0.15127677602688205</td>
</tr>
<tr class="odd">
<td>-0.7430747891693794</td>
</tr>
<tr class="even">
<td>1.1166522423684635</td>
</tr>
<tr class="odd">
<td>0.9764807692690883</td>
</tr>
<tr class="even">
<td>1.0545546293851562</td>
</tr>
<tr class="odd">
<td>1.4217770365949636</td>
</tr>
<tr class="even">
<td>0.8472372480230154</td>
</tr>
<tr class="odd">
<td>1.9293695381886482</td>
</tr>
<tr class="even">
<td>1.224477650092793</td>
</tr>
<tr class="odd">
<td>-0.576902390274286</td>
</tr>
<tr class="even">
<td>1.327683339856686</td>
</tr>
<tr class="odd">
<td>2.3294636041468753</td>
</tr>
<tr class="even">
<td>1.0508125817809573</td>
</tr>
<tr class="odd">
<td>0.6893104376174488</td>
</tr>
<tr class="even">
<td>0.25055576676244107</td>
</tr>
<tr class="odd">
<td>0.9140712539798914</td>
</tr>
<tr class="even">
<td>1.9321126051060917</td>
</tr>
<tr class="odd">
<td>0.26607474319516033</td>
</tr>
<tr class="even">
<td>1.5039430223830939</td>
</tr>
<tr class="odd">
<td>2.4155724118245736e-2</td>
</tr>
<tr class="even">
<td>2.9529975781223285</td>
</tr>
<tr class="odd">
<td>2.525931295222416</td>
</tr>
<tr class="even">
<td>3.0184656376604537</td>
</tr>
<tr class="odd">
<td>1.3686271300712956</td>
</tr>
<tr class="even">
<td>0.4798723250356388</td>
</tr>
<tr class="odd">
<td>-1.008710689163618</td>
</tr>
<tr class="even">
<td>1.5701794389127253</td>
</tr>
<tr class="odd">
<td>0.19978829057056857</td>
</tr>
<tr class="even">
<td>0.9240761354395062</td>
</tr>
<tr class="odd">
<td>0.19521466746159932</td>
</tr>
<tr class="even">
<td>1.2744043502827374</td>
</tr>
<tr class="odd">
<td>-0.5431195983133648</td>
</tr>
<tr class="even">
<td>0.1974591476352352</td>
</tr>
<tr class="odd">
<td>0.7430949008871768</td>
</tr>
<tr class="even">
<td>0.8988725739330019</td>
</tr>
<tr class="odd">
<td>1.6597416237841465</td>
</tr>
<tr class="even">
<td>1.7417674159020793</td>
</tr>
<tr class="odd">
<td>2.4088293700031693</td>
</tr>
<tr class="even">
<td>1.143581580663996</td>
</tr>
<tr class="odd">
<td>1.4082585153064164</td>
</tr>
<tr class="even">
<td>0.47069873985209143</td>
</tr>
<tr class="odd">
<td>-1.1580364942293953</td>
</tr>
<tr class="even">
<td>1.0732710931019263</td>
</tr>
<tr class="odd">
<td>1.5509982425379119</td>
</tr>
<tr class="even">
<td>1.7677585939234246</td>
</tr>
<tr class="odd">
<td>-1.1941141421872046</td>
</tr>
<tr class="even">
<td>0.21105300062231513</td>
</tr>
<tr class="odd">
<td>0.6529477393919702</td>
</tr>
<tr class="even">
<td>-0.34988928270936226</td>
</tr>
<tr class="odd">
<td>0.5444265493743319</td>
</tr>
<tr class="even">
<td>2.251577733100331</td>
</tr>
<tr class="odd">
<td>0.16913394323406872</td>
</tr>
<tr class="even">
<td>11.260505056159252</td>
</tr>
<tr class="odd">
<td>0.7864958296725808</td>
</tr>
<tr class="even">
<td>1.091593382604825</td>
</tr>
<tr class="odd">
<td>0.7471169918052949</td>
</tr>
<tr class="even">
<td>0.36078054843777674</td>
</tr>
<tr class="odd">
<td>1.4284182466312578</td>
</tr>
<tr class="even">
<td>0.3641673471149427</td>
</tr>
<tr class="odd">
<td>-1.0360349861808262</td>
</tr>
<tr class="even">
<td>0.38230293118496894</td>
</tr>
<tr class="odd">
<td>1.8786902260733145</td>
</tr>
<tr class="even">
<td>-0.7366326071049587</td>
</tr>
<tr class="odd">
<td>2.0194567072200393</td>
</tr>
<tr class="even">
<td>0.5111298609273971</td>
</tr>
<tr class="odd">
<td>1.947809368661851</td>
</tr>
<tr class="even">
<td>2.628034116556221</td>
</tr>
<tr class="odd">
<td>0.10041127309972464</td>
</tr>
<tr class="even">
<td>-0.9914516842653798</td>
</tr>
<tr class="odd">
<td>0.42604512187698185</td>
</tr>
<tr class="even">
<td>0.8384351974667634</td>
</tr>
<tr class="odd">
<td>0.9068232484596871</td>
</tr>
<tr class="even">
<td>0.5738655218292824</td>
</tr>
<tr class="odd">
<td>1.9264618723701152</td>
</tr>
<tr class="even">
<td>1.5761237325879685</td>
</tr>
<tr class="odd">
<td>1.626292107129501</td>
</tr>
<tr class="even">
<td>2.0849065606469557</td>
</tr>
<tr class="odd">
<td>-0.11343769134229165</td>
</tr>
<tr class="even">
<td>0.1025048999056456</td>
</tr>
<tr class="odd">
<td>1.053052626678512</td>
</tr>
<tr class="even">
<td>-0.24007907992011845</td>
</tr>
<tr class="odd">
<td>0.1382201206040784</td>
</tr>
<tr class="even">
<td>1.8910416626489552</td>
</tr>
<tr class="odd">
<td>2.8345096657368556</td>
</tr>
<tr class="even">
<td>2.583170811237836</td>
</tr>
<tr class="odd">
<td>-0.3893702721041865</td>
</tr>
<tr class="even">
<td>1.3520108244803342</td>
</tr>
<tr class="odd">
<td>-0.12593338576537327</td>
</tr>
<tr class="even">
<td>-0.9808107291023687</td>
</tr>
<tr class="odd">
<td>1.4015364735733753</td>
</tr>
<tr class="even">
<td>1.695547239092475</td>
</tr>
<tr class="odd">
<td>1.3489569585825598</td>
</tr>
<tr class="even">
<td>0.8360821611908951</td>
</tr>
<tr class="odd">
<td>0.33683162328320115</td>
</tr>
<tr class="even">
<td>-1.260138655228694</td>
</tr>
<tr class="odd">
<td>1.6662817407344905</td>
</tr>
<tr class="even">
<td>2.273339646058636</td>
</tr>
<tr class="odd">
<td>2.1408145302279262</td>
</tr>
<tr class="even">
<td>1.1532315762716479</td>
</tr>
<tr class="odd">
<td>0.792000410181182</td>
</tr>
<tr class="even">
<td>2.617286787875776</td>
</tr>
<tr class="odd">
<td>0.1827575511422984</td>
</tr>
<tr class="even">
<td>-0.9059473522304451</td>
</tr>
<tr class="odd">
<td>-0.31032406628601605</td>
</tr>
<tr class="even">
<td>1.487891710861818</td>
</tr>
<tr class="odd">
<td>-0.19990519218780256</td>
</tr>
<tr class="even">
<td>1.5228011808161672</td>
</tr>
<tr class="odd">
<td>1.091160988784999</td>
</tr>
<tr class="even">
<td>-0.5446290704848642</td>
</tr>
<tr class="odd">
<td>0.5171720764854166</td>
</tr>
<tr class="even">
<td>1.3467504967289186</td>
</tr>
<tr class="odd">
<td>0.5028941713981121</td>
</tr>
<tr class="even">
<td>1.6926426850928427</td>
</tr>
<tr class="odd">
<td>2.737520065317047</td>
</tr>
<tr class="even">
<td>-0.6337974959768131</td>
</tr>
<tr class="odd">
<td>1.8334664621031571</td>
</tr>
<tr class="even">
<td>1.1752071580242511</td>
</tr>
<tr class="odd">
<td>1.7663153320810179</td>
</tr>
<tr class="even">
<td>-3.287929610234186e-2</td>
</tr>
<tr class="odd">
<td>0.9776991082096643</td>
</tr>
<tr class="even">
<td>0.7572719681136401</td>
</tr>
<tr class="odd">
<td>2.0252498233787533</td>
</tr>
<tr class="even">
<td>2.0549863976236282</td>
</tr>
<tr class="odd">
<td>0.28876880002288263</td>
</tr>
<tr class="even">
<td>0.7795217487076926</td>
</tr>
<tr class="odd">
<td>0.5157176523746317</td>
</tr>
<tr class="even">
<td>1.2531709070474009</td>
</tr>
<tr class="odd">
<td>2.814127875620211</td>
</tr>
<tr class="even">
<td>1.1251332829763616</td>
</tr>
<tr class="odd">
<td>-0.8742006368438211</td>
</tr>
<tr class="even">
<td>3.525681357968375</td>
</tr>
<tr class="odd">
<td>-0.6125196383989251</td>
</tr>
<tr class="even">
<td>-1.028539893085076</td>
</tr>
<tr class="odd">
<td>1.944129606903108</td>
</tr>
<tr class="even">
<td>0.4230304057405415</td>
</tr>
<tr class="odd">
<td>0.6337892280346704</td>
</tr>
<tr class="even">
<td>-0.6826244579330205</td>
</tr>
<tr class="odd">
<td>0.4137789790932437</td>
</tr>
<tr class="even">
<td>2.133348714505998</td>
</tr>
<tr class="odd">
<td>1.6093325024482905</td>
</tr>
<tr class="even">
<td>0.1403062548964249</td>
</tr>
<tr class="odd">
<td>0.9977662561095119</td>
</tr>
<tr class="even">
<td>1.6154705922157153</td>
</tr>
<tr class="odd">
<td>1.5325103216966767</td>
</tr>
<tr class="even">
<td>1.6480988802470689</td>
</tr>
<tr class="odd">
<td>1.5457471122768636</td>
</tr>
<tr class="even">
<td>0.9278397921261037</td>
</tr>
<tr class="odd">
<td>0.5346075472347933</td>
</tr>
<tr class="even">
<td>-0.3366100838774142</td>
</tr>
<tr class="odd">
<td>1.544130227285287</td>
</tr>
<tr class="even">
<td>0.36057447512773</td>
</tr>
<tr class="odd">
<td>3.1190339889208265</td>
</tr>
<tr class="even">
<td>0.5642439359943654</td>
</tr>
<tr class="odd">
<td>3.6032355486391277e-2</td>
</tr>
<tr class="even">
<td>1.217657470850345</td>
</tr>
<tr class="odd">
<td>1.3708372094771342</td>
</tr>
<tr class="even">
<td>1.6204088991501409</td>
</tr>
<tr class="odd">
<td>1.8068635367597905</td>
</tr>
<tr class="even">
<td>0.6836982699156782</td>
</tr>
<tr class="odd">
<td>2.416660438805482</td>
</tr>
<tr class="even">
<td>1.435090083978466</td>
</tr>
<tr class="odd">
<td>-0.6957004139189842</td>
</tr>
<tr class="even">
<td>2.796032650243188</td>
</tr>
<tr class="odd">
<td>1.263889553950158</td>
</tr>
<tr class="even">
<td>-0.24234558620465552</td>
</tr>
<tr class="odd">
<td>0.4126133154078948</td>
</tr>
<tr class="even">
<td>0.48194295180327873</td>
</tr>
<tr class="odd">
<td>-4.239311593641104e-2</td>
</tr>
<tr class="even">
<td>2.131857833197308</td>
</tr>
<tr class="odd">
<td>-0.15570995063363013</td>
</tr>
<tr class="even">
<td>0.7854482141700682</td>
</tr>
<tr class="odd">
<td>1.8430551242641047</td>
</tr>
<tr class="even">
<td>-0.30696087051905785</td>
</tr>
<tr class="odd">
<td>1.0556256557163515</td>
</tr>
<tr class="even">
<td>0.6908168936931991</td>
</tr>
<tr class="odd">
<td>0.8953437823585769</td>
</tr>
<tr class="even">
<td>1.3572533765348747</td>
</tr>
<tr class="odd">
<td>0.11398684036386209</td>
</tr>
<tr class="even">
<td>1.6619698080507603</td>
</tr>
<tr class="odd">
<td>1.665250946590736</td>
</tr>
<tr class="even">
<td>0.8975920127377776</td>
</tr>
<tr class="odd">
<td>2.2911345789955044</td>
</tr>
<tr class="even">
<td>0.9992259266914368</td>
</tr>
<tr class="odd">
<td>-0.4298332988614957</td>
</tr>
<tr class="even">
<td>2.856688086679865</td>
</tr>
<tr class="odd">
<td>9.905282503779972</td>
</tr>
<tr class="even">
<td>0.4160546198968119</td>
</tr>
<tr class="odd">
<td>1.3074428261508197</td>
</tr>
<tr class="even">
<td>0.12330796113292308</td>
</tr>
<tr class="odd">
<td>-8.208866462136077e-2</td>
</tr>
<tr class="even">
<td>0.43041154874660903</td>
</tr>
<tr class="odd">
<td>-0.26805738332282525</td>
</tr>
<tr class="even">
<td>0.24248755197881344</td>
</tr>
<tr class="odd">
<td>0.4672444655763044</td>
</tr>
<tr class="even">
<td>0.7429087035211764</td>
</tr>
<tr class="odd">
<td>1.4882911024620438</td>
</tr>
<tr class="even">
<td>2.444968952436855</td>
</tr>
<tr class="odd">
<td>-0.8041993598535895</td>
</tr>
<tr class="even">
<td>1.208622081250596</td>
</tr>
<tr class="odd">
<td>8.898983802592564e-2</td>
</tr>
<tr class="even">
<td>1.8374497912460765</td>
</tr>
<tr class="odd">
<td>2.770255925243865</td>
</tr>
<tr class="even">
<td>-0.8251005403922271</td>
</tr>
<tr class="odd">
<td>-0.31615303993603194</td>
</tr>
<tr class="even">
<td>-6.680911706266524e-2</td>
</tr>
<tr class="odd">
<td>-0.5060055961402281</td>
</tr>
<tr class="even">
<td>-0.10993772270902569</td>
</tr>
<tr class="odd">
<td>-1.7858062514118545</td>
</tr>
<tr class="even">
<td>0.38124537958478155</td>
</tr>
<tr class="odd">
<td>3.343016296304274</td>
</tr>
<tr class="even">
<td>3.200888498150916</td>
</tr>
<tr class="odd">
<td>1.6539706630340567</td>
</tr>
<tr class="even">
<td>1.0358929561627934</td>
</tr>
<tr class="odd">
<td>0.7349519148503848</td>
</tr>
<tr class="even">
<td>-0.5558335228136968</td>
</tr>
<tr class="odd">
<td>0.8033111443298455</td>
</tr>
<tr class="even">
<td>1.0199590698825889</td>
</tr>
<tr class="odd">
<td>1.3413895470645456</td>
</tr>
<tr class="even">
<td>1.7812455522573842</td>
</tr>
<tr class="odd">
<td>0.5566880617934874</td>
</tr>
<tr class="even">
<td>2.3484161679464695</td>
</tr>
<tr class="odd">
<td>1.1721286969240714</td>
</tr>
<tr class="even">
<td>1.985537497377007</td>
</tr>
<tr class="odd">
<td>0.5028248990186489</td>
</tr>
<tr class="even">
<td>1.126187102927933</td>
</tr>
<tr class="odd">
<td>1.098065463397298</td>
</tr>
<tr class="even">
<td>1.0022339510207767</td>
</tr>
<tr class="odd">
<td>0.6524600640259166</td>
</tr>
<tr class="even">
<td>0.9129989416782233</td>
</tr>
<tr class="odd">
<td>-4.072646036731209e-2</td>
</tr>
<tr class="even">
<td>-0.4997127716196892</td>
</tr>
<tr class="odd">
<td>3.427010275934218</td>
</tr>
<tr class="even">
<td>-1.0592305386912666</td>
</tr>
<tr class="odd">
<td>0.2158285556706534</td>
</tr>
<tr class="even">
<td>0.514825837851193</td>
</tr>
<tr class="odd">
<td>1.8458680276815647</td>
</tr>
<tr class="even">
<td>0.6489366461843191</td>
</tr>
<tr class="odd">
<td>1.4264428618420764</td>
</tr>
<tr class="even">
<td>1.8853463069064655</td>
</tr>
<tr class="odd">
<td>0.9353141249181827</td>
</tr>
<tr class="even">
<td>-0.768007390555169</td>
</tr>
<tr class="odd">
<td>-0.2825922690641738</td>
</tr>
<tr class="even">
<td>-0.11644476731169018</td>
</tr>
<tr class="odd">
<td>1.5527313352517889</td>
</tr>
<tr class="even">
<td>1.361096472043486</td>
</tr>
<tr class="odd">
<td>1.595550522072551</td>
</tr>
<tr class="even">
<td>0.7928138591830576</td>
</tr>
<tr class="odd">
<td>2.4014413844006057</td>
</tr>
<tr class="even">
<td>0.9357181425237647</td>
</tr>
<tr class="odd">
<td>1.0321537115844546</td>
</tr>
<tr class="even">
<td>1.017467185134316</td>
</tr>
<tr class="odd">
<td>0.7544499732365095</td>
</tr>
<tr class="even">
<td>3.2914090464924084</td>
</tr>
<tr class="odd">
<td>-0.30115720611734975</td>
</tr>
<tr class="even">
<td>1.1053894805207805</td>
</tr>
<tr class="odd">
<td>0.24699783640458162</td>
</tr>
<tr class="even">
<td>-0.5754508908317295</td>
</tr>
<tr class="odd">
<td>-0.7653405793793806</td>
</tr>
<tr class="even">
<td>2.551152606418246</td>
</tr>
<tr class="odd">
<td>2.002335507569091</td>
</tr>
<tr class="even">
<td>2.873768745568216</td>
</tr>
<tr class="odd">
<td>2.4779420958282303</td>
</tr>
<tr class="even">
<td>0.9919751607449626</td>
</tr>
<tr class="odd">
<td>0.26553883660973165</td>
</tr>
<tr class="even">
<td>1.5810534545434005</td>
</tr>
<tr class="odd">
<td>0.4363020620988478</td>
</tr>
<tr class="even">
<td>0.4208482016324523</td>
</tr>
<tr class="odd">
<td>1.801337254210524</td>
</tr>
<tr class="even">
<td>0.7282927824660008</td>
</tr>
<tr class="odd">
<td>2.370482819434382</td>
</tr>
<tr class="even">
<td>2.2689908454614955</td>
</tr>
<tr class="odd">
<td>1.8992484787681332</td>
</tr>
<tr class="even">
<td>1.1345675892485614</td>
</tr>
<tr class="odd">
<td>0.6800326573416028</td>
</tr>
<tr class="even">
<td>0.8256537442772758</td>
</tr>
<tr class="odd">
<td>0.8771603935244864</td>
</tr>
<tr class="even">
<td>-1.0434719594542736</td>
</tr>
<tr class="odd">
<td>0.8516519961407986</td>
</tr>
<tr class="even">
<td>2.185092193636852</td>
</tr>
<tr class="odd">
<td>0.20653003088418287</td>
</tr>
<tr class="even">
<td>1.0609626373137258</td>
</tr>
<tr class="odd">
<td>1.6312654872266645</td>
</tr>
<tr class="even">
<td>-0.10993816750885665</td>
</tr>
<tr class="odd">
<td>2.511242528714717</td>
</tr>
<tr class="even">
<td>0.44520543525892353</td>
</tr>
<tr class="odd">
<td>1.3189873412126392</td>
</tr>
<tr class="even">
<td>1.4382931017594118</td>
</tr>
<tr class="odd">
<td>1.2450171964918337</td>
</tr>
<tr class="even">
<td>0.1075552521924854</td>
</tr>
<tr class="odd">
<td>1.640701165992256</td>
</tr>
<tr class="even">
<td>1.5615637324174714</td>
</tr>
<tr class="odd">
<td>0.8670086589057957</td>
</tr>
<tr class="even">
<td>-0.5321458051266028</td>
</tr>
<tr class="odd">
<td>-3.0490144428005905e-3</td>
</tr>
<tr class="even">
<td>1.155437571970963</td>
</tr>
<tr class="odd">
<td>2.0317104875172864</td>
</tr>
<tr class="even">
<td>0.10380445370650004</td>
</tr>
<tr class="odd">
<td>1.5267461286865376</td>
</tr>
<tr class="even">
<td>9.102639076417908</td>
</tr>
<tr class="odd">
<td>0.11175944316229147</td>
</tr>
<tr class="even">
<td>2.605816329847464</td>
</tr>
<tr class="odd">
<td>-0.31757356268646797</td>
</tr>
<tr class="even">
<td>1.938296237870294</td>
</tr>
<tr class="odd">
<td>2.623630455719459</td>
</tr>
<tr class="even">
<td>-0.17930511974208407</td>
</tr>
<tr class="odd">
<td>0.22653773264797206</td>
</tr>
<tr class="even">
<td>0.7738024281145457</td>
</tr>
<tr class="odd">
<td>0.8303926211791302</td>
</tr>
<tr class="even">
<td>3.8144763777667077</td>
</tr>
<tr class="odd">
<td>0.2892406024466241</td>
</tr>
<tr class="even">
<td>0.279787632770216</td>
</tr>
<tr class="odd">
<td>1.9176201484359812</td>
</tr>
<tr class="even">
<td>2.508246019756138</td>
</tr>
<tr class="odd">
<td>1.4202553258576178</td>
</tr>
<tr class="even">
<td>0.8725425712951034</td>
</tr>
<tr class="odd">
<td>2.590931954493854</td>
</tr>
<tr class="even">
<td>-0.6083285430052974</td>
</tr>
<tr class="odd">
<td>0.3155829148992413</td>
</tr>
<tr class="even">
<td>0.9716424879068793</td>
</tr>
<tr class="odd">
<td>-1.933633148749392e-2</td>
</tr>
<tr class="even">
<td>0.416940875088748</td>
</tr>
<tr class="odd">
<td>0.9075871303206937</td>
</tr>
<tr class="even">
<td>-0.18322964916243012</td>
</tr>
<tr class="odd">
<td>0.49834578143129415</td>
</tr>
<tr class="even">
<td>1.1523265845585398</td>
</tr>
<tr class="odd">
<td>0.16862160117832925</td>
</tr>
<tr class="even">
<td>0.22112613360304012</td>
</tr>
<tr class="odd">
<td>0.8542929631268784</td>
</tr>
<tr class="even">
<td>2.1065267442021933</td>
</tr>
<tr class="odd">
<td>8.716744674485033e-2</td>
</tr>
<tr class="even">
<td>1.8741906276937679</td>
</tr>
<tr class="odd">
<td>-0.8800017423117874</td>
</tr>
<tr class="even">
<td>0.985677419800145</td>
</tr>
<tr class="odd">
<td>1.7814889560835554</td>
</tr>
<tr class="even">
<td>2.110674163627958</td>
</tr>
<tr class="odd">
<td>0.6068631467692929</td>
</tr>
<tr class="even">
<td>2.010892494531559</td>
</tr>
<tr class="odd">
<td>0.182773938051226</td>
</tr>
<tr class="even">
<td>0.9818670611842848</td>
</tr>
<tr class="odd">
<td>1.5106418585391912</td>
</tr>
<tr class="even">
<td>0.27457120930224954</td>
</tr>
<tr class="odd">
<td>3.131668044566185</td>
</tr>
<tr class="even">
<td>1.426032519824096</td>
</tr>
<tr class="odd">
<td>2.756853957923013</td>
</tr>
<tr class="even">
<td>-8.337312101971261e-2</td>
</tr>
<tr class="odd">
<td>-1.2512930084219307</td>
</tr>
<tr class="even">
<td>1.994731189314644</td>
</tr>
<tr class="odd">
<td>1.5010954171753113</td>
</tr>
<tr class="even">
<td>1.6160885909571072</td>
</tr>
<tr class="odd">
<td>0.997576086981748</td>
</tr>
<tr class="even">
<td>2.290454085433865</td>
</tr>
<tr class="odd">
<td>1.5282322334484473</td>
</tr>
<tr class="even">
<td>0.9423457650293142</td>
</tr>
<tr class="odd">
<td>-0.6929312351526271</td>
</tr>
<tr class="even">
<td>1.2117261668663954</td>
</tr>
<tr class="odd">
<td>1.04304142983433</td>
</tr>
<tr class="even">
<td>9.191415024846095e-2</td>
</tr>
<tr class="odd">
<td>-0.1856239446441006</td>
</tr>
<tr class="even">
<td>1.6459370551496064</td>
</tr>
<tr class="odd">
<td>1.5887750906532614</td>
</tr>
<tr class="even">
<td>0.5153567867710697</td>
</tr>
<tr class="odd">
<td>-0.5317451085692393</td>
</tr>
<tr class="even">
<td>1.2883518590500194</td>
</tr>
<tr class="odd">
<td>-0.7231095994748975</td>
</tr>
<tr class="even">
<td>0.14806012859804774</td>
</tr>
<tr class="odd">
<td>-1.1482141379213884</td>
</tr>
<tr class="even">
<td>-0.3327423570689081</td>
</tr>
<tr class="odd">
<td>1.7898218176905512</td>
</tr>
<tr class="even">
<td>0.9371146998642512</td>
</tr>
<tr class="odd">
<td>0.3889248981364597</td>
</tr>
<tr class="even">
<td>1.2257589408359904</td>
</tr>
<tr class="odd">
<td>5.216316163565138e-2</td>
</tr>
<tr class="even">
<td>-3.2779385011159734e-2</td>
</tr>
<tr class="odd">
<td>0.9614097586524999</td>
</tr>
<tr class="even">
<td>4.39269909553782</td>
</tr>
<tr class="odd">
<td>-0.291144125748688</td>
</tr>
<tr class="even">
<td>1.2868205085801738</td>
</tr>
<tr class="odd">
<td>0.1096371776044478</td>
</tr>
<tr class="even">
<td>1.0358811391307199</td>
</tr>
<tr class="odd">
<td>5.805861249302269e-2</td>
</tr>
<tr class="even">
<td>0.8985406306915447</td>
</tr>
<tr class="odd">
<td>0.3622980657724947</td>
</tr>
<tr class="even">
<td>7.799859986587844</td>
</tr>
<tr class="odd">
<td>-0.32465244606923727</td>
</tr>
<tr class="even">
<td>-0.11398647870671152</td>
</tr>
<tr class="odd">
<td>2.507893114732872</td>
</tr>
<tr class="even">
<td>1.064845371081416</td>
</tr>
<tr class="odd">
<td>0.5365179326980457</td>
</tr>
<tr class="even">
<td>1.7351202994151347</td>
</tr>
<tr class="odd">
<td>0.8109120435203592</td>
</tr>
<tr class="even">
<td>0.3353686164143178</td>
</tr>
<tr class="odd">
<td>0.4575130713351897</td>
</tr>
<tr class="even">
<td>1.544495758400612</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Let's t-digest this <code>data</code> using a user-defined function <code>udf</code> evaluated below.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val udf = TDigestAggregator.udf[Double](compression = 0.2, maxDiscrete = 25)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>udf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedAggregator(org.isarnproject.sketches.spark.tdigest.TDigestAggregator@4ff546b7,class[value[0]: double],None,true,true)
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can <code>agg</code> or aggregate the <code>data</code> DataFrame's <code>value</code> column of <code>Double</code>s that contain our data as follows.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val agg = data.agg(udf($&quot;value&quot;))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>agg: org.apache.spark.sql.DataFrame = [tdigestaggregator(value): tdigest]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Next, let's get the t-digest of the aggregation as <code>td</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val td = agg.first.getAs[TDigest](0) // t-digest
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>td: org.isarnproject.sketches.java.TDigest = TDigest(-2.795387521721169 -&gt; (1.0, 1.0), -2.5827462010549587 -&gt; (1.0, 2.0), -2.5483614528075127 -&gt; (1.0, 3.0), -2.477169648218326 -&gt; (1.0, 4.0), -2.3989148382735106 -&gt; (1.0, 5.0), -2.3621428788859387 -&gt; (1.0, 6.0), -2.3148374687684097 -&gt; (1.0, 7.0), -2.3118179023740413 -&gt; (1.0, 8.0), -2.287613401306727 -&gt; (1.6985517872440687, 9.69855178724407), -2.2636971919621813 -&gt; (0.30144821275593126, 10.0), -2.0993694077900718 -&gt; (1.0, 11.0), -2.0241191135970116 -&gt; (1.698067286443337, 12.698067286443337), -2.003553685010365 -&gt; (0.5043915481076007, 13.202458834550937), -1.9902316558965267 -&gt; (2.7624647600316936, 15.96492359458263), -1.9799895567671855 -&gt; (0.03507640541736867, 16.0), -1.9544570681791966 -&gt; (1.2983022641753663, 17.298302264175366), -1.949427679786941 -&gt; (0.7016977358246337, 18.0), -1.907719117411431 -&gt; (1.697097354468562, 19.69709735446856), -1.8732175304590568 -&gt; (2.302902645531438, 22.0), -1.7834073726649238 -&gt; (4.0, 26.0), -1.6919174552402663 -&gt; (1.0975606232594757, 27.097560623259476), -1.6703272354126013 -&gt; (2.6632081832738317, 29.760768806533306), -1.6589610792385319 -&gt; (2.643090879929395, 32.4038596864627), -1.623299585167854 -&gt; (3.5068289300613555, 35.910688616524055), -1.6069889994292688 -&gt; (3.028777317662718, 38.93946593418678), -1.5892489007898511 -&gt; (5.4762426700006355, 44.415708604187415) ...)
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can evaluate the t-digest <code>td</code> as a cummulative distribution function or CDF at <code>x</code> via the <code>.cdf(x)</code> method.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">td.cdf(1.0)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res28: Double = 0.4995238927606277
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can also get the inverse CDF at any <code>u</code> in the unit interval to get quantiles as follows.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val cutOff = td.cdfInverse(0.99)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>cutOff: Double = 8.75686052913737
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Let's flag those points that cross the threshold determine dby the <code>cutOff</code>.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val dataFlagged = data.withColumn(&quot;anomalous&quot;,$&quot;value&quot;&gt;cutOff)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>dataFlagged: org.apache.spark.sql.DataFrame = [value: double, anomalous: boolean]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Let's show and display the anomalous points.</p>
<p>We are not interested in word-wars over anomalies and outliers here (at the end of the day we are really only interested in the real problem that these arithmetic and syntactic expressions will be used to solve, such as,:</p>
<ul>
<li>keep a washing machine running longer by shutting it down before it will break down (predictive maintenance)</li>
<li>keep a network from being attacked by bots/malware/etc by flagging any unusual events worth escalating to the network security opes teams (without annoying them constantly!)</li>
<li>etc.</li>
</ul>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">data.withColumn(&quot;anomalous&quot;,$&quot;value&quot;&gt;cutOff).filter(&quot;anomalous&quot;).show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+------------------+---------+
|             value|anomalous|
+------------------+---------+
| 9.639219241219372|     true|
|11.539205812425335|     true|
| 9.423175513609095|     true|
|  8.99959554980265|     true|
|10.174199861232976|     true|
+------------------+---------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dataFlagged)
</code></pre>
</div>
<div class="cell markdown">
<h1 id="apply-the-batch-learnt-t-digest-on-a-new-stream-of-data"><a class="header" href="#apply-the-batch-learnt-t-digest-on-a-new-stream-of-data">Apply the batch-learnt T-Digest on a new stream of data</a></h1>
<p>First let's simulate historical data for batch-processing.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.util.Random
import scala.util.Random._

// simulate 5 bursts of historical data - emulate batch processing

// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  Thread.sleep(5L) // sleep 5 milliseconds
  val now = (new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;)).format(new java.util.Date())
  return (now,sample)
   }
   
 dbutils.fs.rm(&quot;/datasets/batchFiles/&quot;,true) // this is to delete the directory before staring a job
 
val r = new Random(123454321L)
var a = 0;
// for loop execution to write files to distributed fs
for( a &lt;- 1 to 5){
  val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).coalesce(1).toDF.as[(String,Double)]
  val minute = (new java.text.SimpleDateFormat(&quot;mm&quot;)).format(new java.util.Date())
  val second = (new java.text.SimpleDateFormat(&quot;ss&quot;)).format(new java.util.Date())
  data.write.mode(SaveMode.Overwrite).csv(&quot;/datasets/batchFiles/&quot; + minute +&quot;_&quot; + second + &quot;.csv&quot;)
  Thread.sleep(10L) // sleep 10 milliseconds
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.util.Random
import scala.util.Random._
myMixtureOf2Normals: (normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: scala.util.Random)(String, Double)
r: scala.util.Random = scala.util.Random@5bdb120b
a: Int = 0
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/batchFiles/&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/batchFiles/09_29.csv/</td>
<td>09_29.csv/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/batchFiles/09_31.csv/</td>
<td>09_31.csv/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/batchFiles/09_32.csv/</td>
<td>09_32.csv/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/batchFiles/09_33.csv/</td>
<td>09_33.csv/</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>dbfs:/datasets/batchFiles/09_35.csv/</td>
<td>09_35.csv/</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<p>Now let's use a static DataFrame to process these files with t-digest and get the 0.99-th quantile based Cut-off.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Read all the csv files written atomically in a directory
import org.apache.spark.sql.types._

val timedScore = new StructType().add(&quot;time&quot;, &quot;timestamp&quot;).add(&quot;score&quot;, &quot;Double&quot;)

import java.sql.{Date, Timestamp}
case class timedScoreCC(time: Timestamp, score: Double)

//val streamingLines = sc.textFile(&quot;/datasets/streamingFiles/*&quot;).toDF.as[String]
val staticLinesDS = spark
  .read
  .option(&quot;sep&quot;, &quot;,&quot;)
  .schema(timedScore)      // Specify schema of the csv files
  .csv(&quot;/datasets/batchFiles/*&quot;).as[timedScoreCC]


val udaf = TDigestAggregator.udf[Double](compression = 0.2, maxDiscrete = 25)


val batchLearntCutOff99 = staticLinesDS
                  .agg(udf($&quot;score&quot;).as(&quot;td&quot;))
                  .first.getAs[TDigest](0)
                  .cdfInverse(0.99)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
timedScore: org.apache.spark.sql.types.StructType = StructType(StructField(time,TimestampType,true), StructField(score,DoubleType,true))
import java.sql.{Date, Timestamp}
defined class timedScoreCC
staticLinesDS: org.apache.spark.sql.Dataset[timedScoreCC] = [time: timestamp, score: double]
udaf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedAggregator(org.isarnproject.sketches.spark.tdigest.TDigestAggregator@53b818de,class[value[0]: double],None,true,true)
batchLearntCutOff99: Double = 8.65009597030763
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We will next execute the companion notebook <code>040a_TDigestInputStream</code> in order to generate the files with the Gaussian mixture for streaming jobs.</p>
<p>The code in the companion notebook is as follows for convenience (you could just copy-paste this code into another notebook in the same cluster with the same distributed file system):</p>
<pre><code class="language-%scala">import scala.util.Random
import scala.util.Random._

// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2Normals( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  Thread.sleep(5L) // sleep 5 milliseconds
  val now = (new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;)).format(new java.util.Date())
  return (now,sample)
   }
   
 dbutils.fs.rm(&quot;/datasets/streamingFiles/&quot;,true) // this is to delete the directory before staring a job
 
val r = new Random(12345L)
var a = 0;
// for loop execution to write files to distributed fs
for( a &lt;- 1 to 20){
  val data = sc.parallelize(Vector.fill(100){myMixtureOf2Normals(1.0, 10.0, 0.99, r)}).coalesce(1).toDF.as[(String,Double)]
  val minute = (new java.text.SimpleDateFormat(&quot;mm&quot;)).format(new java.util.Date())
  val second = (new java.text.SimpleDateFormat(&quot;ss&quot;)).format(new java.util.Date())
  data.write.mode(SaveMode.Overwrite).csv(&quot;/datasets/streamingFiles/&quot; + minute +&quot;_&quot; + second + &quot;.csv&quot;)
  Thread.sleep(5000L) // sleep 5 seconds
}
</code></pre>
<p>We will simply apply the batch-learnt t-digest as the threshold for determining if the streaming data is anomalous or not.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.types._
import java.sql.{Date, Timestamp}

val timedScore = new StructType().add(&quot;time&quot;, &quot;timestamp&quot;).add(&quot;score&quot;, &quot;Double&quot;)
case class timedScoreCC(time: Timestamp, score: Double)

val streamingLinesDS = spark
  .readStream
  .option(&quot;sep&quot;, &quot;,&quot;)
  .schema(timedScore)      // Specify schema of the csv files
  .csv(&quot;/datasets/streamingFiles/*&quot;).as[timedScoreCC]
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
import java.sql.{Date, Timestamp}
timedScore: org.apache.spark.sql.types.StructType = StructType(StructField(time,TimestampType,true), StructField(score,DoubleType,true))
defined class timedScoreCC
streamingLinesDS: org.apache.spark.sql.Dataset[timedScoreCC] = [time: timestamp, score: double]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">//display(streamingLinesDS)
</code></pre>
</div>
<div class="cell markdown">
<p>Now, we can apply this batch-learnt cut-off from the static DataSet to the streaming DataSet.</p>
<p>This is a simple example of learning in batch mode (say overnight or every few hours) and applying it to live streaming data.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Start running the query that prints the running counts to the console
val dataFalgged = streamingLinesDS
      .withColumn(&quot;anomalous&quot;,$&quot;score&quot; &gt; batchLearntCutOff99).filter($&quot;anomalous&quot;)
      .writeStream
      //.outputMode(&quot;complete&quot;)
      .format(&quot;console&quot;)
      .start()

dataFalgged.awaitTermination() // hit cancel to terminate
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+--------------------+------------------+---------+
|                time|             score|anomalous|
+--------------------+------------------+---------+
|2020-11-16 13:12:...| 9.858438409632281|     true|
|2020-11-16 13:12:...| 10.45683581285141|     true|
|2020-11-16 13:11:...| 9.423175513609095|     true|
|2020-11-16 13:11:...|10.442627838980057|     true|
|2020-11-16 13:11:...|10.460772141286911|     true|
|2020-11-16 13:11:...|11.260505056159252|     true|
|2020-11-16 13:12:...| 9.454926349089147|     true|
|2020-11-16 13:12:...| 10.02254460606071|     true|
|2020-11-16 13:12:...| 9.311690918035534|     true|
|2020-11-16 13:12:...| 9.695132992174205|     true|
|2020-11-16 13:12:...|10.439052640762693|     true|
|2020-11-16 13:11:...|11.539205812425335|     true|
|2020-11-16 13:12:...| 9.102639076417908|     true|
|2020-11-16 13:11:...| 9.905282503779972|     true|
|2020-11-16 13:11:...| 9.639219241219372|     true|
|2020-11-16 13:11:...|  8.99959554980265|     true|
|2020-11-16 13:11:...|10.174199861232976|     true|
|2020-11-16 13:13:...| 9.311726779124077|     true|
|2020-11-16 13:13:...| 8.994959541314255|     true|
|2020-11-16 13:12:...|  9.87803253322451|     true|
+--------------------+------------------+---------+
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Although the above pattern of estimating the 99% Cut-Off periodically by batch-processing static DataSets from historical data and then applying these Cut-Offs to filter anamolous data points that are currently streaming at us is <em>good enough</em> for several applications, we may want to do <em>online estimation/learning</em> of the Cut-Off based on the 99% of all the data up to present time and use this <em>live</em> Cut-off to decide which point is anamolous now.</p>
<p>For this we need to use more delicate parts of Structured Streaming.</p>
</div>
<div class="cell markdown">
<h1 id="streaming-t-digest---online-updating-of-the-cut-off"><a class="header" href="#streaming-t-digest---online-updating-of-the-cut-off">Streaming T-Digest - Online Updating of the Cut-Off</a></h1>
<p>To impelment a streaming t-digest of the data that keeps the current threshold and a current t-digest, we need to get into more delicate parts of structured streaming and implement our own <code>flatMapgroupsWithState</code>.</p>
<p>Here are some starting points for diving deeper in this direction of <em>arbitrary stateful processing</em>:</p>
<ul>
<li><a href="https://databricks.com/blog/2017/10/17/arbitrary-stateful-processing-in-apache-sparks-structured-streaming.html">https://databricks.com/blog/2017/10/17/arbitrary-stateful-processing-in-apache-sparks-structured-streaming.html</a>.</li>
<li>Spark Summit EU Dublin 2017 Deep Dive: <a href="https://databricks.com/session/deep-dive-stateful-stream-processing">https://databricks.com/session/deep-dive-stateful-stream-processing</a></li>
<li>See <a href="https://youtu.be/JAb4FIheP28">https://youtu.be/JAb4FIheP28</a></li>
<li>Official <a href="https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#arbitrary-stateful-operations">docs and examples of arbitrary stateful operations</a>
<ul>
<li>doc: <a href="https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.streaming.GroupState">https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.streaming.GroupState</a></li>
</ul>
</li>
<li>See <a href="http://blog.madhukaraphatak.com/introduction-to-spark-structured-streaming-part-14/">Part 14</a> of <a href="http://blog.madhukaraphatak.com/categories/introduction-structured-streaming/">the 14-part series on structured streaming series in Madhukar's blog</a></li>
</ul>
<h1 id="streaming-machine-learning-and-structured-streaming"><a class="header" href="#streaming-machine-learning-and-structured-streaming">Streaming Machine Learning and Structured Streaming</a></h1>
<p>Ultimately we want to use structured streaming for online machine learning algorithms and not just sketching.</p>
<ul>
<li>See Spark Summit 2016 video on streaming ML (streaming logistic regression): <a href="https://youtu.be/r0hyjmLMMOc">https://youtu.be/r0hyjmLMMOc</a></li>
<li><a href="https://github.com/holdenk/spark-structured-streaming-ml/tree/master/src/main/scala/com/high-performance-spark-examples/structuredstreaming">Holden Karau's codes from High Performance Spark Book</a></li>
</ul>
<h1 id="data-engineering-science-pointers"><a class="header" href="#data-engineering-science-pointers">Data Engineering Science Pointers</a></h1>
<p>Using kafka, Cassandra and Spark Structured Streaming</p>
<ul>
<li><a href="https://github.com/ansrivas/spark-structured-streaming">https://github.com/ansrivas/spark-structured-streaming</a></li>
<li><a href="https://github.com/polomarcus/Spark-Structured-Streaming-Examples">https://github.com/polomarcus/Spark-Structured-Streaming-Examples</a></li>
</ul>
</div>
<div style="break-before: page; page-break-before: always;"></div><div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<p><strong>TODO:</strong> - Make this notebook work for latest version of isarn sketches library with lots of optimisations. - Start by learning from resources embedded in earlier notebooks on T-Digest... - This notebook should still work with Spark 2.4+ and isarn-sketches library from 2018 - Estimated time to upgrade to latest version is 1-x hours (actual time is: ? hours).</p>
</div>
<div class="cell markdown">
<h1 id="streaming-tdigest-with-flatmapgroupswithstate"><a class="header" href="#streaming-tdigest-with-flatmapgroupswithstate">Streaming TDigest with flatMapGroupsWithState</a></h1>
<p>by <a href="https://www.linkedin.com/in/benny-avelin-460b99121/">Benny Avelin</a> and <a href="https://www.linkedin.com/in/h%C3%A5kan-persson-064b763/">Håkan Persson</a>. Updated for Spark 3.0 and isarn-sketches-spark 0.5.2 by <a href="https://www.linkedin.com/in/johannes-graner-475677129/">Johannes Graner</a>.</p>
<p>The idea with this sketch is to demonstrate how we can have a running t-Digest in a streaming context.</p>
<h2 id="arbitrary-stateful-aggregations-in-streaming"><a class="header" href="#arbitrary-stateful-aggregations-in-streaming">Arbitrary stateful aggregations in streaming</a></h2>
<p>We have two stateful operations, the first is mapGroupsWithState and flatmapGroupsWithState. The Databricks blog have a relatively good explanation of the two operations in their blogpost https://databricks.com/blog/2017/10/17/arbitrary-stateful-processing-in-apache-sparks-structured-streaming.html. However the concept is maybe not so easy to understand so I will try to give a simple explanation of what is going on with these two aggregations.</p>
<h3 id="structured-streaming"><a class="header" href="#structured-streaming">Structured streaming</a></h3>
<p>For the purpose of this sketch we only need to know that new data will arrive as a batch, if we instead of a streaming dataframe just apply the aggregations on a dataframe then the entirety of the data will be in a single batch.</p>
<h3 id="a-running-state"><a class="header" href="#a-running-state">A running state</a></h3>
<p>The way both mapGroupsWithState and flatMapGroupsWithState works is that we start with a key-value grouped datasets, when new data arrives it will be split into the groups prescribed by the key and each key will get a batch of data. The main important idea to realize is that for each key we have a running state, and there is no prerestriction to witch keys are ok and not so the number of keys can grow/shrink or whatever. If a new key appears, the first step in both mapGroupsWithState and flatmap... is to initialize a zero state before processing the first batch for this key, the next time a key appears it will have remembered the previous state and we can use the previous state and the added batch of data to compute the next state. What can a state be? Well an object of some class that has been predescribed, the simplest would be a running max/min/mean but also as we will see in this sketch a t-digest.</p>
<h3 id="flatmapgroupswithstate-vs-mapgroupswithstate"><a class="header" href="#flatmapgroupswithstate-vs-mapgroupswithstate">flatmapGroupsWithState vs mapGroupsWithState</a></h3>
<p>The simple difference between these two can be infered from the name, but let us go into detail. If we are only interested in an aggregated &quot;value&quot; (could be a case class) from each key we should use mapGroupsWithState, however there are some interesting caveats with using mapGroupsWithState. For instance certain update-modes are not allowed as well as further aggregations are not allowed. flatmap... on the other hand can output any number of rows, allows more output-modes and allows for further aggregations, see the Structured Streaming programming guide.</p>
<table>
  <tr>
    <td>Query type</td><td>Output mode</td><td>Operations allowed</td>
  </tr>
  <tr>
    <td>mapGroupsWithState</td><td>Update</td><td>Aggregations not allowed</td>
  </tr>
  <tr>
    <td>flatMapGroupsWithState</td><td>Append</td><td>Aggregations allowed after</td>
  </tr>
  <tr>
    <td>flatMapGroupsWithState</td><td>Update</td><td>Aggregations not allowed</td>
  </tr>
</table>
</div>
<div class="cell markdown">
<h1 id="some-streaming-input"><a class="header" href="#some-streaming-input">Some streaming input</a></h1>
<p>We need to have a streaming source for our example, this can be done in a number of ways. Probably there is some nice way to do this simply but the few methods I know to generate test-samples is to get a running loop that writes files with data, so that each time a new file arrives Spark will consider it as an update and load it as a batch. We have provided some code to generate points sampled from a normal distribution with anomalies added as another normal distribution.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.util.Random
import scala.util.Random._
import scala.util.{Success, Failure}

// make a sample to produce a mixture of two normal RVs with standard deviation 1 but with different location or mean parameters
def myMixtureOf2NormalsReg( normalLocation: Double, abnormalLocation: Double, normalWeight: Double, r: Random) : (String, Double) = {
  val sample = if (r.nextDouble &lt;= normalWeight) {r.nextGaussian+normalLocation } 
               else {r.nextGaussian + abnormalLocation} 
  Thread.sleep(5L) // sleep 5 milliseconds
  val now = (new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;)).format(new java.util.Date())
  return (now,sample)
}
</code></pre>
</div>
<div class="cell markdown">
<h1 id="the-tmp-folder"><a class="header" href="#the-tmp-folder">The /tmp folder</a></h1>
<p>Databricks community edition has a file-number limit to 10000 and after running databricks for a while one will start to notice that things fail, and skimming the stacktrace of the failure we realize that we have reached said limit. Deleting files that one has created does not seem to solve the issue, well... this is because the /tmp folder counts into the limit and this is not cleared nearly as often as would be good for our work. Therefore we just clear it before starting our job...</p>
<p>ps. If you have not cleared the tmp folder before this might take some time actually. ds.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">dbutils.fs.rm(&quot;/datasets/streamingFiles/&quot;,true) 
//dbutils.fs.rm(&quot;/tmp&quot;,true) // this is to delete the directory before staring a job
val r = new Random(12345L)
var a = 0;
import scala.concurrent.Future
import scala.concurrent.ExecutionContext.Implicits.global
// for loop execution to write files to distributed fs
//We have made a Future out of this, which means that it runs concurrently with what we do next, i.e. essentially it is a seperate thread.

val writeStreamFuture = Future {
  for( a &lt;- 1 to 10){
    val data = sc.parallelize(Vector.fill(1000){myMixtureOf2NormalsReg(1.0, 10.0, 0.99, r)}).coalesce(1).toDF.as[(String,Double)]
    val minute = (new java.text.SimpleDateFormat(&quot;mm&quot;)).format(new java.util.Date())
    val second = (new java.text.SimpleDateFormat(&quot;ss&quot;)).format(new java.util.Date())
    data.write.mode(SaveMode.Overwrite).csv(&quot;/datasets/streamingFiles/&quot; + minute +&quot;_&quot; + second + &quot;.csv&quot;)
    Thread.sleep(5000L) // sleep 5 seconds
  }
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>r: scala.util.Random = scala.util.Random@2c715b75
a: Int = 0
import scala.concurrent.Future
import scala.concurrent.ExecutionContext.Implicits.global
writeStreamFuture: scala.concurrent.Future[Unit] = Future(&lt;not completed&gt;)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(dbutils.fs.ls(&quot;/datasets/streamingFiles&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/streamingFiles/05_30.csv/</td>
<td>05_30.csv/</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>dbfs:/datasets/streamingFiles/05_41.csv/</td>
<td>05_41.csv/</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell markdown">
<h1 id="aws-eventually-consistent"><a class="header" href="#aws-eventually-consistent">AWS eventually consistent</a></h1>
<p>The AWS distributed filesystem is eventually consistent, this can mean for instance that a file just created will not be possible to read and if we are unlucky the following code will fail to run.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import org.apache.spark.sql.types._
import java.sql.{Date, Timestamp}

/**
  * timedScore is the SQL schema for timedScoreCC, and the files written in the above code
  */
val timedScore = new StructType().add(&quot;time&quot;, &quot;timestamp&quot;).add(&quot;score&quot;, &quot;Double&quot;)
case class timedScoreCC(time: Timestamp, val score: Double) {
}

val streamingLinesDS = spark
  .readStream
  .option(&quot;sep&quot;, &quot;,&quot;)
  .schema(timedScore)      // Specify schema of the csv files
  .option(&quot;MaxFilesPerTrigger&quot;, 1) //  maximum number of new files to be considered in every trigger (default: no max) 
  .csv(&quot;/datasets/streamingFiles/*&quot;).as[timedScoreCC]
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.types._
import java.sql.{Date, Timestamp}
timedScore: org.apache.spark.sql.types.StructType = StructType(StructField(time,TimestampType,true), StructField(score,DoubleType,true))
defined class timedScoreCC
streamingLinesDS: org.apache.spark.sql.Dataset[timedScoreCC] = [time: timestamp, score: double]
</code></pre>
</div>
</div>
<div class="cell markdown">
<h1 id="states-and-rows"><a class="header" href="#states-and-rows">States and rows</a></h1>
<p>To begin describing the code below, let us first look at what will be our running State. The <code>isarnproject</code> sketches packs the TDigest class into a TDigestSQL case class and provides encoders for this to be allowed in a Dataframe, therefore we can capitalize on this and use TDigestSQL as our running state (to be precise it is the TDigest wrapped by TDigestSQL that is the state but whatever.). The next thing to worry about is how should we output and what should we output? This example shows how to embed in a single row, the TDigest, the threshold value that comes from <code>cdfInverse(0.99)</code> and the actual data that is above the threshold. To do this we create a case class which will be the template for our row, in the code below it is called <code>TdigAndAnomaly</code>.</p>
<h2 id="updateacrossbatch"><a class="header" href="#updateacrossbatch">updateAcrossBatch</a></h2>
<p>This is our main update-function that we send as a parameter to flatmapGroupsWithState.</p>
<ul>
<li>It takes as first input the key-value, which we will not care about in this example and is just a dummy for us.</li>
<li>The second input is the <code>inputs : Iterator[timedScoreCC]</code>, this is an iterator over the batch of data that we have recieved. This is the type-safe version, i.e. we know that we have a <code>Dataset[timedScoreCC]</code>, if we dont and we instead have a <code>DataFrame = Dataset[Row]</code>, we have to use <code>inputs : Iterator[Row]</code>, and we have to extract the columns of interest cast into the appropriate types.</li>
<li>The third input is the running state variable, this is always wrapped in a <code>GroupState</code> wrapper class, i.e. since <code>TDigestSQL</code> was our state we need to have <code>GroupState[TDigestSQL]</code> as <code>oldstate</code>.</li>
<li>Lastly we have the output, which is an iterator of the case class chosen as outputrow, in our case this is <code>Iterator[TdigAndAnomaly]</code></li>
</ul>
<p>Each time a batch gets processed, the batch data is in the <code>inputs</code> variable. We first make sure that the state is either the previous state (if it exists) or we set it to a zero state. Then we simply process the batch one datapoint at the time, and each time calling updateTDIG, which simply updates the state with the new data point (tDigest add point). Once we have added all the points to the t-Digest, we can compute the updated value of <code>threshold</code> using <code>cdfInverse(0.99)</code>, after that we simply filter the batch to obtain an iterator of the anomalies.</p>
<h3 id="groupstatetimeout"><a class="header" href="#groupstatetimeout">GroupStateTimeout</a></h3>
<p>This is an interesting variable that you really should look into if you wish to understand structured streaming. Essentially it is the whole point of messing around with the structured streaming framework, see the programming guide.</p>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">import java.sql.Timestamp
import org.apache.spark.sql.Encoder
import org.apache.spark.sql.catalyst.encoders.ExpressionEncoder
import org.isarnproject.sketches.spark.tdigest.infra.TDigest
import org.apache.spark.sql.streaming.{GroupStateTimeout, OutputMode, GroupState}

// Need to declare an implicit encoder in order to use the TDigest class in Datasets.
implicit val impEncoder: Encoder[TDigest] = ExpressionEncoder[TDigest]()

// State definition
case class TdigAndAnomaly(tDig:TDigest, tDigThreshold:Double, time:Timestamp, score:Double)

// Update function, takes a key, an iterator of events and a previous state, returns an iterator which represents the
// rows of the output from flatMapGroupsWithState
def updateAcrossBatch(dummy:Int, inputs: Iterator[timedScoreCC], oldState: GroupState[TDigest]):Iterator[TdigAndAnomaly] = {
  
  // state is the oldState if it exists otherwise we create an empty state to start from
  val state:TDigest = if (oldState.exists) oldState.get else new TDigest(TDigest.compressionDefault, TDigest.maxDiscreteDefault)
  
  // We copy the traversableOnce iterator inputs into inputs1 and inputs2, this implies we need to discard inputs
  val (inputs1,inputs2) = inputs.duplicate
  
  // Update the state for each input
  inputs1.foreach( input =&gt; state.update(input.score) )
  
  // Update the state for the next microbatch
  oldState.update(state)
  
  // Precompute the threshold for which we will sort the anomalies
  val cdfInv:Double = state.cdfInverse(0.99)
  
  // Yields an iterator of anomalies
  val anomalies:Iterator[TdigAndAnomaly] = for(input &lt;- inputs2; if (input.score &gt; cdfInv)) yield TdigAndAnomaly(state,cdfInv,input.time,input.score)
  
  // Return the anomalies iterator, each item in the iterator gives a row in the output
  anomalies
}

import org.apache.spark.sql.streaming.GroupStateTimeout

val query = streamingLinesDS
  .groupByKey(x =&gt; 1)
  .flatMapGroupsWithState(OutputMode.Append,GroupStateTimeout.NoTimeout)(updateAcrossBatch)
  .writeStream
  .outputMode(&quot;append&quot;)
  .format(&quot;console&quot;)
  .start
  .awaitTermination
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>-------------------------------------------
Batch: 0
-------------------------------------------
+--------------------+-----------------+--------------------+------------------+
|             tDigSql|    tDigThreshold|                time|             score|
+--------------------+-----------------+--------------------+------------------+
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...| 9.639219241219372|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|11.539205812425335|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...| 9.423175513609095|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|  8.99959554980265|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|10.174199861232976|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|10.442627838980057|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|10.460772141286911|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...|11.260505056159252|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...| 9.905282503779972|
|TDigest(-2.005053...|7.909881933492612|2022-02-14 12:05:...| 9.102639076417908|
+--------------------+-----------------+--------------------+------------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+--------------------+-----------------+--------------------+------------------+
|             tDigSql|    tDigThreshold|                time|             score|
+--------------------+-----------------+--------------------+------------------+
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 9.695132992174205|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...|10.439052640762693|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 10.02254460606071|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 9.311690918035534|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 9.454926349089147|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...|  9.87803253322451|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 9.858438409632281|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 10.45683581285141|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 9.311726779124077|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 8.994959541314255|
|TDigest(-2.314837...|8.363164394938963|2022-02-14 12:05:...| 8.577631475055892|
+--------------------+-----------------+--------------------+------------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+--------------------+-----------------+--------------------+------------------+
|             tDigSql|    tDigThreshold|                time|             score|
+--------------------+-----------------+--------------------+------------------+
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 10.13608393266294|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 9.562663532092044|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 10.50152359072326|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|10.061968291873699|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|10.242131495863143|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 9.535096094790836|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|11.012797937983356|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 9.841120163403126|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|11.569770306228012|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|10.947191786184677|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|10.380284632322022|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...|10.399812080160988|
|TDigest(-2.477169...|9.185194249546218|2022-02-14 12:05:...| 10.47155413079559|
+--------------------+-----------------+--------------------+------------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+--------------------+-----------------+--------------------+------------------+
|             tDigSql|    tDigThreshold|                time|             score|
+--------------------+-----------------+--------------------+------------------+
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:05:...|11.028282567178604|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:05:...| 9.801446956198197|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:05:...| 9.349642991847796|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...|10.446018187089411|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...|10.735315117514041|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...|11.160788156092288|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...| 9.741913362611065|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...|10.031203472330613|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...| 9.310488974576659|
|TDigest(-2.477169...|9.111097583328924|2022-02-14 12:06:...|10.669624608178813|
+--------------------+-----------------+--------------------+------------------+
</code></pre>
</div>
</div>
<div class="cell markdown">
<h1 id="have-fun"><a class="header" href="#have-fun">Have fun</a></h1>
<p>Arbitrary stateful aggregations are very powerful and you can really do a lot, especially if you are allowed to perform aggregations afterwards (flatmapGroupsWithState with Append mode). This is some really cool stuff!</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </body>
</html>
