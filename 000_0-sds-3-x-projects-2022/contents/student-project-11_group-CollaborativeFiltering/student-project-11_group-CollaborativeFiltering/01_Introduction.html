<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>student-project-11_group-CollaborativeFiltering_01_Introduction - sds-3.x/ScaDaMaLe</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../scroll-mdbook-outputs.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/00_Introduction.html"><strong aria-hidden="true">1.</strong> student-project-01_group-GraphOfWiki_00_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/01_DataLoading_redirectsTable.html"><strong aria-hidden="true">1.1.</strong> 01_DataLoading_redirectsTable</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/02_DataLoading_pagesTable.html"><strong aria-hidden="true">1.2.</strong> 02_DataLoading_pagesTable</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/03_DataLoading_pagelinksTable.html"><strong aria-hidden="true">1.3.</strong> 03_DataLoading_pagelinksTable</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/04_DataLoading_categorylinksTable.html"><strong aria-hidden="true">1.4.</strong> 04_DataLoading_categorylinksTable</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/05_DataLoading_categoryTable.html"><strong aria-hidden="true">1.5.</strong> 05_DataLoading_categoryTable</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/06_redirectRemoval.html"><strong aria-hidden="true">1.6.</strong> 06_redirectRemoval</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/07_createArticleGraph.html"><strong aria-hidden="true">1.7.</strong> 07_createArticleGraph</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/08_explorationArticleGraph.html"><strong aria-hidden="true">1.8.</strong> 08_explorationArticleGraph</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/09_fullGraphAnalysis.html"><strong aria-hidden="true">1.9.</strong> 09_fullGraphAnalysis</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/10_explorativeMotifs.html"><strong aria-hidden="true">1.10.</strong> 10_explorativeMotifs</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/11_conclusionDiscussionAndFutureWork.html"><strong aria-hidden="true">1.11.</strong> 11_conclusionDiscussionAndFutureWork</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/12_gameNotebookSetup.html"><strong aria-hidden="true">1.12.</strong> 12_gameNotebookSetup</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-01_group-GraphOfWiki/student-project-01_group-GraphOfWiki/13_gameNotebook.html"><strong aria-hidden="true">1.13.</strong> 13_gameNotebook</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/00_vqa_introduction.html"><strong aria-hidden="true">2.</strong> student-project-02_group-DDLOfVision_00_vqa_introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/01_vqa_model_training.html"><strong aria-hidden="true">2.1.</strong> 01_vqa_model_training</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/00_Notebook_Presentation.html"><strong aria-hidden="true">3.</strong> student-project-04_group-FedMLMedicalApp_00_Notebook_Presentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/01_BrainTumorSegmentation_Centralized_Training.html"><strong aria-hidden="true">3.1.</strong> 01_BrainTumorSegmentation_Centralized_Training</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/02_Federated_Learning_BrainTumorSegmentation.html"><strong aria-hidden="true">3.2.</strong> 02_Federated_Learning_BrainTumorSegmentation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/data_upload_test.html"><strong aria-hidden="true">3.3.</strong> data_upload_test</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/00_introduction.html"><strong aria-hidden="true">4.</strong> student-project-05_group-DistOpt_00_introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/01_Bayesian_optimization.html"><strong aria-hidden="true">4.1.</strong> 01_Bayesian_optimization</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/02_Gaussian_processes.html"><strong aria-hidden="true">4.2.</strong> 02_Gaussian_processes</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/03_acquisition_functions.html"><strong aria-hidden="true">4.3.</strong> 03_acquisition_functions</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/04_scalable_Bayesian_optimization.html"><strong aria-hidden="true">4.4.</strong> 04_scalable_Bayesian_optimization</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/05_implementation_documentation.html"><strong aria-hidden="true">4.5.</strong> 05_implementation_documentation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/06_our_implementation.html"><strong aria-hidden="true">4.6.</strong> 06_our_implementation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/07_additional_code.html"><strong aria-hidden="true">4.7.</strong> 07_additional_code</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-07_group-ExpsZerOInit/student-project-07_group-ExpsZerOInit/00_introduction_resnet.html"><strong aria-hidden="true">5.</strong> student-project-07_group-ExpsZerOInit_00_introduction_resnet</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-07_group-ExpsZerOInit/student-project-07_group-ExpsZerOInit/01_transformer.html"><strong aria-hidden="true">5.1.</strong> 01_transformer</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-07_group-ExpsZerOInit/student-project-07_group-ExpsZerOInit/02_ddpm.html"><strong aria-hidden="true">5.2.</strong> 02_ddpm</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-08_group-WikiSearch/student-project-08_group-WikiSearch/00_Introduction.html"><strong aria-hidden="true">6.</strong> student-project-08_group-WikiSearch_00_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-08_group-WikiSearch/student-project-08_group-WikiSearch/01_InputParsing.html"><strong aria-hidden="true">6.1.</strong> 01_InputParsing</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-08_group-WikiSearch/student-project-08_group-WikiSearch/02_PageRank.html"><strong aria-hidden="true">6.2.</strong> 02_PageRank</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-08_group-WikiSearch/student-project-08_group-WikiSearch/03_QuerySearch.html"><strong aria-hidden="true">6.3.</strong> 03_QuerySearch</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-09_group-DistEnsembles/student-project-09_group-DistEnsembles/00_Introduction.html"><strong aria-hidden="true">7.</strong> student-project-09_group-DistEnsembles_00_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-09_group-DistEnsembles/student-project-09_group-DistEnsembles/02_Ensemble_Training.html"><strong aria-hidden="true">7.1.</strong> 02_Ensemble_Training</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-09_group-DistEnsembles/student-project-09_group-DistEnsembles/03_Ensemble_Evaluation.html"><strong aria-hidden="true">7.2.</strong> 03_Ensemble_Evaluation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-09_group-DistEnsembles/student-project-09_group-DistEnsembles/099_extra_Ensemble.html"><strong aria-hidden="true">7.3.</strong> 099_extra_Ensemble</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/00_introduction.html"><strong aria-hidden="true">8.</strong> student-project-10_group-RDI_00_introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/01_prepare_data.html"><strong aria-hidden="true">8.1.</strong> 01_prepare_data</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/02_baseline.html"><strong aria-hidden="true">8.2.</strong> 02_baseline</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/03_single_machine.html"><strong aria-hidden="true">8.3.</strong> 03_single_machine</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/04_distributed_learning.html"><strong aria-hidden="true">8.4.</strong> 04_distributed_learning</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-11_group-CollaborativeFiltering/student-project-11_group-CollaborativeFiltering/01_Introduction.html" class="active"><strong aria-hidden="true">9.</strong> student-project-11_group-CollaborativeFiltering_01_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-11_group-CollaborativeFiltering/student-project-11_group-CollaborativeFiltering/02_AlgorithmsBeyondALS.html"><strong aria-hidden="true">9.1.</strong> 02_AlgorithmsBeyondALS</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-11_group-CollaborativeFiltering/student-project-11_group-CollaborativeFiltering/03_Implementation.html"><strong aria-hidden="true">9.2.</strong> 03_Implementation</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-12_group-FedLearnOpt/student-project-12_group-FedLearnOpt/01_Federated_Learning_Introduction.html"><strong aria-hidden="true">10.</strong> student-project-12_group-FedLearnOpt_01_Federated_Learning_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-12_group-FedLearnOpt/student-project-12_group-FedLearnOpt/02_Horovod_Introduction.html"><strong aria-hidden="true">10.1.</strong> 02_Horovod_Introduction</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-12_group-FedLearnOpt/student-project-12_group-FedLearnOpt/03_Implementations.html"><strong aria-hidden="true">10.2.</strong> 03_Implementations</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-project-13_group-DRL/student-project-13_group-DRL/00_DistributedRL.html"><strong aria-hidden="true">11.</strong> student-project-13_group-DRL_00_DistributedRL</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/00_Introduction.html"><strong aria-hidden="true">12.</strong> student-project-14_group-EarthObs_00_Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/01_Download_data.html"><strong aria-hidden="true">12.1.</strong> 01_Download_data</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/02_Image_preprocessing.html"><strong aria-hidden="true">12.2.</strong> 02_Image_preprocessing</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/03_Model_Architecture_and_Training.html"><strong aria-hidden="true">12.3.</strong> 03_Model_Architecture_and_Training</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/04_Prediction_And_Visualisation.html"><strong aria-hidden="true">12.4.</strong> 04_Prediction_And_Visualisation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-14_group-EarthObs/student-project-14_group-EarthObs/05_Conclusions.html"><strong aria-hidden="true">12.5.</strong> 05_Conclusions</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../../contents/student-projects-BrIntSuSvConclusion/student-projects-BrIntSuSvConclusion/BrIntSuSv.html"><strong aria-hidden="true">13.</strong> student-projects-BrIntSuSvConclusion_BrIntSuSv</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../../editors.html"><strong aria-hidden="true">14.</strong> Editors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">sds-3.x/ScaDaMaLe</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<h1 id="collaborative-filtering-in-movie-recommender-systems"><a class="header" href="#collaborative-filtering-in-movie-recommender-systems">Collaborative Filtering in Movie Recommender Systems</a></h1>
<p><strong>Project members:</strong></p>
<ul>
<li>Jacob Lindbäck, KTH Royal Institute of Technology</li>
<li>Rebecka Winqvist, KTH Royal Institute of Technology</li>
<li>Robert Bereza, KTH Royal Institute of Technology</li>
<li>Damianos Tranos, KTH Royal Institute of Technology</li>
</ul>
</div>
<div class="cell markdown">
<p><a href="https://www.youtube.com/watch?v=wG8Hn-NyNXg"><img src="http://img.youtube.com/vi/wG8Hn-NyNXg/0.jpg" alt="ScaDaMaLe WASP-UU 2022 - Student Group Project 11 - Collaborative Filtering in Movie Recommender Sys" /></a></p>
</div>
<div class="cell markdown">
<h3 id="collaborative-filtering"><a class="header" href="#collaborative-filtering">Collaborative Filtering</a></h3>
<p>A recommender system provides its users with personalized suggestions, based on their previous feedback and ratings. We encounter them frequently in our everyday lives: for example, in streaming services where they are used for movie and music recommendation, and in e-commerce where they are used for product recommendation.</p>
<p>Collaborative filtering is a widely used technique in recommender systems. The technique makes predictions/suggestions (<em>filtering</em>) based on preferences collected from many users (<em>collaborative</em>). In this project, we use a collaborative filtering method for a movie recommender system. Let's start with a simple example.</p>
<p>Assume that we have five users and six movies in our system. We can collect the user ratings in a matrix</p>
<div align="center">
<img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/ex1.png" alt="ratings-matrix-1" width="200"/>  
</div>
<p>in which the rows represent the users, and the columns represent the movies. We call this matrix the <em>user-item interaction matrix</em> or the <em>ratings matrix</em>, and we denote it by \(X\). This matrix actually contains many dependencies, which we will make use of when we predict &quot;missing&quot; ratings.</p>
</br >
<p><strong>Example 1</strong>
Assume that we have the following ratings matrix
</br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/ex2.png" alt="ratings-matrix-all-threes-one-missing" width="200"/>. </div></p>
<p>In this case, User 3 has not rated Movie 4. Since all users appear to share the same preferences, it makes sense to guess that User 3 will also give Movie 4 a rating of 3.</p>
</br >
<p><strong>Example 2</strong>
Assume the following ratings matrix
</br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/ex3.png" alt="ratings-matrix-one-missing" width="200"/> </div></p>
<p>We want to guess/predict how User 3 will rate Movie 2. We see that User 1 and User 3 seem to have the same preferences. It is therefore safe to assume that User 3 will give Movie 2 a rating of 2.
</br ></p>
</div>
<div class="cell markdown">
<h3 id="matrix-factorization"><a class="header" href="#matrix-factorization">Matrix Factorization</a></h3>
<p>It is easy to see that as the number of users and items grows, the problem of finding these dependencies or patterns becomes untractable/cumbersome. One way of mitigating this is by introducing so called <em>latent features</em> to characterize the items (movies) being rated, and instead learn/estimate how prevalent these fearures are in each movie, and to what extent each user appreciates a certain feature. In a movie recommender system, features could be e.g. movie genres, movie plots, starring actors or producers.</p>
<p>As an example, let's look at the case where we have two features, denoted by F1 and F2. We can then construct two matrices that tells us how the users rate these features, and how prevalent they are in each movie. We call these matrices, or this information, <em>user factors</em> and <em>item factors</em>, respectively, and denote them by \(U\) and \(V\).</p>
<div align="center">
<img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/factor-matrices-combined.png" alt="factor-matrices" width="400"/>  
</br >
</div>
<p>So, for example, if we want to predict/guess how User 1 would rate Movie 1 in this case, we simply take the dot product between the two vectors \[r_{1,1} = 
\left[
3 \ 1
\right]
\cdot 
\left[
1 \ 1
\right]^\top = 4,\]</p>
<p>which we can interpret as how much the user's preferences align with the movie's features, i.e., how likely it is that the user will enjoy the movie. Using this logic, to compute the full ratings matrix, we then take the outer product of the matrices \(U\) and \(V\), i.e., \(X = UV^\top\). This is also visualized in the image below.</p>
<div align="center">
<img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/factorized-matrix.png?token=GHSAT0AAAAAAB3ISG23QWFGSNJ3A3DOILMGY4GD63A" alt="matrix-factorization" width="500"/>  
</div>
</br >
<p>This method is known as <em>Matrix Factorization</em>, which is a class of collaborative filtering algorithms. To summarize, the method decomposes the ratings matrix into the product of two lower-dimensional matrices: one representing the user factors, and one representing the item factors. In this way, computing/predciting the full ratings matrix become more memory efficient and computationally cheape, since we now only need to learn/find the item and user factors. </br ></p>
</div>
<div class="cell markdown">
<h3 id="problem-formulation"><a class="header" href="#problem-formulation">Problem Formulation</a></h3>
<p>Let us now formalize our problem. First, let \(x_{i,j}\) denote the rating user \(i\) has given item/movie \(j\). Further, let \(\Omega\) denote all observed user-item pairs (i.e., which movies have been rated by whom). The collected ratings are represented by the ratings matrix, \(X\).</p>
<p>Our goal/aim is to learn/predict the missing values of \(X\). Using matrix factorization, this corresponds to finding/learning the user and item factors, \(U\) and \(V\), that best describe/represent the collected ratings (the elements of \(X\). That is, we want to minimize the difference (or error) \[
X - UV^\top.
\] Since we cannot compute an error/deviation for missing values/ratings, we introduce the masking operator \(P_\Omega\) defined by \[
{P_\Omega(X)}<em>{i,j} = 
x</em>{i,j} \text{    if    } (i,j) \in \Omega, \text{\ \ \ } {P_\Omega(X)}_{i,j} = 
0 \text{  otherwise  },
\]</p>
<p>and re-formulate the problem as the optimization problem \[ \min_{U \in \mathbb{R}^{n\times k}, V \in \mathbb{R}^{m\times k}} \quad \frac{1}{2}\left\lVert P_\Omega(X - UV^\top) \right\rVert^2_F, \] where \(F\) denotes the Frobenius norm. To facilitate the training/learning, but also to mitigate the risk of overfitting, one typically introduces two regularization terms: \[ \min_{U \in \mathbb{R}^{n\times k}, V \in \mathbb{R}^{m\times k}} \quad \frac{1}{2}\left\lVert P_\Omega(X - UV^\top) \right\rVert^2_F + \frac{\lambda}{2n}\left\lVert U \right\rVert^2_F + \frac{\lambda}{2m}\left\lVert V \right\rVert^2_F.\] </br ></p>
</div>
<div class="cell markdown">
<h3 id="alternating-least-squares-als"><a class="header" href="#alternating-least-squares-als">Alternating Least Squares (ALS)</a></h3>
<p>A standard method for solving the Matrix Factorization problem (that is also implemented in Spark currently) is Alternating Least Squares. The method relies on the observation that if we were to fix one of the optimization variables \(U, V\) then the aforementioned optimization problem reduces to a Least Squares problem.</p>
<p>ALS then involves fixing one of the optimization variables at every iteration (in an alternating fashion) and solving the corresponding convex problem using e.g. gradient descent. As an example of how these gradients can be computed, let:</p>
<p>\[
\mathcal{l}(U,V) = \frac{1}{2}\left\lVert P_\Omega(X - UV^\top) \right\rVert^2_F
\] denote the loss. Then the gradients w.r.t. to the factor matrices are given by \[
\nabla_U \mathcal{l}(U,V) = -P_\Omega(X-UV^\top)V, \quad \quad
\nabla_V \mathcal{l}(U,V) = -P_\Omega^\top(X-UV^\top)U,
\] respectively.</p>
<p>Typically, it's impractical to carry out all the matrix operations, due to the sparse nature of the problem. We note that, for one observation \((i,j)\) in \(\Omega\), that data point will only impact the gradients of the \(i\)th row of \(U\) and the \(j\)th row of \(V\), i.e.</p>
<p>\[
\nabla_{u_i} \mathcal{l} += -(x_{ij}-\langle u_i, v_j \rangle)v_j, \quad \quad
\nabla_{v_j} \mathcal{l} += -(x_{ij}-\langle u_i, v_j \rangle)u_j
\]</p>
<p>where \(u_i\) and \(v_j\) is the \(i\)th and \(j\)th row in \(U\) and \(V\) respectively (here \(+=\) means &quot;add to variable&quot;).</p>
</div>
<div class="cell markdown">
<h2 id="practical-implementation"><a class="header" href="#practical-implementation">Practical Implementation</a></h2>
<p>We illustrate how the data is partitioned with an example. Assume we have collected the ratings matrix: </br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/ratings-matrix-partition-example.png" alt="drawing" width="200"/> </div></p>
<p>Assume further that we charactize the items (movies) by three factors: F1, F2 and F3. With six users, six movies and three factors, the userFactor matrix and itemFactor matrix will both be of size \(6\times 3\). See Figure below.</p>
<p></br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/item-and-user-factor-matrices.png" alt="user-factor-matrix" width="500"/> </div></p>
<p>We want to find the optimal elements of these matrices. We do so by minimizing the loss function defined above.</p>
<h3 id="data-partitioning"><a class="header" href="#data-partitioning">Data Partitioning</a></h3>
<p>To store the large factor matrices \(U\) and \(V\), they are divided up by their rows and distributed in memory across different partitions. To also reduce the communication needed to update \(U\) and \(V\), the rating matrix, which is fixed at all time, is stored in memory structures called OutBlocks and InBlocks. There are four such structures in total, two of each for both items and for users. The userInBlocks contain all the ratings each user needs for its update, partitioned in such a way that the ratings are stored on the same partition as the factor that needs them to update, thus removing the need for communicating the ratings during the optimization. The userOutBlocks simply contain information about (or addresses to) the itemFactors that are necessary to update each block of userFactors. This information is used to, at each iteration, ensure that every userFactor is only communicated exactly those item factors it needs to update, and no more. The corresponding approach is used for itemInBlocks and itemOutBlocks. Note that this way of storing the data stores in total two copies of the rating matrix (one in userInBlocks and one in itemInBlocks), but on the other hand removes the need to communicate any values of the rating matrix during the optimization.</p>
<p>Assume that we split each matrix computation over three partitions each. This is illustrated in the figure below. How the blocks are distributed across partitions can be random, or determined by some specification (i.e., users with even indices on partitions with even indices etc.)</p>
<p></br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/pic1.png" alt="partitioning-1" width="700"/> </div></p>
</br >
<p>The elements of the ratings matrix are then distributed over these six partitions such that all information necessary to compute a particular factor, \(u_{i,j}\) or \(v_{i,j}\), is stored in the same partition. For instance, to compute user factors \(u_{i,j}\) for \(i\in[1,2], j\in[1,3]\), we only need the ratings from users 1 and 2.</p>
<p></br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/pic2.png" alt="partitioning-2" width="1000"/> </div></p>
<p>Finally, we also store...</p>
<p></br > <div align="center"> <img src="https://raw.githubusercontent.com/rwinqvist/wasp-scadamale-project/main/userParts-info-list.png" width="1000"/> </div></p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/04_distributed_learning.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../../contents/student-project-11_group-CollaborativeFiltering/student-project-11_group-CollaborativeFiltering/02_AlgorithmsBeyondALS.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../contents/student-project-10_group-RDI/student-project-10_group-RDI/04_distributed_learning.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../contents/student-project-11_group-CollaborativeFiltering/student-project-11_group-CollaborativeFiltering/02_AlgorithmsBeyondALS.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
