<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>06_our_implementation - sds-3.x/ScaDaMaLe</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../scroll-mdbook-outputs.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/00_vqa_introduction.html"><strong aria-hidden="true">1.</strong> 00_vqa_introduction</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/01_vqa_model_training.html"><strong aria-hidden="true">2.</strong> 01_vqa_model_training</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/02_vqa_model_inference.html"><strong aria-hidden="true">3.</strong> 02_vqa_model_inference</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-02_group-DDLOfVision/student-project-02_group-DDLOfVision/0y_test_mnist-pytorch.html"><strong aria-hidden="true">4.</strong> 0y_test_mnist-pytorch</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/00_ingest_data.html"><strong aria-hidden="true">5.</strong> 00_ingest_data</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/02_load_data.html"><strong aria-hidden="true">6.</strong> 02_load_data</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/03_data_exploration.html"><strong aria-hidden="true">7.</strong> 03_data_exploration</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/04Motif_search_defination_code.html"><strong aria-hidden="true">8.</strong> 04Motif_search_defination_code</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/08_pagerank.html"><strong aria-hidden="true">9.</strong> 08_pagerank</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/10_motif_mining_WikiKGv2.html"><strong aria-hidden="true">10.</strong> 10_motif_mining_WikiKGv2</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-03_group-WikiKG90mv2/student-project-03_group-WikiKG90mv2/fetch_descriptions.html"><strong aria-hidden="true">11.</strong> fetch_descriptions</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/00_Notebook_Presentation.html"><strong aria-hidden="true">12.</strong> 00_Notebook_Presentation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/01_BrainTumorSegmentation_Centralized_Training.html"><strong aria-hidden="true">13.</strong> 01_BrainTumorSegmentation_Centralized_Training</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/02_Federated_Learning_BrainTumorSegmentation.html"><strong aria-hidden="true">14.</strong> 02_Federated_Learning_BrainTumorSegmentation</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-04_group-FedMLMedicalApp/student-project-04_group-FedMLMedicalApp/data_upload_test.html"><strong aria-hidden="true">15.</strong> data_upload_test</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/00_introduction.html"><strong aria-hidden="true">16.</strong> 00_introduction</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/01_Bayesian_optimization.html"><strong aria-hidden="true">17.</strong> 01_Bayesian_optimization</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/02_Gaussian_processes.html"><strong aria-hidden="true">18.</strong> 02_Gaussian_processes</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/03_acquisition_functions.html"><strong aria-hidden="true">19.</strong> 03_acquisition_functions</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/04_TuRBO.html"><strong aria-hidden="true">20.</strong> 04_TuRBO</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/05_deep_kernel_learning.html"><strong aria-hidden="true">21.</strong> 05_deep_kernel_learning</a></li><li class="chapter-item expanded "><a href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/06_our_implementation.html" class="active"><strong aria-hidden="true">22.</strong> 06_our_implementation</a></li><li class="chapter-item expanded "><a href="../../../editors.html"><strong aria-hidden="true">23.</strong> Editors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">sds-3.x/ScaDaMaLe</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<h1 id="our-implementation"><a class="header" href="#our-implementation">Our implementation</a></h1>
<p><strong>UPDATE BELOW!!!</strong></p>
<p>We packaged our implementation to deal with serialization issues of Spark. Therefore, we show the implementation in markdown cells as the code in the notebooks is quite short and incomprehensible.</p>
<h3 id="optimization-problem"><a class="header" href="#optimization-problem">Optimization problem</a></h3>
<p>We first define a helper function that projects points from the GP search space \([0,1]^D\) to the actual support of the function \(f\).</p>
<pre><code class="language-python">from botorch.utils.transforms import unnormalize

def eval_objective(x, fun):
    &quot;&quot;&quot;This is a helper function we use to unnormalize a point from [0, 1]^D and evaluate it&quot;&quot;&quot;
    return fun(unnormalize(x, fun.bounds))
</code></pre>
<p>We define a generic class for optimization problems.</p>
<pre><code class="language-python">from abc import ABC, abstractmethod
import torch
import numpy as np

class OptimizationProblem(ABC):
    &quot;&quot;&quot;
    This is an abstract class for generic optimization problems we consider
    &quot;&quot;&quot;

    @abstractmethod
    def __init__(self, dim: int):
        &quot;&quot;&quot;
        implemented by subclasses
        &quot;&quot;&quot;
        raise NotImplementedError()

    @abstractmethod
    def __call__(self, x: torch.Tensor):
        &quot;&quot;&quot;
        implemented by subclasses
        &quot;&quot;&quot;
        raise NotImplementedError()

    @abstractmethod
    def lb(self) -&gt; np.ndarray:
        &quot;&quot;&quot;
        returns the lower bound of the problem
        &quot;&quot;&quot;
        raise NotImplementedError()

    @abstractmethod
    def ub(self) -&gt; np.ndarray:
        &quot;&quot;&quot;
        returns the upper bound of the problem
        &quot;&quot;&quot;
        raise NotImplementedError()

    @abstractmethod
    def dim(self) -&gt; int:
        &quot;&quot;&quot;
        returns the dimensionality of the problem
        &quot;&quot;&quot;
        raise NotImplementedError()
</code></pre>
<p>We define the Ackley function as a subclass for <code>OptimizationProblem</code>:</p>
<pre><code class="language-python">from botorch.test_functions import Ackley as _Ackley

class Ackley(OptimizationProblem):

    def __init__(self, dim: int):
        self._dim = dim
        self._ackley = _Ackley(dim=dim, negate=True)

    def __call__(self, x: torch.Tensor):
        return eval_objective(x, self._ackley)

    def lb(self) -&gt; np.ndarray:
        return self._ackley.bounds[0]

    def ub(self) -&gt; np.ndarray:
        return self._ackley.bounds[1]

    def dim(self) -&gt; int:
        return self._dim
</code></pre>
<h3 id="turbo-state"><a class="header" href="#turbo-state">TuRBO state</a></h3>
<p><a href="https://arxiv.org/abs/1910.01739">TuRBO</a> is an algorithm for scalable high-dimensional BO. We first define the state of a TuRBO instance:</p>
<pre><code class="language-python">@dataclass
class TurboState:
    dim: int # dimensionality of the search space
    batch_size: int # number of parallel function evaluations
    length: float = 0.8 # initial TR base length
    length_min: float = 0.5 ** 7 # min TR base length
    length_max: float = 1.6 # max TR base length
    failure_counter: int = 0 # number of times we did not make progress in optimizing the function
    failure_tolerance: int = float(&quot;nan&quot;)  # Note: Post-initialized, after more than failure_tolerance failures, we shrink the TR
    success_counter: int = 0 # number of times we made progress in optimizing the function
    success_tolerance: int = 10  # after that many successes, we increase the TR size
    best_value: float = -float(&quot;inf&quot;) # best value observed
    restart_triggered: bool = False # whether we want to restart this TR

    def __post_init__(self):
        # the failure tolerance increases with the dimensionality of the problem
        # and decreases with batch size as batches correspond to parallel
        # function evaluations
        self.failure_tolerance = math.ceil(
            max([4.0 / self.batch_size, float(self.dim) / self.batch_size])
        )
</code></pre>
<p>Depending on the \(y\)-value of the next point evaluated, we want to update the state;</p>
<pre><code class="language-python">def update_state(state, y_next):
    # if we made progress in optimizing the function
    if max(y_next) &gt; state.best_value + 1e-3 * math.fabs(state.best_value):
        state.success_counter += 1
        state.failure_counter = 0
    else:
        state.success_counter = 0
        state.failure_counter += 1
  
    # if we made state.success_tolerance many progresses
    if state.success_counter == state.success_tolerance:  # Expand trust region
        state.length = min(2.0 * state.length, state.length_max)
        state.success_counter = 0
    elif state.failure_counter == state.failure_tolerance:  # Shrink trust region
        state.length /= 2.0
        state.failure_counter = 0

    state.best_value = max(state.best_value, max(y_next).item())
    if state.length &lt; state.length_min:
        state.restart_triggered = True
    return state
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">from botorch.models import SingleTaskGP
import shutil

from scalable_gps.objective import Ackley, Griewank, Rover
from scalable_gps.optimizer import ScalableOptimizer

SAVE_PATH = &quot;/dbfs/FileStore/df/&quot;

try:
    shutil.rmtree(&quot;/databricks/driver/results&quot;)
except:
    pass

objectives = [Ackley(4), Griewank(10)]
#objectives = [Rover(60)]
for objective in objectives:
    for use_dkl in [False, True]:
        for rep in range(10):
            print(f&quot;Repetition {rep}&quot;)
            name = &quot;TurBO-DKL&quot; if use_dkl else &quot;TurBO&quot;
            turbo_kwargs = {
                'model': SingleTaskGP,
            }
            so = ScalableOptimizer(objective, num_parallel=4, turbo_kwargs={}, name=name, use_dkl=use_dkl, outer_iterations=5, save_path=SAVE_PATH) #&lt;--- This makes the files permanent
            so.optimize()
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">basedir = SAVE_PATH

algo_benchs = {}

for path, subdirs, files in os.walk(basedir):
    for name in files:
        bench = path.split(&quot;/&quot;)[-2]
        algo = path.split(&quot;/&quot;)[-1]
        y = pd.read_csv(os.path.join(path, name)).to_numpy()[:, -1]
        y = np.array([max(y[:i]) for i in range(1,len(y)+1)])
        if not bench in algo_benchs:
            algo_benchs[bench] = {}
        if not algo in algo_benchs[bench]:
            algo_benchs[bench][algo] = []
        algo_benchs[bench][algo].append(y)
        
fig, axs = plt.subplots(1, len(algo_benchs), )

for i, bench in enumerate(algo_benchs.keys()):
    ax = axs[i] if len(algo_benchs)&gt;1 else axs
    for algo, y in algo_benchs[bench].items():
        minlen = min([len(yy) for yy in y])
        y = [yy[:minlen] for yy in y]
        mean = np.mean(np.array(y), axis=0)
        ax.plot(np.arange(len(mean)), mean, label=algo)
    ax.set_title(bench)
    ax.legend()
</code></pre>
</div>
<div class="cell markdown">
<h1 id="we-now-define-some-plotting-utilities"><a class="header" href="#we-now-define-some-plotting-utilities">We now define some plotting utilities</a></h1>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">import os
from copy import copy
from glob import glob
from os.path import join
from typing import List

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
from scipy.stats import sem


# plot configuration

COLORS = {
    'TurBO': 'crimson',
    'TurBO-DKL': 'dodgerblue',
}

REGRETS = {
    'Branin': -0.397887,
    'Hartmann-3': 3.86278,
    'Hartmann-6': 3.32237,
    'Ackley-4': 0,
    'Griewank-10': 0,
    &quot;Roverplanning&quot;: 5,
}

INIT_NBRS = {
    'Branin': 3,
    'Hartmann-3': 4,
    'Hartmann-6': 7,
    'Ackley-4': 9,
    'Griewank-10': 11,
    &quot;Roverplanning&quot;:61
}


NAMES = {
    'TurBO': 'TurBO',
    'TurBO-DKL': 'TurBO-DKL',
}

PLOT_LAYOUT = dict(linewidth=2, markevery=20, markersize=8, markeredgewidth=5)


plt.rcParams['font.family'] = 'serif'


def process_funcs_args_kwargs(input_tuple):
    '''
    Helper function for preprocessing to assure that the format of (func, args, kwargs is correct)
    '''
    if len(input_tuple) != 3:
        raise ValueError(
            f'Expected 3 elements (callable, list, dict), got {len(input_tuple)}')

    if not callable(input_tuple[0]):
        raise ValueError('Preprocessing function is not callable.')

    if type(input_tuple[1]) is not list:
        raise ValueError(
            'Second argument to preprocessing function is not a list.')

    if type(input_tuple[2]) is not dict:
        raise ValueError(
            'Third argument to preprocessing function is not a dict.')

    return input_tuple


def filter_paths(all_paths, included_names=None):
    '''
    Filters the provided paths by the included names, if specified.
    Returns a tuple of the filtered paths and their names.
    '''
    all_names = [benchmark_path.split('/')[-1]
                 for benchmark_path in all_paths]
    if included_names is not None:
        used_paths = []
        used_names = []

        for path, name in zip(all_paths, all_names):
            if name in included_names:
                used_paths.append(path)
                used_names.append(name)
        return used_paths, used_names

    return all_paths, all_names


def get_files_from_experiment(experiment_name, benchmarks=None, acquisitions=None):
    '''
    For a specific experiment, gets a dictionary of all the {benchmark: {method: [output_file_paths]}}
    as a dict, including all benchmarks and acquisition functions unless specified otherwise in
    the arguments.
    '''
    paths_dict = {}
    all_benchmark_paths = glob(join(experiment_name, '*'))
    
    filtered_benchmark_paths, filtered_benchmark_names = filter_paths(
        all_benchmark_paths, benchmarks)
    # *ensures hidden files are not included
    for benchmark_path, benchmark_name in zip(filtered_benchmark_paths, filtered_benchmark_names):
        paths_dict[benchmark_name] = {}
        all_acq_paths = glob(join(benchmark_path, '*'))
        print(join(benchmark_path, '*'))
        filtered_acq_paths, filtered_acq_names = filter_paths(
            all_acq_paths, acquisitions)

        for acq_path, acq_name in zip(filtered_acq_paths, filtered_acq_names):
            run_paths = glob(join(acq_path, '*'))
            paths_dict[benchmark_name][acq_name] = run_paths
    
    print(paths_dict)
    return paths_dict


def get_dataframe(paths, funcs_args_kwargs=None, idx=0):
    '''
    For a given benchmark and acquisition function (i.e. the relevant list of paths), 
    creates the dataframe that includes the relevant metrics.

    Parameters:
        paths: The paths to the experiments that should be included in the dataframe
        funcs_args_kwargs: List of tuples of preprocessing arguments,
    '''
    # ensure we grab the name from the right spot in the file structure
    names = [path.split('/')[-1].split('.')[0] for path in paths]

    # just create the dataframe and set the column names
    complete_df = pd.DataFrame(columns=names)

    # tracks the maximum possible length of the dataframe
    max_length = None

    for path, name in zip(paths, names):
        per_run_df = pd.read_csv(path)
        # this is where we get either the predictions or the true values
        if funcs_args_kwargs is not None:
            for func_arg_kwarg in funcs_args_kwargs:
                func, args, kwargs = process_funcs_args_kwargs(func_arg_kwarg)
                per_run_df = func(per_run_df, name, *args, **kwargs)

        complete_df.loc[:, name] = per_run_df.iloc[:, 0]
    return complete_df


def get_min(df, run_name, metric, minimize=False):
    '''
    Make sure we only print the best values
    '''
    if minimize:
        min_observed = np.inf
    else:
        min_observed = -np.inf
    mins = np.zeros(len(df))

    for r, row in enumerate(df[metric]):
        if minimize:
            if row &lt; min_observed:
                min_observed = row
            mins[r] = min_observed
        else:
            if row &gt; min_observed:
                min_observed = row
            mins[r] = min_observed
    return pd.DataFrame(mins, columns=[run_name])


def compute_regret(df, run_name, regret, log=True):
    '''
    Compute regret depending on the function
    '''
    if log:
        mins = df.iloc[:, 0].apply(lambda x: x)
    else:
        mins = df.iloc[:, 0].apply(lambda x: x)

    return pd.DataFrame(mins)


def plot_optimization(data_dict, preprocessing=None, title='benchmark', xlabel='X', ylabel='Y', fix_range=None,
                      only_plot=-1, names=None, predictions=False, init=2, n_markers=20, n_std=1, show_ylabel=True,
                      maxlen=-1, plot_ax=None, first=True, show_noise=None):
    '''
    Plot all the optimization runs for the different benchmarks and optimization algorithms.
    '''
    if plot_ax is None:
        fig, ax = plt.subplots(figsize=(25, 16))
    else:
        ax = plot_ax
    min_ = np.inf
    for run_name, files in data_dict.items():
        plot_layout = copy(PLOT_LAYOUT)
        plot_layout['c'] = COLORS.get(run_name, 'k')
        plot_layout['label'] = NAMES.get(run_name, 'Nameless Run')
        if plot_layout['label'] == 'Nameless Run':
            continue
        plot_layout['marker'] = '*'
        plot_layout['markersize'] = 10
        plot_layout['markeredgewidth'] = 2
        # preprocess the data for the set of runs
        result_dataframe = get_dataframe(files, preprocessing)
        # convert to array and plot
        data_array = result_dataframe.to_numpy()
        markevery = np.floor(maxlen / n_markers).astype(int)
        plot_layout['markevery'] = markevery
        if maxlen &gt; 0:
            data_array = data_array[0:maxlen, :]
            
        y_mean = data_array.mean(axis=1)
        y_std = sem(data_array, axis=1)
        X = np.arange(1, maxlen + 1)
        if fix_range is not None:
            ax.set_ylim(fix_range)

        ax.plot(X, y_mean, **plot_layout)
        ax.fill_between(X, y_mean - n_std * y_std, y_mean + n_std *
                        y_std, alpha=0.1, color=plot_layout['c'])
        ax.plot(X, y_mean - n_std * y_std, alpha=0.5, color=plot_layout['c'])
        ax.plot(X, y_mean + n_std * y_std, alpha=0.5, color=plot_layout['c'])
        min_ = min((y_mean - n_std * y_std).min(), min_)

    ax.axvline(x=init, color='k', linestyle=':', linewidth=4)
    ax.tick_params(axis='x', labelsize=18)
    ax.tick_params(axis='y', labelsize=18)
    ax.set_xlabel(xlabel, fontsize=24)
    ax.set_title(title, fontsize=30)
    if show_ylabel:
        ax.set_ylabel(ylabel, fontsize=24)
    ax.legend()
    return ax


def plot(algos: List[str], functions: List[str], save_path: str, experiment_name: str, maxlen: int = 750):

    files = get_files_from_experiment(
        f'{os.getcwd()}/results', functions, algos)

    num_benchmarks = len(files)
    if num_benchmarks == 0:
        raise ValueError('No files')

    fig, ax = plt.subplots(1, num_benchmarks, figsize=(25, 9))
    if num_benchmarks == 1:
        ax = [ax]
    for benchmark_idx, (benchmark_name, paths) in enumerate(files.items()):
        preprocessing = [(get_min, [], {'metric': 'y'}), (compute_regret, [], {
            'log': True, 'regret': REGRETS[benchmark_name]})]
        plot_optimization(paths,
                          xlabel='Iteration',
                          ylabel='Log Regret',
                          n_std=2,
                          preprocessing=preprocessing,
                          maxlen=maxlen,
                          plot_ax=ax[benchmark_idx],
                          first=benchmark_idx == 0,
                          n_markers=10,
                          init=INIT_NBRS[benchmark_name],
                          title=benchmark_name,
                          show_ylabel=False,
                          )
    plt.tight_layout()
    plt.savefig(f&quot;{os.getcwd()}/{experiment_name}_{'_'.join(functions)}.pdf&quot;)
    plt.show()

</code></pre>
</div>
<div class="cell markdown">
<h1 id="next-we-plot-the-results"><a class="header" href="#next-we-plot-the-results">Next, we plot the results</a></h1>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">plot([&quot;TurBO-DKL&quot;],[&quot;Ackley-4&quot;], save_path=SAVE_PATH, experiment_name=&quot;plot_name&quot;, axlen=750) 
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">import pandas as pd
pd.read_csv(f&quot;{SAVE_PATH}/Ackley-4/TurBO-DKL/run_0.csv&quot;)
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">import pandas as pd
k = pd.read_csv(&quot;/databricks/driver/results/Ackley-4/TurBO-DKL/run_0.csv&quot;)
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-python">import scalable_gps
scalable_gps.__version__
</code></pre>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/05_deep_kernel_learning.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../../editors.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../contents/student-project-05_group-DistOpt/student-project-05_group-DistOpt/05_deep_kernel_learning.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../editors.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
