<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>998_EX_01_GraphXShortestWeightedPaths</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/010a_packageCells.html">010a_packageCells</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_02_IntroToSimulation.html">011_02_IntroToSimulation</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_03_IntroToML.html">011_03_IntroToML</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/012_UnsupervisedClustering_1MSongsKMeans_Intro.html">012_UnsupervisedClustering_1MSongsKMeans_Intro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL.html">013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore.html">014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/015_UnsupervisedClustering_1MSongsKMeans_Stage3Model.html">015_UnsupervisedClustering_1MSongsKMeans_Stage3Model</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition.html">016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/017_LAlgIntro.html">017_LAlgIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/018_LinRegIntro.html">018_LinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019_DistLAlgForLinRegIntro.html">019_DistLAlgForLinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_000_dataTypesProgGuide.html">019x_000_dataTypesProgGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_001_LocalVector.html">019x_001_LocalVector</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_002_LabeledPoint.html">019x_002_LabeledPoint</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_003_LocalMatrix.html">019x_003_LocalMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_004_DistributedMatrix.html">019x_004_DistributedMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_005_RowMatrix.html">019x_005_RowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_006_IndexedRowMatrix.html">019x_006_IndexedRowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_007_CoordinateMatrix.html">019x_007_CoordinateMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_008_BlockMatrix.html">019x_008_BlockMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/020_PowerPlantPipeline_02ModelTuneEvaluate.html">020_PowerPlantPipeline_02ModelTuneEvaluate</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/021_recognizeActivityByRandomForest.html">021_recognizeActivityByRandomForest</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/022_GraphFramesUserGuide.html">022_GraphFramesUserGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/023_OnTimeFlightPerformance.html">023_OnTimeFlightPerformance</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/030_PowerPlantPipeline_03ModelTuneEvaluateDeploy.html">030_PowerPlantPipeline_03ModelTuneEvaluateDeploy</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/036_ALS_MovieRecommender.html">036_ALS_MovieRecommender</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/998_EX_01_GraphXShortestWeightedPaths.html" class="active">998_EX_01_GraphXShortestWeightedPaths</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="extending-sparkgraphxlibshortestpaths-to-graphxshortestweightedpaths"><a class="header" href="#extending-sparkgraphxlibshortestpaths-to-graphxshortestweightedpaths">Extending spark.graphx.lib.ShortestPaths to GraphXShortestWeightedPaths</a></h1>
<h3 id="2016-2020-ivan-sadikov-and-raazesh-sainudiin"><a class="header" href="#2016-2020-ivan-sadikov-and-raazesh-sainudiin">2016-2020, Ivan Sadikov and Raazesh Sainudiin</a></h3>
<p>We extend Shortest Paths algorithm in Spark's GraphX Library to allow for user-specified edge-weights as an edge attribute.</p>
<p>This is part of <em>Project MEP: Meme Evolution Programme</em> and supported by databricks academic partners program.</p>
<p>The analysis is available in the following databricks notebook: * <a href="http://lamastex.org/lmse/mep/src/GraphXShortestWeightedPaths.html">http://lamastex.org/lmse/mep/src/GraphXShortestWeightedPaths.html</a></p>
<pre><code>Copyright 2016 Ivan Sadikov and Raazesh Sainudiin

Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre>
</div>
<div class="cell markdown">
<h3 id="lets-modify-shortest-paths-algorithm-to-allow-for-user-specified-edge-weights"><a class="header" href="#lets-modify-shortest-paths-algorithm-to-allow-for-user-specified-edge-weights">Let's modify shortest paths algorithm to allow for user-specified edge-weights</a></h3>
<p>Update shortest paths algorithm to work over edge attribute of edge-weights as Double, key concepts are: - we increment map with delta, which is <code>edge.attr</code> - edge attribute is anything numeric, tested on Double - infinity value is not infinity, but <code>Integer.MAX_VALUE</code></p>
<p>Modifying the following code: * https://github.com/apache/spark/blob/master/graphx/src/main/scala/org/apache/spark/graphx/lib/ShortestPaths.scala</p>
<p>Explained here: * http://note.yuhc.me/2015/03/graphx-pregel-shortest-path/</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.reflect.ClassTag
import org.apache.spark.graphx._

/**
 * Computes shortest weighted paths to the given set of landmark vertices, returning a graph where each
 * vertex attribute is a map containing the shortest-path distance to each reachable landmark.
 * Currently supports only Graph of [VD, Double], where VD is an arbitrary vertex type.
 */
object GraphXShortestWeightedPaths extends Serializable {
  /** Stores a map from the vertex id of a landmark to the distance to that landmark. */
  type SPMap = Map[VertexId, Double]
  // initial and infinity values, use to relax edges
  private val INITIAL = 0.0
  private val INFINITY = Int.MaxValue.toDouble

  private def makeMap(x: (VertexId, Double)*) = Map(x: _*)

  private def incrementMap(spmap: SPMap, delta: Double): SPMap = {
    spmap.map { case (v, d) =&gt; v -&gt; (d + delta) }
  }

  private def addMaps(spmap1: SPMap, spmap2: SPMap): SPMap = {
    (spmap1.keySet ++ spmap2.keySet).map {
      k =&gt; k -&gt; math.min(spmap1.getOrElse(k, INFINITY), spmap2.getOrElse(k, INFINITY))
    }.toMap
  }
  
  // at this point it does not really matter what vertex type is
  def run[VD](graph: Graph[VD, Double], landmarks: Seq[VertexId]): Graph[SPMap, Double] = {
    val spGraph = graph.mapVertices { (vid, attr) =&gt;
      // initial value for itself is 0.0 as Double
      if (landmarks.contains(vid)) makeMap(vid -&gt; INITIAL) else makeMap()
    }

    val initialMessage = makeMap()

    def vertexProgram(id: VertexId, attr: SPMap, msg: SPMap): SPMap = {
      addMaps(attr, msg)
    }

    def sendMessage(edge: EdgeTriplet[SPMap, Double]): Iterator[(VertexId, SPMap)] = {
      val newAttr = incrementMap(edge.dstAttr, edge.attr)
      if (edge.srcAttr != addMaps(newAttr, edge.srcAttr)) Iterator((edge.srcId, newAttr))
      else Iterator.empty
    }

    Pregel(spGraph, initialMessage)(vertexProgram, sendMessage, addMaps)
  }
}

println(&quot;Usage: val result = GraphXShortestWeightedPaths.run(graph, Seq(4L, 0L, 9L))&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>Usage: val result = GraphXShortestWeightedPaths.run(graph, Seq(4L, 0L, 9L))
import scala.reflect.ClassTag
import org.apache.spark.graphx._
defined object GraphXShortestWeightedPaths
</code></pre>
</div>
</div>
<div class="cell markdown">
<h3 id="generate-test-graph"><a class="header" href="#generate-test-graph">Generate test graph</a></h3>
<p>Generate simple graph with double weights for edges</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.util.Random

import org.apache.spark.graphx.{Graph, VertexId}
import org.apache.spark.graphx.util.GraphGenerators

// A graph with edge attributes containing distances
val graph: Graph[Long, Double] = GraphGenerators.logNormalGraph(sc, numVertices = 10, seed=123L).mapEdges { e =&gt; 
  // to make things nicer we assign 0 distance to itself
  if (e.srcId == e.dstId) 0.0 else Random.nextDouble()
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.util.Random
import org.apache.spark.graphx.{Graph, VertexId}
import org.apache.spark.graphx.util.GraphGenerators
graph: org.apache.spark.graphx.Graph[Long,Double] = org.apache.spark.graphx.impl.GraphImpl@45dcade2
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val landMarkVertexIds = Seq(4L, 0L, 9L)
val result = GraphXShortestWeightedPaths.run(graph, landMarkVertexIds)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>landMarkVertexIds: Seq[Long] = List(4, 0, 9)
result: org.apache.spark.graphx.Graph[GraphXShortestWeightedPaths.SPMap,Double] = org.apache.spark.graphx.impl.GraphImpl@4bc2f186
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Found shortest paths
println(result.vertices.collect.mkString(&quot;\n&quot;))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>(0,Map(0 -&gt; 0.0, 4 -&gt; 0.9508628404888835, 9 -&gt; 0.9591413283099168))
(8,Map(0 -&gt; 0.2934032163544852, 4 -&gt; 0.9801207594550188, 9 -&gt; 0.8196019765599419))
(1,Map(0 -&gt; 0.5802357924540097, 4 -&gt; 1.2669533355545433, 9 -&gt; 1.2752318233755766))
(9,Map(9 -&gt; 0.0, 0 -&gt; 0.5231864117917981, 4 -&gt; 0.7980365238526225))
(2,Map(0 -&gt; 0.2582682915929926, 4 -&gt; 0.8339520209319522, 9 -&gt; 0.5701009018719322))
(3,Map(0 -&gt; 0.0923559237731384, 4 -&gt; 0.18942157781466173, 9 -&gt; 0.1977000656356951))
(4,Map(4 -&gt; 0.0, 0 -&gt; 0.25873464218225106, 9 -&gt; 0.008278487821033353))
(5,Map(0 -&gt; 0.031742669363998166, 4 -&gt; 0.1288083234055215, 9 -&gt; 0.13708681122655486))
(6,Map(0 -&gt; 0.12059036542225454, 4 -&gt; 0.8073079085227881, 9 -&gt; 0.8155863963438215))
(7,Map(4 -&gt; 0.22844606564222758, 9 -&gt; 0.23672455346326093, 0 -&gt; 0.33818821718284775))
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">// edges with weights, make sure to check couple of shortest paths from above
display(result.edges.toDF)
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>srcId</th>
<th>dstId</th>
<th>attr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>0.0</td>
<td>1.0</td>
<td>0.6721979874068958</td>
</tr>
<tr class="odd">
<td>0.0</td>
<td>4.0</td>
<td>0.9508628404888835</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>6.0</td>
<td>0.45964542703175515</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>6.0</td>
<td>0.7349975451261668</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>0.0</td>
<td>0.2582682915929926</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>1.0</td>
<td>0.9280493920155959</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>4.0</td>
<td>0.8339520209319522</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>6.0</td>
<td>0.26091386534774674</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>6.0</td>
<td>0.9481996224496678</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>9.0</td>
<td>0.5701009018719322</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>2.0</td>
<td>0.8893068591814861</td>
</tr>
<tr class="even">
<td>3.0</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>5.0</td>
<td>6.061325440914023e-2</td>
</tr>
<tr class="even">
<td>3.0</td>
<td>7.0</td>
<td>0.26415564719487117</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>8.0</td>
<td>0.5847037097670544</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>0.0</td>
<td>0.373044758393941</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>3.0</td>
<td>0.16637871840911267</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>5.0</td>
<td>0.8133138055926398</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>7.0</td>
<td>0.5329270151953733</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>7.0</td>
<td>0.7076376180464232</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>9.0</td>
<td>0.3590440724653333</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>9.0</td>
<td>8.278487821033353e-3</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>0.0</td>
<td>3.1742669363998166e-2</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>1.0</td>
<td>0.4799303618281624</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>2.0</td>
<td>0.9373917774347413</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>3.0</td>
<td>5.426676615013515e-2</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>4.0</td>
<td>0.1288083234055215</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>0.0</td>
<td>0.12059036542225454</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>1.0</td>
<td>1.867282877196641e-2</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>2.0</td>
<td>0.9882878315838144</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>3.0</td>
<td>0.944141072288605</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>5.0</td>
<td>0.6784995851172666</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>8.0</td>
<td>0.16318250935765966</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>2.0</td>
<td>7.991992558985517e-2</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>2.0</td>
<td>0.7824158528877193</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>2.0</td>
<td>0.17715746355547157</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>4.0</td>
<td>0.7655621066580156</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>4.0</td>
<td>0.2580382514924928</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>4.0</td>
<td>0.22844606564222758</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>8.0</td>
<td>0.750024180696321</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>9.0</td>
<td>0.9228699021998864</td>
</tr>
<tr class="even">
<td>8.0</td>
<td>1.0</td>
<td>0.351758945103697</td>
</tr>
<tr class="odd">
<td>8.0</td>
<td>2.0</td>
<td>0.24950107468800975</td>
</tr>
<tr class="even">
<td>8.0</td>
<td>3.0</td>
<td>0.9928995269181429</td>
</tr>
<tr class="odd">
<td>8.0</td>
<td>6.0</td>
<td>0.17281285093223064</td>
</tr>
<tr class="even">
<td>9.0</td>
<td>0.0</td>
<td>0.5838217791812277</td>
</tr>
<tr class="odd">
<td>9.0</td>
<td>2.0</td>
<td>0.26491812019880556</td>
</tr>
<tr class="even">
<td>9.0</td>
<td>4.0</td>
<td>0.853261480233851</td>
</tr>
<tr class="odd">
<td>9.0</td>
<td>7.0</td>
<td>0.5695904582103949</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">display(graph.edges.toDF) // this is the directed weighted edge of the graph
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>srcId</th>
<th>dstId</th>
<th>attr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>0.0</td>
<td>1.0</td>
<td>0.2473870305881326</td>
</tr>
<tr class="odd">
<td>0.0</td>
<td>4.0</td>
<td>0.7593678671727498</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>6.0</td>
<td>0.4721793531500751</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>6.0</td>
<td>0.7565157046946671</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>0.0</td>
<td>0.8601376666144385</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>1.0</td>
<td>0.15474243507003416</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>4.0</td>
<td>0.17585136043466876</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>6.0</td>
<td>0.9762506825428003</td>
</tr>
<tr class="odd">
<td>2.0</td>
<td>6.0</td>
<td>0.8022953138023812</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>9.0</td>
<td>0.8898859140300339</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>2.0</td>
<td>0.23688722482284008</td>
</tr>
<tr class="even">
<td>3.0</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>5.0</td>
<td>0.6621552329080445</td>
</tr>
<tr class="even">
<td>3.0</td>
<td>7.0</td>
<td>0.6189436789554128</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>8.0</td>
<td>0.7648758038805598</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>0.0</td>
<td>0.9568298106188533</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>3.0</td>
<td>0.41779642900620517</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>5.0</td>
<td>0.2897812470698585</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>7.0</td>
<td>0.9845657600597383</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>7.0</td>
<td>0.6752427687212571</td>
</tr>
<tr class="odd">
<td>4.0</td>
<td>9.0</td>
<td>0.23033960072928972</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>9.0</td>
<td>0.6688651818696816</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>0.0</td>
<td>0.4544165543058408</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>1.0</td>
<td>3.778698342738085e-2</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>2.0</td>
<td>0.8383018223597426</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>3.0</td>
<td>0.7890454146717444</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>4.0</td>
<td>0.3471895990573223</td>
</tr>
<tr class="even">
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>0.0</td>
<td>0.2431403242371375</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>1.0</td>
<td>0.6109097064072662</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>2.0</td>
<td>0.7701858934760617</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>3.0</td>
<td>0.12066591357902912</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>5.0</td>
<td>0.5034427240618765</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>6.0</td>
<td>6.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>6.0</td>
<td>8.0</td>
<td>0.616288715486008</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>2.0</td>
<td>7.870712177892414e-2</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>2.0</td>
<td>0.5147452602931151</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>2.0</td>
<td>0.8214716030697653</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>4.0</td>
<td>0.25578984521277015</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>4.0</td>
<td>0.3583207455757458</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>4.0</td>
<td>8.320072407893553e-2</td>
</tr>
<tr class="even">
<td>7.0</td>
<td>8.0</td>
<td>0.36976177580734204</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>9.0</td>
<td>0.5704097005469446</td>
</tr>
<tr class="even">
<td>8.0</td>
<td>1.0</td>
<td>0.20123008667210507</td>
</tr>
<tr class="odd">
<td>8.0</td>
<td>2.0</td>
<td>0.7558945801315478</td>
</tr>
<tr class="even">
<td>8.0</td>
<td>3.0</td>
<td>0.5592884924812593</td>
</tr>
<tr class="odd">
<td>8.0</td>
<td>6.0</td>
<td>0.5437831714308268</td>
</tr>
<tr class="even">
<td>9.0</td>
<td>0.0</td>
<td>0.7347489314741307</td>
</tr>
<tr class="odd">
<td>9.0</td>
<td>2.0</td>
<td>0.2611206797801059</td>
</tr>
<tr class="even">
<td>9.0</td>
<td>4.0</td>
<td>0.6543183939764342</td>
</tr>
<tr class="odd">
<td>9.0</td>
<td>7.0</td>
<td>0.6768117581780281</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// now let us collect the shortest distance between every vertex and every landmark vertex
// to manipulate scala maps that are vertices of the result see: http://docs.scala-lang.org/overviews/collections/maps.html
// a quick point: http://stackoverflow.com/questions/28769367/scala-map-a-map-to-list-of-tuples
val shortestDistsVertex2Landmark = result.vertices.flatMap(GxSwpSPMap =&gt; {
  GxSwpSPMap._2.toSeq.map(x =&gt; (GxSwpSPMap._1, x._1, x._2)) // to get triples: vertex, landmarkVertex, shortest_distance
})
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>shortestDistsVertex2Landmark: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, org.apache.spark.graphx.VertexId, Double)] = MapPartitionsRDD[3128] at flatMap at command-2744653148555415:4
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">shortestDistsVertex2Landmark.collect.mkString(&quot;\n&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res4: String =
(0,0,0.0)
(0,4,0.9508628404888835)
(0,9,0.9591413283099168)
(8,0,0.2934032163544852)
(8,4,0.9801207594550188)
(8,9,0.8196019765599419)
(1,0,0.5802357924540097)
(1,4,1.2669533355545433)
(1,9,1.2752318233755766)
(9,9,0.0)
(9,0,0.5231864117917981)
(9,4,0.7980365238526225)
(2,0,0.2582682915929926)
(2,4,0.8339520209319522)
(2,9,0.5701009018719322)
(3,0,0.0923559237731384)
(3,4,0.18942157781466173)
(3,9,0.1977000656356951)
(4,4,0.0)
(4,0,0.25873464218225106)
(4,9,0.008278487821033353)
(5,0,0.031742669363998166)
(5,4,0.1288083234055215)
(5,9,0.13708681122655486)
(6,0,0.12059036542225454)
(6,4,0.8073079085227881)
(6,9,0.8155863963438215)
(7,4,0.22844606564222758)
(7,9,0.23672455346326093)
(7,0,0.33818821718284775)
</code></pre>
</div>
</div>
<div class="cell markdown">
<h4 id="lets-make-a-dataframe-for-visualizing-pairwise-matrix-plots"><a class="header" href="#lets-make-a-dataframe-for-visualizing-pairwise-matrix-plots">Let's make a DataFrame for visualizing pairwise matrix plots</a></h4>
<p>We want to make 4 columns in this example as follows (note actual values change for each realisation of graph!):</p>
<pre><code>landmark_Id1 (&quot;0&quot;),   landmarkID2 (&quot;4&quot;), landmarkId3 (&quot;9&quot;),  srcVertexId
------------------------------------------------------------------------
0.0,                  0.7425..,          0.8718,                0
0.924...,             1.2464..,          1.0472,                1
...
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// http://alvinalexander.com/scala/how-to-sort-map-in-scala-key-value-sortby-sortwith
// we need this to make sure that the maps are ordered by the keys for ensuring unique column values
import scala.collection.immutable.ListMap
import sqlContext.implicits._
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.collection.immutable.ListMap
import sqlContext.implicits._
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala"> // recall our landmark vertices in landMarkVertexIds. let's use their Strings for names
val unorderedNamedLandmarkVertices = landMarkVertexIds.map(id =&gt; (id, id.toString) )
val orderedNamedLandmarkVertices = ListMap(unorderedNamedLandmarkVertices.sortBy(_._1):_*)
val orderedLandmarkVertexNames = orderedNamedLandmarkVertices.toSeq.map(x =&gt; x._2)
orderedLandmarkVertexNames.mkString(&quot;, &quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>unorderedNamedLandmarkVertices: Seq[(Long, String)] = List((4,4), (0,0), (9,9))
orderedNamedLandmarkVertices: scala.collection.immutable.ListMap[Long,String] = ListMap(0 -&gt; 0, 4 -&gt; 4, 9 -&gt; 9)
orderedLandmarkVertexNames: Seq[String] = Vector(0, 4, 9)
res5: String = 0, 4, 9
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// this is going to be our column names
val columnNames:Seq[String] = orderedLandmarkVertexNames :+ &quot;srcVertexId&quot;
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>columnNames: Seq[String] = Vector(0, 4, 9, srcVertexId)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// a case class to make a data-frame quickly from the result
case class SeqOfDoublesAndsrcVertexId(shortestDistances: Seq[Double], srcVertexId: VertexId)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>defined class SeqOfDoublesAndsrcVertexId
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val shortestDistsSeqFromVertex2Landmark2DF = result.vertices.map(GxSwpSPMap =&gt; {
  //GxSwpSPMap._2.toSeq.map(x =&gt; (GxSwpSPMap._1, x._1, x._2)) // from before to get triples: vertex, landmarkVertex, shortest_distance
  val v = GxSwpSPMap._1
  val a = ListMap(GxSwpSPMap._2.toSeq.sortBy(_._1):_*).toSeq.map(x =&gt; x._2)
  val d = (a,v)
  d
}).map(x =&gt; SeqOfDoublesAndsrcVertexId(x._1, x._2)).toDF()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>shortestDistsSeqFromVertex2Landmark2DF: org.apache.spark.sql.DataFrame = [shortestDistances: array&lt;double&gt;, srcVertexId: bigint]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(shortestDistsSeqFromVertex2Landmark2DF) // but this dataframe needs the first column exploded into 3 columns
</code></pre>
</div>
<div class="cell markdown">
<p>Now we want to make separate columns for each distance in the Sequence in column 'shortestDistances'.</p>
<p>Let us use the following ideas for this: * https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/3741049972324885/2662535171379268/4413065072037724/latest.html</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// this is from https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/3741049972324885/2662535171379268/4413065072037724/latest.html
import org.apache.spark.sql.{Column, DataFrame}
import org.apache.spark.sql.functions.{lit, udf}

// UDF to extract i-th element from array column
//val elem = udf((x: Seq[Int], y: Int) =&gt; x(y))
val elem = udf((x: Seq[Double], y: Int) =&gt; x(y)) // modified for Sequence of Doubles

// Method to apply 'elem' UDF on each element, requires knowing length of sequence in advance
def split(col: Column, len: Int): Seq[Column] = {
  for (i &lt;- 0 until len) yield { elem(col, lit(i)).as(s&quot;$col($i)&quot;) }
}

// Implicit conversion to make things nicer to use, e.g. 
// select(Column, Seq[Column], Column) is converted into select(Column*) flattening sequences
implicit class DataFrameSupport(df: DataFrame) {
  def select(cols: Any*): DataFrame = {
    var buffer: Seq[Column] = Seq.empty
    for (col &lt;- cols) {
      if (col.isInstanceOf[Seq[_]]) {
        buffer = buffer ++ col.asInstanceOf[Seq[Column]]
      } else {
        buffer = buffer :+ col.asInstanceOf[Column]
      }
    }
    df.select(buffer:_*)
  }
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.sql.{Column, DataFrame}
import org.apache.spark.sql.functions.{lit, udf}
elem: org.apache.spark.sql.expressions.UserDefinedFunction = SparkUserDefinedFunction($Lambda$7813/1969990681@1a441b0e,DoubleType,List(Some(class[value[0]: array&lt;double&gt;]), Some(class[value[0]: int])),None,false,true)
split: (col: org.apache.spark.sql.Column, len: Int)Seq[org.apache.spark.sql.Column]
defined class DataFrameSupport
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val shortestDistsFromVertex2Landmark2DF = shortestDistsSeqFromVertex2Landmark2DF.select(split($&quot;shortestDistances&quot;, 3), $&quot;srcVertexId&quot;)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>shortestDistsFromVertex2Landmark2DF: org.apache.spark.sql.DataFrame = [shortestDistances(0): double, shortestDistances(1): double ... 2 more fields]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(shortestDistsFromVertex2Landmark2DF)
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>shortestDistances(0)</th>
<th>shortestDistances(1)</th>
<th>shortestDistances(2)</th>
<th>srcVertexId</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td>0.9508628404888835</td>
<td>0.9591413283099168</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>0.2934032163544852</td>
<td>0.9801207594550188</td>
<td>0.8196019765599419</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td>0.5802357924540097</td>
<td>1.2669533355545433</td>
<td>1.2752318233755766</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>0.5231864117917981</td>
<td>0.7980365238526225</td>
<td>0.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td>0.2582682915929926</td>
<td>0.8339520209319522</td>
<td>0.5701009018719322</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>9.23559237731384e-2</td>
<td>0.18942157781466173</td>
<td>0.1977000656356951</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>0.25873464218225106</td>
<td>0.0</td>
<td>8.278487821033353e-3</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>3.1742669363998166e-2</td>
<td>0.1288083234055215</td>
<td>0.13708681122655486</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>0.12059036542225454</td>
<td>0.8073079085227881</td>
<td>0.8155863963438215</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>0.33818821718284775</td>
<td>0.22844606564222758</td>
<td>0.23672455346326093</td>
<td>7.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// now let's give it our names based on the landmark vertex Ids
val shortestDistsFromVertex2Landmark2DF = shortestDistsSeqFromVertex2Landmark2DF.select(split($&quot;shortestDistances&quot;, 3), $&quot;srcVertexId&quot;).toDF(columnNames:_*)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>shortestDistsFromVertex2Landmark2DF: org.apache.spark.sql.DataFrame = [0: double, 4: double ... 2 more fields]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(shortestDistsFromVertex2Landmark2DF)
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>0</th>
<th>4</th>
<th>9</th>
<th>srcVertexId</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td>0.9508628404888835</td>
<td>0.9591413283099168</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>0.2934032163544852</td>
<td>0.9801207594550188</td>
<td>0.8196019765599419</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td>0.5802357924540097</td>
<td>1.2669533355545433</td>
<td>1.2752318233755766</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>0.5231864117917981</td>
<td>0.7980365238526225</td>
<td>0.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td>0.2582682915929926</td>
<td>0.8339520209319522</td>
<td>0.5701009018719322</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>9.23559237731384e-2</td>
<td>0.18942157781466173</td>
<td>0.1977000656356951</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>0.25873464218225106</td>
<td>0.0</td>
<td>8.278487821033353e-3</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>3.1742669363998166e-2</td>
<td>0.1288083234055215</td>
<td>0.13708681122655486</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>0.12059036542225454</td>
<td>0.8073079085227881</td>
<td>0.8155863963438215</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>0.33818821718284775</td>
<td>0.22844606564222758</td>
<td>0.23672455346326093</td>
<td>7.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">display(shortestDistsFromVertex2Landmark2DF.select($&quot;0&quot;,$&quot;4&quot;,$&quot;9&quot;))
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>0</th>
<th>4</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td>0.9508628404888835</td>
<td>0.9591413283099168</td>
</tr>
<tr class="even">
<td>0.2934032163544852</td>
<td>0.9801207594550188</td>
<td>0.8196019765599419</td>
</tr>
<tr class="odd">
<td>0.5802357924540097</td>
<td>1.2669533355545433</td>
<td>1.2752318233755766</td>
</tr>
<tr class="even">
<td>0.5231864117917981</td>
<td>0.7980365238526225</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>0.2582682915929926</td>
<td>0.8339520209319522</td>
<td>0.5701009018719322</td>
</tr>
<tr class="even">
<td>9.23559237731384e-2</td>
<td>0.18942157781466173</td>
<td>0.1977000656356951</td>
</tr>
<tr class="odd">
<td>0.25873464218225106</td>
<td>0.0</td>
<td>8.278487821033353e-3</td>
</tr>
<tr class="even">
<td>3.1742669363998166e-2</td>
<td>0.1288083234055215</td>
<td>0.13708681122655486</td>
</tr>
<tr class="odd">
<td>0.12059036542225454</td>
<td>0.8073079085227881</td>
<td>0.8155863963438215</td>
</tr>
<tr class="even">
<td>0.33818821718284775</td>
<td>0.22844606564222758</td>
<td>0.23672455346326093</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../contents/000_2-sds-3-x-ml/036_ALS_MovieRecommender.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../contents/000_2-sds-3-x-ml/036_ALS_MovieRecommender.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
