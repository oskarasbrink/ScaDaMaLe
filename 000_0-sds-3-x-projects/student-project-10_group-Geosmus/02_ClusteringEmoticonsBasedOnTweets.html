
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clustering emoticons based on tweets &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dynamic Tweet Maps" href="03_Dynamic_Tweet_Maps.html" />
    <link rel="prev" title="Twitter Streaming Using Geolocation and Emoji Based Sentiment Analysis" href="01_Introduction.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
     Login to databricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
     Import Course Content Now!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment">
     Cloud-free Computing Environment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
     Multi-lingual Notebooks
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Scala Crash Course
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
     Scala Crash Course Continued
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
     HOMEWORK on RDD Transformations and Actions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
     Piped RDDs and Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
     Pipe RDDs to System Commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
     mapPartitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
     foreachPartition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
     Numerically Rigorous Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
     Usage instructions for IsIt1or2Coins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
     Word Count on US State of the Union (SoU) Addresses
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
     Spark Sql Programming Guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
     Getting Started - Exercise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
     Data Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
     Data Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
     Performance Tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
     Distributed SQL Engine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
     Distributed SQL Engine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
     SQL Pivoting since Spark 2.4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
     Load Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
     Pivoting in SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
     Pivoting with Multiple Aggregate Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
     Pivoting with Multiple Grouping Columns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
     Pivoting with Multiple Pivot Columns
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Extract Transform and Load
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
     Piped RDDs and Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
     From a Local Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
     glom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
     Checkpointing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
     Pipe RDDs to System Commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
     mapPartitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
     foreachPartition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
     Numerically Rigorous Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
     Usage instructions for IsIt1or2Coins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
     Parsing the output from
     <code class="docutils literal notranslate">
      <span class="pre">
       IsIt1or2Coins
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
     Providing case classes for input and output for easy spark communication
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Trends in Money and News
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/000_TrendsInFinancialStocksAndNewsEvents.html">
   Trends in Financial Stocks and News Events
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/00a_FX1M.html">
     Historical FX-1-M Financial Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/00b_yfinance.html">
     yfinance Stock Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/000a_finance_utils.html">
     Utilities Needed for Financial Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/000b_gdelt_utils.html">
     Utilities Needed for Mass Media Data
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/01_trend_calculus_showcase.html">
   Finding trends in oil price data.
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/02_streamable_trend_calculus.html">
     Streaming Trend Calculus with Maximum Necessary Reversals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/03_streamable_trend_calculus_estimators.html">
     Markov Model for Trend Calculus
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/030_Spark_GDELT_project_001.html">
   Plugging into GDELT Mass Media Streams
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/030a_gdelt_EOI_detection.html">
     Detecting Events of Interest to OIL/GAS Price Trends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/030b_gdelt_POI_detection.html">
     Detecting Persons of Interest to OIL/GAS Price Trends
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distributed Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
     Distributed deep learning training using TensorFlow and Keras with HorovodRunner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
     Distributed deep learning training using PyTorch with HorovodRunner for MNIST
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-01_group-TheTwoCultures/00_download_data.html">
   The two cultures
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/01_load_data.html">
     Preprocessing and loading the relevant data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/02_logisticregression.html">
     The two cultures - Classifying threads with logistic regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/03_word2vec.html">
     Classification using Word2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/04_LDA.html">
     Topic Modeling with LDA
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/01_SceneGraphMotifs.html">
   Exploring the GQA Scene Graph Dataset Structure and Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-03_group-GuangyiZhang/01_triads.html">
   Signed Triads in Social Media
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/01_DistributedSVD.html">
   Distributed Linear Algebra
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/02_CollaborativeFiltering.html">
     Music Recommendation System
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html">
   Wikipedia analysis using Latent Dirichlet Allocation (LDA)
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html">
   Unsupervised clustering of particle physics data with distributed training
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/01_data_and_preprocessing.html">
     Data and preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/02_dl_single_machine.html">
     UCluster on a single machine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/03_dl_horovod.html">
     UCluster with distributed learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/04_evaluate.html">
     Evaluation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html">
   Motif Finding
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html#application">
   Application
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/02_Data_Processing.html">
     Data Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html#examples">
     Examples
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html">
   Distributed ensembles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#distributed-ensembles-prediction-api">
   Distributed ensembles prediction API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#application-example-distributed-predictions">
   Application example: Distributed predictions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#application-example-out-of-distribution-detection">
   Application example: Out of distribution detection
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/01_Introduction.html">
   Topic Modeling with SARS-Cov-2 Genome üß¨
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/02_Data_Processing.html">
     Data Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/03_LDA.html">
     LDA - Extract Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html">
     Classification CountVector
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html">
     Load processed data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#explore-data">
     Explore data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#classification">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#evaluation">
     Evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/06_Results.html">
     Results and Conclusion
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="01_Introduction.html">
   Twitter Streaming Using Geolocation and Emoji Based Sentiment Analysis
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Clustering emoticons based on tweets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_Dynamic_Tweet_Maps.html">
     Dynamic Tweet Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_conclusion.html">
     Conclusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_appendix_get-cc-data.html">
     Notebook for collecting tweets with country codes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_a_appendix_extendedTwitterUtils2run.html">
     ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_a_appendix_extendedTwitterUtils2run.html#extended-spark-streaming-twitter-twitterutils">
     Extended spark.streaming.twitter.TwitterUtils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_b_appendix_TTTDFfunctions.html">
     ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-11_group-Sketchings/00_QuantileEstimation.html">
   Anomaly Detection with Iterative Quantile Estimation and T-digest
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/00_ProjectDescriptionAndPlanning.html">
   Project Description and Introduction
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_DownloadFilesPeriodicallyScript.html">
     Download Files Periodically
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_StreamToFile.html">
     Stream to parquet file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html">
     Loading data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html#preprocessing">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html">
     Loading data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html#preprocessing">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html">
     This notebook is for explosive analysis of features in data.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#statistics-of-invariant-features">
     Statistics of invariant features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-invariant-features">
     Correlation between invariant features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-new-case-per-million-total-case-new-death-per-million-total-death-per-million-reproduction-rate-and-stringency-index">
     Correlation between new case per million, total case, new death per million, total death per million, reproduction rate and stringency index.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html">
     Show reproduction rate of selected countries i.e. Sweden, Germany, Danmark, Finland, Norway
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#visualize-total-cases-total-deaths-new-cases-and-new-deaths-during-pandemic">
     Visualize total cases, total deaths, new cases and new deaths during pandemic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#total-deaths">
     Total Deaths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-cases">
     New Cases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-deaths">
     New Deaths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/05_Clustering.html">
     Clustering of country features in the Covid 19 dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/06_DataPredicton_LR.html">
     Prediction with Linear Regression (LR) Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/07_DataPredicton_ARIMA.html">
     Prediction with Time Series model - ARIMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/08_DataPrediction_GP.html">
     Prediction with time series model - Gaussian Processes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html">
   Genomics Analysis with Glow and Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#load-libs-and-define-helper-functions">
   Load libs and define helper functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#read-data">
   Read data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#pca">
   PCA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#predicting-ethinicity">
   Predicting Ethinicity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#filtering-of-snps-based-on-chi-squared-test">
   Filtering of SNPs based on chi-squared test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-14_group-NullHypothesisEvaluationCriteria/00_distributed_combinatorial_bandit.html">
   Distributed combinatorial bandits
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/00_video.html">
   Reinforcement Learning for Intraday Trading
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/01_rl_intraday_trading.html">
     Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/01_rl_intraday_trading.html#summary-and-outlook">
     Summary and Outlook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html">
     Reinforcement Learning - Distributed model tuning with Elephas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#elephas">
     Elephas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#notes-to-the-elephas-training">
     Notes to the elephas training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html">
     Resources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html">
   Intrusion Detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html#preparing-the-dataframe-for-training-classifers">
   Preparing the DataFrame for training classifers
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/00_introduction.html">
   Density Estimation via Voronoi Diagrams in High Dimensions
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/01_methodology.html">
     Methodology
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/02_gaussian_analysis.html">
     Gaussian Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/03_robotics_dataset.html">
     Robotics Dataset
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-18_group-ProjectRL/00_Problem_Description.html">
   Recommender System
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-18_group-ProjectRL/01_The_ALS_method.html">
     <span class="xref myst">
      The Alternating Least Squares method (ALS)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-18_group-ProjectRL/01_The_ALS_method.html#on-a-small-dataset">
     <span class="xref myst">
      On a small dataset
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-18_group-ProjectRL/01_The_ALS_method.html#on-a-large-dataset-netflix-dataset">
     <span class="xref myst">
      On a large dataset - Netflix dataset
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-18_group-ProjectRL/02_Extensions.html">
     Extensions
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html">
   Fundamental Matrix
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-20_group-Generalization/01_Background.html">
   MixUp and Generalization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/02_Random_Forest.html">
     Random Forests and MixUp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/03_CNN_MNIST.html">
     CNN for MNIST
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/04_CNN_Intel_Image.html">
     CNN for Intel Image Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/05_Horovod_test.html">
     CNNs and MixUp with Horovod
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/00_introduction.html">
   Graph Spectral Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/01_preprocess_data.html">
     Preprocess the data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/02_generate_graphs.html">
     Generate random graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/03_compute_rsvd.html">
     Compute RSVD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/04_analyse_eigenvalues.html">
     Analyse the eigenvalue spectrum
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-22_group-SwapWithDDP/00_Introduction.html">
   SWAP
   <em>
    With
   </em>
   DDP
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-22_group-SwapWithDDP/01_SWAP_with_DDP.html">
     SWAP
     <em>
      With
     </em>
     DDP
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-10_group-Geosmus/02_ClusteringEmoticonsBasedOnTweets.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-10_group-Geosmus/02_ClusteringEmoticonsBasedOnTweets.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-cluster-emoticons">
   How to cluster emoticons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clustering-using-python">
   Clustering using python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#locally-linear-embedding">
     Locally linear embedding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#t-distributed-stochastic-neighbor-embedding-t-sne">
     t-distributed Stochastic Neighbor Embedding (t-SNE)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hierarchical-clustering">
     Hierarchical clustering
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering-the-tweets-by-cluster">
   Filtering the tweets by cluster
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="clustering-emoticons-based-on-tweets">
<h1>Clustering emoticons based on tweets<a class="headerlink" href="#clustering-emoticons-based-on-tweets" title="Permalink to this headline">¬∂</a></h1>
<p>In this notebook we will look at the symbols in the Unicode block
<em>Emoticons</em>, which contains 80 commonly used emojis. The goal is to find
out which emoticons are related to each other and hopefully finding
clusters that correspond vaguely to some sentiment of an emoticon. We
will do this in a fairly na√Øve way since our focus was on learning
streaming, spark and scala. First let‚Äôs have a look at the emojis in
question, they are presented in the table from Wikipedia below.</p>
<p>In the following two cells we create a list of these emoticons and load
the previously collected dataset of tweets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">val</span> <span class="n">emoticonsList</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span>
  <span class="s2">&quot;üòÄ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòÅ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòÇ&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòÉ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòÑ&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòÖ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòÜ&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòá&quot;</span><span class="p">,</span> <span class="s2">&quot;üòà&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòâ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòä&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòã&quot;</span><span class="p">,</span> <span class="s2">&quot;üòå&quot;</span><span class="p">,</span> <span class="s2">&quot;üòç&quot;</span><span class="p">,</span> <span class="s2">&quot;üòé&quot;</span><span class="p">,</span> <span class="s2">&quot;üòè&quot;</span><span class="p">,</span>
  <span class="s2">&quot;üòê&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòë&quot;</span><span class="p">,</span> <span class="s2">&quot;üòí&quot;</span><span class="p">,</span>	<span class="s2">&quot;üòì&quot;</span><span class="p">,</span> <span class="s2">&quot;üòî&quot;</span><span class="p">,</span> <span class="s2">&quot;üòï&quot;</span><span class="p">,</span> <span class="s2">&quot;üòñ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòó&quot;</span><span class="p">,</span> <span class="s2">&quot;üòò&quot;</span><span class="p">,</span> <span class="s2">&quot;üòô&quot;</span><span class="p">,</span> <span class="s2">&quot;üòö&quot;</span><span class="p">,</span> <span class="s2">&quot;üòõ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòú&quot;</span><span class="p">,</span> <span class="s2">&quot;üòù&quot;</span><span class="p">,</span> <span class="s2">&quot;üòû&quot;</span><span class="p">,</span> <span class="s2">&quot;üòü&quot;</span><span class="p">,</span>
  <span class="s2">&quot;üò†&quot;</span><span class="p">,</span>	<span class="s2">&quot;üò°&quot;</span><span class="p">,</span> <span class="s2">&quot;üò¢&quot;</span><span class="p">,</span> <span class="s2">&quot;üò£&quot;</span><span class="p">,</span> <span class="s2">&quot;üò§&quot;</span><span class="p">,</span> <span class="s2">&quot;üò•&quot;</span><span class="p">,</span> <span class="s2">&quot;üò¶&quot;</span><span class="p">,</span> <span class="s2">&quot;üòß&quot;</span><span class="p">,</span> <span class="s2">&quot;üò®&quot;</span><span class="p">,</span> <span class="s2">&quot;üò©&quot;</span><span class="p">,</span> <span class="s2">&quot;üò™&quot;</span><span class="p">,</span> <span class="s2">&quot;üò´&quot;</span><span class="p">,</span> <span class="s2">&quot;üò¨&quot;</span><span class="p">,</span> <span class="s2">&quot;üò≠&quot;</span><span class="p">,</span> <span class="s2">&quot;üòÆ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòØ&quot;</span><span class="p">,</span>
  <span class="s2">&quot;üò∞&quot;</span><span class="p">,</span>	<span class="s2">&quot;üò±&quot;</span><span class="p">,</span> <span class="s2">&quot;üò≤&quot;</span><span class="p">,</span> <span class="s2">&quot;üò≥&quot;</span><span class="p">,</span> <span class="s2">&quot;üò¥&quot;</span><span class="p">,</span> <span class="s2">&quot;üòµ&quot;</span><span class="p">,</span> <span class="s2">&quot;üò∂&quot;</span><span class="p">,</span> <span class="s2">&quot;üò∑&quot;</span><span class="p">,</span> <span class="s2">&quot;üò∏&quot;</span><span class="p">,</span> <span class="s2">&quot;üòπ&quot;</span><span class="p">,</span> <span class="s2">&quot;üò∫&quot;</span><span class="p">,</span> <span class="s2">&quot;üòª&quot;</span><span class="p">,</span> <span class="s2">&quot;üòº&quot;</span><span class="p">,</span> <span class="s2">&quot;üòΩ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòæ&quot;</span><span class="p">,</span> <span class="s2">&quot;üòø&quot;</span><span class="p">,</span>
  <span class="s2">&quot;üôÄ&quot;</span><span class="p">,</span>	<span class="s2">&quot;üôÅ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôÇ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôÉ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôÑ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôÖ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôÜ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôá&quot;</span><span class="p">,</span> <span class="s2">&quot;üôà&quot;</span><span class="p">,</span> <span class="s2">&quot;üôâ&quot;</span><span class="p">,</span> <span class="s2">&quot;üôä&quot;</span><span class="p">,</span> <span class="s2">&quot;üôã&quot;</span><span class="p">,</span> <span class="s2">&quot;üôå&quot;</span><span class="p">,</span> <span class="s2">&quot;üôç&quot;</span><span class="p">,</span> <span class="s2">&quot;üôé&quot;</span><span class="p">,</span> <span class="s2">&quot;üôè&quot;</span>
<span class="p">)</span>

<span class="n">val</span> <span class="n">emoticonsMap</span> <span class="o">=</span> <span class="n">emoticonsList</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">toMap</span>
<span class="n">val</span> <span class="n">nbrEmoticons</span> <span class="o">=</span> <span class="n">emoticonsList</span><span class="o">.</span><span class="n">length</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">val</span> <span class="n">fullDF</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/{2020,2021,continuous_22_12}/*/*/*/*/*&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="n">fullDF</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2013137
fullDF: org.apache.spark.sql.DataFrame = [CurrentTweetDate: timestamp, CurrentTwID: bigint ... 7 more fields]
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-cluster-emoticons">
<h2>How to cluster emoticons<a class="headerlink" href="#how-to-cluster-emoticons" title="Permalink to this headline">¬∂</a></h2>
<p>We could just look at the descriptions and appearances of the various
emoticons and cluster them into broad categories based on that. However,
instead we will try to use our collected tweet dataset to create a
clustering. Then we will use the intuition based on the descriptions and
appearances to judge how successful this approach was.</p>
<p>We will use the Jaccard distance between emoticons to try to cluster
them. The Jaccard distance between emoticons <span class="math notranslate nohighlight">\(e_1\)</span> and <span class="math notranslate nohighlight">\(e_2\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}  
  d(e_1, e_2) = 1 - \frac{\\# (e_1\wedge e_2)}{\\# (e_1) + \\# (e_2) - \\# (e_1\wedge e_2)},
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\\#(e)\)</span> is the number of tweets collected containing the emoticon
<span class="math notranslate nohighlight">\(e\)</span>, and <span class="math notranslate nohighlight">\(\\# (e_1\wedge e_2)\)</span> is the number of tweets collected
containing both <span class="math notranslate nohighlight">\(e_1\)</span> and <span class="math notranslate nohighlight">\(e_2\)</span>.</p>
<p>In order to find the Jaccard distances between emoticons, we must create
a matrix containing for each pair of emoticons how often they appear
together in the dataset of tweets and also in how many tweets each
emoticon appears individually. First we define a function to create such
a matrix for an individual tweet. Then we will sum these matrices for
all the tweets. The matrices will be represented by a 1D array following
a certain indexing scheme and containing the entries of the upper
triangular part of the matrix (there would be redundancy in finding the
whole matrix since it will be symmetric).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="k">def</span> <span class="nf">emoticonPairToIndex</span> <span class="p">(</span><span class="n">a</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="n">Int</span> <span class="o">=</span> <span class="p">{</span> <span class="o">//</span> <span class="n">helper</span> <span class="n">function</span> <span class="k">for</span> <span class="n">indexing</span>
  <span class="n">val</span> <span class="n">i</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="n">a</span> <span class="k">else</span> <span class="n">b</span> <span class="o">//</span> <span class="n">makes</span> <span class="n">sure</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">i</span>
  <span class="n">val</span> <span class="n">j</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="n">b</span> <span class="k">else</span> <span class="n">a</span>
  <span class="k">return</span> <span class="n">i</span><span class="o">*</span><span class="n">nbrEmoticons</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">j</span> 
<span class="p">}</span>

<span class="k">def</span> <span class="nf">createEmoticonIterator</span> <span class="p">(</span><span class="n">s</span> <span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">scala</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">Regex</span><span class="o">.</span><span class="n">MatchIterator</span> <span class="o">=</span> <span class="p">{</span> <span class="o">//</span> <span class="n">helper</span> <span class="n">function</span> <span class="k">for</span> <span class="n">iterating</span> <span class="n">through</span> <span class="n">the</span> <span class="n">emoticons</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">string</span> <span class="n">s</span>
  <span class="k">return</span> <span class="n">s</span><span class="s2">&quot;&quot;&quot;[$</span><span class="si">{emoticonsList.mkString}</span><span class="s2">]&quot;&quot;&quot;</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">findAllIn</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">createEmoticonMatrix</span> <span class="p">(</span><span class="n">s</span> <span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Array</span><span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="o">//</span> <span class="n">The</span> <span class="n">pair</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="n">will</span> <span class="n">be</span> <span class="n">at</span> <span class="n">location</span> <span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">nbrEmoticons</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">array</span> <span class="p">(</span><span class="n">this</span> <span class="ow">is</span> <span class="n">compatible</span> <span class="k">with</span> <span class="n">later</span> <span class="n">scipy</span> <span class="n">functions</span><span class="p">)</span>
  <span class="n">var</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Array</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="n">nbrEmoticons</span><span class="o">*</span><span class="n">nbrEmoticons</span> <span class="o">+</span> <span class="n">nbrEmoticons</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span> <span class="o">//</span> <span class="n">there</span> <span class="n">are</span> <span class="mi">80</span> <span class="n">emoticons</span> <span class="ow">and</span> <span class="n">thus</span> <span class="mi">80</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">80</span> <span class="o">/</span> <span class="mi">2</span> <span class="n">emoticon</span> <span class="n">pairs</span> <span class="n">including</span> <span class="n">pairs</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">emoticon</span>
  <span class="n">val</span> <span class="n">emoticonIterator</span> <span class="o">=</span> <span class="n">createEmoticonIterator</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="o">//</span> <span class="n">sets</span> <span class="n">m</span> <span class="n">to</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">each</span> <span class="n">index</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">a</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">emoticons</span> <span class="n">present</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">string</span> <span class="n">s</span> <span class="p">(</span><span class="n">very</span> <span class="n">hacky</span> <span class="n">code</span><span class="o">...</span><span class="p">)</span>
  <span class="n">emoticonIterator</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">em_pair</span> <span class="o">=&gt;</span> <span class="o">//</span> <span class="n">iterate</span> <span class="n">over</span> <span class="n">emoticons</span> <span class="ow">in</span> <span class="n">s</span>
                                        <span class="p">(</span><span class="n">createEmoticonIterator</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">em_pair</span><span class="o">.</span><span class="n">_2</span><span class="p">))</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span> <span class="o">//</span> <span class="n">iterate</span> <span class="n">over</span> <span class="n">remaining</span> <span class="n">emoticons</span> <span class="ow">in</span> <span class="n">s</span>
                                          <span class="n">second_em</span> <span class="o">=&gt;</span> 
                                            <span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span>
                                                <span class="n">emoticonsMap</span><span class="p">(</span><span class="n">em_pair</span><span class="o">.</span><span class="n">_1</span><span class="p">),</span>
                                                <span class="n">emoticonsMap</span><span class="p">(</span><span class="n">second_em</span><span class="p">))</span>
                                              <span class="p">)</span>
                                            <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="nb">set</span> <span class="n">m</span> <span class="n">to</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">each</span> <span class="n">emoticon</span> <span class="n">pair</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">s</span>
                                         <span class="p">)</span>
                                       <span class="p">)</span>
  <span class="k">return</span> <span class="n">m</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>emoticonPairToIndex: (a: Int, b: Int)Int
createEmoticonIterator: (s: String)util.matching.Regex.MatchIterator
createEmoticonMatrix: (s: String)Array[Int]
</pre></div>
</div>
</div>
</div>
<p>In the cell below we sum all the ‚Äúoccurence-matrices‚Äù and print the
diagonal of the summed matrix, i.e. the number of tweets containing each
individual emoticon. It is clear that some emoticons are used far more
often than others.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
val emoticonsMatrix = fullDF.select(&quot;CurrentTweet&quot;)
                            .filter($&quot;CurrentTweet&quot;.rlike(emoticonsList.mkString(&quot;|&quot;))) // filters tweets with emoticons
                            .map(row =&gt; createEmoticonMatrix(row.mkString)) // creates an &quot;adjacency matrix&quot; for each tweet
                            .reduce((_, _).zipped.map(_ + _)) // sums the matrices elementwise

emoticonsList.zipWithIndex.foreach({case (e, i) =&gt; println(e + &quot;, &quot; + Integer.toString(emoticonsMatrix(emoticonPairToIndex(i, i))) + &quot; occurences&quot;)})
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üòÄ, 3510 occurences
üòÅ, 8679 occurences
üòÇ, 65997 occurences
üòÉ, 3603 occurences
üòÑ, 2851 occurences
üòÖ, 10402 occurences
üòÜ, 4817 occurences
üòá, 2550 occurences
üòà, 2127 occurences
üòâ, 6846 occurences
üòä, 11300 occurences
üòã, 3729 occurences
üòå, 3664 occurences
üòç, 18604 occurences
üòé, 5412 occurences
üòè, 3181 occurences
üòê, 1417 occurences
üòë, 1303 occurences
üòí, 2678 occurences
üòì, 1264 occurences
üòî, 5475 occurences
üòï, 973 occurences
üòñ, 805 occurences
üòó, 416 occurences
üòò, 8414 occurences
üòô, 381 occurences
üòö, 797 occurences
üòõ, 892 occurences
üòú, 3070 occurences
üòù, 1405 occurences
üòû, 1743 occurences
üòü, 401 occurences
üò†, 815 occurences
üò°, 2853 occurences
üò¢, 3563 occurences
üò£, 1064 occurences
üò§, 1778 occurences
üò•, 1181 occurences
üò¶, 101 occurences
üòß, 170 occurences
üò®, 353 occurences
üò©, 5055 occurences
üò™, 1828 occurences
üò´, 1594 occurences
üò¨, 2828 occurences
üò≠, 23494 occurences
üòÆ, 483 occurences
üòØ, 328 occurences
üò∞, 612 occurences
üò±, 2205 occurences
üò≤, 708 occurences
üò≥, 3712 occurences
üò¥, 1906 occurences
üòµ, 483 occurences
üò∂, 577 occurences
üò∑, 1568 occurences
üò∏, 230 occurences
üòπ, 933 occurences
üò∫, 143 occurences
üòª, 1177 occurences
üòº, 178 occurences
üòΩ, 173 occurences
üòæ, 58 occurences
üòø, 127 occurences
üôÄ, 141 occurences
üôÅ, 417 occurences
üôÇ, 3283 occurences
üôÉ, 2935 occurences
üôÑ, 7233 occurences
üôÖ, 737 occurences
üôÜ, 887 occurences
üôá, 1829 occurences
üôà, 2492 occurences
üôâ, 193 occurences
üôä, 641 occurences
üôã, 2220 occurences
üôå, 6954 occurences
üôç, 21 occurences
üôé, 37 occurences
üôè, 25801 occurences
emoticonsMatrix: Array[Int] = Array(3510, 163, 149, 188, 115, 81, 91, 33, 4, 51, 64, 32, 7, 75, 44, 5, 6, 6, 6, 1, 2, 0, 1, 11, 41, 13, 10, 15, 36, 14, 8, 1, 2, 2, 6, 0, 1, 15, 0, 0, 2, 3, 0, 2, 10, 17, 10, 4, 3, 15, 9, 15, 1, 4, 1, 18, 9, 0, 3, 3, 1, 2, 1, 1, 0, 6, 26, 17, 27, 0, 2, 4, 11, 1, 3, 15, 34, 0, 0, 92, 8679, 476, 135, 171, 225, 180, 44, 14, 161, 227, 75, 39, 161, 114, 39, 17, 8, 17, 7, 19, 9, 5, 15, 132, 14, 50, 36, 104, 36, 10, 1, 3, 13, 22, 2, 12, 14, 0, 0, 0, 22, 5, 6, 30, 49, 6, 6, 4, 30, 17, 27, 7, 7, 8, 37, 3, 0, 3, 6, 2, 2, 1, 0, 1, 6, 53, 31, 63, 5, 9, 36, 47, 5, 13, 34, 74, 0, 0, 244, 65997, 139, 151, 977, 348, 104, 39, 365, 206, 117, 118, 437, 222, 115, 37, 28, 95, 20, 84, 20, 21, 14, 285, 17, 26, 46, 295, 108, 19, 9, 12, 42, 73, 22, 40, 26, 4, 5, 5, 363, 33, 72, 174, 2074, 26, 15, 11, 93, 43, 203, 38, 21, 17, 50, 5, 65, 2, 39, 2, 0, 2, 0, 1, 15, 110, 119, 355, 24, 95, 19, 306, 14, 60, 73, 183, 0, 1, 493, 3603, 176, 131, 117, 22, 3, 86, 189, 33, 16, 80, 30, 10, 5, 2, 4, 6, 8, 5, 4, 11, 59, 10, 13, 18, 26, 20, 2, 2, 2, 5, 12, 5, 3, 3, 0, 0, 8, 2, 2, 2, 10, 34, 9, 7, 3, 14, 13, 14, 3, 3, 1, 17, 9, 0, 6, 4, 2, 4, 0, 0, 2, 2, 30, 15, 12, 1, 22, 82, 4, 1, 1, 16, 27, 0, 0, 102, 2851, 130, 122, 22, 6, 58, 104, 29, 20, 66, 37, 9, 4, 5, 4, 2, 8, 4, 2, 10, 35, 10, 12, 15, 34, 20, 2, 2, 0, 3, 7, 4, 4, 3, 0, 0, 3, 1, 6, 3, 11, 25, 8, 5, 2, 6, 11, 16, 3, 1, 0, 10, 5, 3, 7, 5, 0, 4, 1, 0, 0, 2, 31, 14, 21, 1, 10, 23, 16, 0, 1, 19, 20, 0, 0, 69, 10402, 222, 53, 21, 124, 169, 71, 54, 118, 52, 62, 18, 15, 23, 20, 31, 5, 7, 18, 79, 13, 14, 23, 70, 36, 13, 4, 4, 6, 39, 17, 5, 6, 2, 1, 6, 44, 11, 12, 57, 157, 10, 7, 13, 45, 19, 40, 20, 11, 3, 17, 7, 13, 2, 3, 1, 1, 0, 1, 0, 5, 39, 48, 77, 11, 12, 67, 64, 4, 12, 19, 34, 0, 1, 135, 4817, 20, 5, 87, 160, 61, 27, 89, 36, 14, 5, 3, 7, 7, 10, 4, 3, 10, 52, 10, 13, 14, 43, 27, 4, 7, 2, 3, 8, 4, 8, 15, 1, 3, 2, 11, 1, 5, 19, 51, 10, 6, 2, 15, 15, 36, 6, 4, 1, 8, 7, 12, 4, 4, 1, 3, 1, 0, 2, 2, 23, 19, 43, 0, 9, 58, 23, 4, 2, 20, 49, 0, 0, 68, 2550, 24, 29, 99, 28, 20, 86, 46, 9, 1, 3, 3, 0, 7, 2, 0, 6, 57, 10, 13, 10, 14, 9, 4, 1, 2, 3, 10, 1, 2, 1, 0, 0, 3, 2, 2, 1, 17, 37, 4, 5, 1, 12, 15, 16, 9, 11, 0, 22, 3, 0, 2, 3, 2, 3, 0, 0, 1, 1, 22, 11, 16, 0, 3, 6, 5, 0, 0, 10, 40, 0, 0, 329, 2127, 46, 15, 45, 4, 40, 32, 57, 2, 1, 5, 16, 2, 1, 0, 0, 26, 1, 1, 11, 37, 6, 2, 0, 5, 6, 3, 2, 5, 0, 0, 0, 3, 11, 3, 2, 8, 12, 3, 0, 2, 8, 0, 4, 2, 0, 0, 3, 2, 2, 0, 4, 5, 2, 0, 0, 0, 0, 3, 6, 5, 1, 1, 0, 12, 0, 4, 10, 8, 0, 0, 11, 6846, 223, 86, 42, 127, 98, 74, 8, 9, 9, 11, 14, 4, 0, 18, 244, 15, 27, 26, 77, 20, 6, 3, 3, 2, 12, 2, 5, 5, 0, 2, 1, 7, 2, 1, 23, 18, 6, 6, 2, 14, 13, 24, 8, 0, 1, 25, 5, 4, 3, 13, 0, 0, 0, 1, 0, 3, 45, 46, 46, 7, 0, 25, 23, 5, 6, 25, 75, 0, 0, 173, 11300, 102, 58, 221, 82, 36, 23, 18, 14, 18, 26, 10, 9, 21, 254, 24, 48, 16, 39, 20, 10, 3, 0, 5, 35, 10, 2, 7, 0, 2, 6, 23, 8, 10, 28, 86, 6, 5, 5, 22, 12, 31, 23, 4, 8, 39, 8, 4, 4, 17, 1, 6, 0, 0, 1, 11, 65, 37, 50, 3, 11, 179, 20, 0, 2, 75, 99, 0, 0, 612, 3729, 49, 241, 45, 39, 10, 6, 13, 3, 14, 9, 4, 22, 106, 26, 37, 58, 54, 33, 13, 8, 4, 2, 15, 5, 5, 2, 0, 0, 3, 18, 2, 10, 12, 28, 4, 7, 0, 12, 8, 21, 6, 1, 1, 10, 6, 1, 3, 18, 1, 6, 0, 0, 0, 12, 22, 19, 25, 2, 4, 26, 25, 4, 7, 13, 20, 0, 0, 76, 3664, 87, 28, 47, 6, 5, 7, 3, 21, 12, 1, 3, 35, 11, 12, 6, 19, 11, 6, 5, 1, 2, 11, 3, 5, 4, 0, 2, 1, 18, 10, 9, 8, 40, 1, 0, 1, 7, 2, 10, 14, 4, 2, 6, 1, 3, 0, 1, 2, 0, 0, 0, 0, 3, 29, 14, 20, 1, 4, 15, 9, 1, 23, 6, 38, 0, 0, 101, 18604, 100, 53, 13, 13, 18, 10, 33, 11, 8, 35, 745, 44, 64, 47, 86, 40, 8, 7, 17, 15, 29, 4, 11, 10, 0, 1, 2, 102, 16, 22, 24, 324, 20, 9, 8, 54, 23)
</pre></div>
</div>
</div>
</div>
<p>In the following two cells we create the Jaccard distance matrix which
we want to use to cluster the emoticons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="k">def</span> <span class="nf">jaccardDistance</span> <span class="p">(</span><span class="n">e1</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">e2</span> <span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">:</span> <span class="n">Double</span> <span class="o">=</span> <span class="p">{</span> <span class="o">//</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">emojis</span> <span class="ow">in</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">their</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">list</span>
  <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">emoticonsMatrix</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">))</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">emoticonsMatrix</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">e1</span><span class="p">))</span> <span class="o">+</span>  <span class="n">emoticonsMatrix</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="n">e2</span><span class="p">))</span> <span class="o">-</span> <span class="n">emoticonsMatrix</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jaccardDistance: (e1: Int, e2: Int)Double
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">var</span> <span class="n">jaccardMatrix</span> <span class="o">=</span> <span class="n">Array</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">emoticonsMatrix</span><span class="o">.</span><span class="n">length</span><span class="p">)(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="p">(</span><span class="mi">0</span> <span class="n">until</span> <span class="n">nbrEmoticons</span><span class="p">)</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">i</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">i</span> <span class="n">until</span> <span class="n">nbrEmoticons</span><span class="p">)</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">j</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">jaccardMatrix</span><span class="p">(</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="o">=</span> <span class="n">jaccardDistance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jaccardMatrix: Array[Double] = Array(0.0, 0.98644603359388, 0.997851725828311, 0.9728519855595668, 0.9815882164585334, 0.9941435904851421, 0.9889509470616804, 0.9945246391239423, 0.9992898988105805, 0.9950509461426492, 0.9956598399565983, 0.9955598723463299, 0.9990233012418027, 0.9965969417850175, 0.9950439288127957, 0.9992521687107389, 0.9987807356228409, 0.9987518202621177, 0.999029440310579, 0.9997904881625812, 0.9997773572303239, 1.0, 0.9997681965693093, 0.9971902937420178, 0.9965496928385088, 0.9966477565755544, 0.9976727949732371, 0.9965808069295646, 0.9944987775061125, 0.9971434401142624, 0.9984747378455672, 0.9997442455242966, 0.9995373583159842, 0.9996855840276686, 0.9991509834441772, 1.0, 0.9998108568186117, 0.9967921300256629, 1.0, 1.0, 0.9994819994819995, 0.9996496145760336, 1.0, 0.999607996863975, 0.9984197218710493, 0.9993700670693296, 0.9974893296510168, 0.9989567031820553, 0.9992716678805535, 0.9973684210526316, 0.9978617248752673, 0.9979186901623421, 0.9998153277931672, 0.9989972424166458, 0.9997552618697993, 0.9964426877470356, 0.997587778075583, 1.0, 0.9991780821917808, 0.9993595217762596, 0.9997287767832926, 0.9994566693833198, 0.9997196523689375, 0.9997249724972497, 1.0, 0.9984697781178271, 0.9961578247376977, 0.997355320472931, 0.9974804031354984, 1.0, 0.9995449374288965, 0.9992502343017807, 0.9981639125354699, 0.9997298757428417, 0.9992767598842816, 0.9973753280839895, 0.9967401725790987, 1.0, 1.0, 0.9968513638385982, 0.0, 0.9935849056603774, 0.9888861447270931, 0.9849458579100273, 0.9880674586338566, 0.9864824271553019, 0.9960661600357622, 0.998702742772424, 0.9895209580838323, 0.9885074929121102, 0.993918754560934, 0.9968302990897269, 0.9940638595973749, 0.9918437432925521, 0.9967007867354708, 0.9983133247345967, 0.9991979145779025, 0.9985008818342151, 0.9992954911433173, 0.9986558188892819, 0.9990666804936223, 0.9994725181981222, 0.9983480176211453, 0.9922174400094335, 0.9984523546318815, 0.99469552302143, 0.9962244362873623, 0.9910691283812795, 0.9964171974522293, 0.9990395697272378, 0.9998898557109814, 0.9996839110736487, 0.9988714298116156, 0.9981996726677578, 0.9997946822708141, 0.9988511249401627, 0.998578102782856, 1.0, 1.0, 1.0, 0.9983955659276547, 0.9995239002094839, 0.9994156033895003, 0.9973860765008278, 0.9984746606898269, 0.9993446920052425, 0.9993334073991779, 0.9995692904059438, 0.9972360420121614, 0.9981856990394877, 0.9978162406988029, 0.9993382491964454, 0.9992353904969962, 0.9991349480968859, 0.9963761018609206, 0.9996631484392544, 1.0, 0.9996598253770269, 0.9993908629441625, 0.9997741389045737, 0.999774011299435, 0.9998855311355311, 1.0, 0.999886608459009, 0.9993399339933994, 0.9955495843479721, 0.9973236639903307, 0.9960249858035207, 0.9994687068324302, 0.9990582818876217, 0.9965622612681436, 0.9957749011147069, 0.9994361114243825, 0.9986032018910498, 0.996870685687989, 0.9952439102770101, 1.0, 1.0, 0.9928729991821474, 0.0, 0.9979988770677071, 0.9978019418606344, 0.9870462199358278, 0.9950614480742486, 0.9984804874128838, 0.9994271866049791, 0.9949639890725461, 0.9973278333398192, 0.9983191828642848, 0.9983032080870828, 0.9948077562853477, 0.9968814530742973, 0.9983348536843172, 0.99945085118067, 0.9995837792841004, 0.9986147564887722, 0.9997025624247111, 0.9988233316523786, 0.9997012696041823, 0.9996855393001003, 0.9997891534511062, 0.9961551952081591, 0.9997438254396408, 0.9996105919003115, 0.9993118202354772, 0.9957104635607514, 0.9983951020893393, 0.9997194371022282, 0.9998644353733299, 0.9998203592814371, 0.9993896058597838, 0.998949443780851, 0.9996718328137353, 0.9994094633498192, 0.9996128186800095, 0.9999394801343541, 0.9999244279193494, 0.9999246363704876, 0.9948648304545261, 0.9995132168987492, 0.9989336334957567, 0.9974654411443388, 0.9762746376562911, 0.9996087519186204, 0.9997737897752978, 0.999834829874771, 0.9986345416905255, 0.9993549548468392, 0.9970793888297413, 0.9994400648345981, 0.9996840157089333, 0.9997445798338267, 0.999259423831741, 0.9999244963909275, 0.9990278920212369, 0.9999697601983731, 0.9994190809562821, 0.999969776192707, 1.0, 0.9999697212844231, 1.0, 0.9999848798705717, 0.9997740929833281, 0.9984097151944484, 0.9982706755990873, 0.9951286449399657, 0.9996402338479988, 0.9985776100854932, 0.9997197929417316, 0.9955120777906517, 0.9997884429400387, 0.9990988014058698, 0.9989287391406434, 0.9974851583113457, 1.0, 0.9999848560568201, 0.994600514758228, 0.0, 0.9719655941382606, 0.9905578780452645, 0.9859087076960135, 0.9964116783558963, 0.9994761655316919, 0.991701244813278, 0.9871550903901046, 0.9954788327168105, 0.9977934078058199, 0.9963845076151309, 0.996661101836394, 0.9985237673457337, 0.9990029910269193, 0.9995921696574225, 0.9993627529074398, 0.9987656860728246, 0.9991179713340683, 0.9989061474513236, 0.9990917347865577, 0.997255489021956, 0.9950660645592908, 0.9974836436839456, 0.997036699338956, 0.9959794505249051, 0.9960884609598315, 0.9959903769045709, 0.999625748502994, 0.9995002498750625, 0.9995471014492754, 0.999224926368005, 0.99832261671792, 0.9989274989274989, 0.9994421718110822, 0.9993725162099979, 1.0, 1.0, 0.9979736575481256, 0.9997689463955638, 0.999631608030945, 0.9996150144369587, 0.9984426101853294, 0.9987436721723386, 0.9977924944812362, 0.9982161060142711, 0.9992877492877493, 0.9975837072833966, 0.9969753373662168, 0.9980824544582934, 0.9994551398474392, 0.9992652461425422, 0.9997607083034219, 0.9967015909972836, 0.9976464435146444, 1.0, 0.9983957219251337, 0.9991624790619765, 0.9994707594601746, 0.9989395546129375, 1.0, 1.0, 0.9994655264564404, 0.9995022399203584, 0.9956242707117853, 0.9977004445807144, 0.9988913525498891, 0.999769532150265, 0.9950760966875559, 0.9846728971962617, 0.9993432933836809, 0.9997364953886693, 0.9997643176997407, 0.9972447046667815, 0.9974358974358974, 1.0, 1.0, 0.9965190089413692, 0.0, 0.9900937285681628, 0.9838324940365757, 0.9959100204498977, 0.998793242156074, 0.9939827782965038, 0.9925962839040364, 0.9955731949320714, 0.9969207082371054, 0.9969143017438871, 0.9955020666180403, 0.9985057280425037, 0.99906191369606, 0.9987948903350204, 0.9992760180995475, 0.99951373693168, 0.9990382303438327, 0.9989528795811519, 0.9994526546250684, 0.9969296898986798, 0.9968833481745325, 0.9968963376784605, 0.9966996699669967, 0.9959763948497854, 0.9942245625955495, 0.9952785646836638, 0.9995644599303136, 0.9993846153846154, 1.0, 0.9994737765304332, 0.9989074449820509, 0.9989772436716953, 0.9991351351351352, 0.9992553983618764, 1.0, 1.0, 0.9990627928772259, 0.9998734977862113, 0.9987160282473786, 0.9993246285457001, 0.998059280169372, 0.9990501519756839, 0.9975947083583885, 0.9984247006931317, 0.9994221323316961, 0.9988118811881188, 0.9968996617812852, 0.9975561325798076, 0.9993689524610854, 0.9996999699969997, 1.0, 0.9977319119981856, 0.9983745123537061, 0.9992065591113463, 0.9976565115500502, 0.9987571464081532, 1.0, 0.9986754966887417, 0.999656121045392, 1.0, 1.0, 0.9993876301285977, 0.9949205308864493, 0.9975744975744976, 0.9979131471728113, 0.9997212155004181, 0.9973175965665236, 0.9950611981962637, 0.9969964332645016, 1.0, 0.9997135491263248, 0.9962391132224862, 0.99795605518651, 1.0, 1.0, 0.99758597767904, 0.0, 0.9851970394078816, 0.9958911543530506, 0.9983210745123121, 0.9927587012380285, 0.9921515812938281, 0.994950213371266, 0.9961461604339138, 0.995915258931044, 0.996700926278391, 0.995414540344649, 0.9984747055334293, 0.9987168520102652, 0.9982384927625029, 0.9982826721621157, 0.9980436703268963, 0.9995602462620933, 0.999375, 0.9983333333333333, 0.9957837433954209, 0.9987929433611885, 0.9987483236477425, 0.9979593647413717, 0.994776898970303, 0.9969416362246198, 0.9989284536762282, 0.9996295953329012, 0.9996432712030678, 0.999547135632878, 0.9971994829814735, 0.9985151541619356, 0.9995893223819302, 0.9994817310183985, 0.9998095419483859, 0.9999054015703339, 0.9994418085403294, 0.9971452669824175, 0.9990997626647025, 0.9989986648865153, 0.9956729674333865, 0.9953466314947094, 0.999080459770115, 0.9993471976126084, 0.9988182892464321, 0.996417767871358, 0.9982868992877107, 0.9971578797783146, 0.9983723958333334, 0.9989884127276072, 0.9997266763848397, 0.9985777629047101, 0.9993411764705883, 0.99885179296944, 0.9998103006734326, 0.9997408431237043, 0.999905473107099, 0.9999054284093059, 1.0, 0.9999050151975684, 1.0, 0.9995376363972628, 0.9971420196394548, 0.9963879900669727, 0.9956145346850439, 0.9990115025161754, 0.9989358872040436, 0.994491943439658, 0.9950116913484022, 0.9996223208384477, 0.9989121566494424, 0.9984924224391019, 0.9980371781549474, 1.0, 0.9999041962061698, 0.9962570699789287, 0.0, 0.9972778004627739, 0.9992794350771005, 0.9924844505874223, 0.9899730525788055, 0.9928108426635238, 0.9968062455642299, 0.996185496314075, 0.9964681644265673, 0.9982464929859719, 0.9991973029378712, 0.9995095635115253, 0.9990651709401709, 0.998847546921304, 0.9990274265707061, 0.9993086761147598, 0.999466097170315, 0.9980853915374306, 0.9960543288565141, 0.9980724749421742, 0.9976789858953758, 0.9975417032484636, 0.994518103008669, 0.9956416464891041, 0.9993898718730934, 0.9986566877758588, 0.9996447602131439, 0.9996087126646668, 0.9990444338270426, 0.9993193806363792, 0.9987854865644451, 0.9974928965401972, 0.9997966239576977, 0.9993980738362761, 0.9996130030959752, 0.9988844944731772, 0.9998494882600842, 0.9992194817358726, 0.9975085234723315, 0.9981953290870488, 0.998109640831758, 0.9988324576765908, 0.9996314722682882, 0.9978592835735692, 0.9972776769509982, 0.9957612151183327, 0.9991067440821796, 0.9992447129909365, 0.999814574448359, 0.9987454916104751, 0.9986111111111111, 0.9979086789822238, 0.9991928974979822, 0.9993322203672788, 0.999799759711654, 0.9993984359334269, 0.9997948297086582, 1.0, 0.9995964487489911, 0.9996177370030581, 0.9971524080723041, 0.9975429975429976, 0.9964187557258266, 1.0, 0.9984196663740122, 0.9911961141469339, 0.9968432610485863, 0.9992009588493808, 0.999633431085044, 0.9971497791078808, 0.9958198259682648, 1.0, 1.0, 0.9977741407528642, 0.0, 0.9948420373952289, 0.9969040247678018, 0.9928005235982837, 0.9955207166853304, 0.9967710687762351, 0.9959179798746914, 0.9941889843355229, 0.9984271233834323, 0.9997478567826525, 0.9992207792207792, 0.9994258373205742, 1.0, 0.9991269643302569, 0.9994319795512638, 1.0, 0.9979729729729729, 0.9947739983496837, 0.9965765148921603, 0.9961007798440312, 0.997086247086247, 0.9975026757046022, 0.9977192093258996, 0.9990673816740498, 0.9996610169491525, 0.9994052928932501, 0.9994444444444445, 0.9983614615762739, 0.9997232216994187, 0.9995376791493297, 0.9997319034852546, 1.0, 1.0, 0.9989655172413793, 0.9997369459423912, 0.9995429616087751, 0.9997586290127927, 0.9968289498227942, 0.9985773061098935, 0.998679432155827, 0.998259658893143, 0.999683644416324, 0.9974699557242251, 0.9953746530989824, 0.9974383605507525, 0.9979761637058692, 0.9963600264725347, 1.0, 0.99462890625, 0.9989196975153043, 1.0, 0.9992567818654775, 0.9991944146079484, 0.9992663242846662, 0.9988970588235294, 1.0, 1.0, 0.9996282527881041, 0.9996628455832771, 0.9962140767509895, 0.9979905005480453, 0.9983618306542439, 1.0, 0.999126383226558, 0.9986279442030642, 0.9990073456422474, 1.0, 1.0, 0.9978991596638656, 0.9957734573119188, 1.0, 1.0, 0.9882592248947256, 0.0, 0.9948470930883836, 0.9988815985684462, 0.9922560660815695, 0.9993087955762917, 0.9980667923251655, 0.9957373118422805, 0.9891449247762331, 0.9994353472614342, 0.99970836978711, 0.9989583333333333, 0.9952592592592593, 0.9997368421052631, 0.9996773152629881, 1.0, 1.0, 0.9975273418925344, 0.9996011168727563, 0.9996578857338351, 0.996343085106383, 0.9928294573643411, 0.998298355076574, 0.999482936918304, 1.0, 0.9982975825672454, 0.9987937273823885, 0.9994724810972393, 0.9993728441517717, 0.9987179487179487, 1.0, 1.0, 1.0, 0.9987888574888979, 0.9984660437874774, 0.9992408906882592, 0.9994622210271579, 0.9983828582979584, 0.9995314147370066, 0.998849252013809, 1.0, 0.999269272926562, 0.9981498612395929, 1.0, 0.9993144815766923, 0.9995038451997023, 1.0, 1.0, 0.9991874322860238, 0.9991507430997877, 0.999345977763244, 1.0, 0.9987878787878788, 0.9978260869565218, 0.999129677980853, 1.0, 1.0, 1.0, 1.0, 0.9994451636767153, 0.9988132911392406, 0.9994655264564404, 0.9996507160321342, 0.9996681048788583, 1.0, 0.9973952680703277, 1.0, 0.9985528219971056, 0.9976942587041734, 0.9991182629780668, 1.0, 1.0, 0.9996059748540316, 0.0, 0.9875578865145344, 0.9918009343121366, 0.995987772258311, 0.9949847964301228, 0.9919407894736842, 0.9925650557620818, 0.999030890369473, 0.9988943488943489, 0.9990541250656858, 0.9986418076305716, 0.9988624360120256, 0.999488163787588, 1.0, 0.9975151849806737, 0.9837506659563132, 0.9979201331114809, 0.9964548319327731, 0.9966286307053942, 0.9921740014229088, 0.9975701615842546, 0.9993009437259699, 0.9995858641634456, 0.9996082528075215, 0.9997937506445292, 0.9988458209098778, 0.9997470915528579, 0.9994198862977144, 0.9993767140363999, 1.0, 0.9997148560022812, 0.9998610725201444, 0.9994114679670422, 0.9997693726937269, 0.9998815025476953, 0.9976168272717854, 0.9994063716113712, 0.9991806636624334, 0.9991629464285714, 0.9997317596566524, 0.9984508133230054, 0.9982760907041507, 0.9977216631858743, 0.9990850869167429, 1.0, 0.9998652654271086, 0.9970199070210991, 0.9992928864375619, 0.9994855305466238, 0.9995705697108502, 0.9983770287141074, 1.0, 1.0, 1.0, 0.9998565691336776, 1.0, 0.9995867768595041, 0.9955374851249504, 0.9952747817154597, 0.9967220123993444, 0.9990760295670539, 1.0, 0.9971098265895953, 0.9975308641975309, 0.999289166903611, 0.9991979681860714, 0.9972348191571728, 0.994535519125683, 1.0, 1.0, 0.9946726612058878, 0.0, 0.993166744824814, 0.9961089494163424, 0.9925546609170232, 0.9950691521346964, 0.9975077881619938, 0.9981881203718292, 0.998569725864124, 0.9989974219421369, 0.9985652797704447, 0.9984476685175234, 0.9991845388567234, 0.9992559523809523, 0.9982043608379649, 0.9869475847893114, 0.9979411512395985, 0.996016266910117, 0.9986859395532195, 0.9972786267531923, 0.9984233346472211, 0.9992327169492826, 0.9997435459052829, 1.0, 0.9996465931580435, 0.9976396007553278, 0.9991905455722843, 0.9998470480269196, 0.999438832772166, 1.0, 0.999825601674224, 0.99948484588306, 0.998591721773206, 0.999390243902439, 0.999223843526855, 0.9980141843971632, 0.9975221850870116, 0.9994905323936486, 0.9995698184633915, 0.9995800789451583, 0.998368315656753, 0.9989996665555185, 0.9979307122354983, 0.9982553288325874, 0.9996604125986925, 0.9993259752295897, 0.9969600124717437, 0.9993056760978997, 0.9996729086597432, 0.999650319083836, 0.9986356340288924, 0.9999128692166943, 0.9994767593965291, 1.0, 1.0, 0.9999125874125874, 0.9990603109516487, 0.9955227992836478, 0.9973939991548105, 0.997294811448358, 0.9997507063320592, 0.9990965834428384, 0.9861776061776062, 0.9985477781004938, 1.0, 0.9998324817823938, 0.9944217181108219, 0.9945469567612228, 1.0, 1.0, 0.9832278220833676, 0.0, 0.9933278867102396, 0.9890910736918341, 0.9950527704485488, 0.9943239703099985, 0.9980529595015576, 0.9988062077198567, 0.9979668439161714, 0.9993987975951903, 0.9984766050054407, 0.9980822501598124, 0.9991169977924945, 0.994664079553723, 0.9911938190579048, 0.9936336924583742, 0.9917576297616396, 0.9872890642121411, 0.9919940696812454, 0.9935306802587728, 0.9976186114673017, 0.9980591945657448, 0.9991189427312775, 0.9996960486322188, 0.9979387110072833, 0.9989557226399332, 0.9990912395492548, 0.9995925020374898, 1.0, 1.0, 0.9992645256190242, 0.997946611909651, 0.9996399639963996, 0.9981178242047807, 0.9981665393430099, 0.998970398970399, 0.9990494296577946, 0.9982716049382716, 1.0, 0.9979736575481256, 0.9981937231880785, 0.9971698113207547, 0.9989340913128442, 0.9997625267157445, 0.9997677119628339, 0.9981085681861169, 0.9984821654439666, 0.9997854537652864, 0.9992246058413027, 0.9963175122749591, 0.9997439836149513, 0.9984599589322382, 1.0, 1.0, 1.0, 0.9970972423802612, 0.9968526466380544, 0.9971407072987208, 0.9977141812197129, 0.9995519713261649, 0.9991326973113617, 0.9953000723065799, 0.9959651387992253, 0.9989790709545686, 0.9983955993582397, 0.9978099730458221, 0.9981243552471162, 1.0, 1.0, 0.9974197053031846, 0.0, 0.9960777241783508, 0.9969053934571176, 0.9930862018240659, 0.9988177339901478, 0.9989923417976623, 0.9988950276243094, 0.9993908629441625, 0.9976968633472253, 0.9974054054054055, 0.9997761862130707, 0.9992641648270787, 0.9970937474051316, 0.9972731779871096, 0.9973027646662171, 0.9986813186813187, 0.9971705137751303, 0.9978252273625939, 0.9988890946121088, 0.9987684729064039, 0.9997766860205449, 0.9996930161166538, 0.9984756097560976, 0.9993650793650793, 0.9990803752069156, 0.9991737244370997, 1.0, 0.9994780793319415, 0.9997509960159362, 0.9979312722675554, 0.9981758482305728, 0.9982853876928939, 0.9987661937075879, 0.998524964967918, 0.9997588036661843, 1.0, 0.9997660818713451, 0.998805868304333, 0.9995423340961098, 0.9986424110779256, 0.9974802015838733, 0.9990345160511707, 0.9995281906109932, 0.9988518943742825, 0.999743128692525, 0.9993469743143231, 1.0, 0.9997933884297521, 0.9994791666666667, 1.0, 1.0, 1.0, 1.0, 0.9992643452672879, 0.9958080370049147, 0.9978739559605163, 0.9981612576997334, 0.9997727272727273, 0.9991202990983066, 0.9972617743702081, 0.9985358711566618, 0.9997406639004149, 0.9946286781877627, 0.9989792446410344, 0.9964083175803403, 1.0, 1.0, 0.9965604141125187, 0.0, 0.99581869877906, 0.9975612000736241, 0.9993502598960415, 0.9993465366442144, 0.9991534988713319, 0.9994964246147648, 0.9986276303751144, 0.9994378002657671, 0.9995876501211278, 0.9981564392941796, 0.9716438929699691, 0.9976769969906552, 0.9966902828773854, 0.9975834233122526, 0.9960163053548268, 0.9979968951875406, 0.9996066669944442, 0.9996315401621223, 0.999123801669931, 0.999300438391941, 0.9986900352335351, 0.9997965825874695, 0.9994600166903932, 0.9994943109987358, 1.0, 0.999946732008736, 0.9998944869427592, 0.995670076834911, 0.9992163009404389, 0.9989095955590801, 0.9988789237668162, 0.9922439795087854, 0.9989510672890334, 0.9995243883105216, 0.9995835068721366, 0.9973982172970368, 0.9988076105552387)
</pre></div>
</div>
</div>
</div>
<p>Finally we write the Jaccard distance matrix and the emoticon list to
file so that we don‚Äôt have to keep rerunning the above cells and so that
we can load them into python cells next.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span><span class="n">scala</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">nsc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/emoticonsList.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">writeAll</span><span class="p">(</span><span class="n">emoticonsList</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="o">//</span><span class="n">scala</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">nsc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/jMatrix.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">writeAll</span><span class="p">(</span><span class="n">jaccardMatrix</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="clustering-using-python">
<h2>Clustering using python<a class="headerlink" href="#clustering-using-python" title="Permalink to this headline">¬∂</a></h2>
<p>We now switch to python cells in order to use various clustering methods
implemented in SciPy and scikit-learn. First we install and import some
packages for later use, then we load the previously saved Jaccard matrix
and emoticons list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pycountry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python interpreter will be restarted.
Collecting pycountry
  Downloading pycountry-20.7.3.tar.gz (10.1 MB)
Building wheels for collected packages: pycountry
  Building wheel for pycountry (setup.py): started
  Building wheel for pycountry (setup.py): finished with status &#39;done&#39;
  Created wheel for pycountry: filename=pycountry-20.7.3-py2.py3-none-any.whl size=10746863 sha256=870cc02de7d6d11499effd59f2b73acdbffc04146079c4a4f9a841ca30f2b587
  Stored in directory: /root/.cache/pip/wheels/57/e8/3f/120ccc1ff7541c108bc5d656e2a14c39da0d824653b62284c6
Successfully built pycountry
Installing collected packages: pycountry
Successfully installed pycountry-20.7.3
Python interpreter will be restarted.
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">font_manager</span> <span class="k">as</span> <span class="n">fm</span><span class="p">,</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span><span class="p">,</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pycountry</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">locally_linear_embedding</span><span class="p">,</span> <span class="n">TSNE</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">jMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/jMatrix.txt&quot;</span><span class="p">)</span>

<span class="n">emoticonsList</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/emoticonsList.txt&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filehandle</span><span class="p">:</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c1">#remove line break</span>
        <span class="n">emoticonsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">nbrEmoticons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">emoticonsList</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">emoticonsList</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;üòÄ&#39;, &#39;üòÅ&#39;, &#39;üòÇ&#39;, &#39;üòÉ&#39;, &#39;üòÑ&#39;, &#39;üòÖ&#39;, &#39;üòÜ&#39;, &#39;üòá&#39;, &#39;üòà&#39;, &#39;üòâ&#39;, &#39;üòä&#39;, &#39;üòã&#39;, &#39;üòå&#39;, &#39;üòç&#39;, &#39;üòé&#39;, &#39;üòè&#39;, &#39;üòê&#39;, &#39;üòë&#39;, &#39;üòí&#39;, &#39;üòì&#39;, &#39;üòî&#39;, &#39;üòï&#39;, &#39;üòñ&#39;, &#39;üòó&#39;, &#39;üòò&#39;, &#39;üòô&#39;, &#39;üòö&#39;, &#39;üòõ&#39;, &#39;üòú&#39;, &#39;üòù&#39;, &#39;üòû&#39;, &#39;üòü&#39;, &#39;üò†&#39;, &#39;üò°&#39;, &#39;üò¢&#39;, &#39;üò£&#39;, &#39;üò§&#39;, &#39;üò•&#39;, &#39;üò¶&#39;, &#39;üòß&#39;, &#39;üò®&#39;, &#39;üò©&#39;, &#39;üò™&#39;, &#39;üò´&#39;, &#39;üò¨&#39;, &#39;üò≠&#39;, &#39;üòÆ&#39;, &#39;üòØ&#39;, &#39;üò∞&#39;, &#39;üò±&#39;, &#39;üò≤&#39;, &#39;üò≥&#39;, &#39;üò¥&#39;, &#39;üòµ&#39;, &#39;üò∂&#39;, &#39;üò∑&#39;, &#39;üò∏&#39;, &#39;üòπ&#39;, &#39;üò∫&#39;, &#39;üòª&#39;, &#39;üòº&#39;, &#39;üòΩ&#39;, &#39;üòæ&#39;, &#39;üòø&#39;, &#39;üôÄ&#39;, &#39;üôÅ&#39;, &#39;üôÇ&#39;, &#39;üôÉ&#39;, &#39;üôÑ&#39;, &#39;üôÖ&#39;, &#39;üôÜ&#39;, &#39;üôá&#39;, &#39;üôà&#39;, &#39;üôâ&#39;, &#39;üôä&#39;, &#39;üôã&#39;, &#39;üôå&#39;, &#39;üôç&#39;, &#39;üôé&#39;, &#39;üôè&#39;]
</pre></div>
</div>
</div>
</div>
<p>Some of the SciPy clustering implementations require a full distance
matrix, rather than the condensed representation consisting of only the
upper triangular part which we have been using thus far. So we create a
full matrix in the cell below. In the cell after that we define a helper
function for plotting 2D embeddings of emoticons, note that this
function loads the unifont-upper font for emoticon rendering, which can
be downloaded from <code class="docutils literal notranslate"><span class="pre">http://unifoundry.com/unifont/index.html</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="k">def</span> <span class="nf">emoticonPairToIndex</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="c1"># same helper function as already defined in scala previously</span>
  <span class="n">i</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="c1"># makes sure j &gt;= i</span>
  <span class="n">j</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="n">nbrEmoticons</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">j</span> 

<span class="n">fullDistanceMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nbrEmoticons</span><span class="p">,</span> <span class="n">nbrEmoticons</span><span class="p">])</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrEmoticons</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrEmoticons</span><span class="p">):</span>
    <span class="n">fullDistanceMatrix</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">jMatrix</span><span class="p">[</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="k">def</span> <span class="nf">scatterEmojis</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">):</span>
  <span class="c1"># This function plots a scatter plot of emoticons.</span>
  <span class="c1"># emoticonsEmbedded should be an 80x2 array </span>
  <span class="c1"># containing 2D coordinates for each of the</span>
  <span class="c1"># 80 emoticons in the unicode emoticon block (in the correct order).</span>
  
  <span class="c1"># standardize the embedding for nicer plotting:</span>
  <span class="n">emoticonsEmbedded</span> <span class="o">=</span> <span class="n">emoticonsEmbedded</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">)</span>
  <span class="n">emoticonsEmbedded</span> <span class="o">=</span> <span class="n">emoticonsEmbedded</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">)</span> 

  <span class="c1"># for proper emoji rendering change the font</span>
  <span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;datapath&quot;</span><span class="p">],</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/unifont_upper-13.0.05.ttf&quot;</span><span class="p">)</span>
  <span class="n">prop</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emoticonsList</span><span class="p">):</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">emoticonsEmbedded</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">prop</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">frame_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">(),</span> <span class="n">yticks</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="locally-linear-embedding">
<h3>Locally linear embedding<a class="headerlink" href="#locally-linear-embedding" title="Permalink to this headline">¬∂</a></h3>
<p>First off we will look at embedding the emoticons into 2D in ways that
respect the Jaccard distances at least to a degree.</p>
<p>Locally linear embedding (LLE) is one such method, which is focused on
good presentation of local neighborhoods. You can read more about it in
the scikit-learn documentation embedded below.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">nbrNeighbors</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">emoticonsNeighbors</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">nbrNeighbors</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fullDistanceMatrix</span><span class="p">)</span>
<span class="n">emoticonsEmbedded</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">locally_linear_embedding</span><span class="p">(</span><span class="n">emoticonsNeighbors</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="n">nbrNeighbors</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As we can see in the scatter plot below, LLE succeeds in separating the
emoticons broadly into happy (down to the left), sad (up) and animal
(down to the right) categories. Also some local clusters can be spotted,
such as the three emoticons sticking out their tongues, close to the
lower left corner.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">scatterEmojis</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="t-distributed-stochastic-neighbor-embedding-t-sne">
<h3>t-distributed Stochastic Neighbor Embedding (t-SNE)<a class="headerlink" href="#t-distributed-stochastic-neighbor-embedding-t-sne" title="Permalink to this headline">¬∂</a></h3>
<p>Another approach for embedding the distances into 2D is t-SNE. You can
read more about this method in the sk-learn documentation below.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">emoticonsEmbedded</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">perplexity</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">early_exaggeration</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                         <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;precomputed&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">fullDistanceMatrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>t-SNE also does a good job at showing a separation between happy and sad
emojis but the result is not as convincing as the LLE case. One could
spend more time on optimizing the hyperparameters and probably find a
better embedding here.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">scatterEmojis</span><span class="p">(</span><span class="n">emoticonsEmbedded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hierarchical-clustering">
<h3>Hierarchical clustering<a class="headerlink" href="#hierarchical-clustering" title="Permalink to this headline">¬∂</a></h3>
<p>Instead of trying to embed the distances into 2D, we can also create a
nice graphical representation in the form of a dendrogram or
hierarchical clustering. For this we need to process the distance matrix
somewhat again in the following cell.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="c1"># remove diagonal from jMatrix, as this is expected by the scipy linkage function:</span>
<span class="n">diagonalIndices</span> <span class="o">=</span> <span class="p">[</span><span class="n">emoticonPairToIndex</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrEmoticons</span><span class="p">)]</span>
<span class="n">jMatrixUpper</span> <span class="o">=</span> <span class="n">jMatrix</span><span class="p">[[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">nbrEmoticons</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">nbrEmoticons</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">diagonalIndices</span><span class="p">]]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">jMatrixUpper</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">jMatrix</span><span class="p">)</span> <span class="o">-</span> <span class="n">nbrEmoticons</span><span class="p">,</span> <span class="s2">&quot;the upper matrix should have exactly 80 elements fewer than the upper+diagonal&quot;</span>

<span class="c1"># creating a linkage matrix</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">jMatrixUpper</span><span class="p">,</span> <span class="s1">&#39;complete&#39;</span><span class="p">,</span> <span class="n">optimal_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hierarchical clustering works by starting of with clusters of size one
which are just the emoticons and then iteratively joining those clusters
which are closest together. The distance between clusters can be defined
in various ways, here we somewhat arbitrarily choose so called ‚Äúcomplete
linkage‚Äù which means that the distance between clusters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> is
given by the maximum Jaccard distance between some emoticon in <span class="math notranslate nohighlight">\(a\)</span> and
some emoticon in <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>We can use dendrograms to neatly represent hirearchical clusterings
graphically. The closer two emoticons (or rather emoticon clusters) are
to each other, the further down in the dendrogram their branches merge.</p>
<p>The interested WASP PhD student could consider taking the WASP
Topological Data Analysis course to learn more about hierarchical
clustering.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="c1"># plotting a dendrogram</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">emoticonsList</span><span class="p">,</span> <span class="n">leaf_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color_threshold</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="c1"># for proper emoji rendering change the font</span>
<span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;datapath&quot;</span><span class="p">],</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/unifont_upper-13.0.05.ttf&quot;</span><span class="p">)</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
<span class="n">x_labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xmajorticklabels</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_labels</span><span class="p">:</span>
    <span class="n">x</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We identify six main clusters in the dendrogram above. From left to
right:</p>
<ul class="simple">
<li><p>The green ‚Äúprayer‚Äù cluster (üôåüôèüòäüôáüôãüò∑) which also contains the mask
emoji and a common smile emoji,</p></li>
<li><p>the teal ‚Äúhappy‚Äù cluster (üòùüòõüòúüòéüòâüòèüòàüòåüòãüòçüòòüòáüòÄüòÉüòÑüòÅüòÜüòÖüôÇüôÉ),</p></li>
<li><p>the magenta ‚Äúcat‚Äù cluster (üòπüò∏üòΩüò∫üòªüòøüòæüôÄüòº),</p></li>
<li><p>the yellow ‚Äúshocked and kisses‚Äù or ‚ÄúSK‚Äù cluster (üò∂üò¨üò≤üòÆüòØüòóüòôüòö),</p></li>
<li><p>a combined ‚Äúnot happy‚Äù cluster consisting of the next black, green,
red, teal and magenta clusters (üòµüòßüò¶üò®üò∞üò±üò≥üòÇüò≠üò©üòîüò¢üòûüò•üòìüò™üò¥üò´üòñüò£üòüüôÅüòïüòêüòëüòíüôÑüò§üò°üò†),</p></li>
<li><p>finally the yellow ‚Äúmonkey‚Äù cluster (üôàüôäüôâ).</p></li>
</ul>
<p>We proceed with these clusters as they appeal sufficiently to our
intuition to seem worthwhile. The observant reader will however have
noted some curiosities such as the fact that the ‚Äúnot happy‚Äù cluster
contains the crying laughing emoji üòÇ which is the most popular emoticon
in our tweet dataset and which might be used in both happy and not so
happy contexts.</p>
<p>Next, we finish the clustering part of this notebook by saving the
clusters to file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">monkeyEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">76</span><span class="p">:</span><span class="mi">79</span><span class="p">]</span>
<span class="n">prayerEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="n">shockedAndKissesEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span>
<span class="n">happyEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">9</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span>
<span class="n">notHappyEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">46</span><span class="p">:</span><span class="mi">76</span><span class="p">]</span>
<span class="n">catEmoticons</span> <span class="o">=</span> <span class="n">dn</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">][</span><span class="mi">29</span><span class="p">:</span><span class="mi">38</span><span class="p">]</span>
<span class="n">emoticonsDict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;monkey&quot;</span> <span class="p">:</span> <span class="n">monkeyEmoticons</span><span class="p">,</span>
                 <span class="s2">&quot;prayer&quot;</span> <span class="p">:</span> <span class="n">prayerEmoticons</span><span class="p">,</span>
                 <span class="s2">&quot;SK&quot;</span> <span class="p">:</span> <span class="n">shockedAndKissesEmoticons</span><span class="p">,</span>
                <span class="s2">&quot;happy&quot;</span> <span class="p">:</span> <span class="n">happyEmoticons</span><span class="p">,</span>
                <span class="s2">&quot;notHappy&quot;</span> <span class="p">:</span> <span class="n">notHappyEmoticons</span><span class="p">,</span>
                <span class="s2">&quot;cat&quot;</span> <span class="p">:</span> <span class="n">catEmoticons</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">emoticonsDict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;monkey&#39;: [72, 74, 73], &#39;prayer&#39;: [76, 79, 10, 71, 75, 55], &#39;SK&#39;: [54, 44, 50, 46, 47, 23, 25, 26], &#39;happy&#39;: [29, 27, 28, 14, 9, 15, 8, 12, 11, 13, 24, 7, 0, 3, 4, 1, 6, 5, 66, 67], &#39;notHappy&#39;: [53, 39, 38, 40, 48, 49, 51, 2, 45, 41, 20, 34, 30, 37, 19, 42, 52, 43, 22, 35, 31, 65, 21, 16, 17, 18, 68, 36, 33, 32], &#39;cat&#39;: [57, 56, 61, 58, 59, 63, 62, 64, 60]}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="c1">#with open(&#39;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/emoticonClusters.json&#39;, &#39;w+&#39;) as f:</span>
<span class="c1">#    json.dump(emoticonsDict, f)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="filtering-the-tweets-by-cluster">
<h2>Filtering the tweets by cluster<a class="headerlink" href="#filtering-the-tweets-by-cluster" title="Permalink to this headline">¬∂</a></h2>
<p>We return to scala cells to filter the original dataset by what
emoticons are present in each tweet. First we load the clusters from the
just created json-file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="kn">import</span> <span class="nn">org.json4s.jackson.JsonMethods.parse</span>
<span class="n">val</span> <span class="n">jsonString</span> <span class="o">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">fromFile</span><span class="p">(</span><span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/emoticonClusters.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkString</span> 
<span class="n">val</span> <span class="n">emoticonClusters</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">jsonString</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Map</span><span class="p">[</span><span class="n">String</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">BigInt</span><span class="p">]]]</span>
<span class="n">emoticonClusters</span><span class="o">.</span><span class="n">foreach</span><span class="p">({</span><span class="n">case</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">list</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">i</span> <span class="o">=&gt;</span> <span class="n">emoticonsList</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">toInt</span><span class="p">))</span><span class="o">.</span><span class="n">mkString</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>prayer: üôåüôèüòäüôáüôãüò∑
monkey: üôàüôäüôâ
happy: üòùüòõüòúüòéüòâüòèüòàüòåüòãüòçüòòüòáüòÄüòÉüòÑüòÅüòÜüòÖüôÇüôÉ
SK: üò∂üò¨üò≤üòÆüòØüòóüòôüòö
cat: üòπüò∏üòΩüò∫üòªüòøüòæüôÄüòº
notHappy: üòµüòßüò¶üò®üò∞üò±üò≥üòÇüò≠üò©üòîüò¢üòûüò•üòìüò™üò¥üò´üòñüò£üòüüôÅüòïüòêüòëüòíüôÑüò§üò°üò†
import org.json4s.jackson.JsonMethods.parse
jsonString: String = {&quot;monkey&quot;: [72, 74, 73], &quot;prayer&quot;: [76, 79, 10, 71, 75, 55], &quot;SK&quot;: [54, 44, 50, 46, 47, 23, 25, 26], &quot;happy&quot;: [29, 27, 28, 14, 9, 15, 8, 12, 11, 13, 24, 7, 0, 3, 4, 1, 6, 5, 66, 67], &quot;notHappy&quot;: [53, 39, 38, 40, 48, 49, 51, 2, 45, 41, 20, 34, 30, 37, 19, 42, 52, 43, 22, 35, 31, 65, 21, 16, 17, 18, 68, 36, 33, 32], &quot;cat&quot;: [57, 56, 61, 58, 59, 63, 62, 64, 60]}
emoticonClusters: Map[String,List[BigInt]] = Map(prayer -&gt; List(76, 79, 10, 71, 75, 55), monkey -&gt; List(72, 74, 73), happy -&gt; List(29, 27, 28, 14, 9, 15, 8, 12, 11, 13, 24, 7, 0, 3, 4, 1, 6, 5, 66, 67), SK -&gt; List(54, 44, 50, 46, 47, 23, 25, 26), cat -&gt; List(57, 56, 61, 58, 59, 63, 62, 64, 60), notHappy -&gt; List(53, 39, 38, 40, 48, 49, 51, 2, 45, 41, 20, 34, 30, 37, 19, 42, 52, 43, 22, 35, 31, 65, 21, 16, 17, 18, 68, 36, 33, 32))
</pre></div>
</div>
</div>
</div>
<p>Next, we create a dataframe <code class="docutils literal notranslate"><span class="pre">emoticonDF</span></code> with a row for each tweet
containing at least one emoticon. We add a column for each cluster
indicating if the cluster is represented by some emoticon in the tweet.
This dataframe is saved to file to be used in the next notebook 03 which
focuses more on data visualization. Here we will finish this notebook by
using the databricks <code class="docutils literal notranslate"><span class="pre">display</span></code> function to plot geopraphic information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
val emoticonDF = fullDF.filter($&quot;CurrentTweet&quot;.rlike(emoticonsList.mkString(&quot;|&quot;))) // filter tweets with emoticons
                       .select(($&quot;countryCode&quot; :: // select the countryCode column
                                $&quot;CurrentTweetDate&quot; :: // and the timestamp
                                (for {(name, cluster) &lt;- emoticonClusters.toList} yield  // also create a new column for each emoticon cluster indicating if the tweet contains an emoticon of that cluster
                                 $&quot;CurrentTweet&quot;.rlike(cluster.map(i =&gt; emoticonsList(i.toInt)).mkString(&quot;|&quot;))
                                                .alias(name))) // rename new column
                                                : _*) // expand list
      
emoticonDF.show(3)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------+-------------------+------+------+-----+-----+-----+--------+
|countryCode|   CurrentTweetDate|prayer|monkey|happy|   SK|  cat|notHappy|
+-----------+-------------------+------+------+-----+-----+-----+--------+
|         EG|2020-12-31 15:59:54| false| false|false|false|false|    true|
|         SA|2020-12-31 15:59:54|  true| false|false|false|false|   false|
|         DO|2020-12-31 15:59:54| false| false| true|false|false|   false|
+-----------+-------------------+------+------+-----+-----+-----+--------+
only showing top 3 rows

emoticonDF: org.apache.spark.sql.DataFrame = [countryCode: string, CurrentTweetDate: timestamp ... 6 more fields]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">save</span> <span class="n">to</span> <span class="n">file</span>
<span class="o">//</span> <span class="n">emoticonDF</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/processedEmoticonClusterParquets/emoticonCluster.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The goal for the last part of this notebook will be to display for each
country what proportion of its total tweets correspond to a certain
cluster. First we create a dataframe <code class="docutils literal notranslate"><span class="pre">emoticonCCDF</span></code> which contains the
total number of tweets with some emoticon for each country. Using that
dataframe we create dataframes containing the described proportions for
each cluster and transfer these dataframes from scala to python by using
the <code class="docutils literal notranslate"><span class="pre">createOrReplaceTmpView</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
val emoticonCCDF = emoticonDF.groupBy($&quot;countryCode&quot;)
                             .count
emoticonCCDF.show(3)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------+-----+
|countryCode|count|
+-----------+-----+
|         DZ|  157|
|         MM|   44|
|         TC|    5|
+-----------+-----+
only showing top 3 rows

emoticonCCDF: org.apache.spark.sql.DataFrame = [countryCode: string, count: bigint]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
def createPropClusterDF (cluster : org.apache.spark.sql.Column) : org.apache.spark.sql.DataFrame = {  
  // This function filters the emoticonDF by a cluster-column and then
  // creates a dataframe with a row per country and columns for the countryCode and proportion
  // of tweets from that country that fall into the cluster as well as the count of tweets
  // falling into the cluster.
  val nbrClusterTweets = emoticonDF.filter(cluster).count
  val clusterDF = emoticonDF.filter(cluster)
                            .groupBy($&quot;countryCode&quot;)
                            .count
  val propDF = emoticonCCDF.alias(&quot;total&quot;)
                           .join(clusterDF.alias(&quot;cluster&quot;), &quot;countryCode&quot;)
                           .select($&quot;countryCode&quot;, $&quot;cluster.count&quot;.alias(&quot;count&quot;), ($&quot;cluster.count&quot; / $&quot;total.count&quot;).alias(&quot;proportion&quot;))
  return propDF
}
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>createPropClusterDF: (cluster: org.apache.spark.sql.Column)org.apache.spark.sql.DataFrame
</pre></div>
</div>
</div>
</div>
<p>Below we see an example of the dataframes generated by
<code class="docutils literal notranslate"><span class="pre">createPropClusterDF</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
val clusterColumn = $&quot;notHappy&quot;
val propClusterDF = createPropClusterDF(clusterColumn)
propClusterDF.show(3)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----------+-----+------------------+
|countryCode|count|        proportion|
+-----------+-----+------------------+
|         DZ|   80|0.5095541401273885|
|         MM|   14|0.3181818181818182|
|         CI|  164|0.6507936507936508|
+-----------+-----+------------------+
only showing top 3 rows

clusterColumn: org.apache.spark.sql.ColumnName = notHappy
propClusterDF: org.apache.spark.sql.DataFrame = [countryCode: string, count: bigint ... 1 more field]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="k">def</span> <span class="nf">createPropClusterDFAndCreateTmpView</span> <span class="p">(</span><span class="n">clusterName</span> <span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">function</span> <span class="k">for</span> <span class="n">creating</span> <span class="n">proportion</span> <span class="n">dataframes</span> <span class="k">for</span> <span class="n">each</span> <span class="n">cluster</span> <span class="ow">and</span> <span class="n">making</span> <span class="n">them</span> <span class="n">available</span> <span class="k">for</span> <span class="n">later</span> <span class="n">python</span> <span class="n">code</span>
  <span class="n">val</span> <span class="n">propClusterDF</span> <span class="o">=</span> <span class="n">createPropClusterDF</span><span class="p">(</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">clusterName</span><span class="p">))</span>
  <span class="o">//</span> <span class="n">make</span> <span class="n">df</span> <span class="n">available</span> <span class="n">to</span> <span class="n">python</span><span class="o">/</span><span class="n">sql</span> <span class="n">etc</span>
  <span class="n">propClusterDF</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="n">clusterName</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>createPropClusterDFAndCreateTmpView: (clusterName: String)Unit
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">create</span> <span class="n">proportion</span> <span class="n">dataframes</span> <span class="k">for</span> <span class="n">each</span> <span class="n">cluster</span> <span class="ow">and</span> <span class="n">make</span> <span class="n">them</span> <span class="n">available</span> <span class="k">for</span> <span class="n">later</span> <span class="n">python</span> <span class="n">code</span>
<span class="n">emoticonClusters</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">createPropClusterDFAndCreateTmpView</span> <span class="n">_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we turn to python to use the <code class="docutils literal notranslate"><span class="pre">pycountry</span></code> package in order to
translate the country codes into another standard (three letters instead
of two) which makes plotting with the built in databricks <code class="docutils literal notranslate"><span class="pre">display</span></code> a
breeze. The cell below contains some functions that read the dataframes
from the temporary view created in scala and translate them to pandas
dataframes with the three letter country codes. Also, we filter out
countries for which there are fewer than 100 tweets.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="k">def</span> <span class="nf">add_iso_a3_col</span><span class="p">(</span><span class="n">df_cc</span><span class="p">):</span>
  <span class="n">cc_dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="p">:</span>
    <span class="n">cc_dict</span><span class="p">[</span><span class="n">country</span><span class="o">.</span><span class="n">alpha_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">country</span><span class="o">.</span><span class="n">alpha_3</span>

    <span class="n">df_cc</span><span class="p">[</span><span class="s2">&quot;iso_a3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cc</span><span class="p">[</span><span class="s2">&quot;countryCode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cc_dict</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">df_cc</span>

<span class="k">def</span> <span class="nf">cc_df_from_spark_to_pandas_and_process</span><span class="p">(</span><span class="n">df_cc</span><span class="p">,</span> <span class="n">columnOfInterest</span><span class="p">):</span>
  <span class="c1">#df_cc should be a dataframe with a column &quot;countryCode&quot; and a column columnOfInterest which has some interesting numerical data</span>
  <span class="n">df_cc</span> <span class="o">=</span> <span class="n">df_cc</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
  <span class="n">add_iso_a3_col</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>
  <span class="n">df_cc</span> <span class="o">=</span> <span class="n">df_cc</span><span class="p">[[</span><span class="s2">&quot;iso_a3&quot;</span><span class="p">,</span> <span class="n">columnOfInterest</span><span class="p">]]</span>  <span class="c1">#reorder to have iso_a3 as first column (required in order to use the map view in display), and select the useful columns</span>
  <span class="k">return</span> <span class="n">df_cc</span>

<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>
<span class="k">def</span> <span class="nf">createProps</span><span class="p">(</span><span class="n">clusterName</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">sql</span><span class="p">(</span><span class="s2">&quot;select * from &quot;</span> <span class="o">+</span> <span class="n">clusterName</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">cc_df_from_spark_to_pandas_and_process</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;proportion&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;proportion&quot;</span><span class="p">)</span> <span class="c1"># filter so that only countries with at least 100 tweets in a given country are used</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can show the proportion of tweets in each country that fall
into each cluster. Make sure that the plot type is set to <code class="docutils literal notranslate"><span class="pre">map</span></code> in the
outputs from the cells below. It is possible to hover over the countries
to see the precise values.</p>
<p>If anything interesting can actually be read from these plots we leave
for the reader to decide.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;happy&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DZA</td>
<td>0.37579617834394907</td>
</tr>
<tr class="even">
<td>CIV</td>
<td>0.26587301587301587</td>
</tr>
<tr class="odd">
<td>FIN</td>
<td>0.5069252077562327</td>
</tr>
<tr class="even">
<td>AZE</td>
<td>0.25742574257425743</td>
</tr>
<tr class="odd">
<td>UKR</td>
<td>0.5272727272727272</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>0.2222222222222222</td>
</tr>
<tr class="odd">
<td>NLD</td>
<td>0.504885993485342</td>
</tr>
<tr class="even">
<td>BWA</td>
<td>0.13818722139673106</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>0.6512488436632747</td>
</tr>
<tr class="even">
<td>MEX</td>
<td>0.4382897697767007</td>
</tr>
<tr class="odd">
<td>CHN</td>
<td>0.41338582677165353</td>
</tr>
<tr class="even">
<td>AUT</td>
<td>0.4725274725274725</td>
</tr>
<tr class="odd">
<td>RUS</td>
<td>0.46016381236038717</td>
</tr>
<tr class="even">
<td>NAM</td>
<td>0.18110236220472442</td>
</tr>
<tr class="odd">
<td>IRQ</td>
<td>0.3049645390070922</td>
</tr>
<tr class="even">
<td>SLV</td>
<td>0.39826839826839827</td>
</tr>
<tr class="odd">
<td>HRV</td>
<td>0.452755905511811</td>
</tr>
<tr class="even">
<td>NPL</td>
<td>0.40932642487046633</td>
</tr>
<tr class="odd">
<td>CZE</td>
<td>0.597864768683274</td>
</tr>
<tr class="even">
<td>PRT</td>
<td>0.33161688980432547</td>
</tr>
<tr class="odd">
<td>GHA</td>
<td>0.19372592184920198</td>
</tr>
<tr class="even">
<td>HKG</td>
<td>0.4166666666666667</td>
</tr>
<tr class="odd">
<td>TWN</td>
<td>0.44651162790697674</td>
</tr>
<tr class="even">
<td>BGD</td>
<td>0.5663716814159292</td>
</tr>
<tr class="odd">
<td>PRY</td>
<td>0.41501103752759383</td>
</tr>
<tr class="even">
<td>LBN</td>
<td>0.4008714596949891</td>
</tr>
<tr class="odd">
<td>CHL</td>
<td>0.4048804780876494</td>
</tr>
<tr class="even">
<td>IDN</td>
<td>0.37397967682825256</td>
</tr>
<tr class="odd">
<td>LBY</td>
<td>0.31592039800995025</td>
</tr>
<tr class="even">
<td>SAU</td>
<td>0.28804244836081105</td>
</tr>
<tr class="odd">
<td>PAK</td>
<td>0.3372164316370325</td>
</tr>
<tr class="even">
<td>AUS</td>
<td>0.38910812943962114</td>
</tr>
<tr class="odd">
<td>MWI</td>
<td>0.1694915254237288</td>
</tr>
<tr class="even">
<td>CAN</td>
<td>0.3287632105112825</td>
</tr>
<tr class="odd">
<td>GBR</td>
<td>0.33724265408885207</td>
</tr>
<tr class="even">
<td>BRA</td>
<td>0.3243058910454972</td>
</tr>
<tr class="odd">
<td>HND</td>
<td>0.38414634146341464</td>
</tr>
<tr class="even">
<td>GTM</td>
<td>0.3463414634146341</td>
</tr>
<tr class="odd">
<td>DEU</td>
<td>0.46123332131265776</td>
</tr>
<tr class="even">
<td>ESP</td>
<td>0.5046986390149061</td>
</tr>
<tr class="odd">
<td>IRN</td>
<td>0.3935281837160752</td>
</tr>
<tr class="even">
<td>ECU</td>
<td>0.3973105134474328</td>
</tr>
<tr class="odd">
<td>BHR</td>
<td>0.2660332541567696</td>
</tr>
<tr class="even">
<td>ISR</td>
<td>0.4166666666666667</td>
</tr>
<tr class="odd">
<td>TUR</td>
<td>0.4073997305420251</td>
</tr>
<tr class="even">
<td>VEN</td>
<td>0.43042452830188677</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>0.17471131639722864</td>
</tr>
<tr class="even">
<td>CRI</td>
<td>0.33762886597938147</td>
</tr>
<tr class="odd">
<td>KOR</td>
<td>0.476</td>
</tr>
<tr class="even">
<td>TZA</td>
<td>0.3263327948303716</td>
</tr>
<tr class="odd">
<td>USA</td>
<td>0.2629567344442746</td>
</tr>
<tr class="even">
<td>SRB</td>
<td>0.42391304347826086</td>
</tr>
<tr class="odd">
<td>MYS</td>
<td>0.34582330697834307</td>
</tr>
<tr class="even">
<td>IND</td>
<td>0.3529998338042214</td>
</tr>
<tr class="odd">
<td>JAM</td>
<td>0.24205378973105135</td>
</tr>
<tr class="even">
<td>ARE</td>
<td>0.3684210526315789</td>
</tr>
<tr class="odd">
<td>CMR</td>
<td>0.26024096385542167</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>0.39061207609594706</td>
</tr>
<tr class="odd">
<td>CHE</td>
<td>0.4774590163934426</td>
</tr>
<tr class="even">
<td>GRC</td>
<td>0.3875968992248062</td>
</tr>
<tr class="odd">
<td>PAN</td>
<td>0.3615023474178404</td>
</tr>
<tr class="even">
<td>JOR</td>
<td>0.4090909090909091</td>
</tr>
<tr class="odd">
<td>SGP</td>
<td>0.39705882352941174</td>
</tr>
<tr class="even">
<td>ITA</td>
<td>0.4835164835164835</td>
</tr>
<tr class="odd">
<td>CUB</td>
<td>0.3492063492063492</td>
</tr>
<tr class="even">
<td>SWE</td>
<td>0.5173333333333333</td>
</tr>
<tr class="odd">
<td>PHL</td>
<td>0.37993180711154406</td>
</tr>
<tr class="even">
<td>PER</td>
<td>0.41214057507987223</td>
</tr>
<tr class="odd">
<td>LSO</td>
<td>0.23076923076923078</td>
</tr>
<tr class="even">
<td>DOM</td>
<td>0.2949852507374631</td>
</tr>
<tr class="odd">
<td>QAT</td>
<td>0.34765625</td>
</tr>
<tr class="even">
<td>THA</td>
<td>0.4527736131934033</td>
</tr>
<tr class="odd">
<td>EGY</td>
<td>0.21916643039410263</td>
</tr>
<tr class="even">
<td>JPN</td>
<td>0.5093529411764706</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>0.19291338582677164</td>
</tr>
<tr class="even">
<td>SEN</td>
<td>0.14020857473928158</td>
</tr>
<tr class="odd">
<td>NZL</td>
<td>0.324</td>
</tr>
<tr class="even">
<td>OMN</td>
<td>0.2815533980582524</td>
</tr>
<tr class="odd">
<td>LKA</td>
<td>0.38283828382838286</td>
</tr>
<tr class="even">
<td>HUN</td>
<td>0.5842696629213483</td>
</tr>
<tr class="odd">
<td>KEN</td>
<td>0.20917431192660552</td>
</tr>
<tr class="even">
<td>CYP</td>
<td>0.36220472440944884</td>
</tr>
<tr class="odd">
<td>HTI</td>
<td>0.24</td>
</tr>
<tr class="even">
<td>UGA</td>
<td>0.252361673414305</td>
</tr>
<tr class="odd">
<td>IRL</td>
<td>0.36175298804780875</td>
</tr>
<tr class="even">
<td>KWT</td>
<td>0.3197925669835782</td>
</tr>
<tr class="odd">
<td>BEL</td>
<td>0.48970588235294116</td>
</tr>
<tr class="even">
<td>MAR</td>
<td>0.19548872180451127</td>
</tr>
<tr class="odd">
<td>NIC</td>
<td>0.3416666666666667</td>
</tr>
<tr class="even">
<td>TTO</td>
<td>0.18385650224215247</td>
</tr>
<tr class="odd">
<td>NOR</td>
<td>0.43373493975903615</td>
</tr>
<tr class="even">
<td>COL</td>
<td>0.37363387978142076</td>
</tr>
<tr class="odd">
<td>URY</td>
<td>0.39155920281359907</td>
</tr>
<tr class="even">
<td>NGA</td>
<td>0.24102413184226015</td>
</tr>
<tr class="odd">
<td>ARG</td>
<td>0.4079581993569132</td>
</tr>
<tr class="even">
<td>DNK</td>
<td>0.40327868852459015</td>
</tr>
<tr class="odd">
<td>COD</td>
<td>0.24875621890547264</td>
</tr>
<tr class="even">
<td>BHS</td>
<td>0.15447154471544716</td>
</tr>
<tr class="odd">
<td>MNG</td>
<td>0.42424242424242425</td>
</tr>
<tr class="even">
<td>GLP</td>
<td>0.12781954887218044</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;notHappy&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DZA</td>
<td>0.5095541401273885</td>
</tr>
<tr class="even">
<td>CIV</td>
<td>0.6507936507936508</td>
</tr>
<tr class="odd">
<td>AZE</td>
<td>0.66996699669967</td>
</tr>
<tr class="even">
<td>FIN</td>
<td>0.29085872576177285</td>
</tr>
<tr class="odd">
<td>UKR</td>
<td>0.403030303030303</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>0.6581196581196581</td>
</tr>
<tr class="odd">
<td>NLD</td>
<td>0.3555917480998914</td>
</tr>
<tr class="even">
<td>BHS</td>
<td>0.7967479674796748</td>
</tr>
<tr class="odd">
<td>BWA</td>
<td>0.7488855869242199</td>
</tr>
<tr class="even">
<td>MNG</td>
<td>0.47474747474747475</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>0.2738205365402405</td>
</tr>
<tr class="even">
<td>MEX</td>
<td>0.3759736887657954</td>
</tr>
<tr class="odd">
<td>CHN</td>
<td>0.4251968503937008</td>
</tr>
<tr class="even">
<td>AUT</td>
<td>0.27106227106227104</td>
</tr>
<tr class="odd">
<td>NAM</td>
<td>0.7322834645669292</td>
</tr>
<tr class="even">
<td>RUS</td>
<td>0.4050632911392405</td>
</tr>
<tr class="odd">
<td>IRQ</td>
<td>0.5797872340425532</td>
</tr>
<tr class="even">
<td>HRV</td>
<td>0.3858267716535433</td>
</tr>
<tr class="odd">
<td>SLV</td>
<td>0.3852813852813853</td>
</tr>
<tr class="even">
<td>NPL</td>
<td>0.4430051813471503</td>
</tr>
<tr class="odd">
<td>CZE</td>
<td>0.30604982206405695</td>
</tr>
<tr class="even">
<td>PRT</td>
<td>0.5468589083419155</td>
</tr>
<tr class="odd">
<td>GHA</td>
<td>0.6769400110071546</td>
</tr>
<tr class="even">
<td>HKG</td>
<td>0.44166666666666665</td>
</tr>
<tr class="odd">
<td>TWN</td>
<td>0.4418604651162791</td>
</tr>
<tr class="even">
<td>BGD</td>
<td>0.3053097345132743</td>
</tr>
<tr class="odd">
<td>LBN</td>
<td>0.37037037037037035</td>
</tr>
<tr class="even">
<td>PRY</td>
<td>0.4503311258278146</td>
</tr>
<tr class="odd">
<td>CHL</td>
<td>0.4676294820717131</td>
</tr>
<tr class="even">
<td>IDN</td>
<td>0.4832583708145927</td>
</tr>
<tr class="odd">
<td>LBY</td>
<td>0.6467661691542289</td>
</tr>
<tr class="even">
<td>SAU</td>
<td>0.5931400416903544</td>
</tr>
<tr class="odd">
<td>AUS</td>
<td>0.4262036306235201</td>
</tr>
<tr class="even">
<td>PAK</td>
<td>0.5536480686695279</td>
</tr>
<tr class="odd">
<td>CAN</td>
<td>0.47643530419880037</td>
</tr>
<tr class="even">
<td>MWI</td>
<td>0.801452784503632</td>
</tr>
<tr class="odd">
<td>GBR</td>
<td>0.49614379501561606</td>
</tr>
<tr class="even">
<td>BRA</td>
<td>0.4923697746454858</td>
</tr>
<tr class="odd">
<td>HND</td>
<td>0.5030487804878049</td>
</tr>
<tr class="even">
<td>GTM</td>
<td>0.5048780487804878</td>
</tr>
<tr class="odd">
<td>DEU</td>
<td>0.3541291020555355</td>
</tr>
<tr class="even">
<td>ESP</td>
<td>0.393551523007129</td>
</tr>
<tr class="odd">
<td>ECU</td>
<td>0.4119804400977995</td>
</tr>
<tr class="even">
<td>BHR</td>
<td>0.6437054631828979</td>
</tr>
<tr class="odd">
<td>IRN</td>
<td>0.5407098121085595</td>
</tr>
<tr class="even">
<td>ISR</td>
<td>0.36666666666666664</td>
</tr>
<tr class="odd">
<td>TUR</td>
<td>0.38988496217224583</td>
</tr>
<tr class="even">
<td>VEN</td>
<td>0.3113207547169811</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>0.70635103926097</td>
</tr>
<tr class="even">
<td>CRI</td>
<td>0.5283505154639175</td>
</tr>
<tr class="odd">
<td>KOR</td>
<td>0.384</td>
</tr>
<tr class="even">
<td>TZA</td>
<td>0.6187399030694669</td>
</tr>
<tr class="odd">
<td>USA</td>
<td>0.6010294042704989</td>
</tr>
<tr class="even">
<td>SRB</td>
<td>0.49130434782608695</td>
</tr>
<tr class="odd">
<td>MYS</td>
<td>0.5338604331385356</td>
</tr>
<tr class="even">
<td>IND</td>
<td>0.31984377596809044</td>
</tr>
<tr class="odd">
<td>JAM</td>
<td>0.6405867970660146</td>
</tr>
<tr class="even">
<td>ARE</td>
<td>0.509534706331045</td>
</tr>
<tr class="odd">
<td>CMR</td>
<td>0.6144578313253012</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>0.48304383788254757</td>
</tr>
<tr class="odd">
<td>CHE</td>
<td>0.4385245901639344</td>
</tr>
<tr class="even">
<td>GRC</td>
<td>0.4232558139534884</td>
</tr>
<tr class="odd">
<td>PAN</td>
<td>0.5101721439749609</td>
</tr>
<tr class="even">
<td>JOR</td>
<td>0.5495867768595041</td>
</tr>
<tr class="odd">
<td>SGP</td>
<td>0.43137254901960786</td>
</tr>
<tr class="even">
<td>ITA</td>
<td>0.4220467032967033</td>
</tr>
<tr class="odd">
<td>CUB</td>
<td>0.4973544973544973</td>
</tr>
<tr class="even">
<td>SWE</td>
<td>0.3546666666666667</td>
</tr>
<tr class="odd">
<td>PHL</td>
<td>0.48449423607728526</td>
</tr>
<tr class="even">
<td>PER</td>
<td>0.4073482428115016</td>
</tr>
<tr class="odd">
<td>LSO</td>
<td>0.6965811965811965</td>
</tr>
<tr class="even">
<td>DOM</td>
<td>0.5088495575221239</td>
</tr>
<tr class="odd">
<td>QAT</td>
<td>0.5234375</td>
</tr>
<tr class="even">
<td>THA</td>
<td>0.35932033983008493</td>
</tr>
<tr class="odd">
<td>EGY</td>
<td>0.7312163311596257</td>
</tr>
<tr class="even">
<td>JPN</td>
<td>0.26341176470588235</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>0.6850393700787402</td>
</tr>
<tr class="even">
<td>SEN</td>
<td>0.8250289687137891</td>
</tr>
<tr class="odd">
<td>NZL</td>
<td>0.46</td>
</tr>
<tr class="even">
<td>LKA</td>
<td>0.47194719471947194</td>
</tr>
<tr class="odd">
<td>OMN</td>
<td>0.6588072122052705</td>
</tr>
<tr class="even">
<td>HUN</td>
<td>0.37640449438202245</td>
</tr>
<tr class="odd">
<td>KEN</td>
<td>0.7064220183486238</td>
</tr>
<tr class="even">
<td>CYP</td>
<td>0.4409448818897638</td>
</tr>
<tr class="odd">
<td>GLP</td>
<td>0.8120300751879699</td>
</tr>
<tr class="even">
<td>HTI</td>
<td>0.68</td>
</tr>
<tr class="odd">
<td>UGA</td>
<td>0.631578947368421</td>
</tr>
<tr class="even">
<td>KWT</td>
<td>0.5280898876404494</td>
</tr>
<tr class="odd">
<td>IRL</td>
<td>0.4645418326693227</td>
</tr>
<tr class="even">
<td>MAR</td>
<td>0.3684210526315789</td>
</tr>
<tr class="odd">
<td>BEL</td>
<td>0.37058823529411766</td>
</tr>
<tr class="even">
<td>NIC</td>
<td>0.5541666666666667</td>
</tr>
<tr class="odd">
<td>TTO</td>
<td>0.7488789237668162</td>
</tr>
<tr class="even">
<td>NOR</td>
<td>0.40963855421686746</td>
</tr>
<tr class="odd">
<td>COL</td>
<td>0.398224043715847</td>
</tr>
<tr class="even">
<td>URY</td>
<td>0.4091441969519343</td>
</tr>
<tr class="odd">
<td>NGA</td>
<td>0.6253678634490877</td>
</tr>
<tr class="even">
<td>ARG</td>
<td>0.43770096463022506</td>
</tr>
<tr class="odd">
<td>COD</td>
<td>0.5771144278606966</td>
</tr>
<tr class="even">
<td>DNK</td>
<td>0.29508196721311475</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;monkey&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NLD</td>
<td>2.714440825190011e-2</td>
</tr>
<tr class="even">
<td>BWA</td>
<td>8.915304606240713e-3</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>3.6077705827937095e-2</td>
</tr>
<tr class="even">
<td>MEX</td>
<td>2.9600138480180026e-2</td>
</tr>
<tr class="odd">
<td>RUS</td>
<td>2.680565897244974e-2</td>
</tr>
<tr class="even">
<td>NAM</td>
<td>1.3123359580052493e-2</td>
</tr>
<tr class="odd">
<td>GHA</td>
<td>1.4859658778205834e-2</td>
</tr>
<tr class="even">
<td>CHL</td>
<td>1.99203187250996e-2</td>
</tr>
<tr class="odd">
<td>IDN</td>
<td>1.4492753623188406e-2</td>
</tr>
<tr class="even">
<td>SAU</td>
<td>1.137009664582149e-2</td>
</tr>
<tr class="odd">
<td>CAN</td>
<td>6.283918880319908e-3</td>
</tr>
<tr class="even">
<td>GBR</td>
<td>2.0970106444005356e-2</td>
</tr>
<tr class="odd">
<td>BRA</td>
<td>7.161328824348518e-3</td>
</tr>
<tr class="even">
<td>DEU</td>
<td>3.750450775333574e-2</td>
</tr>
<tr class="odd">
<td>ESP</td>
<td>1.3123784834737525e-2</td>
</tr>
<tr class="even">
<td>BHR</td>
<td>9.501187648456057e-3</td>
</tr>
<tr class="odd">
<td>TUR</td>
<td>2.166027567623588e-2</td>
</tr>
<tr class="even">
<td>TZA</td>
<td>2.10016155088853e-2</td>
</tr>
<tr class="odd">
<td>USA</td>
<td>4.399599109888057e-3</td>
</tr>
<tr class="even">
<td>MYS</td>
<td>1.4437951185974561e-2</td>
</tr>
<tr class="odd">
<td>IND</td>
<td>1.0137942496260596e-2</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>5.9966914805624485e-3</td>
</tr>
<tr class="odd">
<td>PAN</td>
<td>2.190923317683881e-2</td>
</tr>
<tr class="even">
<td>ITA</td>
<td>1.407967032967033e-2</td>
</tr>
<tr class="odd">
<td>SWE</td>
<td>1.4666666666666666e-2</td>
</tr>
<tr class="even">
<td>PHL</td>
<td>1.5424581912648156e-2</td>
</tr>
<tr class="odd">
<td>PER</td>
<td>3.514376996805112e-2</td>
</tr>
<tr class="even">
<td>JPN</td>
<td>3.0e-3</td>
</tr>
<tr class="odd">
<td>KEN</td>
<td>5.504587155963303e-3</td>
</tr>
<tr class="even">
<td>KWT</td>
<td>1.8150388936905792e-2</td>
</tr>
<tr class="odd">
<td>IRL</td>
<td>3.346613545816733e-2</td>
</tr>
<tr class="even">
<td>BEL</td>
<td>2.2058823529411766e-2</td>
</tr>
<tr class="odd">
<td>NOR</td>
<td>3.614457831325301e-2</td>
</tr>
<tr class="even">
<td>COL</td>
<td>3.1079234972677595e-2</td>
</tr>
<tr class="odd">
<td>NGA</td>
<td>7.945850500294291e-3</td>
</tr>
<tr class="even">
<td>ARG</td>
<td>1.587620578778135e-2</td>
</tr>
<tr class="odd">
<td>BGD</td>
<td>1.327433628318584e-2</td>
</tr>
<tr class="even">
<td>PAK</td>
<td>1.7780502759043533e-2</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>1.3279445727482679e-2</td>
</tr>
<tr class="even">
<td>SRB</td>
<td>1.3043478260869565e-2</td>
</tr>
<tr class="odd">
<td>EGY</td>
<td>9.923447689254324e-3</td>
</tr>
<tr class="even">
<td>LKA</td>
<td>3.3003300330033e-2</td>
</tr>
<tr class="odd">
<td>UGA</td>
<td>1.2145748987854251e-2</td>
</tr>
<tr class="even">
<td>UKR</td>
<td>6.060606060606061e-3</td>
</tr>
<tr class="odd">
<td>PRY</td>
<td>2.207505518763797e-2</td>
</tr>
<tr class="even">
<td>JAM</td>
<td>2.2004889975550123e-2</td>
</tr>
<tr class="odd">
<td>CHE</td>
<td>3.0737704918032786e-2</td>
</tr>
<tr class="even">
<td>THA</td>
<td>7.4962518740629685e-3</td>
</tr>
<tr class="odd">
<td>OMN</td>
<td>1.5256588072122053e-2</td>
</tr>
<tr class="even">
<td>FIN</td>
<td>3.32409972299169e-2</td>
</tr>
<tr class="odd">
<td>CHN</td>
<td>1.1811023622047244e-2</td>
</tr>
<tr class="even">
<td>IRQ</td>
<td>7.0921985815602835e-3</td>
</tr>
<tr class="odd">
<td>SLV</td>
<td>3.896103896103896e-2</td>
</tr>
<tr class="even">
<td>PRT</td>
<td>4.119464469618949e-3</td>
</tr>
<tr class="odd">
<td>ARE</td>
<td>1.5255530129672006e-2</td>
</tr>
<tr class="even">
<td>AZE</td>
<td>1.9801980198019802e-2</td>
</tr>
<tr class="odd">
<td>MNG</td>
<td>1.5151515151515152e-2</td>
</tr>
<tr class="even">
<td>HRV</td>
<td>3.543307086614173e-2</td>
</tr>
<tr class="odd">
<td>ECU</td>
<td>1.2224938875305624e-2</td>
</tr>
<tr class="even">
<td>ISR</td>
<td>1.0e-2</td>
</tr>
<tr class="odd">
<td>KOR</td>
<td>2.0e-2</td>
</tr>
<tr class="even">
<td>JOR</td>
<td>8.264462809917356e-2</td>
</tr>
<tr class="odd">
<td>NZL</td>
<td>1.6e-2</td>
</tr>
<tr class="even">
<td>URY</td>
<td>2.1101992966002344e-2</td>
</tr>
<tr class="odd">
<td>AUS</td>
<td>7.103393843725336e-3</td>
</tr>
<tr class="even">
<td>GTM</td>
<td>3.170731707317073e-2</td>
</tr>
<tr class="odd">
<td>VEN</td>
<td>1.2971698113207548e-2</td>
</tr>
<tr class="even">
<td>SEN</td>
<td>4.634994206257242e-3</td>
</tr>
<tr class="odd">
<td>CYP</td>
<td>1.5748031496062992e-2</td>
</tr>
<tr class="even">
<td>DOM</td>
<td>1.032448377581121e-2</td>
</tr>
<tr class="odd">
<td>CZE</td>
<td>3.914590747330961e-2</td>
</tr>
<tr class="even">
<td>DNK</td>
<td>1.639344262295082e-2</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>5.698005698005698e-3</td>
</tr>
<tr class="even">
<td>CRI</td>
<td>1.288659793814433e-2</td>
</tr>
<tr class="odd">
<td>HUN</td>
<td>5.6179775280898875e-3</td>
</tr>
<tr class="even">
<td>IRN</td>
<td>5.219206680584551e-3</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>1.5748031496062992e-2</td>
</tr>
<tr class="even">
<td>AUT</td>
<td>3.296703296703297e-2</td>
</tr>
<tr class="odd">
<td>LSO</td>
<td>2.1367521367521368e-2</td>
</tr>
<tr class="even">
<td>NIC</td>
<td>8.333333333333333e-3</td>
</tr>
<tr class="odd">
<td>COD</td>
<td>1.4925373134328358e-2</td>
</tr>
<tr class="even">
<td>QAT</td>
<td>1.171875e-2</td>
</tr>
<tr class="odd">
<td>MWI</td>
<td>2.421307506053269e-3</td>
</tr>
<tr class="even">
<td>MAR</td>
<td>1.5037593984962405e-2</td>
</tr>
<tr class="odd">
<td>CIV</td>
<td>3.968253968253968e-3</td>
</tr>
<tr class="even">
<td>LBY</td>
<td>4.975124378109453e-3</td>
</tr>
<tr class="odd">
<td>HND</td>
<td>9.146341463414634e-3</td>
</tr>
<tr class="even">
<td>LBN</td>
<td>4.357298474945534e-3</td>
</tr>
<tr class="odd">
<td>BHS</td>
<td>8.130081300813009e-3</td>
</tr>
<tr class="even">
<td>CMR</td>
<td>2.4096385542168677e-3</td>
</tr>
<tr class="odd">
<td>DZA</td>
<td>6.369426751592357e-3</td>
</tr>
<tr class="even">
<td>TWN</td>
<td>9.302325581395349e-3</td>
</tr>
<tr class="odd">
<td>GRC</td>
<td>3.1007751937984496e-3</td>
</tr>
<tr class="even">
<td>SGP</td>
<td>4.901960784313725e-3</td>
</tr>
<tr class="odd">
<td>NPL</td>
<td>5.1813471502590676e-3</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>UKR</td>
<td>1.2121212121212121e-2</td>
</tr>
<tr class="even">
<td>MEX</td>
<td>1.15977150770296e-2</td>
</tr>
<tr class="odd">
<td>RUS</td>
<td>3.052866716306776e-2</td>
</tr>
<tr class="even">
<td>GHA</td>
<td>2.3665382498624106e-2</td>
</tr>
<tr class="odd">
<td>CHL</td>
<td>3.137450199203187e-2</td>
</tr>
<tr class="even">
<td>IDN</td>
<td>3.664834249541896e-3</td>
</tr>
<tr class="odd">
<td>SAU</td>
<td>7.959067652075043e-3</td>
</tr>
<tr class="even">
<td>CAN</td>
<td>9.71151099685804e-3</td>
</tr>
<tr class="odd">
<td>GBR</td>
<td>7.457454267321053e-3</td>
</tr>
<tr class="even">
<td>BRA</td>
<td>1.3839552132768763e-2</td>
</tr>
<tr class="odd">
<td>ESP</td>
<td>8.263123784834738e-3</td>
</tr>
<tr class="even">
<td>TUR</td>
<td>6.943724738314851e-3</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>7.0438799076212475e-3</td>
</tr>
<tr class="even">
<td>USA</td>
<td>1.0192121490088161e-2</td>
</tr>
<tr class="odd">
<td>ARE</td>
<td>1.2967200610221205e-2</td>
</tr>
<tr class="even">
<td>CMR</td>
<td>6.0240963855421686e-2</td>
</tr>
<tr class="odd">
<td>PHL</td>
<td>6.3321967851924016e-3</td>
</tr>
<tr class="even">
<td>DOM</td>
<td>2.2123893805309734e-2</td>
</tr>
<tr class="odd">
<td>THA</td>
<td>1.7991004497751123e-2</td>
</tr>
<tr class="even">
<td>JPN</td>
<td>1.5058823529411765e-2</td>
</tr>
<tr class="odd">
<td>OMN</td>
<td>6.934812760055479e-3</td>
</tr>
<tr class="even">
<td>UGA</td>
<td>2.699055330634278e-2</td>
</tr>
<tr class="odd">
<td>BEL</td>
<td>5.8823529411764705e-3</td>
</tr>
<tr class="even">
<td>NIC</td>
<td>2.0833333333333332e-2</td>
</tr>
<tr class="odd">
<td>COL</td>
<td>1.2636612021857924e-2</td>
</tr>
<tr class="even">
<td>NGA</td>
<td>1.2213066509711596e-2</td>
</tr>
<tr class="odd">
<td>ARG</td>
<td>1.2057877813504822e-2</td>
</tr>
<tr class="even">
<td>BHS</td>
<td>1.6260162601626018e-2</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>5.550416281221091e-3</td>
</tr>
<tr class="even">
<td>NPL</td>
<td>7.772020725388601e-3</td>
</tr>
<tr class="odd">
<td>PRT</td>
<td>2.059732234809475e-2</td>
</tr>
<tr class="even">
<td>PRY</td>
<td>7.72626931567329e-3</td>
</tr>
<tr class="odd">
<td>LBY</td>
<td>7.462686567164179e-3</td>
</tr>
<tr class="even">
<td>PAK</td>
<td>3.188228080931944e-2</td>
</tr>
<tr class="odd">
<td>TZA</td>
<td>2.9079159935379646e-2</td>
</tr>
<tr class="even">
<td>MYS</td>
<td>3.0250945342041938e-2</td>
</tr>
<tr class="odd">
<td>IND</td>
<td>1.0137942496260596e-2</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>1.4681555004135649e-2</td>
</tr>
<tr class="odd">
<td>PAN</td>
<td>1.0954616588419406e-2</td>
</tr>
<tr class="even">
<td>ITA</td>
<td>8.928571428571428e-3</td>
</tr>
<tr class="odd">
<td>PER</td>
<td>1.437699680511182e-2</td>
</tr>
<tr class="even">
<td>CIV</td>
<td>5.1587301587301584e-2</td>
</tr>
<tr class="odd">
<td>NLD</td>
<td>9.771986970684038e-3</td>
</tr>
<tr class="even">
<td>CZE</td>
<td>2.491103202846975e-2</td>
</tr>
<tr class="odd">
<td>DEU</td>
<td>5.76992426974396e-3</td>
</tr>
<tr class="even">
<td>ISR</td>
<td>1.0e-2</td>
</tr>
<tr class="odd">
<td>CUB</td>
<td>6.878306878306878e-2</td>
</tr>
<tr class="even">
<td>SWE</td>
<td>6.666666666666667e-3</td>
</tr>
<tr class="odd">
<td>EGY</td>
<td>8.222285228239297e-3</td>
</tr>
<tr class="even">
<td>URY</td>
<td>8.206330597889801e-3</td>
</tr>
<tr class="odd">
<td>AUT</td>
<td>2.564102564102564e-2</td>
</tr>
<tr class="even">
<td>IRQ</td>
<td>1.0638297872340425e-2</td>
</tr>
<tr class="odd">
<td>AUS</td>
<td>3.946329913180742e-3</td>
</tr>
<tr class="even">
<td>BHR</td>
<td>7.125890736342043e-3</td>
</tr>
<tr class="odd">
<td>IRN</td>
<td>5.219206680584551e-3</td>
</tr>
<tr class="even">
<td>VEN</td>
<td>1.061320754716981e-2</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>2.7559055118110236e-2</td>
</tr>
<tr class="even">
<td>NZL</td>
<td>4.0e-2</td>
</tr>
<tr class="odd">
<td>FIN</td>
<td>2.21606648199446e-2</td>
</tr>
<tr class="even">
<td>CRI</td>
<td>2.0618556701030927e-2</td>
</tr>
<tr class="odd">
<td>SRB</td>
<td>1.0869565217391304e-2</td>
</tr>
<tr class="even">
<td>KWT</td>
<td>1.0371650821089023e-2</td>
</tr>
<tr class="odd">
<td>MNG</td>
<td>1.5151515151515152e-2</td>
</tr>
<tr class="even">
<td>KEN</td>
<td>8.256880733944955e-3</td>
</tr>
<tr class="odd">
<td>COD</td>
<td>4.975124378109453e-3</td>
</tr>
<tr class="even">
<td>CHN</td>
<td>1.968503937007874e-2</td>
</tr>
<tr class="odd">
<td>ECU</td>
<td>4.889975550122249e-3</td>
</tr>
<tr class="even">
<td>KOR</td>
<td>1.6e-2</td>
</tr>
<tr class="odd">
<td>BGD</td>
<td>1.327433628318584e-2</td>
</tr>
<tr class="even">
<td>HRV</td>
<td>1.968503937007874e-2</td>
</tr>
<tr class="odd">
<td>AZE</td>
<td>6.600660066006601e-3</td>
</tr>
<tr class="even">
<td>IRL</td>
<td>7.968127490039841e-4</td>
</tr>
<tr class="odd">
<td>LBN</td>
<td>4.357298474945534e-3</td>
</tr>
<tr class="even">
<td>GRC</td>
<td>1.5503875968992248e-3</td>
</tr>
<tr class="odd">
<td>TWN</td>
<td>1.3953488372093023e-2</td>
</tr>
<tr class="even">
<td>JOR</td>
<td>8.264462809917356e-3</td>
</tr>
<tr class="odd">
<td>DNK</td>
<td>3.278688524590164e-3</td>
</tr>
<tr class="even">
<td>SGP</td>
<td>4.901960784313725e-3</td>
</tr>
<tr class="odd">
<td>NAM</td>
<td>7.874015748031496e-3</td>
</tr>
<tr class="even">
<td>QAT</td>
<td>7.8125e-3</td>
</tr>
<tr class="odd">
<td>HND</td>
<td>3.048780487804878e-3</td>
</tr>
<tr class="even">
<td>LKA</td>
<td>3.3003300330033004e-3</td>
</tr>
<tr class="odd">
<td>GTM</td>
<td>4.878048780487805e-3</td>
</tr>
<tr class="even">
<td>GLP</td>
<td>7.518796992481203e-3</td>
</tr>
<tr class="odd">
<td>NOR</td>
<td>4.016064257028112e-3</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;SK&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AZE</td>
<td>1.3201320132013201e-2</td>
</tr>
<tr class="even">
<td>NLD</td>
<td>2.3344191096634093e-2</td>
</tr>
<tr class="odd">
<td>MEX</td>
<td>3.340834343084646e-2</td>
</tr>
<tr class="even">
<td>RUS</td>
<td>2.4571854058078928e-2</td>
</tr>
<tr class="odd">
<td>HRV</td>
<td>3.937007874015748e-2</td>
</tr>
<tr class="even">
<td>NPL</td>
<td>2.3316062176165803e-2</td>
</tr>
<tr class="odd">
<td>PRT</td>
<td>4.325437693099897e-2</td>
</tr>
<tr class="even">
<td>BGD</td>
<td>7.964601769911504e-2</td>
</tr>
<tr class="odd">
<td>LBN</td>
<td>1.7429193899782137e-2</td>
</tr>
<tr class="even">
<td>PRY</td>
<td>2.869757174392936e-2</td>
</tr>
<tr class="odd">
<td>CHL</td>
<td>4.233067729083665e-2</td>
</tr>
<tr class="even">
<td>IDN</td>
<td>2.582042312177245e-2</td>
</tr>
<tr class="odd">
<td>SAU</td>
<td>1.6865643357968543e-2</td>
</tr>
<tr class="even">
<td>PAK</td>
<td>1.1036174126302882e-2</td>
</tr>
<tr class="odd">
<td>AUS</td>
<td>2.6835043409629045e-2</td>
</tr>
<tr class="even">
<td>CAN</td>
<td>2.913453299057412e-2</td>
</tr>
<tr class="odd">
<td>GBR</td>
<td>2.70253043533686e-2</td>
</tr>
<tr class="even">
<td>BRA</td>
<td>2.671289323368098e-2</td>
</tr>
<tr class="odd">
<td>HND</td>
<td>3.353658536585366e-2</td>
</tr>
<tr class="even">
<td>GTM</td>
<td>2.6829268292682926e-2</td>
</tr>
<tr class="odd">
<td>DEU</td>
<td>2.84890010818608e-2</td>
</tr>
<tr class="even">
<td>ESP</td>
<td>2.608554763447829e-2</td>
</tr>
<tr class="odd">
<td>BHR</td>
<td>4.750593824228029e-3</td>
</tr>
<tr class="even">
<td>ECU</td>
<td>3.178484107579462e-2</td>
</tr>
<tr class="odd">
<td>IRN</td>
<td>2.0876826722338204e-2</td>
</tr>
<tr class="even">
<td>TUR</td>
<td>2.352575396414136e-2</td>
</tr>
<tr class="odd">
<td>VEN</td>
<td>2.94811320754717e-2</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>1.189376443418014e-2</td>
</tr>
<tr class="odd">
<td>TZA</td>
<td>1.615508885298869e-2</td>
</tr>
<tr class="even">
<td>USA</td>
<td>2.089384905468073e-2</td>
</tr>
<tr class="odd">
<td>MYS</td>
<td>2.3031969749054658e-2</td>
</tr>
<tr class="even">
<td>IND</td>
<td>3.3987036729267076e-2</td>
</tr>
<tr class="odd">
<td>ARE</td>
<td>1.5255530129672006e-2</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>2.357320099255583e-2</td>
</tr>
<tr class="odd">
<td>CUB</td>
<td>7.407407407407407e-2</td>
</tr>
<tr class="even">
<td>PHL</td>
<td>3.783081669102127e-2</td>
</tr>
<tr class="odd">
<td>DOM</td>
<td>1.6224188790560472e-2</td>
</tr>
<tr class="even">
<td>EGY</td>
<td>8.505812305075135e-3</td>
</tr>
<tr class="odd">
<td>JPN</td>
<td>2.0588235294117647e-2</td>
</tr>
<tr class="even">
<td>HUN</td>
<td>1.1235955056179775e-2</td>
</tr>
<tr class="odd">
<td>CYP</td>
<td>7.874015748031496e-3</td>
</tr>
<tr class="even">
<td>GLP</td>
<td>2.2556390977443608e-2</td>
</tr>
<tr class="odd">
<td>KWT</td>
<td>1.2100259291270527e-2</td>
</tr>
<tr class="even">
<td>IRL</td>
<td>3.5856573705179286e-2</td>
</tr>
<tr class="odd">
<td>BEL</td>
<td>4.852941176470588e-2</td>
</tr>
<tr class="even">
<td>COL</td>
<td>3.0054644808743168e-2</td>
</tr>
<tr class="odd">
<td>NGA</td>
<td>1.1624484991171278e-2</td>
</tr>
<tr class="even">
<td>ARG</td>
<td>2.4718649517684887e-2</td>
</tr>
<tr class="odd">
<td>CIV</td>
<td>1.1904761904761904e-2</td>
</tr>
<tr class="even">
<td>FIN</td>
<td>3.32409972299169e-2</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>1.6651248843663275e-2</td>
</tr>
<tr class="even">
<td>AUT</td>
<td>3.663003663003663e-2</td>
</tr>
<tr class="odd">
<td>SLV</td>
<td>3.0303030303030304e-2</td>
</tr>
<tr class="even">
<td>LBY</td>
<td>2.4875621890547265e-2</td>
</tr>
<tr class="odd">
<td>CMR</td>
<td>1.4457831325301205e-2</td>
</tr>
<tr class="even">
<td>CHE</td>
<td>2.459016393442623e-2</td>
</tr>
<tr class="odd">
<td>ITA</td>
<td>2.0260989010989012e-2</td>
</tr>
<tr class="even">
<td>SWE</td>
<td>1.8666666666666668e-2</td>
</tr>
<tr class="odd">
<td>PER</td>
<td>2.875399361022364e-2</td>
</tr>
<tr class="even">
<td>LSO</td>
<td>2.564102564102564e-2</td>
</tr>
<tr class="odd">
<td>THA</td>
<td>4.097951024487756e-2</td>
</tr>
<tr class="even">
<td>SEN</td>
<td>5.793742757821553e-3</td>
</tr>
<tr class="odd">
<td>URY</td>
<td>2.46189917936694e-2</td>
</tr>
<tr class="even">
<td>DNK</td>
<td>4.262295081967213e-2</td>
</tr>
<tr class="odd">
<td>BWA</td>
<td>1.634472511144131e-2</td>
</tr>
<tr class="even">
<td>CHN</td>
<td>1.968503937007874e-2</td>
</tr>
<tr class="odd">
<td>IRQ</td>
<td>1.950354609929078e-2</td>
</tr>
<tr class="even">
<td>CRI</td>
<td>3.0927835051546393e-2</td>
</tr>
<tr class="odd">
<td>JAM</td>
<td>1.7114914425427872e-2</td>
</tr>
<tr class="even">
<td>PAN</td>
<td>1.7214397496087636e-2</td>
</tr>
<tr class="odd">
<td>NIC</td>
<td>1.6666666666666666e-2</td>
</tr>
<tr class="even">
<td>NOR</td>
<td>3.614457831325301e-2</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>1.7094017094017096e-2</td>
</tr>
<tr class="even">
<td>MNG</td>
<td>2.0202020202020204e-2</td>
</tr>
<tr class="odd">
<td>HKG</td>
<td>3.333333333333333e-2</td>
</tr>
<tr class="even">
<td>NZL</td>
<td>2.8e-2</td>
</tr>
<tr class="odd">
<td>KEN</td>
<td>7.339449541284404e-3</td>
</tr>
<tr class="even">
<td>GHA</td>
<td>4.9532195927352776e-3</td>
</tr>
<tr class="odd">
<td>TWN</td>
<td>3.255813953488372e-2</td>
</tr>
<tr class="even">
<td>SRB</td>
<td>2.1739130434782608e-2</td>
</tr>
<tr class="odd">
<td>SGP</td>
<td>3.92156862745098e-2</td>
</tr>
<tr class="even">
<td>GRC</td>
<td>4.651162790697674e-3</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>1.1811023622047244e-2</td>
</tr>
<tr class="even">
<td>UGA</td>
<td>8.097165991902834e-3</td>
</tr>
<tr class="odd">
<td>DZA</td>
<td>1.2738853503184714e-2</td>
</tr>
<tr class="even">
<td>ISR</td>
<td>1.0e-2</td>
</tr>
<tr class="odd">
<td>NAM</td>
<td>2.6246719160104987e-3</td>
</tr>
<tr class="even">
<td>QAT</td>
<td>2.734375e-2</td>
</tr>
<tr class="odd">
<td>UKR</td>
<td>1.818181818181818e-2</td>
</tr>
<tr class="even">
<td>CZE</td>
<td>1.0676156583629894e-2</td>
</tr>
<tr class="odd">
<td>LKA</td>
<td>4.29042904290429e-2</td>
</tr>
<tr class="even">
<td>MWI</td>
<td>2.421307506053269e-3</td>
</tr>
<tr class="odd">
<td>OMN</td>
<td>5.547850208044383e-3</td>
</tr>
<tr class="even">
<td>KOR</td>
<td>2.0e-2</td>
</tr>
<tr class="odd">
<td>TTO</td>
<td>4.484304932735426e-3</td>
</tr>
<tr class="even">
<td>BHS</td>
<td>1.6260162601626018e-2</td>
</tr>
<tr class="odd">
<td>MAR</td>
<td>7.518796992481203e-3</td>
</tr>
<tr class="even">
<td>HTI</td>
<td>6.666666666666667e-3</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">python</span>
<span class="n">display</span><span class="p">(</span><span class="n">createProps</span><span class="p">(</span><span class="s2">&quot;prayer&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>iso_a3</th>
<th>proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CIV</td>
<td>7.936507936507936e-2</td>
</tr>
<tr class="even">
<td>FIN</td>
<td>0.18005540166204986</td>
</tr>
<tr class="odd">
<td>AZE</td>
<td>9.570957095709572e-2</td>
</tr>
<tr class="even">
<td>UKR</td>
<td>9.090909090909091e-2</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>0.1282051282051282</td>
</tr>
<tr class="even">
<td>NLD</td>
<td>0.1482084690553746</td>
</tr>
<tr class="odd">
<td>BWA</td>
<td>9.361069836552749e-2</td>
</tr>
<tr class="even">
<td>MNG</td>
<td>0.13131313131313133</td>
</tr>
<tr class="odd">
<td>POL</td>
<td>0.11193339500462535</td>
</tr>
<tr class="even">
<td>MEX</td>
<td>0.18123593560671628</td>
</tr>
<tr class="odd">
<td>CHN</td>
<td>0.14173228346456693</td>
</tr>
<tr class="even">
<td>AUT</td>
<td>0.22344322344322345</td>
</tr>
<tr class="odd">
<td>RUS</td>
<td>0.11243484735666419</td>
</tr>
<tr class="even">
<td>NAM</td>
<td>8.923884514435695e-2</td>
</tr>
<tr class="odd">
<td>HRV</td>
<td>0.12598425196850394</td>
</tr>
<tr class="even">
<td>SLV</td>
<td>0.21212121212121213</td>
</tr>
<tr class="odd">
<td>NPL</td>
<td>0.19430051813471502</td>
</tr>
<tr class="even">
<td>CZE</td>
<td>9.608540925266904e-2</td>
</tr>
<tr class="odd">
<td>PRT</td>
<td>8.650875386199794e-2</td>
</tr>
<tr class="even">
<td>GHA</td>
<td>0.12878370941111722</td>
</tr>
<tr class="odd">
<td>HKG</td>
<td>0.2</td>
</tr>
<tr class="even">
<td>TWN</td>
<td>0.11162790697674418</td>
</tr>
<tr class="odd">
<td>BGD</td>
<td>0.17256637168141592</td>
</tr>
<tr class="even">
<td>LBN</td>
<td>0.24618736383442266</td>
</tr>
<tr class="odd">
<td>PRY</td>
<td>0.1456953642384106</td>
</tr>
<tr class="even">
<td>CHL</td>
<td>0.14840637450199204</td>
</tr>
<tr class="odd">
<td>IDN</td>
<td>0.16058637347992671</td>
</tr>
<tr class="even">
<td>LBY</td>
<td>6.467661691542288e-2</td>
</tr>
<tr class="odd">
<td>SAU</td>
<td>0.12601857115785484</td>
</tr>
<tr class="even">
<td>PAK</td>
<td>0.12691600245248313</td>
</tr>
<tr class="odd">
<td>AUS</td>
<td>0.2170481452249408</td>
</tr>
<tr class="even">
<td>CAN</td>
<td>0.20108540417023707</td>
</tr>
<tr class="odd">
<td>GBR</td>
<td>0.16737841799987252</td>
</tr>
<tr class="even">
<td>BRA</td>
<td>0.175793571854841</td>
</tr>
<tr class="odd">
<td>GTM</td>
<td>0.13658536585365855</td>
</tr>
<tr class="even">
<td>DEU</td>
<td>0.2005048683736026</td>
</tr>
<tr class="odd">
<td>ECU</td>
<td>0.21026894865525672</td>
</tr>
<tr class="even">
<td>ESP</td>
<td>0.12022034996759559</td>
</tr>
<tr class="odd">
<td>BHR</td>
<td>0.12351543942992874</td>
</tr>
<tr class="even">
<td>IRN</td>
<td>0.10751565762004175</td>
</tr>
<tr class="odd">
<td>ISR</td>
<td>0.25666666666666665</td>
</tr>
<tr class="even">
<td>TUR</td>
<td>0.21898642346357136</td>
</tr>
<tr class="odd">
<td>VEN</td>
<td>0.3455188679245283</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>0.12240184757505773</td>
</tr>
<tr class="odd">
<td>CRI</td>
<td>0.12628865979381443</td>
</tr>
<tr class="even">
<td>TZA</td>
<td>0.13408723747980614</td>
</tr>
<tr class="odd">
<td>USA</td>
<td>0.14399768978579558</td>
</tr>
<tr class="even">
<td>SRB</td>
<td>0.13695652173913042</td>
</tr>
<tr class="odd">
<td>MYS</td>
<td>8.525266414575455e-2</td>
</tr>
<tr class="even">
<td>IND</td>
<td>0.3976234003656307</td>
</tr>
<tr class="odd">
<td>JAM</td>
<td>0.14180929095354522</td>
</tr>
<tr class="even">
<td>ARE</td>
<td>0.14721586575133486</td>
</tr>
<tr class="odd">
<td>CMR</td>
<td>0.1180722891566265</td>
</tr>
<tr class="even">
<td>FRA</td>
<td>0.1466087675765095</td>
</tr>
<tr class="odd">
<td>CHE</td>
<td>0.13934426229508196</td>
</tr>
<tr class="even">
<td>GRC</td>
<td>0.28217054263565894</td>
</tr>
<tr class="odd">
<td>PAN</td>
<td>0.13928012519561817</td>
</tr>
<tr class="even">
<td>JOR</td>
<td>0.1115702479338843</td>
</tr>
<tr class="odd">
<td>SGP</td>
<td>0.21568627450980393</td>
</tr>
<tr class="even">
<td>ITA</td>
<td>0.13427197802197802</td>
</tr>
<tr class="odd">
<td>CUB</td>
<td>0.1164021164021164</td>
</tr>
<tr class="even">
<td>SWE</td>
<td>0.19466666666666665</td>
</tr>
<tr class="odd">
<td>PHL</td>
<td>0.13865887319370027</td>
</tr>
<tr class="even">
<td>PER</td>
<td>0.16613418530351437</td>
</tr>
<tr class="odd">
<td>LSO</td>
<td>7.264957264957266e-2</td>
</tr>
<tr class="even">
<td>DOM</td>
<td>0.18289085545722714</td>
</tr>
<tr class="odd">
<td>QAT</td>
<td>0.13671875</td>
</tr>
<tr class="even">
<td>THA</td>
<td>0.18990504747626186</td>
</tr>
<tr class="odd">
<td>EGY</td>
<td>7.768641905301957e-2</td>
</tr>
<tr class="even">
<td>JPN</td>
<td>0.31676470588235295</td>
</tr>
<tr class="odd">
<td>SEN</td>
<td>7.068366164542295e-2</td>
</tr>
<tr class="even">
<td>NZL</td>
<td>0.192</td>
</tr>
<tr class="odd">
<td>LKA</td>
<td>0.132013201320132</td>
</tr>
<tr class="even">
<td>OMN</td>
<td>5.825242718446602e-2</td>
</tr>
<tr class="odd">
<td>KEN</td>
<td>8.807339449541285e-2</td>
</tr>
<tr class="even">
<td>CYP</td>
<td>0.2125984251968504</td>
</tr>
<tr class="odd">
<td>HTI</td>
<td>9.333333333333334e-2</td>
</tr>
<tr class="even">
<td>UGA</td>
<td>0.13225371120107962</td>
</tr>
<tr class="odd">
<td>IRL</td>
<td>0.16733067729083664</td>
</tr>
<tr class="even">
<td>KWT</td>
<td>0.1547104580812446</td>
</tr>
<tr class="odd">
<td>MAR</td>
<td>0.44360902255639095</td>
</tr>
<tr class="even">
<td>BEL</td>
<td>0.12205882352941176</td>
</tr>
<tr class="odd">
<td>NIC</td>
<td>0.10416666666666667</td>
</tr>
<tr class="even">
<td>NOR</td>
<td>0.1566265060240964</td>
</tr>
<tr class="odd">
<td>COL</td>
<td>0.21448087431693988</td>
</tr>
<tr class="even">
<td>URY</td>
<td>0.21805392731535755</td>
</tr>
<tr class="odd">
<td>NGA</td>
<td>0.15553266627427897</td>
</tr>
<tr class="even">
<td>ARG</td>
<td>0.15052250803858522</td>
</tr>
<tr class="odd">
<td>DNK</td>
<td>0.3344262295081967</td>
</tr>
<tr class="even">
<td>IRQ</td>
<td>0.14184397163120568</td>
</tr>
<tr class="odd">
<td>MWI</td>
<td>7.021791767554479e-2</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>9.448818897637795e-2</td>
</tr>
<tr class="odd">
<td>GLP</td>
<td>5.263157894736842e-2</td>
</tr>
<tr class="even">
<td>TTO</td>
<td>0.11659192825112108</td>
</tr>
<tr class="odd">
<td>COD</td>
<td>0.19402985074626866</td>
</tr>
<tr class="even">
<td>HND</td>
<td>0.13414634146341464</td>
</tr>
<tr class="odd">
<td>KOR</td>
<td>0.168</td>
</tr>
<tr class="even">
<td>DZA</td>
<td>0.14012738853503184</td>
</tr>
<tr class="odd">
<td>HUN</td>
<td>0.12359550561797752</td>
</tr>
<tr class="even">
<td>BHS</td>
<td>4.878048780487805e-2</td>
</tr>
</tbody>
</table></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-10_group-Geosmus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="01_Introduction.html" title="previous page">Twitter Streaming Using Geolocation and Emoji Based Sentiment Analysis</a>
    <a class='right-next' id="next-link" href="03_Dynamic_Tweet_Maps.html" title="next page">Dynamic Tweet Maps</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>