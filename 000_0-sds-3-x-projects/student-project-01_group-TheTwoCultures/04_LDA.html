
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Topic Modeling with LDA &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reading GQA JSON files" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/01_Loading_GQA-JSON.html" />
    <link rel="prev" title="Classification using Word2Vec" href="03_word2vec.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Letâ€™s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Letâ€™s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="00_download_data.html">
   The two cultures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_load_data.html">
   Preprocessing and loading the relevant data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_logisticregression.html">
   The two cultures - Classifying threads with logistic regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_word2vec.html">
   Classification using Word2Vec
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Topic Modeling with LDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/01_Loading_GQA-JSON.html">
   Reading GQA JSON files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/02_SceneGraphMotifs.html">
   Exploring the GQA Scene Graph Dataset Structure and Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/02_SceneGraphMotifs.html#general-discussion">
   General discussion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-03_group-GuangyiZhang/01_triads.html">
   Signed Triads in Social Media
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/01_DistributedSVD.html">
   Distributed singular value decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/02_CollaborativeFiltering.html">
   Music Recommendation System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html">
   Wikipedia analysis using Latent Dirichlet Allocation (LDA)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#folders-and-files">
   Folders and Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#downloading">
   Downloading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#extracting-and-filtering">
   Extracting and Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#prepare-for-lda">
   Prepare for LDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#lda">
   LDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html#looking-at-the-model">
   Looking at the model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html">
   Unsupervised clustering of particle physics data with distributed training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#introduction">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#background">
   Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#the-uclusted-algorithm">
   The UClusted algorithm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#motivation">
   Motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#our-contribution">
   Our contribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/01_data_and_preprocessing.html">
   Important!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/01_data_and_preprocessing.html#important-continued-from-above">
   Important (continued from above)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/04_evaluate.html">
   Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html">
   Motif Finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html#application">
   Application
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/02_Data_Processing.html">
   Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html">
   Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html#examples">
   Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_Introduction.html">
   Lit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_Introduction.html#docs">
   Docs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/model_2.html">
   MLP with auto-inferred
   <code class="docutils literal notranslate">
    <span class="pre">
     shapes
    </span>
   </code>
   param
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html">
   ScaDaMaLe project: Distributed ensembles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#imports">
   Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#data">
   Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#distributed-ensemble-of-neural-networks">
   Distributed ensemble of neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#distributed-ensembles-prediction-api">
   Distributed ensembles prediction API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#application-example-distributed-predictions">
   Application example: Distributed predictions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/project.html#application-example-out-of-distribution-detection">
   Application example: Out of distribution detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/01_Introduction.html">
   Topic Modeling with SARS-Cov-2 Genome ðŸ§¬
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/02_Data_Processing.html">
   Extract (overlapping [since yet do not know which parts corresponds to coding regions]) 3-mers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/03_LDA.html">
   Load processed data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/03_LDA.html#format-data-for-apache-spark-mllib-clustering-lda-adapted-from-the-lda-course-tutorial-034lda20newsgroupssmall">
   Format data for apache.spark.mllib.clustering.LDA (adapted from the LDA course tutorial â€˜034
   <em>
    LDA
   </em>
   20NewsGroupsSmallâ€™)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/03_LDA.html#visualise-results">
   Visualise Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html">
   Load processed data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html#format-data">
   Format data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html#classification">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html#evaluation">
   Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html">
   Load processed data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#explore-data">
   Explore data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#classification">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#evaluation">
   Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/06_Results.html">
   Results and Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/01_Introduction.html">
   Twitter Streaming Using Geolocation and Emoji Based Sentiment Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/02_ClusteringEmoticonsBasedOnTweets.html">
   Clustering emoticons based on tweets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/03_Dynamic_Tweet_Maps.html">
   Dynamic Tweet Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/04_conclusion.html">
   Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/05_appendix_get-cc-data.html">
   Notebook for collecting tweets with country codes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/07_a_appendix_extendedTwitterUtils2run.html">
   Note, this notebook has been edited slightly from the one supplied by Raaz.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/07_a_appendix_extendedTwitterUtils2run.html#scadamale-scalable-data-science-and-distributed-machine-learning">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/07_a_appendix_extendedTwitterUtils2run.html#extended-spark-streaming-twitter-twitterutils">
   Extended spark.streaming.twitter.TwitterUtils
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/07_b_appendix_TTTDFfunctions.html">
   Note, this notebook has been edited slightly from the one supplied by Raaz.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-10_group-Geosmus/07_b_appendix_TTTDFfunctions.html#scadamale-scalable-data-science-and-distributed-machine-learning">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-11_group-Sketchings/00_QuantileEstimation.html">
   Anomaly Detection with Iterative Quantile Estimation and T-digest
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/00_ProjectDescriptionAndPlanning.html">
   Project Description and Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_DownloadFilesPeriodicallyScript.html">
   Download Files Periodically
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_StreamToFile.html">
   Stream to parquet file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html">
   Loading data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html#preprocessing">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html">
   Loading data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html#preprocessing">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html">
   This notebook is for explosive analysis of features in data.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#statistics-of-invariant-features">
   Statistics of invariant features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-invariant-features">
   Correlation between invariant features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-new-case-per-million-total-case-new-death-per-million-total-death-per-million-reproduction-rate-and-stringency-index">
   Correlation between new case per million, total case, new death per million, total death per million, reproduction rate and stringency index.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html">
   Show reproduction rate of selected countries i.e. Sweden, Germany, Danmark, Finland, Norway
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#visualize-total-cases-total-deaths-new-cases-and-new-deaths-during-pandemic">
   Visualize total cases, total deaths, new cases and new deaths during pandemic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#total-deaths">
   Total Deaths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-cases">
   New Cases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-deaths">
   New Deaths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/05_Clustering.html">
   Clustering of country features in the Covid 19 dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/06_DataPredicton_LR.html">
   Prediction with Linear Regression (LR) Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/07_DataPredicton_ARIMA.html">
   Prediction with Time Series model - ARIMA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/08_DataPrediction_GP.html">
   Prediction with time series model - Gaussian Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html">
   Genomics Analysis with Glow and Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#load-libs-and-define-helper-functions">
   Load libs and define helper functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#read-data">
   Read data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#pca">
   PCA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#predicting-ethinicity">
   Predicting Ethinicity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#filtering-of-snps-based-on-chi-squared-test">
   Filtering of SNPs based on chi-squared test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-14_group-NullHypothesisEvaluationCriteria/distributed_combinatorial_bandit.html">
   Distributional combinatorial bandits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/00_video.html">
   Reinforcement Learning for Intraday Trading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/01_rl_intraday_trading.html">
   Reinforcement Learning for Intraday Trading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html">
   Reinforcement Learning for Intraday Trading - Distributed model tuning with Elephas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#elephas">
   Elephas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#notes-to-the-elephas-training">
   Notes to the elephas training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#id1">
   Notes to the elephas training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html#environment">
   Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html#rl-algorithms">
   RL-Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html#scalable-dl">
   Scalable DL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html#spark-scalability-monitoring">
   Spark scalability monitoring
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html#raaz-to-group">
   Raaz to groupâ€¦
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html">
   Problem Definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html#loading-and-preprocessing-data">
   Loading and Preprocessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-18_group-ProjectRL/Intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-18_group-ProjectRL/Intro.html#problem-description">
   Problem description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html">
   Link to our video explaining the 1) theory, 2) preprocessing the dataset, 3) algorithm and 4) results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html#https-drive-google-com-drive-folders-1zewj6jsjeuu9f8q5xy-avwxq3yj9oi7z-usp-sharing">
   https://drive.google.com/drive/folders/1zEWj6JsJEUu9f8Q5Xy_avwxQ3yJ9oI7Z?usp=sharing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html#problem-formulation">
   Problem formulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html#results">
   Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html">
   The data set
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html#mixup-data-generator">
   MixUp data generator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html#training-function">
   Training function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html#connection-between-mixup-performance-and-generalization">
   Connection between MixUp performance and generalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html#directly-training-on-mixup-data">
   Directly training on MixUp data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-20_group-Generalization/02_CNNs.html#conclusions">
   Conclusions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/00_introduction.html">
   Graph Spectral Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/01_preprocess_data.html">
   Preprocess the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/02_generate_graphs.html">
   Generate random graphs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/03_compute_rsvd.html">
   Compute RSVD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/04_analyse_eigenvalues.html">
   Analyse the eigenvalue spectrum
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/04_LDA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/04_LDA.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-description">
   Notebook description
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-the-data">
   Downloading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preprocessing-and-loading-the-relevant-data">
   Preprocessing and loading the relevant data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lda-methods">
   LDA Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stopwords">
     Stopwords
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   Experiments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="topic-modeling-with-lda">
<h1>Topic Modeling with LDA<a class="headerlink" href="#topic-modeling-with-lda" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="notebook-description">
<h2>Notebook description<a class="headerlink" href="#notebook-description" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://www.flashback.org/">Flashback</a> and
<a class="reference external" href="https://www.familjeliv.se/forum">Familjeliv</a> are two well-known swedish
online forums. Flashback is one of Swedenâ€™s most visited websites and
has discussions on a wide-range of topics. It is famous for emphasizing
freedom of speech and the members citizen journalism on many topics. The
online forum Familjeliv, on the other hand, focuses more on questions
about pregnancy, children and parenthood (the translation is â€œFamily
Lifeâ€). Part of the forum is also for more general topics, and this part
of Familjeliv is probably more famous than its other parts.</p>
<p>What we want to do in this notebook is analyze the language used in
these two, quite different, online forums. An interesting approach we
will try here is to do some topic modeling with <a class="reference external" href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation">Latent Dirichlet
Allocation</a>
(LDA). We know that each discussion forum in our data has multiple
subforums, so it would be interesting to see if LDA can accurately pick
up these different subforums as different topics, or if it sees other
patterns in the threads (the threads are what corresponds to documents
in the LDA method). We will also mainly do this with forums that have a
correspondence in both Flashback and Familjeliv. For instance, both have
forums dedicated to questions regarding economy and also forums
discussing topics close to sex and relationships.</p>
<p>This notebook is to a large extent adapted from notebook
034<em>LDA</em>20NewsGroupsSmall.</p>
</div>
<div class="section" id="downloading-the-data">
<h2>Downloading the data<a class="headerlink" href="#downloading-the-data" title="Permalink to this headline">Â¶</a></h2>
<p>Data comes from <a class="reference external" href="https://spraakbanken.gu.se">sprÃ¥kbanken</a>, see notebook
00<em>download</em>data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">00</span><span class="n">_download_data</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="preprocessing-and-loading-the-relevant-data">
<h2>Preprocessing and loading the relevant data<a class="headerlink" href="#preprocessing-and-loading-the-relevant-data" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">just</span> <span class="kn">import</span> <span class="nn">methods</span> <span class="kn">from</span> <span class="nn">notebook</span> <span class="mi">01</span><span class="n">_load_data</span><span class="p">,</span> <span class="n">so</span> <span class="n">we</span> <span class="n">can</span> <span class="n">load</span> <span class="n">our</span> <span class="n">data</span>

<span class="o">%</span><span class="n">run</span> <span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">01</span><span class="n">_load_data</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.functions.{col, concat_ws, udf, flatten, explode, collect_list, collect_set, lit}
import org.apache.spark.sql.types.{ArrayType, StructType, StructField, StringType, IntegerType}
import com.databricks.spark.xml._
import org.apache.spark.sql.functions._
read_xml: (file_name: String)org.apache.spark.sql.DataFrame
get_dataset: (file_name: String)org.apache.spark.sql.DataFrame
</pre></div>
</div>
</div></blockquote>
<p>[TABLE]</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_df: (df: org.apache.spark.sql.DataFrame, filePath: String)Unit
load_df: (filePath: String)org.apache.spark.sql.DataFrame
no_forums: (df: org.apache.spark.sql.DataFrame)Long
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>familjeliv-allmanna-ekonomi.xml already exists!
familjeliv-sexsamlevnad.xml already exists!
flashback-ekonomi.xml already exists!
flashback-sex.xml already exists!
import sys.process._
fl_data: Array[String] = Array(familjeliv-allmanna-ekonomi.xml, familjeliv-sexsamlevnad.xml)
fb_data: Array[String] = Array(flashback-ekonomi.xml, flashback-sex.xml)
url: String = http://spraakbanken.gu.se/lb/resurser/meningsmangder/
tmp_folder_fl: String = /tmp/familjeliv/
tmp_folder_fb: String = /tmp/flashback/
res3: String = &quot;&quot;
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dbfs:/datasets/student-project-01/flashback/familjeliv-allmanna-ekonomi_df
familjeliv-allmanna-ekonomi_df already exists!
dbfs:/datasets/student-project-01/flashback/familjeliv-sexsamlevnad_df
familjeliv-sexsamlevnad_df already exists!
dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df
flashback-ekonomi_df already exists!
dbfs:/datasets/student-project-01/flashback/flashback-sex_df
flashback-sex_df already exists!
fl_root: String = dbfs:/datasets/student-project-01/familjeliv/
fb_root: String = dbfs:/datasets/student-project-01/flashback/
fl_data: Array[String] = Array(familjeliv-allmanna-ekonomi, familjeliv-sexsamlevnad)
fb_data: Array[String] = Array(flashback-ekonomi, flashback-sex)
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="lda-methods">
<h2>LDA Methods<a class="headerlink" href="#lda-methods" title="Permalink to this headline">Â¶</a></h2>
<p>Below we put some of the LDA pipeline, working with
<a class="reference external" href="https://spark.apache.org/docs/latest/ml-guide.html">MLlib</a>, into a
single function called get_lda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.</span><span class="p">{</span><span class="n">RegexTokenizer</span><span class="p">,</span> <span class="n">StopWordsRemover</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.clustering.</span><span class="p">{</span><span class="n">LDA</span><span class="p">,</span> <span class="n">OnlineLDAOptimizer</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.ml.</span><span class="p">{</span><span class="n">Pipeline</span><span class="p">,</span> <span class="n">PipelineModel</span><span class="p">,</span> <span class="n">PipelineStage</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="p">{</span> <span class="n">LongType</span> <span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.ml.linalg.Vector</span>

<span class="k">def</span> <span class="nf">get_lda</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>  <span class="o">//</span> <span class="n">Main</span> <span class="n">function</span> <span class="n">to</span> <span class="n">do</span> <span class="n">LDA</span>
            <span class="n">min_token</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">vocabSize</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">minDF</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>            
            <span class="n">numTopics</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">maxIter</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">stopWords</span><span class="p">:</span> <span class="n">Array</span><span class="p">[</span><span class="n">String</span><span class="p">])</span> <span class="o">=</span> <span class="p">{</span> 

  <span class="n">val</span> <span class="n">corpus_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">LongType</span><span class="p">))</span> <span class="o">//</span> <span class="n">From</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">dataframe</span> <span class="n">we</span> <span class="n">take</span> <span class="n">out</span> <span class="n">each</span> <span class="n">thread</span>

  <span class="n">val</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RegexTokenizer</span><span class="p">()</span>
  <span class="o">.</span><span class="n">setPattern</span><span class="p">(</span><span class="s2">&quot;(?U)[</span><span class="se">\\</span><span class="s2">W_]+&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="k">break</span> <span class="n">by</span> <span class="n">white</span> <span class="n">space</span> <span class="n">character</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="o">-</span> <span class="k">try</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">emails</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">patterns</span>
  <span class="o">.</span><span class="n">setMinTokenLength</span><span class="p">(</span><span class="n">min_token</span><span class="p">)</span> <span class="o">//</span> <span class="n">Filter</span> <span class="n">away</span> <span class="n">tokens</span> <span class="k">with</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">min_token</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">column</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">column</span>
  
  <span class="n">val</span> <span class="n">remover</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StopWordsRemover</span><span class="p">()</span> 
  <span class="o">.</span><span class="n">setStopWords</span><span class="p">(</span><span class="n">stopWords</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">getOutputCol</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
  
  <span class="n">val</span> <span class="n">tokenized_df</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus_df</span><span class="p">)</span> <span class="o">//</span> <span class="n">Removes</span> <span class="n">uninteresting</span> <span class="n">words</span> <span class="kn">from</span> <span class="nn">each</span> <span class="n">thread</span>
  <span class="n">val</span> <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">remover</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">tokenized_df</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Chosing</span> <span class="n">only</span> <span class="n">the</span> <span class="n">filtered</span> <span class="n">threads</span> 
  
  <span class="n">val</span> <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CountVectorizer</span><span class="p">()</span> <span class="o">//</span> <span class="n">Creates</span> <span class="n">dictionary</span> <span class="ow">and</span> <span class="n">counts</span> <span class="n">the</span> <span class="n">occurences</span> <span class="n">of</span> <span class="n">different</span> <span class="n">words</span>
   <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="n">remover</span><span class="o">.</span><span class="n">getOutputCol</span><span class="p">)</span>
   <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">setVocabSize</span><span class="p">(</span><span class="n">vocabSize</span><span class="p">)</span> <span class="o">//</span> <span class="n">Size</span> <span class="n">of</span> <span class="n">dictonary</span>
   <span class="o">.</span><span class="n">setMinDF</span><span class="p">(</span><span class="n">minDF</span><span class="p">)</span>
   <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">//</span> <span class="n">returns</span> <span class="n">CountVectorizerModel</span>
  
  <span class="n">val</span> <span class="n">lda</span> <span class="o">=</span> <span class="n">new</span> <span class="n">LDA</span><span class="p">()</span> <span class="o">//</span> <span class="n">Creates</span> <span class="n">LDA</span> <span class="n">Model</span> <span class="k">with</span> <span class="n">some</span> <span class="n">user</span> <span class="n">defined</span> <span class="n">choice</span> <span class="n">of</span> <span class="n">parameters</span>
  <span class="o">.</span><span class="n">setOptimizer</span><span class="p">(</span><span class="n">new</span> <span class="n">OnlineLDAOptimizer</span><span class="p">()</span><span class="o">.</span><span class="n">setMiniBatchFraction</span><span class="p">(</span><span class="mf">0.8</span><span class="p">))</span>
  <span class="o">.</span><span class="n">setK</span><span class="p">(</span><span class="n">numTopics</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setMaxIterations</span><span class="p">(</span><span class="n">maxIter</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setDocConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">use</span> <span class="n">default</span> <span class="n">values</span>
  <span class="o">.</span><span class="n">setTopicConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  
  <span class="n">val</span> <span class="n">countVectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>

  <span class="n">val</span> <span class="n">lda_countVector</span> <span class="o">=</span> <span class="n">countVectors</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Row</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">Long</span><span class="p">,</span> <span class="n">countVector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">countVector</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">val</span> <span class="n">lda_countVector_mllib</span> <span class="o">=</span> <span class="n">lda_countVector</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mllib</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Vectors</span><span class="o">.</span><span class="n">fromML</span><span class="p">(</span><span class="n">vector</span><span class="p">))</span> <span class="p">}</span><span class="o">.</span><span class="n">rdd</span>
  
  <span class="n">val</span> <span class="n">lda_model</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lda_countVector_mllib</span><span class="p">)</span>
  <span class="p">(</span><span class="n">lda_model</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.{RegexTokenizer, StopWordsRemover, CountVectorizer}
import org.apache.spark.mllib.clustering.{LDA, OnlineLDAOptimizer}
import org.apache.spark.ml.{Pipeline, PipelineModel, PipelineStage}
import org.apache.spark.sql.types.LongType
import org.apache.spark.ml.linalg.Vector
get_lda: (df: org.apache.spark.sql.DataFrame, min_token: Int, vocabSize: Int, minDF: Int, numTopics: Int, maxIter: Int, stopWords: Array[String])(org.apache.spark.mllib.clustering.LDAModel, org.apache.spark.ml.feature.CountVectorizerModel)
</pre></div>
</div>
</div></blockquote>
<div class="section" id="stopwords">
<h3>Stopwords<a class="headerlink" href="#stopwords" title="Permalink to this headline">Â¶</a></h3>
<p>Stop words are highly relevant to get interesting topics distributions,
with not all weight on very common words that do not carry much meaning
for a particular topic. To do this we both use collections by others and
input words we find meaningless for these particular settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">peterdalle</span><span class="o">/</span><span class="n">svensktext</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">stoppord</span><span class="o">/</span><span class="n">stoppord</span><span class="o">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--2021-01-11 14:30:09--  https://raw.githubusercontent.com/peterdalle/svensktext/master/stoppord/stoppord.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.52.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.52.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1936 (1.9K) [text/plain]
Saving to: â€˜/tmp/stopwords.csvâ€™

     0K .                                                     100% 11.5M=0s

2021-01-11 14:30:09 (11.5 MB/s) - â€˜/tmp/stopwords.csvâ€™ saved [1936/1936]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">file</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span> <span class="n">dbfs</span><span class="p">:</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res24: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Creating</span> <span class="n">a</span> <span class="nb">list</span> <span class="k">with</span> <span class="n">stopwords</span>

<span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.StopWordsRemover</span>
<span class="n">val</span> <span class="n">stoppord</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/stopwords.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="n">val</span> <span class="n">stopwordList</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="s2">&quot;bara&quot;</span><span class="p">,</span><span class="s2">&quot;lite&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;vill&quot;</span><span class="p">,</span><span class="s2">&quot;samt&quot;</span><span class="p">,</span><span class="s2">&quot;inga&quot;</span><span class="p">,</span><span class="s2">&quot;Ã¤ven&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;ganska&quot;</span><span class="p">,</span><span class="s2">&quot;ocksÃ¥&quot;</span><span class="p">,</span><span class="s2">&quot;igen&quot;</span><span class="p">,</span><span class="s2">&quot;just&quot;</span><span class="p">,</span><span class="s2">&quot;that&quot;</span><span class="p">,</span><span class="s2">&quot;with&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;kanske&quot;</span><span class="p">,</span><span class="s2">&quot;tycker&quot;</span><span class="p">,</span><span class="s2">&quot;gillar&quot;</span><span class="p">,</span> <span class="s2">&quot;bra&quot;</span><span class="p">,</span><span class="s2">&quot;the&quot;</span><span class="p">,</span><span class="s2">&quot;000&quot;</span><span class="p">,</span><span class="s2">&quot;mÃ¥ste&quot;</span><span class="p">,</span><span class="s2">&quot;tjej&quot;</span><span class="p">,</span><span class="s2">&quot;tjejer&quot;</span><span class="p">,</span><span class="s2">&quot;tjejen&quot;</span><span class="p">,</span><span class="s2">&quot;tjejerna&quot;</span><span class="p">,</span><span class="s2">&quot;kvinna&quot;</span><span class="p">,</span><span class="s2">&quot;kvinnor&quot;</span><span class="p">,</span><span class="s2">&quot;kille&quot;</span><span class="p">,</span><span class="s2">&quot;killar&quot;</span><span class="p">,</span><span class="s2">&quot;killen&quot;</span><span class="p">,</span><span class="s2">&quot;mÃ¤n&quot;</span><span class="p">,</span><span class="s2">&quot;rÃ¤tt&quot;</span><span class="p">,</span><span class="s2">&quot;mÃ¤n&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;and&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;mÃ¥nga&quot;</span><span class="p">,</span><span class="s2">&quot;aldrig&quot;</span><span class="p">,</span><span class="s2">&quot;www&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;wmv&quot;</span><span class="p">,</span><span class="s2">&quot;fan&quot;</span><span class="p">,</span><span class="s2">&quot;fÃ¶rhelvetet&quot;</span><span class="p">,</span><span class="s2">&quot;riktigt&quot;</span><span class="p">,</span><span class="s2">&quot;kÃ¤nner&quot;</span><span class="p">,</span><span class="s2">&quot;vÃ¤ldigt&quot;</span><span class="p">,</span><span class="s2">&quot;font&quot;</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;mms&quot;</span><span class="p">,</span><span class="s2">&quot;2008&quot;</span><span class="p">,</span><span class="s2">&quot;2009&quot;</span><span class="p">,</span><span class="s2">&quot;95kr&quot;</span><span class="p">,</span><span class="s2">&quot;dom&quot;</span><span class="p">,</span><span class="s2">&quot;fÃ¥r&quot;</span><span class="p">,</span><span class="s2">&quot;ska&quot;</span><span class="p">,</span><span class="s2">&quot;kommer&quot;</span><span class="p">,</span><span class="s2">&quot;tvÃ¥&quot;</span><span class="p">,</span><span class="s2">&quot;vet&quot;</span><span class="p">,</span><span class="s2">&quot;mer&quot;</span><span class="p">,</span><span class="s2">&quot;pengar&quot;</span><span class="p">,</span><span class="s2">&quot;pengarna&quot;</span><span class="p">,</span><span class="s2">&quot;gÃ¶ra&quot;</span><span class="p">,</span><span class="s2">&quot;fick&quot;</span><span class="p">,</span><span class="s2">&quot;tror&quot;</span><span class="p">,</span><span class="s2">&quot;andra&quot;</span><span class="p">,</span><span class="s2">&quot;helt&quot;</span><span class="p">,</span><span class="s2">&quot;kunna&quot;</span><span class="p">,</span><span class="s2">&quot;behÃ¶ver&quot;</span><span class="p">,</span><span class="s2">&quot;betala&quot;</span><span class="p">,</span><span class="s2">&quot;inget&quot;</span><span class="p">,</span><span class="s2">&quot;dock&quot;</span><span class="p">,</span><span class="s2">&quot;inget&quot;</span><span class="p">,</span><span class="s2">&quot;tack&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">stoppord</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">StopWordsRemover</span><span class="o">.</span><span class="n">loadDefaultStopWords</span><span class="p">(</span><span class="s2">&quot;swedish&quot;</span><span class="p">))</span> <span class="o">//</span> <span class="n">In</span> <span class="n">this</span> <span class="n">step</span> <span class="n">we</span> <span class="n">add</span> <span class="n">custom</span> <span class="n">stop</span> <span class="n">words</span> <span class="ow">and</span> <span class="n">another</span> <span class="n">premade</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">stopwords</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.StopWordsRemover
stoppord: Array[String] = Array(word, all, alla, allas, allt, alltsÃ¥, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, bÃ¥da, bÃ¥das, bÃ¥de, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, dÃ¤r, dÃ¤rfÃ¶r, dÃ¥, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjÃ¤rde, fler, flera, flesta, fram, framfÃ¶r, frÃ¥n, fyra, fyrtio, fyrtionde, fÃ¥, fÃ¥r, fÃ¥tt, fÃ¶r, fÃ¶re, fÃ¶rra, fÃ¶rsta, ge, genom, ger, gick, gjorde, gjort, gÃ¤lla, gÃ¤ller, gÃ¤llt, gÃ¤rna, gÃ¥, gÃ¥ng, gÃ¥r, gÃ¥tt, gÃ¶r, gÃ¶ra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjÃ¤lp, hon, honom, hundra, hundraen, hundraett, hur, hÃ¤r, i, ibland, icke, igen, in, infÃ¶r, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jÃ¤mfÃ¶rt, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kÃ¶r, legat, ligga, ligger, lÃ¤gga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, nÃ¤r, nÃ¤sta, nÃ¥gon, nÃ¥gonting, nÃ¥got, nÃ¥gra, nÃ¥n, nÃ¥t, och, ocksÃ¥, om, oss, pÃ¥, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, sjÃ¤lv, sjÃ¤tte, ska, skall, skriver, skulle, slutligen, snart, som, stÃ¥r, sÃ¤ga, sÃ¤ger, sÃ¤tt, sÃ¥, sÃ¥dan, sÃ¥dana, sÃ¥dant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvÃ¥, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, tvÃ¥, tvÃ¥hundra, under, upp, ur, ut, utan, utanfÃ¶r, ute, vad, var, vara, varfÃ¶r, varifrÃ¥n, varit, varje, varken, vars, varsÃ¥god, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, vÃ¤l, vÃ¤rre, vÃ¥r, vÃ¥ra, vÃ¥rt, Ã¤n, Ã¤ndÃ¥, Ã¤nnu, Ã¤r, Ã¤ven, Ã¥ret, Ã¥t, Ã¥tminstone, Ã¥tta, Ã¥ttio, Ã¥ttionde, Ã¥ttonde, Ã¶ver, Ã¶vre)
stopwordList: Array[String] = Array(bara, lite, finns, vill, samt, inga, Ã¤ven, finns, ganska, ocksÃ¥, igen, just, that, with, http, jpg, kanske, tycker, gillar, bra, the, 000, mÃ¥ste, tjej, tjejer, tjejen, tjejerna, kvinna, kvinnor, kille, killar, killen, mÃ¤n, rÃ¤tt, mÃ¤n, com, and, html, mÃ¥nga, aldrig, www, mpg, avi, wmv, fan, fÃ¶rhelvetet, riktigt, kÃ¤nner, vÃ¤ldigt, font, size, mms, 2008, 2009, 95kr, dom, fÃ¥r, ska, kommer, tvÃ¥, vet, mer, pengar, pengarna, gÃ¶ra, fick, tror, andra, helt, kunna, behÃ¶ver, betala, inget, dock, inget, tack, word, all, alla, allas, allt, alltsÃ¥, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, bÃ¥da, bÃ¥das, bÃ¥de, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, dÃ¤r, dÃ¤rfÃ¶r, dÃ¥, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjÃ¤rde, fler, flera, flesta, fram, framfÃ¶r, frÃ¥n, fyra, fyrtio, fyrtionde, fÃ¥, fÃ¥r, fÃ¥tt, fÃ¶r, fÃ¶re, fÃ¶rra, fÃ¶rsta, ge, genom, ger, gick, gjorde, gjort, gÃ¤lla, gÃ¤ller, gÃ¤llt, gÃ¤rna, gÃ¥, gÃ¥ng, gÃ¥r, gÃ¥tt, gÃ¶r, gÃ¶ra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjÃ¤lp, hon, honom, hundra, hundraen, hundraett, hur, hÃ¤r, i, ibland, icke, igen, in, infÃ¶r, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jÃ¤mfÃ¶rt, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kÃ¶r, legat, ligga, ligger, lÃ¤gga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, nÃ¤r, nÃ¤sta, nÃ¥gon, nÃ¥gonting, nÃ¥got, nÃ¥gra, nÃ¥n, nÃ¥t, och, ocksÃ¥, om, oss, pÃ¥, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, sjÃ¤lv, sjÃ¤tte, ska, skall, skriver, skulle, slutligen, snart, som, stÃ¥r, sÃ¤ga, sÃ¤ger, sÃ¤tt, sÃ¥, sÃ¥dan, sÃ¥dana, sÃ¥dant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvÃ¥, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, tvÃ¥, tvÃ¥hundra, under, upp, ur, ut, utan, utanfÃ¶r, ute, vad, var, vara, varfÃ¶r, varifrÃ¥n, varit, varje, varken, vars, varsÃ¥god, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, vÃ¤l, vÃ¤rre, vÃ¥r, vÃ¥ra, vÃ¥rt, Ã¤n, Ã¤ndÃ¥, Ã¤nnu, Ã¤r, Ã¤ven, Ã¥ret, Ã¥t, Ã¥tminstone, Ã¥tta, Ã¥ttio, Ã¥ttionde, Ã¥ttonde, Ã¶ver, Ã¶vre, och, det, att, i, en, jag, hon, som, han, pÃ¥, den, med, var, sig, fÃ¶r, sÃ¥, till, Ã¤r, men, ett, om, hade, de, av, icke, mig, du, henne, dÃ¥, sin, nu, har, inte, hans, honom, skulle, hennes, dÃ¤r, min, man, ej, vid, kunde, nÃ¥got, frÃ¥n, ut, nÃ¤r, efter, upp, vi, dem, vara, vad, Ã¶ver, Ã¤n, dig, kan, sina, hÃ¤r, ha, mot, alla, under, nÃ¥gon, eller, allt, mycket, sedan, ju, denna, sjÃ¤lv, detta, Ã¥t, utan, varit, hur, ingen, mitt, ni, bli, blev, oss, din, dessa, nÃ¥gra, deras, blir, mina, samma, vilken, er, sÃ¥dan, vÃ¥r, blivit, dess, inom, mellan, sÃ¥dant, varfÃ¶r, varje, vilka, ditt, vem, vilket, sitta, sÃ¥dana, vart, dina, vars, vÃ¥rt, vÃ¥ra, ert, era, vilkas)
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="experiments">
<h2>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">Â¶</a></h2>
<p>Below we we chosen some similar forums from FB and FL. First two
regarding economics, and two discussing sex and relationships. Here we
run the two economics forums and see how well TDA captures any topic
structure.</p>
<p>Here one does not have to use similar forums, but if one is interested
in only Flashback forums one could use only those. We could also of
course join several of these forums together to try to capture even
broader topic distributions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Loading</span> <span class="n">the</span> <span class="n">forums</span> <span class="n">we</span> <span class="n">will</span> <span class="n">do</span> <span class="n">LDA</span> <span class="n">on</span><span class="o">.</span>

<span class="n">val</span> <span class="n">file_path_FL</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-allmanna-ekonomi_df&quot;</span>
<span class="n">val</span> <span class="n">file_path_FB</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df&quot;</span>
<span class="o">//</span><span class="n">val</span> <span class="n">file_path_FL</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-sexsamlevnad_df&quot;</span>
<span class="o">//</span><span class="n">val</span> <span class="n">file_path_FB</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/flashback/flashback-sex_df&quot;</span>
  
<span class="n">val</span> <span class="n">df_FL</span> <span class="o">=</span> <span class="n">load_df</span><span class="p">(</span><span class="n">file_path_FL</span><span class="p">)</span>
<span class="n">val</span> <span class="n">df_FB</span> <span class="o">=</span> <span class="n">load_df</span><span class="p">(</span><span class="n">file_path_FB</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_path_FL: String = dbfs:/datasets/student-project-01/familjeliv/familjeliv-allmanna-ekonomi_df
file_path_FB: String = dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df
df_FL: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
df_FB: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Dataframes</span> <span class="n">containg</span> <span class="n">a</span> <span class="n">forum</span> <span class="kn">from</span> <span class="nn">FB.</span>

<span class="n">df_FB</span><span class="o">.</span><span class="n">show</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
|thread_id|        thread_title|                   w|forum_id|         forum_title| platform|           corpus_id|
+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
|  1005670| &quot;Spara i madrassen&quot;|DÃ¤r,stÃ¥r,mycket,l...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1005847|Invester vinst in...|Om,du,sÃ¤tter,av,t...|     258|Ekonomi &gt; FÃ¶retag...|flashback|flashback-ekonomi...|
|  1008130|Johan Norbergs En...|Tack,.,El,penal,d...|     293|Ekonomi &gt; Nationa...|flashback|flashback-ekonomi...|
|  1008965|&quot;Det stora raset&quot;...|Om,tekniken,fÃ¥r,f...|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
|  1011185|EF och dra av dyr...|PÃ¥,fÃ¶retaget,dÃ¤r,...|     258|Ekonomi &gt; FÃ¶retag...|flashback|flashback-ekonomi...|
|  1013160|    Vilken Kinafond?|Jag,tror,pÃ¥,HQ,Ki...|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
|  1014006|FÃ¶rvara kontanter...|Det,Ã¤r,sÃ¥,extrema...|     294|Ekonomi &gt; Private...|flashback|flashback-ekonomi...|
|  1015049|     InkÃ¶p i fÃ¶retag|Ã„r,ny,inom,fÃ¶reta...|     258|Ekonomi &gt; FÃ¶retag...|flashback|flashback-ekonomi...|
|   101813|     Startkapitalet?|Av,MVH,/,/,Detta,...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1025347|           BlancÃ¥lÃ¥n|hjÃ¤lp,!,Sen,tycke...|     294|Ekonomi &gt; Private...|flashback|flashback-ekonomi...|
|  1032576|           korvkiosk|Finns,vanliga,kor...|     258|Ekonomi &gt; FÃ¶retag...|flashback|flashback-ekonomi...|
|  1034516|Vilka Kina fonder...|Vill,man,hÃ¶ja,ris...|     489|    Ekonomi &gt; Fonder|flashback|flashback-ekonomi...|
|  1036269|Handla optioner i...|Visst,stÃ¤mmer,det...|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
|  1037036|Vad tjÃ¤nar en fÃ¶r...|Jag,jobbar,ocksÃ¥,...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1039302|KapitalfÃ¶rsÃ¤kring...|Brytpunkten,fÃ¶r,d...|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
|  1041102|    Begreppet pengar|Statligt,utfÃ¤rdad...|     293|Ekonomi &gt; Nationa...|flashback|flashback-ekonomi...|
|  1041767|      AvrÃ¤kningsnota|fÃ¶rsta,alternativ...|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
|  1042680|UtlÃ¤ndska indexfo...|Tycker,sjÃ¤lv,att,...|     489|    Ekonomi &gt; Fonder|flashback|flashback-ekonomi...|
|  1043999|Tulldeklaration, ...|sÃ¥,vad,mer,behÃ¶ve...|     258|Ekonomi &gt; FÃ¶retag...|flashback|flashback-ekonomi...|
|  1045539|        mini futures|handlar,med,RBS,....|     260|Ekonomi &gt; VÃ¤rdepa...|flashback|flashback-ekonomi...|
+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
only showing top 20 rows
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Overview of number of threads in different subforums

df_FL.groupBy($&quot;forum_title&quot;).agg(count($&quot;forum_title&quot;).as(&quot;count&quot;)).show(false)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------+-----+
|forum_title                                               |count|
+----------------------------------------------------------+-----+
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Konsument/Inhandla|26307|
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; FamiljerÃ¤tt       |1623 |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Ã–vrigt            |1638 |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Ekonomi           |24284|
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Spartips          |217  |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Juridik           |3246 |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; FÃ¶retagande       |957  |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; LÃ¥n &amp; skulder     |1168 |
+----------------------------------------------------------+-----+
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>df_FB.groupBy($&quot;forum_title&quot;).agg(count($&quot;forum_title&quot;).as(&quot;count&quot;)).show(false)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------------------------------------------------+-----+
|forum_title                                        |count|
+---------------------------------------------------+-----+
|Ekonomi &gt; Privatekonomi                            |15154|
|Ekonomi &gt; Bitcoin och andra virtuella valutor      |524  |
|Ekonomi &gt; VÃ¤rdepapper, valutor och rÃ¥varor: allmÃ¤nt|8300 |
|Ekonomi &gt; Fonder                                   |645  |
|Ekonomi &gt; FÃ¶retagande och fÃ¶retagsekonomi          |12139|
|Ekonomi &gt; Nationalekonomi                          |3114 |
|Ekonomi &gt; Aktier                                   |508  |
|Ekonomi &gt; Ekonomi: Ã¶vrigt                          |19308|
|Ekonomi &gt; Offshore och skatteplanering             |1567 |
+---------------------------------------------------+-----+
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Set</span> <span class="n">parameters</span><span class="p">,</span> <span class="ow">and</span> <span class="n">perform</span> <span class="n">two</span> <span class="n">different</span> <span class="n">LDAs</span><span class="p">,</span> <span class="n">one</span> <span class="n">on</span> <span class="n">FB</span> <span class="ow">and</span> <span class="n">one</span> <span class="n">on</span> <span class="n">FL</span>

<span class="n">val</span> <span class="n">min_token</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">//</span> <span class="n">only</span> <span class="n">accept</span> <span class="n">tokens</span> <span class="n">larger</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span>
<span class="n">val</span> <span class="n">vocabSize</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">//</span> <span class="n">Size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vocab</span> <span class="n">dictionary</span>
<span class="n">val</span> <span class="n">minDF</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">//</span> <span class="n">The</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">different</span> <span class="n">documents</span> <span class="n">a</span> <span class="n">term</span> <span class="n">must</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">to</span> <span class="n">be</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">minTF</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">//</span> <span class="n">The</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">a</span> <span class="n">term</span> <span class="n">has</span> <span class="n">to</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">document</span> <span class="n">to</span> <span class="n">be</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vocabulary</span>

<span class="n">val</span> <span class="n">numTopics_FL</span> <span class="o">=</span> <span class="n">no_forums</span><span class="p">(</span><span class="n">df_FL</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span> <span class="o">//</span><span class="mi">4</span> <span class="o">//</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">topics</span> <span class="ow">in</span> <span class="n">LDA</span> <span class="n">model</span>
<span class="n">val</span> <span class="n">numTopics_FB</span> <span class="o">=</span> <span class="n">no_forums</span><span class="p">(</span><span class="n">df_FB</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span>
<span class="n">val</span> <span class="n">maxIter</span> <span class="o">=</span> <span class="mi">8</span>  <span class="o">//</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="k">for</span> <span class="n">LDA</span> <span class="n">model</span>
<span class="n">val</span> <span class="n">stopwords</span> <span class="o">=</span> <span class="n">stopwordList</span>
<span class="n">val</span> <span class="p">(</span><span class="n">ldaModel_FL</span><span class="p">,</span> <span class="n">vectorizer_FL</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_lda</span><span class="p">(</span><span class="n">df_FL</span><span class="p">,</span> <span class="n">min_token</span><span class="p">,</span> <span class="n">vocabSize</span><span class="p">,</span> <span class="n">minDF</span><span class="p">,</span> <span class="n">numTopics_FL</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">)</span>
<span class="n">val</span> <span class="p">(</span><span class="n">ldaModel_FB</span><span class="p">,</span> <span class="n">vectorizer_FB</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_lda</span><span class="p">(</span><span class="n">df_FB</span><span class="p">,</span> <span class="n">min_token</span><span class="p">,</span> <span class="n">vocabSize</span><span class="p">,</span> <span class="n">minDF</span><span class="p">,</span> <span class="n">numTopics_FB</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------+
|forum_title                                               |
+----------------------------------------------------------+
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Konsument/Inhandla|
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; FamiljerÃ¤tt       |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Ã–vrigt            |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Ekonomi           |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Spartips          |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; Juridik           |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; FÃ¶retagande       |
|AllmÃ¤nna rubriker &gt; Ekonomi &amp; juridik &gt; LÃ¥n &amp; skulder     |
+----------------------------------------------------------+

+---------------------------------------------------+
|forum_title                                        |
+---------------------------------------------------+
|Ekonomi &gt; Privatekonomi                            |
|Ekonomi &gt; Bitcoin och andra virtuella valutor      |
|Ekonomi &gt; VÃ¤rdepapper, valutor och rÃ¥varor: allmÃ¤nt|
|Ekonomi &gt; Fonder                                   |
|Ekonomi &gt; FÃ¶retagande och fÃ¶retagsekonomi          |
|Ekonomi &gt; Nationalekonomi                          |
|Ekonomi &gt; Aktier                                   |
|Ekonomi &gt; Ekonomi: Ã¶vrigt                          |
|Ekonomi &gt; Offshore och skatteplanering             |
+---------------------------------------------------+

min_token: Int = 4
vocabSize: Int = 10000
minDF: Int = 5
minTF: Int = 2
numTopics_FL: Int = 8
numTopics_FB: Int = 9
maxIter: Int = 8
stopwords: Array[String] = Array(bara, lite, finns, vill, samt, inga, Ã¤ven, finns, ganska, ocksÃ¥, igen, just, that, with, http, jpg, kanske, tycker, gillar, bra, the, 000, mÃ¥ste, tjej, tjejer, tjejen, tjejerna, kvinna, kvinnor, kille, killar, killen, mÃ¤n, rÃ¤tt, mÃ¤n, com, and, html, mÃ¥nga, aldrig, www, mpg, avi, wmv, fan, fÃ¶rhelvetet, riktigt, kÃ¤nner, vÃ¤ldigt, font, size, mms, 2008, 2009, 95kr, dom, fÃ¥r, ska, kommer, tvÃ¥, vet, mer, pengar, pengarna, gÃ¶ra, fick, tror, andra, helt, kunna, behÃ¶ver, betala, inget, dock, inget, tack, word, all, alla, allas, allt, alltsÃ¥, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, bÃ¥da, bÃ¥das, bÃ¥de, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, dÃ¤r, dÃ¤rfÃ¶r, dÃ¥, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjÃ¤rde, fler, flera, flesta, fram, framfÃ¶r, frÃ¥n, fyra, fyrtio, fyrtionde, fÃ¥, fÃ¥r, fÃ¥tt, fÃ¶r, fÃ¶re, fÃ¶rra, fÃ¶rsta, ge, genom, ger, gick, gjorde, gjort, gÃ¤lla, gÃ¤ller, gÃ¤llt, gÃ¤rna, gÃ¥, gÃ¥ng, gÃ¥r, gÃ¥tt, gÃ¶r, gÃ¶ra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjÃ¤lp, hon, honom, hundra, hundraen, hundraett, hur, hÃ¤r, i, ibland, icke, igen, in, infÃ¶r, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jÃ¤mfÃ¶rt, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kÃ¶r, legat, ligga, ligger, lÃ¤gga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, nÃ¤r, nÃ¤sta, nÃ¥gon, nÃ¥gonting, nÃ¥got, nÃ¥gra, nÃ¥n, nÃ¥t, och, ocksÃ¥, om, oss, pÃ¥, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, sjÃ¤lv, sjÃ¤tte, ska, skall, skriver, skulle, slutligen, snart, som, stÃ¥r, sÃ¤ga, sÃ¤ger, sÃ¤tt, sÃ¥, sÃ¥dan, sÃ¥dana, sÃ¥dant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvÃ¥, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, tvÃ¥, tvÃ¥hundra, under, upp, ur, ut, utan, utanfÃ¶r, ute, vad, var, vara, varfÃ¶r, varifrÃ¥n, varit, varje, varken, vars, varsÃ¥god, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, vÃ¤l, vÃ¤rre, vÃ¥r, vÃ¥ra, vÃ¥rt, Ã¤n, Ã¤ndÃ¥, Ã¤nnu, Ã¤r, Ã¤ven, Ã¥ret, Ã¥t, Ã¥tminstone, Ã¥tta, Ã¥ttio, Ã¥ttionde, Ã¥ttonde, Ã¶ver, Ã¶vre, och, det, att, i, en, jag, hon, som, han, pÃ¥, den, med, var, sig, fÃ¶r, sÃ¥, till, Ã¤r, men, ett, om, hade, de, av, icke, mig, du, henne, dÃ¥, sin, nu, har, inte, hans, honom, skulle, hennes, dÃ¤r, min, man, ej, vid, kunde, nÃ¥got, frÃ¥n, ut, nÃ¤r, efter, upp, vi, dem, vara, vad, Ã¶ver, Ã¤n, dig, kan, sina, hÃ¤r, ha, mot, alla, under, nÃ¥gon, eller, allt, mycket, sedan, ju, denna, sjÃ¤lv, detta, Ã¥t, utan, varit, hur, ingen, mitt, ni, bli, blev, oss, din, dessa, nÃ¥gra, deras, blir, mina, samma, vilken, er, sÃ¥dan, vÃ¥r, blivit, dess, inom, mellan, sÃ¥dant, varfÃ¶r, varje, vilka, ditt, vem, vilket, sitta, sÃ¥dana, vart, dina, vars, vÃ¥rt, vÃ¥ra, ert, era, vilkas)
ldaModel_FL: org.apache.spark.mllib.clustering.LDAModel = org.apache.spark.mllib.clustering.LocalLDAModel@10a74a7d
vectorizer_FL: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_92cbca9d69d3
ldaModel_FB: org.apache.spark.mllib.clustering.LDAModel = org.apache.spark.mllib.clustering.LocalLDAModel@28741094
vectorizer_FB: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_aaaff6faf1cc
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">Â¶</a></h2>
<p>Here we will visualize the most important part of the different topic
distributions, both for FB and for FL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">pick</span> <span class="n">out</span> <span class="n">the</span> <span class="n">most</span> <span class="n">important</span> <span class="n">terms</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">topic</span> <span class="k">for</span> <span class="n">FL</span><span class="o">.</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FL</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FL</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>8 topics:
TOPIC 0
tillbaka	0.008216191335042956
skatt	0.006509257902643634
betalar	0.005635041121233399
folk	0.005131491885839656
jobb	0.0051057124094540714
==========
TOPIC 1
barn	0.013917573767387432
spara	0.00891926717912398
skrev	0.008795787566591128
fÃ¶ljande	0.007687478743540771
kÃ¶pa	0.007421083954132069
==========
TOPIC 2
jobb	0.005941548013271099
banken	0.005184644368971845
betalar	0.004761136982814706
jobbar	0.004732367048439004
tillbaka	0.00447708103221914
==========
TOPIC 3
kÃ¶per	0.011086173062869036
handlar	0.010707762120455214
Ã¤ter	0.007974933506441925
kÃ¶pa	0.007856980307486902
vuxna	0.005976512509098039
==========
TOPIC 4
kÃ¶pa	0.009345022745034834
klÃ¤der	0.007752851561346635
kÃ¶pte	0.0057978627025462625
barn	0.005201306667796932
kolla	0.004548491158766831
==========
TOPIC 5
barn	0.02047574524007617
barnet	0.009776681578582441
barnen	0.005742962450413186
skrev	0.004847780768717609
jobb	0.004608856784822973
==========
TOPIC 6
betalar	0.010248488991996553
ekonomi	0.008863292049078849
huset	0.0068847763666443585
kÃ¶pa	0.006869607591782869
barn	0.0062769843242390586
==========
TOPIC 7
buffert	0.022462688377360988
kontantinsats	0.01832413857067284
000kr	0.012844781601955733
resa	0.008253097762916517
amortering	0.005493083255139651
==========
topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(8, 51, 3, 21, 7),Array(0.008216191335042956, 0.006509257902643634, 0.005635041121233399, 0.005131491885839656, 0.0051057124094540714)), (Array(0, 15, 2, 11, 1),Array(0.013917573767387432, 0.00891926717912398, 0.008795787566591128, 0.007687478743540771, 0.007421083954132069)), (Array(7, 52, 3, 24, 8),Array(0.005941548013271099, 0.005184644368971845, 0.004761136982814706, 0.004732367048439004, 0.00447708103221914)), (Array(5, 12, 168, 1, 161),Array(0.011086173062869036, 0.010707762120455214, 0.007974933506441925, 0.007856980307486902, 0.005976512509098039)), (Array(1, 6, 19, 0, 16),Array(0.009345022745034834, 0.007752851561346635, 0.0057978627025462625, 0.005201306667796932, 0.004548491158766831)), (Array(0, 40, 27, 2, 7),Array(0.02047574524007617, 0.009776681578582441, 0.005742962450413186, 0.004847780768717609, 0.004608856784822973)), (Array(3, 30, 37, 1, 0),Array(0.010248488991996553, 0.008863292049078849, 0.0068847763666443585, 0.006869607591782869, 0.0062769843242390586)), (Array(157, 370, 166, 226, 469),Array(0.022462688377360988, 0.01832413857067284, 0.012844781601955733, 0.008253097762916517, 0.005493083255139651)))
vocabList: Array[String] = Array(barn, kÃ¶pa, skrev, betalar, alltid, kÃ¶per, klÃ¤der, jobb, tillbaka, saker, olika, fÃ¶ljande, handlar, kostar, brukar, spara, kolla, bÃ¤ttre, svar, kÃ¶pte, borde, folk, hemma, lika, jobbar, faktiskt, precis, barnen, frÃ¥ga, istÃ¤llet, ekonomi, annars, runt, mindre, inkomst, sambo, hoppas, huset, kÃ¤nns, kÃ¶pt, barnet, bort, ihop, verkar, alls, hÃ¥ller, problem, dessutom, stor, mÃ¥nad, svÃ¥rt, skatt, banken, fÃ¶rstÃ¥r, tjÃ¤nar, lÃ¥ter, tips, extra, direkt, jobba, lÃ¤nge, rÃ¤kningar, mamma, klart, stÃ¶rre, tyvÃ¤rr, beror, konto, handla, vissa, ofta, massa, tÃ¤nker, sÃ¥nt, liten, rÃ¤nta, sparar, egentligen, undrar, ville, lÃ¤gger, skriva, dÃ¤remot, stora, sÃ¤lja, billigare, veta, mest, sjÃ¤lva, sÃ¤kert, absolut, tÃ¤nkte, tÃ¤nka, enligt, leva, nÃ¤stan, bilen, fÃ¶rÃ¤ldrar, fÃ¶rst, hitta, sett, funkar, hyra, enkelt, anvÃ¤nda, sjÃ¤lvklart, lÃ¥na, enda, fortfarande, tidigare, sambon, ungefÃ¤r, anvÃ¤nder, bÃ¶rja, egen, egna, lÃ¤ngre, nytt, lÃ¤tt, utgifter, ringa, kort, lÃ¤genhet, bÃ¶rjar, behÃ¶va, sitter, summa, billigt, hittar, trots, tillsammans, rÃ¤kna, pappa, trÃ¥den, bÃ¤sta, liknande, fÃ¶retag, skicka, bank, dyrt, jobbet, flytta, rÃ¤knar, klarar, pris, hjÃ¤lpa, lever, sÃ¤ljer, slut, vilja, hÃ¶gre, betalt, anser, lÃ¥net, okej, ifrÃ¥n, oftast, buffert, mÃ¤nniskor, gott, hÃ¥lla, vuxna, koll, sÃ¤tta, tagit, klara, 000kr, dyrare, Ã¤ter, byta, betalat, jobbat, stort, vÃ¤lja, dotter, hand, tÃ¤nkt, person, vÃ¤ljer, lycka, gratis, familj, bÃ¤st, delar, eget, oavsett, nÃ¤tet, boende, gemensam, lÃ¥ngt, frÃ¥gan, sidan, gamla, dÃ¥ligt, sparande, bidrag, tyckte, minst, vanliga, rÃ¤cker, hÃ¤nder, haha, konstigt, vÃ¤nta, plus, sonen, priset, hÃ¶rt, undan, sida, summan, drar, dela, betalade, kostade, mÃ¥naden, rÃ¤knas, skaffa, skillnad, vÃ¤rt, mÃ¶jligt, skrivit, exakt, fÃ¶rsÃ¶ka, mÃ¥nader, ersÃ¤ttning, resa, fungerar, fÃ¶rsÃ¶ker, kostnader, lÃ¤sa, endast, papper, trodde, rÃ¤ntan, hemsida, sÃ¤tter, inlÃ¤gg, lÃ¤genheten, beroende, prata, skulder, spelar, vanligt, tÃ¤nk, resten, innebÃ¤r, liksom, speciellt, massor, sÃ¶ka, gemensamma, skor, sÃ¤ljaren, pappan, dyra, vore, lÃ¤mna, emot, nÃ¶jd, tusen, halva, livet, kontot, roll, ingenting, hittade, Ã¥ker, hÃ¶ra, bÃ¶rjan, funderar, butik, namn, igenom, svara, trÃ¥d, lÃ¶nen, enbart, ring, gemensamt, lÃ¤st, familjen, kassan, heltid, visa, kassa, fattar, personer, arbetslÃ¶s, fina, ansvar, totalt, ekonomiskt, ringer, paket, ringde, bÃ¶rjade, nÃ¥tt, slipper, dottern, barnbidraget, satt, telefon, inkomster, sÃ¥klart, exempel, betalas, internet, fÃ¶retaget, storlek, dÃ¥lig, vatten, dagis, miljoner, passar, Ã¤lskar, stÃ¤mmer, ingÃ¥r, personen, tanke, vÃ¤nner, hÃ¤lften, arbete, skÃ¶nt, lagt, Ã¤ger, utbildning, jÃ¤ttebra, varor, lÃ¶sa, stod, sparat, tjÃ¤na, kosta, behÃ¶vs, lÃ¥ta, fÃ¶rsÃ¤kring, vagn, fort, ekonomin, frakt, viktigt, mÃ¶jlighet, kompis, snabbt, glad, sÃ¶nder, problemet, skit, Ã¶vrigt, mamman, plats, tydligen, gÃ¥nger, reda, lÃ¤gre, situation, vanlig, varan, aning, fÃ¶rstÃ¥, semester, bilar, maken, sÃ¤ker, hyran, varandra, tacksam, erfarenhet, billiga, kontantinsats, butiken, skolan, sÃ¤rskilt, kontakt, iallafall, rent, skickar, sÃ¥na, tycka, mesta, betyder, viss, alternativ, affÃ¤ren, avtal, lilla, 3000, mail, kÃ¶ra, bostad, hittat, kollar, handlat, fint, visste, lÃ¤ser, fonder, fÃ¶rutom, ifall, sparkonto, stan, blÃ¶jor, valt, kontakta, givetvis, litet, alldeles, pratar, tiden, maten, priser, vÃ¤ntar, ensam, 2000, behov, antar, knappt, anledning, kollat, lÃ¤ste, roligt, jobbade, sjuk, 5000, skatten, sÃ¶ker, fyller, kÃ¤nna, gifta, japp, rÃ¤knat, vÃ¥ran, bÃ¶rjat, avgift, posten, slippa, barnbidrag, 1000, vagnen, titta, jÃ¤tte, affÃ¤r, bestÃ¤lla, intressant, frÃ¥gade, ivÃ¤g, nyfiken, saken, betydligt, fÃ¶rklara, flyttade, antingen, fixa, sÃ¤llan, bostadsrÃ¤tt, fÃ¶rÃ¤ldrarna, krÃ¤va, svenska, hamnar, nÃ¤ra, kollade, dras, hjÃ¤lper, synd, billig, kostnaden, vÃ¤rde, flyttar, amortering, berÃ¤tta, fÃ¶rsÃ¤kringar, gÃ¥ngen, frÃ¥gor, rabatt, knappast, nÃ¥gonstans, brev, sjukt, sluta, bensin, sÃ¥lt, ekonomiska, antal, mannen, rÃ¤kningarna, illa, svart, blocket, kreditkort, gammal, hÃ¤nda, dÃ¤rifrÃ¥n, sparade, minns, jobbigt, underhÃ¥ll, skickat, medan, frÃ¥gar, resor, fullt, arbetar, otroligt, sÃ¤mre, tvungen, julklappar, orkar, snÃ¤lla, landet, senare, fÃ¶rÃ¤ldrapenning, mobil, kostnad, plagg, gravid, regler, amortera, iofs, klÃ¤derna, krav, kortet, princip, inkl, bodde, rimligt, Ã¶verens, 4000, kronofogden, lÃ¤ttare, hÃ¶ga, kredit, vinst, lÃ¥ng, behÃ¶vde, form, skull, affÃ¤rer, konton, mÃ¶bler, menade, bostadsbidrag, normalt, fÃ¶rstÃ¥s, fÃ¶rÃ¤ldraledig, hehe, barnets, prova, fÃ¶rut, banker, sjukskriven, privat, handlade, plugga, fortsÃ¤tta, kÃ¶tt, kontant, ihÃ¥g, rÃ¤kning, dels, visar, sÃ¤ljare, byxor, kÃ¶rkort, butiker, hÃ¤nt, lÃ¥nen, kring, vecka, vÃ¥rdnad, krÃ¤ver, naturligtvis, onÃ¶digt, fÃ¶rÃ¤lder, Ã¶vriga, svaret, mjÃ¶lk, budget, bild, barnens, sÃ¥lde, skickade, kÃ¶pet, lÃ¤ra, brÃ¶d, trÃ¥kigt, fÃ¶rmodligen, behÃ¥lla, vÃ¤gen, himla, nÃ¤mligen, arbeta, sant, avdrag, rosa, anvÃ¤nt, kÃ¶paren, Ã¤ndra, trÃ¶ja, tillÃ¤ggskommentar, skuld, inkÃ¶p, valde, info, trÃ¥dstartarens, fasta, coop, beslut, fÃ¶rslag, nordea, utÃ¶ver, pass, testa, bestÃ¤llt, facket, personligen, Ã¤ldre, faktura, belopp, stÃ¤lle, rÃ¤ntor, intresserad, utomlands, nÃ¶jen, antagligen, full, fundera, paketet, arbetsgivare, hÃ¤mta, avbetalning, lÃ¥nar, tillrÃ¤ckligt, polisen, jeans, fylla, rÃ¤cka, fallet, kunder, snarare, fÃ¶rrÃ¤n, priserna, mÃ¤rke, dator, Ã¥ring, lunch, sÃ¥hÃ¤r, lidl, studielÃ¥n, perfekt, lÃ¶ser, ensamstÃ¥ende, ekonomisk, kommun, stÃ¤lla, Ã¶nskar, brÃ¶llop, lÃ¤mnar, bygga, 1500, krÃ¤vs, bebis, kronor, starta, forum, fÃ¶rsÃ¶rja, bestÃ¤llde, uppgifter, dÃ¤rmed, 2007, villa, information, stÃ¤llet, chans, vÃ¤rlden, delad, fÃ¶rsÃ¶kt, stÃ¤llen, dumt, leta, stad, begagnat, lyckas, bilder, vuxen, aktier, lÃ¶ner, pratat, bott, hÃ¶gt, bryr, studerar, svarar, skillnaden, fÃ¶rstÃ¥tt, gekÃ¥s, jacka, glÃ¶mde, grund, tillÃ¤gga, tala, godis, nÃ¶jda, mÃ¤rken, tjÃ¤nst, tanken, borta, avgifter, shoppa, syster, hinner, laga, senaste, tillgÃ¥ngar, skulden, Ã¶ppna, plÃ¶tsligt, situationen, skriv, ovan, tittar, krona, stÃ¶rsta, automatiskt, smart, hamna, miljon, beloppet, snygga, anmÃ¤la, gett, 6000, leksaker, pluggar, ytterligare, omÃ¶jligt, kommunen, lagen, utav, sparkontot, pratade, drygt, mÃ¤nniska, vÃ¤nda, puffar, visserligen, sÃ¤ttet, fÃ¶rresten, bestÃ¤mma, bestÃ¤mt, datum, barnklÃ¤der, frakten, bolag, skatteverket, present, hyresrÃ¤tt, studier, jÃ¤vla, kvitto, fÃ¶rhoppningsvis, bankerna, skyldig, ordentligt, sambos, produkter, dags, annorlunda, arbetsgivaren, tillkommer, ringt, jÃ¤mfÃ¶ra, amorterar, rÃ¤dd, fattig, passa, samhÃ¤llet, moms, erbjudande, sÃ¤kerhet, Ã¥lder, risk, summor, middag, trist, exempelvis, fÃ¶rsÃ¶k, inkomsten, puff, svarade, jurist, betalda, vÃ¥rat, dagens, vÃ¤grar, vÃ¤rd, allra, staten, minsta, vÃ¤rsta, lÃ¥ga, fÃ¶rhÃ¥llande, bolÃ¥n, hÃ¤nger, dÃ¥liga, bÃ¶cker, kund, trÃ¥dar, telefonen, rÃ¤kningen, kostnaderna, anledningen, fÃ¶rsvinner, huvudet, usch, hemifrÃ¥n, hÃ¥ll, lagar, timmar, student, lÃ¤gsta, utifrÃ¥n, skiljer, bredband, grej, klar, julklapp, vare, planerar, begÃ¤ra, jaha, flyttat, letar, lÃ¥nga, guld, tillgÃ¥ng, noga, angÃ¥ende, tjÃ¤nat, ledig, sidor, fÃ¤rg, tillbaks, hÃ¥rt, planera, advokat, bostaden, igÃ¥ng, klÃ¤nning, studera, hund, skÃ¤l, poÃ¤ng, extremt, kvalitet, anvÃ¤nds, systemet, socialbidrag, stÃ¤ller, isÃ¥fall, nuvarande, kompisar, rÃ¶ra, reklam, definitivt, syskon, enskild, stÃ¤llt, utmÃ¤rkt, relativt, pension, snygg, datorn, suck, trÃ¤ffa, tvÃ¤rtom, Ã¥kte, Ã¶ppet, vÃ¥gar, missat, risken, vinsten, frukt, minus, land, trÃ¶tt, mammaledig, service, spel, chef, svensk, gymnasiet, vÃ¤rdet, funka, avgiften, riktig, snÃ¥l, anstÃ¤lld, lÃ¤get, fÃ¶rsÃ¤ljning, sÃ¤ng, osÃ¤ker, gift, Ã¶verallt, diskutera, velat, fÃ¶rlorar, bevisa, fakturan, frÃ¤mst, djur, sÃ¥dÃ¤r, bestÃ¤mmer, Ã¶verhuvudtaget, grÃ¶nsaker, modell, anstÃ¤llning, kalla, strl, lagom, fÃ¶rhand, Ã¥sikter, prylar, lÃ¤nken, skola, fÃ¶lja, 7000, adress, trivs, kÃ¶pare, kunden, boendet, goda, super, saknar, kram, skÃ¶ter, skaffar, medans, presenter, tackar, lÃ¤gg, vitt, sakerna, lÃ¥nade, kÃ¤nde, byter, medlem, mÃ¤klaren, slags, jÃ¤mfÃ¶r, dÃ¤refter, tipset, fÃ¶rÃ¤ldern, tÃ¤cker, huslÃ¥n, lÃ¥nat, billigaste, vÃ¤ll, Ã¥sikt, tillfÃ¤llet, slutar, kaffe, 500kr, ansÃ¶ka, unna, uppe, storlekar, testamente, grattis, rÃ¤tten, sorry, 8000, tipsa, spar, utom, barns, rÃ¤knade, provat, hemmet, kanon, troligen, anvÃ¤ndas, nivÃ¥, privata, lyckats, deklarationen, omrÃ¥de, senast, plocka, renovering, 2500, toppen, separat, sÃ¶kt, roliga, slÃ¤nga, sambons, spendera, egendom)
topics: Array[Array[(String, Double)]] = Array(Array((tillbaka,0.008216191335042956), (skatt,0.006509257902643634), (betalar,0.005635041121233399), (folk,0.005131491885839656), (jobb,0.0051057124094540714)), Array((barn,0.013917573767387432), (spara,0.00891926717912398), (skrev,0.008795787566591128), (fÃ¶ljande,0.007687478743540771), (kÃ¶pa,0.007421083954132069)), Array((jobb,0.005941548013271099), (banken,0.005184644368971845), (betalar,0.004761136982814706), (jobbar,0.004732367048439004), (tillbaka,0.00447708103221914)), Array((kÃ¶per,0.011086173062869036), (handlar,0.010707762120455214), (Ã¤ter,0.007974933506441925), (kÃ¶pa,0.007856980307486902), (vuxna,0.005976512509098039)), Array((kÃ¶pa,0.009345022745034834), (klÃ¤der,0.007752851561346635), (kÃ¶pte,0.0057978627025462625), (barn,0.005201306667796932), (kolla,0.004548491158766831)), Array((barn,0.02047574524007617), (barnet,0.009776681578582441), (barnen,0.005742962450413186), (skrev,0.004847780768717609), (jobb,0.004608856784822973)), Array((betalar,0.010248488991996553), (ekonomi,0.008863292049078849), (huset,0.0068847763666443585), (kÃ¶pa,0.006869607591782869), (barn,0.0062769843242390586)), Array((buffert,0.022462688377360988), (kontantinsats,0.01832413857067284), (000kr,0.012844781601955733), (resa,0.008253097762916517), (amortering,0.005493083255139651)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">pick</span> <span class="n">out</span> <span class="n">the</span> <span class="n">most</span> <span class="n">important</span> <span class="n">terms</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">topic</span> <span class="k">for</span> <span class="n">FB</span><span class="o">.</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FB</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FB</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FB topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9 topics:
TOPIC 0
aktier	0.010372609709935948
fonder	0.009985682032437188
kÃ¶pa	0.007147380184535501
fÃ¶retag	0.004942859552056198
olika	0.004763000081202069
==========
TOPIC 1
skatt	0.014364304931778378
fÃ¶retag	0.008645452621562126
fÃ¶retaget	0.008300389229465058
bolaget	0.007903692818210637
bolag	0.006402673712961038
==========
TOPIC 2
folk	0.0052167273044414555
jobb	0.004475724890639614
kÃ¶pa	0.0044337052877254195
bÃ¤ttre	0.003773904791916776
istÃ¤llet	0.003169961913268716
==========
TOPIC 3
bitcoin	0.015097168905144656
bitcoins	0.009816539841970279
kÃ¶pa	0.0040680120997631155
fÃ¶retag	0.0032437136384805445
olika	0.0030445615311591244
==========
TOPIC 4
moms	0.00633827140783334
kÃ¶pa	0.005959993345718559
fÃ¶retag	0.005906188488700269
sÃ¤lja	0.005238515382692445
betalar	0.004281708500936429
==========
TOPIC 5
banken	0.00864432335805033
konto	0.008339277536899259
bank	0.007340445595021358
tillbaka	0.005965709762899769
rÃ¤nta	0.005342093657300021
==========
TOPIC 6
kÃ¶pa	0.0034366699860672793
banken	0.003289013342902767
moms	0.003103723942186164
kÃ¶per	0.003101990581430088
will	0.0030185287141540774
==========
TOPIC 7
inflation	0.007176851887240197
guld	0.006395635479842193
staten	0.006005858645610903
valuta	0.005155325598855097
vÃ¤rde	0.0049879413505575666
==========
TOPIC 8
aktier	0.012040212950249483
kÃ¶pa	0.007639727547960423
aktien	0.006203784300724798
bolag	0.0057716967783410945
aktie	0.004584515168344491
==========
topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(1, 42, 0, 2, 15),Array(0.010372609709935948, 0.009985682032437188, 0.007147380184535501, 0.004942859552056198, 0.004763000081202069)), (Array(7, 2, 32, 40, 23),Array(0.014364304931778378, 0.008645452621562126, 0.008300389229465058, 0.007903692818210637, 0.006402673712961038)), (Array(3, 25, 0, 4, 9),Array(0.0052167273044414555, 0.004475724890639614, 0.0044337052877254195, 0.003773904791916776, 0.003169961913268716)), (Array(554, 726, 0, 2, 15),Array(0.015097168905144656, 0.009816539841970279, 0.0040680120997631155, 0.0032437136384805445, 0.0030445615311591244)), (Array(115, 0, 2, 6, 10),Array(0.00633827140783334, 0.005959993345718559, 0.005906188488700269, 0.005238515382692445, 0.004281708500936429)), (Array(5, 22, 20, 12, 13),Array(0.00864432335805033, 0.008339277536899259, 0.007340445595021358, 0.005965709762899769, 0.005342093657300021)), (Array(0, 5, 115, 16, 993),Array(0.0034366699860672793, 0.003289013342902767, 0.003103723942186164, 0.003101990581430088, 0.0030185287141540774)), (Array(220, 87, 65, 254, 56),Array(0.007176851887240197, 0.006395635479842193, 0.006005858645610903, 0.005155325598855097, 0.0049879413505575666)), (Array(1, 0, 63, 23, 100),Array(0.012040212950249483, 0.007639727547960423, 0.006203784300724798, 0.0057716967783410945, 0.004584515168344491)))
vocabList: Array[String] = Array(kÃ¶pa, aktier, fÃ¶retag, folk, bÃ¤ttre, banken, sÃ¤lja, skatt, borde, istÃ¤llet, betalar, verkar, tillbaka, rÃ¤nta, frÃ¥ga, olika, kÃ¶per, mindre, alltid, stor, bank, problem, konto, bolag, stÃ¶rre, jobb, stora, direkt, runt, lika, svÃ¥rt, svar, fÃ¶retaget, precis, kÃ¤nns, handlar, saker, fÃ¶rstÃ¥r, dessutom, kort, bolaget, enkelt, fonder, enligt, lÃ¥na, hÃ¶gre, sÃ¤ljer, hÃ¥ller, vinst, brukar, kostar, kolla, annars, faktiskt, lÃ¥ter, svenska, vÃ¤rde, egentligen, spara, bÃ¶rja, bort, tidigare, tjÃ¤nar, aktien, lÃ¤nge, staten, marknaden, enda, sÃ¤kert, ekonomi, fortfarande, anvÃ¤nda, liknande, inkomst, mest, rÃ¤ntan, frÃ¥gan, tÃ¤nker, hoppas, vissa, bÃ¶rsen, ihop, bÃ¶rjar, tjÃ¤na, tips, klart, banker, guld, dÃ¤remot, sett, fungerar, miljoner, intressant, exempel, sitter, trÃ¥den, kapital, hÃ¥lla, mÃ¤nniskor, egen, aktie, mÃ¶jligt, alls, tÃ¤nkte, massa, avkastning, jobbar, liten, ifrÃ¥n, fÃ¶rst, beror, kÃ¶pte, risk, endast, hitta, moms, undrar, bÃ¤sta, anvÃ¤nder, tÃ¤nka, investera, sÃ¤tta, innebÃ¤r, sjÃ¤lva, ofta, jobba, stort, jÃ¤vla, lÃ¤ngre, skulder, rÃ¤kna, handla, priset, leva, bankerna, visa, skriva, egna, trots, lÃ¤gre, kursen, person, problemet, kontot, hyra, veta, kÃ¶pt, extra, hÃ¤nder, starta, pris, eget, Ã¤ger, nÃ¤stan, mÃ¥nad, sidan, vore, sjÃ¤lvklart, ungefÃ¤r, vÃ¤rt, lÃ¤tt, summa, lÃ¤nder, lÃ¤sa, tÃ¤nkt, koll, tyvÃ¤rr, skicka, givetvis, lÃ¥net, land, fÃ¶rsÃ¶ka, skrev, gratis, flytta, behÃ¶va, vÃ¤rlden, ifall, billigare, vilja, absolut, exakt, form, alternativ, tanke, kostnader, vÃ¤rdet, nytt, avgifter, lÃ¤genhet, Ã¶kar, lÃ¤gger, funkar, emot, fÃ¶rsÃ¶ker, lÃ¥ngt, minst, enbart, snabbt, igenom, information, stÃ¤mmer, personer, oavsett, vanligt, vÃ¤nta, spelar, skit, inlÃ¤gg, kunder, speciellt, skatten, hemma, trÃ¥d, tillgÃ¥ngar, bÃ¤st, drar, hittar, betalt, rÃ¤knar, inflation, ekonomin, totalt, skaffa, plus, barn, beroende, antar, anser, hjÃ¤lpa, dÃ¥ligt, stÃ¶rsta, lever, viss, frÃ¥gor, risken, sida, roll, sÃ¥nt, avgift, dagens, lÃ¥nar, tagit, vÃ¤ljer, gott, vinsten, vÃ¤lja, exempelvis, princip, sÃ¤ker, arbete, kontanter, bÃ¶rjan, fÃ¶rklara, valuta, varor, antal, knappast, Ã¶vrigt, lÃ¤st, rent, ingenting, landet, okej, betyder, ville, utgifter, belopp, bidrag, snarare, tÃ¤nk, visar, utdelning, oftast, sparande, skatteverket, namn, kring, fond, slut, sÃ¤tter, dÃ¤rmed, index, lyckas, system, 000kr, anledning, fÃ¶rmodligen, skillnad, skapa, sÃ¥klart, gamla, skuld, delar, rÃ¤cker, bilen, firma, mÃ¶jlighet, nordea, kÃ¶ra, resten, livet, sparar, lÃ¥ta, vanliga, betydligt, sker, billigt, hand, betalat, relativt, hÃ¶rt, produkter, krÃ¤vs, klarar, lycka, undan, slipper, svensk, lÃ¥ng, fortsÃ¤tta, bostad, ytterligare, jobbet, hemsida, tusen, sÃ¥lde, summan, byta, satsa, senare, internet, Ã¶ppna, sÃ¤rskilt, fÃ¶rstÃ¥, ekonomiska, avtal, sÃ¤lj, resultat, svara, betalas, verksamhet, funderar, fallet, sÃ¥lt, kortet, krÃ¤ver, tjÃ¤nster, priserna, antingen, dÃ¥lig, klara, tiden, utomlands, hÃ¶ga, lÃ¶sa, antagligen, privat, pratar, ekonomiskt, priser, dyrare, fÃ¶rutom, personen, investering, kund, reda, papper, satt, medan, avdrag, skickar, fÃ¶rlust, senaste, haha, erfarenhet, fort, situation, aktierna, naturligtvis, personligen, extremt, ringa, kronofogden, siffror, tillrÃ¤ckligt, behÃ¶vs, trodde, summor, lÃ¥ga, bankkonto, fÃ¶rÃ¤ldrar, dyrt, rÃ¤knas, omÃ¶jligt, sluta, inflationen, systemet, intresserad, investeringar, grund, fÃ¶rsÃ¤ljning, skulden, lÃ¶nen, zero, bÃ¶rjade, vanlig, kollar, svaret, hÃ¤nda, enskild, kronor, tillgÃ¥ng, ovan, dela, tydligen, Ã¶vriga, sÃ¶ka, sparkonto, sÃ¤mre, kredit, info, klÃ¤der, kostnad, konstigt, boende, tacksam, konton, angÃ¥ende, anledningen, lÃ¤ra, privata, rÃ¤ntor, efterfrÃ¥gan, huset, gÃ¥nger, fÃ¶ljande, bygga, sÃ¤kerhet, tillvÃ¤xt, kurs, affÃ¤rer, lÃ¤ser, samhÃ¤llet, sÃ¥ledes, inkomster, igÃ¥ng, lÃ¤ste, miljarder, aning, marknad, skrivit, skatta, nuvarande, nivÃ¥, vÃ¤rd, lÃ¤mna, nÃ¥gonstans, konkurs, ekonomisk, hÃ¶gt, bÃ¶rjat, fattar, skapar, krav, miljon, sÃ¶ker, fÃ¶rslag, frÃ¤mst, bilar, mÃ¥nader, slippa, fÃ¶rlora, lÃ¤genheten, fÃ¶rstÃ¥tt, sant, hÃ¶ra, innehav, hamnar, saken, jobbat, titta, tillsammans, faktura, flashback, helvete, skillnaden, nÃ¥tt, chans, stiger, fortsÃ¤tter, frÃ¥gar, fonden, tjÃ¤nst, produkt, sikt, fÃ¶ljer, skatter, talar, minskar, behÃ¥lla, fixa, uppgifter, litet, lÃ¤ge, olja, utbildning, beloppet, vÃ¤nner, lÃ¥ngsiktigt, dels, vÃ¤gen, uppÃ¥t, regler, nÃ¤ra, eventuellt, minus, momsen, fullt, framtida, Ã¤gare, dollar, normalt, lÃ¥gt, pass, sÃ¤ttet, skiten, leder, fÃ¶rlorar, vÃ¤ntar, behov, kontakt, kostnaden, fÃ¶rsÃ¶k, kontakta, jÃ¤vligt, viktigt, fungera, nÃ¤tet, rÃ¤kningar, resa, 1000, Ã¶kat, fÃ¶rhand, fÃ¶ra, Ã¥ker, placera, hÃ¥ll, fÃ¶rstÃ¥s, varandra, affÃ¤r, tanken, driva, lagt, bitcoin, otroligt, plats, hyran, utav, fÃ¶lja, minska, utveckling, anstÃ¤llda, hÃ¤lften, kompis, bostadsrÃ¤tt, svart, kassa, tjÃ¤nat, liksom, hÃ¥rt, berÃ¤tta, dÃ¤refter, sjukt, arbeta, hittade, faller, kassan, vinster, analys, portfÃ¶lj, amerikanska, pÃ¥verkar, ivÃ¤g, rejÃ¤lt, mesta, dras, stiga, sidor, prata, uppgÃ¥ng, knappt, brev, intresse, sÃ¥hÃ¤r, utÃ¶ver, kosta, sjunker, kunden, rÃ¤knat, vÃ¤rldens, krona, spel, stÃ¤lla, beslut, arbetar, dator, pension, positivt, totala, silver, cash, forum, hjÃ¤lper, lÃ¶ner, motsvarande, rimligt, lÃ¤ttare, hittat, dollarn, tillfÃ¤llet, investerar, sparat, gammal, gÃ¥ngen, uttag, lyckats, omsÃ¤ttning, framÃ¶ver, alldeles, mÃ¥naden, erbjuder, dyra, kontant, troligen, orkar, anvÃ¤nds, fÃ¶retagen, smart, procent, tittar, rika, handel, dÃ¥liga, google, plÃ¶tsligt, steg, fÃ¶rsvinner, betalning, courtage, fylla, generellt, kreditkort, insatt, spela, korrekt, stod, alternativt, plocka, nÃ¤mligen, saknar, driver, minns, lÃ¤gg, familj, betalade, arbetsgivare, bygger, skyldig, diverse, nÃ¶jd, ihÃ¥g, global, dags, billig, verksamheten, fÃ¶rsÃ¤kring, hÃ¤nt, medel, flyttar, krÃ¤va, dumt, riktiga, troligtvis, lÃ¶sning, kraftigt, hÃ¶gst, ersÃ¤ttning, iallafall, sÃ¤nka, slags, telefon, order, stÃ¤llet, lÃ¤get, goda, avkastningen, tvungen, verkligheten, utdelningen, vÃ¤xa, inkÃ¶p, lilla, fundera, konsumtion, Ã¶verhuvudtaget, bostÃ¤der, svÃ¥rare, massor, stÃ¤ller, kunskap, rekommendera, gÃ¤llande, nyheter, post, valutan, tvÃ¤rtom, Ã¤ndra, deklarationen, lÃ¥nga, fÃ¶rhoppningsvis, testa, kronan, vare, ring, kapitalet, bitcoins, allting, bryr, hÃ¶ja, fint, vÃ¤rdepapper, praktiken, borta, rÃ¤ntorna, framtiden, illa, desto, resultatet, poÃ¤ng, tackar, undvika, sÃ¤kra, anstÃ¤lld, investerare, tillbaks, sÃ¤llan, sambo, mail, 2000, botten, vÃ¤nda, buffert, tyckte, anvÃ¤ndas, ansvar, kommande, tankar, valt, nere, billiga, halva, amortera, fastigheter, krediter, lÃ¥nen, pÃ¥verka, skiter, skÃ¤l, lÃ¤nk, visste, skolan, samband, kallas, vÃ¤ll, blocket, mynt, valutor, starkt, andel, kvitto, jÃ¤mfÃ¶r, situationen, Ã¤mnet, spendera, ingÃ¥r, lÃ¥nat, adress, lÃ¤mnar, kalla, fakturan, produktion, gÃ¶rs, kapitalfÃ¶rsÃ¤kring, automatiskt, gett, kollat, uppenbarligen, aktiebolag, enklare, roligt, projekt, privatperson, rapporten, resor, full, iofs, rapport, sedlar, mÃ¶jligheter, svenskar, sjunka, nordnet, ringer, rekommenderar, slÃ¥r, fÃ¶retagets, kÃ¤nna, politiker, fÃ¶rsÃ¶kt, varan, missat, faktum, kÃ¤lla, fina, leta, bolagen, vÃ¤xla, passar, menade, visserligen, tycka, uppe, lÃ¶ser, plan, Ã¤ter, 5000, butik, jÃ¤mfÃ¶ra, utlÃ¤ndska, sÃ¥na, diskutera, fÃ¶rut, pÃ¥stÃ¥r, produkten, skull, antalet, avgiften, samtliga, enskilda, tydligt, polare, hamna, argument, Ã¶kad, samhÃ¤lle, vÃ¤rda, definitivt, eventuella, glad, nÃ¥gonsin, intÃ¤kter, folket, rÃ¤tta, utvecklingen, vÃ¤rsta, fasta, osÃ¤ker, anses, utifrÃ¥n, intressanta, spÃ¤nnande, riktig, transaktioner, euro, vÃ¥gar, garanterat, funderat, deklaration, risker, cirka, 100k, nÃ¤rmare, bolagets, back, framtid, arbetslÃ¶s, resurser, vÃ¤nder, startar, posten, sÃ¤ljaren, trÃ¥dar, bild, huvudet, mÃ¶jligheten, nedgÃ¥ng, fÃ¶rdel, Ã¶kade, skÃ¶ter, handlas, vÃ¤xer, bolÃ¥n, framfÃ¶rallt, firman, kollade, depÃ¥, slutar, budget, seriÃ¶st, tvingas, utveckla, grÃ¤nsen, alternativet, synd, frÃ¥gade, snackar, drygt, potential, program, fonderna, dylikt, butiker, nytta, kÃ¶pet, netto, student, skÃ¶nt, anvÃ¤nt, ordentligt, fÃ¶rr, mamma, isÃ¥fall, total, bÃ¶cker, kostnaderna, regel, senast, snabbare, stÃ¶d, tider, privatpersoner, stad, skickat, erbjuda, inser, fÃ¶rhÃ¥llande, enkel, hÃ¤mta, gissar, trycka, vettigt, mille, datum, sÃ¤ljare, amortering, obligationer, eventuell, bostaden, fattiga, tala, negativt, sannolikt, minsta, beskattas, paket, rÃ¶ra, stÃ¤lle, ringde, stark, kunderna, vatten, fÃ¶rutsatt, slutet, nivÃ¥er, bestÃ¤mmer, leda, Ã¶verens, denne, portfÃ¶ljen, stabil, fÃ¶rsÃ¤ljningen, Ã¶ppnar, sÃ¤ljs, utdelningar, reklam, internetbank, onÃ¶digt, investmentbolag, fÃ¶rdelar, this, skulderna, klar, will, oberoende, svarta, bevisa, annorlunda, mÃ¶jligen, bevis)
topics: Array[Array[(String, Double)]] = Array(Array((aktier,0.010372609709935948), (fonder,0.009985682032437188), (kÃ¶pa,0.007147380184535501), (fÃ¶retag,0.004942859552056198), (olika,0.004763000081202069)), Array((skatt,0.014364304931778378), (fÃ¶retag,0.008645452621562126), (fÃ¶retaget,0.008300389229465058), (bolaget,0.007903692818210637), (bolag,0.006402673712961038)), Array((folk,0.0052167273044414555), (jobb,0.004475724890639614), (kÃ¶pa,0.0044337052877254195), (bÃ¤ttre,0.003773904791916776), (istÃ¤llet,0.003169961913268716)), Array((bitcoin,0.015097168905144656), (bitcoins,0.009816539841970279), (kÃ¶pa,0.0040680120997631155), (fÃ¶retag,0.0032437136384805445), (olika,0.0030445615311591244)), Array((moms,0.00633827140783334), (kÃ¶pa,0.005959993345718559), (fÃ¶retag,0.005906188488700269), (sÃ¤lja,0.005238515382692445), (betalar,0.004281708500936429)), Array((banken,0.00864432335805033), (konto,0.008339277536899259), (bank,0.007340445595021358), (tillbaka,0.005965709762899769), (rÃ¤nta,0.005342093657300021)), Array((kÃ¶pa,0.0034366699860672793), (banken,0.003289013342902767), (moms,0.003103723942186164), (kÃ¶per,0.003101990581430088), (will,0.0030185287141540774)), Array((inflation,0.007176851887240197), (guld,0.006395635479842193), (staten,0.006005858645610903), (valuta,0.005155325598855097), (vÃ¤rde,0.0049879413505575666)), Array((aktier,0.012040212950249483), (kÃ¶pa,0.007639727547960423), (aktien,0.006203784300724798), (bolag,0.0057716967783410945), (aktie,0.004584515168344491)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
<span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

<span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
  <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
  <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
<span class="p">})</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
<span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">termDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Creates</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span> <span class="n">of</span> <span class="n">forum</span> <span class="ow">in</span> <span class="n">FB</span>
<span class="n">val</span> <span class="n">rawJson</span> <span class="o">=</span> <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Similar</span> <span class="k">as</span> <span class="n">above</span> <span class="n">but</span> <span class="k">for</span> <span class="n">FL</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FL</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FL</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
<span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

<span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
  <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
  <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
<span class="p">})</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
<span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span> <span class="n">of</span> <span class="n">forum</span> <span class="ow">in</span> <span class="n">FB</span>
<span class="n">val</span> <span class="n">rawJson</span> <span class="o">=</span> <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rawJson</span><span class="p">(</span><span class="n">lda_model</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mllib</span><span class="o">.</span><span class="n">clustering</span><span class="o">.</span><span class="n">LDAModel</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">CountVectorizerModel</span><span class="p">):</span> <span class="n">String</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">lda_model</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">vocabulary</span>
  <span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
  <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
    <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
  <span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

  <span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
    <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
    <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
  <span class="p">})</span>

  <span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
  <span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

  <span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span>
  <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span>
<span class="n">val</span> <span class="n">rawJson_FL</span> <span class="o">=</span> <span class="n">rawJson</span><span class="p">(</span><span class="n">ldaModel_FL</span><span class="p">,</span> <span class="n">vectorizer_FL</span><span class="p">)</span>
<span class="n">val</span> <span class="n">rawJson_FB</span> <span class="o">=</span> <span class="n">rawJson</span><span class="p">(</span><span class="n">ldaModel_FB</span><span class="p">,</span> <span class="n">vectorizer_FB</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="03_word2vec.html" title="previous page">Classification using Word2Vec</a>
    <a class='right-next' id="next-link" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/01_Loading_GQA-JSON.html" title="next page">Reading GQA JSON files</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>