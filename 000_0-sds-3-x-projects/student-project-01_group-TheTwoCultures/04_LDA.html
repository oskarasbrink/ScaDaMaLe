
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Topic Modeling with LDA &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
     Distributed deep learning training using TensorFlow and Keras with HorovodRunner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
     Distributed deep learning training using PyTorch with HorovodRunner for MNIST
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/04_LDA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/04_LDA.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-description">
   Notebook description
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-the-data">
   Downloading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preprocessing-and-loading-the-relevant-data">
   Preprocessing and loading the relevant data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lda-methods">
   LDA Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stopwords">
     Stopwords
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   Experiments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="topic-modeling-with-lda">
<h1>Topic Modeling with LDA<a class="headerlink" href="#topic-modeling-with-lda" title="Permalink to this headline">¶</a></h1>
<div class="section" id="notebook-description">
<h2>Notebook description<a class="headerlink" href="#notebook-description" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.flashback.org/">Flashback</a> and
<a class="reference external" href="https://www.familjeliv.se/forum">Familjeliv</a> are two well-known swedish
online forums. Flashback is one of Sweden’s most visited websites and
has discussions on a wide-range of topics. It is famous for emphasizing
freedom of speech and the members citizen journalism on many topics. The
online forum Familjeliv, on the other hand, focuses more on questions
about pregnancy, children and parenthood (the translation is “Family
Life”). Part of the forum is also for more general topics, and this part
of Familjeliv is probably more famous than its other parts.</p>
<p>What we want to do in this notebook is analyze the language used in
these two, quite different, online forums. An interesting approach we
will try here is to do some topic modeling with <a class="reference external" href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation">Latent Dirichlet
Allocation</a>
(LDA). We know that each discussion forum in our data has multiple
subforums, so it would be interesting to see if LDA can accurately pick
up these different subforums as different topics, or if it sees other
patterns in the threads (the threads are what corresponds to documents
in the LDA method). We will also mainly do this with forums that have a
correspondence in both Flashback and Familjeliv. For instance, both have
forums dedicated to questions regarding economy and also forums
discussing topics close to sex and relationships.</p>
<p>This notebook is to a large extent adapted from notebook
034<em>LDA</em>20NewsGroupsSmall.</p>
</div>
<div class="section" id="downloading-the-data">
<h2>Downloading the data<a class="headerlink" href="#downloading-the-data" title="Permalink to this headline">¶</a></h2>
<p>Data comes from <a class="reference external" href="https://spraakbanken.gu.se">språkbanken</a>, see notebook
00<em>download</em>data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">00</span><span class="n">_download_data</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="preprocessing-and-loading-the-relevant-data">
<h2>Preprocessing and loading the relevant data<a class="headerlink" href="#preprocessing-and-loading-the-relevant-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">just</span> <span class="kn">import</span> <span class="nn">methods</span> <span class="kn">from</span> <span class="nn">notebook</span> <span class="mi">01</span><span class="n">_load_data</span><span class="p">,</span> <span class="n">so</span> <span class="n">we</span> <span class="n">can</span> <span class="n">load</span> <span class="n">our</span> <span class="n">data</span>

<span class="o">%</span><span class="n">run</span> <span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">01</span><span class="n">_load_data</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.functions.{col, concat_ws, udf, flatten, explode, collect_list, collect_set, lit}
import org.apache.spark.sql.types.{ArrayType, StructType, StructField, StringType, IntegerType}
import com.databricks.spark.xml._
import org.apache.spark.sql.functions._
read_xml: (file_name: String)org.apache.spark.sql.DataFrame
get_dataset: (file_name: String)org.apache.spark.sql.DataFrame
</pre></div>
</div>
</div></blockquote>
<p>[TABLE]</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_df: (df: org.apache.spark.sql.DataFrame, filePath: String)Unit
load_df: (filePath: String)org.apache.spark.sql.DataFrame
no_forums: (df: org.apache.spark.sql.DataFrame)Long
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>familjeliv-allmanna-ekonomi.xml already exists!
familjeliv-sexsamlevnad.xml already exists!
flashback-ekonomi.xml already exists!
flashback-sex.xml already exists!
import sys.process._
fl_data: Array[String] = Array(familjeliv-allmanna-ekonomi.xml, familjeliv-sexsamlevnad.xml)
fb_data: Array[String] = Array(flashback-ekonomi.xml, flashback-sex.xml)
url: String = http://spraakbanken.gu.se/lb/resurser/meningsmangder/
tmp_folder_fl: String = /tmp/familjeliv/
tmp_folder_fb: String = /tmp/flashback/
res3: String = &quot;&quot;
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dbfs:/datasets/student-project-01/flashback/familjeliv-allmanna-ekonomi_df
familjeliv-allmanna-ekonomi_df already exists!
dbfs:/datasets/student-project-01/flashback/familjeliv-sexsamlevnad_df
familjeliv-sexsamlevnad_df already exists!
dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df
flashback-ekonomi_df already exists!
dbfs:/datasets/student-project-01/flashback/flashback-sex_df
flashback-sex_df already exists!
fl_root: String = dbfs:/datasets/student-project-01/familjeliv/
fb_root: String = dbfs:/datasets/student-project-01/flashback/
fl_data: Array[String] = Array(familjeliv-allmanna-ekonomi, familjeliv-sexsamlevnad)
fb_data: Array[String] = Array(flashback-ekonomi, flashback-sex)
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="lda-methods">
<h2>LDA Methods<a class="headerlink" href="#lda-methods" title="Permalink to this headline">¶</a></h2>
<p>Below we put some of the LDA pipeline, working with
<a class="reference external" href="https://spark.apache.org/docs/latest/ml-guide.html">MLlib</a>, into a
single function called get_lda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.</span><span class="p">{</span><span class="n">RegexTokenizer</span><span class="p">,</span> <span class="n">StopWordsRemover</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.clustering.</span><span class="p">{</span><span class="n">LDA</span><span class="p">,</span> <span class="n">OnlineLDAOptimizer</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.ml.</span><span class="p">{</span><span class="n">Pipeline</span><span class="p">,</span> <span class="n">PipelineModel</span><span class="p">,</span> <span class="n">PipelineStage</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="p">{</span> <span class="n">LongType</span> <span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.ml.linalg.Vector</span>

<span class="k">def</span> <span class="nf">get_lda</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>  <span class="o">//</span> <span class="n">Main</span> <span class="n">function</span> <span class="n">to</span> <span class="n">do</span> <span class="n">LDA</span>
            <span class="n">min_token</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">vocabSize</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">minDF</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>            
            <span class="n">numTopics</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">maxIter</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
            <span class="n">stopWords</span><span class="p">:</span> <span class="n">Array</span><span class="p">[</span><span class="n">String</span><span class="p">])</span> <span class="o">=</span> <span class="p">{</span> 

  <span class="n">val</span> <span class="n">corpus_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">LongType</span><span class="p">))</span> <span class="o">//</span> <span class="n">From</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">dataframe</span> <span class="n">we</span> <span class="n">take</span> <span class="n">out</span> <span class="n">each</span> <span class="n">thread</span>

  <span class="n">val</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RegexTokenizer</span><span class="p">()</span>
  <span class="o">.</span><span class="n">setPattern</span><span class="p">(</span><span class="s2">&quot;(?U)[</span><span class="se">\\</span><span class="s2">W_]+&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="k">break</span> <span class="n">by</span> <span class="n">white</span> <span class="n">space</span> <span class="n">character</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="o">-</span> <span class="k">try</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">emails</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">patterns</span>
  <span class="o">.</span><span class="n">setMinTokenLength</span><span class="p">(</span><span class="n">min_token</span><span class="p">)</span> <span class="o">//</span> <span class="n">Filter</span> <span class="n">away</span> <span class="n">tokens</span> <span class="k">with</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">min_token</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">column</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">column</span>
  
  <span class="n">val</span> <span class="n">remover</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StopWordsRemover</span><span class="p">()</span> 
  <span class="o">.</span><span class="n">setStopWords</span><span class="p">(</span><span class="n">stopWords</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">getOutputCol</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
  
  <span class="n">val</span> <span class="n">tokenized_df</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corpus_df</span><span class="p">)</span> <span class="o">//</span> <span class="n">Removes</span> <span class="n">uninteresting</span> <span class="n">words</span> <span class="kn">from</span> <span class="nn">each</span> <span class="n">thread</span>
  <span class="n">val</span> <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">remover</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">tokenized_df</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Chosing</span> <span class="n">only</span> <span class="n">the</span> <span class="n">filtered</span> <span class="n">threads</span> 
  
  <span class="n">val</span> <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CountVectorizer</span><span class="p">()</span> <span class="o">//</span> <span class="n">Creates</span> <span class="n">dictionary</span> <span class="ow">and</span> <span class="n">counts</span> <span class="n">the</span> <span class="n">occurences</span> <span class="n">of</span> <span class="n">different</span> <span class="n">words</span>
   <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="n">remover</span><span class="o">.</span><span class="n">getOutputCol</span><span class="p">)</span>
   <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">)</span>
   <span class="o">.</span><span class="n">setVocabSize</span><span class="p">(</span><span class="n">vocabSize</span><span class="p">)</span> <span class="o">//</span> <span class="n">Size</span> <span class="n">of</span> <span class="n">dictonary</span>
   <span class="o">.</span><span class="n">setMinDF</span><span class="p">(</span><span class="n">minDF</span><span class="p">)</span>
   <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">//</span> <span class="n">returns</span> <span class="n">CountVectorizerModel</span>
  
  <span class="n">val</span> <span class="n">lda</span> <span class="o">=</span> <span class="n">new</span> <span class="n">LDA</span><span class="p">()</span> <span class="o">//</span> <span class="n">Creates</span> <span class="n">LDA</span> <span class="n">Model</span> <span class="k">with</span> <span class="n">some</span> <span class="n">user</span> <span class="n">defined</span> <span class="n">choice</span> <span class="n">of</span> <span class="n">parameters</span>
  <span class="o">.</span><span class="n">setOptimizer</span><span class="p">(</span><span class="n">new</span> <span class="n">OnlineLDAOptimizer</span><span class="p">()</span><span class="o">.</span><span class="n">setMiniBatchFraction</span><span class="p">(</span><span class="mf">0.8</span><span class="p">))</span>
  <span class="o">.</span><span class="n">setK</span><span class="p">(</span><span class="n">numTopics</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setMaxIterations</span><span class="p">(</span><span class="n">maxIter</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setDocConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">use</span> <span class="n">default</span> <span class="n">values</span>
  <span class="o">.</span><span class="n">setTopicConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  
  <span class="n">val</span> <span class="n">countVectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>

  <span class="n">val</span> <span class="n">lda_countVector</span> <span class="o">=</span> <span class="n">countVectors</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Row</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">Long</span><span class="p">,</span> <span class="n">countVector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">countVector</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">val</span> <span class="n">lda_countVector_mllib</span> <span class="o">=</span> <span class="n">lda_countVector</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mllib</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Vectors</span><span class="o">.</span><span class="n">fromML</span><span class="p">(</span><span class="n">vector</span><span class="p">))</span> <span class="p">}</span><span class="o">.</span><span class="n">rdd</span>
  
  <span class="n">val</span> <span class="n">lda_model</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lda_countVector_mllib</span><span class="p">)</span>
  <span class="p">(</span><span class="n">lda_model</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.{RegexTokenizer, StopWordsRemover, CountVectorizer}
import org.apache.spark.mllib.clustering.{LDA, OnlineLDAOptimizer}
import org.apache.spark.ml.{Pipeline, PipelineModel, PipelineStage}
import org.apache.spark.sql.types.LongType
import org.apache.spark.ml.linalg.Vector
get_lda: (df: org.apache.spark.sql.DataFrame, min_token: Int, vocabSize: Int, minDF: Int, numTopics: Int, maxIter: Int, stopWords: Array[String])(org.apache.spark.mllib.clustering.LDAModel, org.apache.spark.ml.feature.CountVectorizerModel)
</pre></div>
</div>
</div></blockquote>
<div class="section" id="stopwords">
<h3>Stopwords<a class="headerlink" href="#stopwords" title="Permalink to this headline">¶</a></h3>
<p>Stop words are highly relevant to get interesting topics distributions,
with not all weight on very common words that do not carry much meaning
for a particular topic. To do this we both use collections by others and
input words we find meaningless for these particular settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">peterdalle</span><span class="o">/</span><span class="n">svensktext</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">stoppord</span><span class="o">/</span><span class="n">stoppord</span><span class="o">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--2021-01-11 14:30:09--  https://raw.githubusercontent.com/peterdalle/svensktext/master/stoppord/stoppord.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.52.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.52.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1936 (1.9K) [text/plain]
Saving to: ‘/tmp/stopwords.csv’

     0K .                                                     100% 11.5M=0s

2021-01-11 14:30:09 (11.5 MB/s) - ‘/tmp/stopwords.csv’ saved [1936/1936]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">file</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span> <span class="n">dbfs</span><span class="p">:</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="o">/</span><span class="n">stopwords</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res24: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Creating</span> <span class="n">a</span> <span class="nb">list</span> <span class="k">with</span> <span class="n">stopwords</span>

<span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.StopWordsRemover</span>
<span class="n">val</span> <span class="n">stoppord</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/stopwords.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="n">val</span> <span class="n">stopwordList</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="s2">&quot;bara&quot;</span><span class="p">,</span><span class="s2">&quot;lite&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;vill&quot;</span><span class="p">,</span><span class="s2">&quot;samt&quot;</span><span class="p">,</span><span class="s2">&quot;inga&quot;</span><span class="p">,</span><span class="s2">&quot;även&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;ganska&quot;</span><span class="p">,</span><span class="s2">&quot;också&quot;</span><span class="p">,</span><span class="s2">&quot;igen&quot;</span><span class="p">,</span><span class="s2">&quot;just&quot;</span><span class="p">,</span><span class="s2">&quot;that&quot;</span><span class="p">,</span><span class="s2">&quot;with&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;kanske&quot;</span><span class="p">,</span><span class="s2">&quot;tycker&quot;</span><span class="p">,</span><span class="s2">&quot;gillar&quot;</span><span class="p">,</span> <span class="s2">&quot;bra&quot;</span><span class="p">,</span><span class="s2">&quot;the&quot;</span><span class="p">,</span><span class="s2">&quot;000&quot;</span><span class="p">,</span><span class="s2">&quot;måste&quot;</span><span class="p">,</span><span class="s2">&quot;tjej&quot;</span><span class="p">,</span><span class="s2">&quot;tjejer&quot;</span><span class="p">,</span><span class="s2">&quot;tjejen&quot;</span><span class="p">,</span><span class="s2">&quot;tjejerna&quot;</span><span class="p">,</span><span class="s2">&quot;kvinna&quot;</span><span class="p">,</span><span class="s2">&quot;kvinnor&quot;</span><span class="p">,</span><span class="s2">&quot;kille&quot;</span><span class="p">,</span><span class="s2">&quot;killar&quot;</span><span class="p">,</span><span class="s2">&quot;killen&quot;</span><span class="p">,</span><span class="s2">&quot;män&quot;</span><span class="p">,</span><span class="s2">&quot;rätt&quot;</span><span class="p">,</span><span class="s2">&quot;män&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;and&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;många&quot;</span><span class="p">,</span><span class="s2">&quot;aldrig&quot;</span><span class="p">,</span><span class="s2">&quot;www&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;wmv&quot;</span><span class="p">,</span><span class="s2">&quot;fan&quot;</span><span class="p">,</span><span class="s2">&quot;förhelvetet&quot;</span><span class="p">,</span><span class="s2">&quot;riktigt&quot;</span><span class="p">,</span><span class="s2">&quot;känner&quot;</span><span class="p">,</span><span class="s2">&quot;väldigt&quot;</span><span class="p">,</span><span class="s2">&quot;font&quot;</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">,</span><span class="s2">&quot;mms&quot;</span><span class="p">,</span><span class="s2">&quot;2008&quot;</span><span class="p">,</span><span class="s2">&quot;2009&quot;</span><span class="p">,</span><span class="s2">&quot;95kr&quot;</span><span class="p">,</span><span class="s2">&quot;dom&quot;</span><span class="p">,</span><span class="s2">&quot;får&quot;</span><span class="p">,</span><span class="s2">&quot;ska&quot;</span><span class="p">,</span><span class="s2">&quot;kommer&quot;</span><span class="p">,</span><span class="s2">&quot;två&quot;</span><span class="p">,</span><span class="s2">&quot;vet&quot;</span><span class="p">,</span><span class="s2">&quot;mer&quot;</span><span class="p">,</span><span class="s2">&quot;pengar&quot;</span><span class="p">,</span><span class="s2">&quot;pengarna&quot;</span><span class="p">,</span><span class="s2">&quot;göra&quot;</span><span class="p">,</span><span class="s2">&quot;fick&quot;</span><span class="p">,</span><span class="s2">&quot;tror&quot;</span><span class="p">,</span><span class="s2">&quot;andra&quot;</span><span class="p">,</span><span class="s2">&quot;helt&quot;</span><span class="p">,</span><span class="s2">&quot;kunna&quot;</span><span class="p">,</span><span class="s2">&quot;behöver&quot;</span><span class="p">,</span><span class="s2">&quot;betala&quot;</span><span class="p">,</span><span class="s2">&quot;inget&quot;</span><span class="p">,</span><span class="s2">&quot;dock&quot;</span><span class="p">,</span><span class="s2">&quot;inget&quot;</span><span class="p">,</span><span class="s2">&quot;tack&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">stoppord</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">StopWordsRemover</span><span class="o">.</span><span class="n">loadDefaultStopWords</span><span class="p">(</span><span class="s2">&quot;swedish&quot;</span><span class="p">))</span> <span class="o">//</span> <span class="n">In</span> <span class="n">this</span> <span class="n">step</span> <span class="n">we</span> <span class="n">add</span> <span class="n">custom</span> <span class="n">stop</span> <span class="n">words</span> <span class="ow">and</span> <span class="n">another</span> <span class="n">premade</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">stopwords</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.StopWordsRemover
stoppord: Array[String] = Array(word, all, alla, allas, allt, alltså, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, båda, bådas, både, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, där, därför, då, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjärde, fler, flera, flesta, fram, framför, från, fyra, fyrtio, fyrtionde, få, får, fått, för, före, förra, första, ge, genom, ger, gick, gjorde, gjort, gälla, gäller, gällt, gärna, gå, gång, går, gått, gör, göra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjälp, hon, honom, hundra, hundraen, hundraett, hur, här, i, ibland, icke, igen, in, inför, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jämfört, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kör, legat, ligga, ligger, lägga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, när, nästa, någon, någonting, något, några, nån, nåt, och, också, om, oss, på, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, själv, sjätte, ska, skall, skriver, skulle, slutligen, snart, som, står, säga, säger, sätt, så, sådan, sådana, sådant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvå, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, två, tvåhundra, under, upp, ur, ut, utan, utanför, ute, vad, var, vara, varför, varifrån, varit, varje, varken, vars, varsågod, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, väl, värre, vår, våra, vårt, än, ändå, ännu, är, även, året, åt, åtminstone, åtta, åttio, åttionde, åttonde, över, övre)
stopwordList: Array[String] = Array(bara, lite, finns, vill, samt, inga, även, finns, ganska, också, igen, just, that, with, http, jpg, kanske, tycker, gillar, bra, the, 000, måste, tjej, tjejer, tjejen, tjejerna, kvinna, kvinnor, kille, killar, killen, män, rätt, män, com, and, html, många, aldrig, www, mpg, avi, wmv, fan, förhelvetet, riktigt, känner, väldigt, font, size, mms, 2008, 2009, 95kr, dom, får, ska, kommer, två, vet, mer, pengar, pengarna, göra, fick, tror, andra, helt, kunna, behöver, betala, inget, dock, inget, tack, word, all, alla, allas, allt, alltså, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, båda, bådas, både, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, där, därför, då, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjärde, fler, flera, flesta, fram, framför, från, fyra, fyrtio, fyrtionde, få, får, fått, för, före, förra, första, ge, genom, ger, gick, gjorde, gjort, gälla, gäller, gällt, gärna, gå, gång, går, gått, gör, göra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjälp, hon, honom, hundra, hundraen, hundraett, hur, här, i, ibland, icke, igen, in, inför, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jämfört, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kör, legat, ligga, ligger, lägga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, när, nästa, någon, någonting, något, några, nån, nåt, och, också, om, oss, på, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, själv, sjätte, ska, skall, skriver, skulle, slutligen, snart, som, står, säga, säger, sätt, så, sådan, sådana, sådant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvå, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, två, tvåhundra, under, upp, ur, ut, utan, utanför, ute, vad, var, vara, varför, varifrån, varit, varje, varken, vars, varsågod, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, väl, värre, vår, våra, vårt, än, ändå, ännu, är, även, året, åt, åtminstone, åtta, åttio, åttionde, åttonde, över, övre, och, det, att, i, en, jag, hon, som, han, på, den, med, var, sig, för, så, till, är, men, ett, om, hade, de, av, icke, mig, du, henne, då, sin, nu, har, inte, hans, honom, skulle, hennes, där, min, man, ej, vid, kunde, något, från, ut, när, efter, upp, vi, dem, vara, vad, över, än, dig, kan, sina, här, ha, mot, alla, under, någon, eller, allt, mycket, sedan, ju, denna, själv, detta, åt, utan, varit, hur, ingen, mitt, ni, bli, blev, oss, din, dessa, några, deras, blir, mina, samma, vilken, er, sådan, vår, blivit, dess, inom, mellan, sådant, varför, varje, vilka, ditt, vem, vilket, sitta, sådana, vart, dina, vars, vårt, våra, ert, era, vilkas)
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="experiments">
<h2>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h2>
<p>Below we we chosen some similar forums from FB and FL. First two
regarding economics, and two discussing sex and relationships. Here we
run the two economics forums and see how well TDA captures any topic
structure.</p>
<p>Here one does not have to use similar forums, but if one is interested
in only Flashback forums one could use only those. We could also of
course join several of these forums together to try to capture even
broader topic distributions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Loading</span> <span class="n">the</span> <span class="n">forums</span> <span class="n">we</span> <span class="n">will</span> <span class="n">do</span> <span class="n">LDA</span> <span class="n">on</span><span class="o">.</span>

<span class="n">val</span> <span class="n">file_path_FL</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-allmanna-ekonomi_df&quot;</span>
<span class="n">val</span> <span class="n">file_path_FB</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df&quot;</span>
<span class="o">//</span><span class="n">val</span> <span class="n">file_path_FL</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-sexsamlevnad_df&quot;</span>
<span class="o">//</span><span class="n">val</span> <span class="n">file_path_FB</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/flashback/flashback-sex_df&quot;</span>
  
<span class="n">val</span> <span class="n">df_FL</span> <span class="o">=</span> <span class="n">load_df</span><span class="p">(</span><span class="n">file_path_FL</span><span class="p">)</span>
<span class="n">val</span> <span class="n">df_FB</span> <span class="o">=</span> <span class="n">load_df</span><span class="p">(</span><span class="n">file_path_FB</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_path_FL: String = dbfs:/datasets/student-project-01/familjeliv/familjeliv-allmanna-ekonomi_df
file_path_FB: String = dbfs:/datasets/student-project-01/flashback/flashback-ekonomi_df
df_FL: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
df_FB: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Dataframes</span> <span class="n">containg</span> <span class="n">a</span> <span class="n">forum</span> <span class="kn">from</span> <span class="nn">FB.</span>

<span class="n">df_FB</span><span class="o">.</span><span class="n">show</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
|thread_id|        thread_title|                   w|forum_id|         forum_title| platform|           corpus_id|
+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
|  1005670| &quot;Spara i madrassen&quot;|Där,står,mycket,l...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1005847|Invester vinst in...|Om,du,sätter,av,t...|     258|Ekonomi &gt; Företag...|flashback|flashback-ekonomi...|
|  1008130|Johan Norbergs En...|Tack,.,El,penal,d...|     293|Ekonomi &gt; Nationa...|flashback|flashback-ekonomi...|
|  1008965|&quot;Det stora raset&quot;...|Om,tekniken,får,f...|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
|  1011185|EF och dra av dyr...|På,företaget,där,...|     258|Ekonomi &gt; Företag...|flashback|flashback-ekonomi...|
|  1013160|    Vilken Kinafond?|Jag,tror,på,HQ,Ki...|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
|  1014006|Förvara kontanter...|Det,är,så,extrema...|     294|Ekonomi &gt; Private...|flashback|flashback-ekonomi...|
|  1015049|     Inköp i företag|Är,ny,inom,företa...|     258|Ekonomi &gt; Företag...|flashback|flashback-ekonomi...|
|   101813|     Startkapitalet?|Av,MVH,/,/,Detta,...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1025347|           Blancålån|hjälp,!,Sen,tycke...|     294|Ekonomi &gt; Private...|flashback|flashback-ekonomi...|
|  1032576|           korvkiosk|Finns,vanliga,kor...|     258|Ekonomi &gt; Företag...|flashback|flashback-ekonomi...|
|  1034516|Vilka Kina fonder...|Vill,man,höja,ris...|     489|    Ekonomi &gt; Fonder|flashback|flashback-ekonomi...|
|  1036269|Handla optioner i...|Visst,stämmer,det...|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
|  1037036|Vad tjänar en för...|Jag,jobbar,också,...|      18|Ekonomi &gt; Ekonomi...|flashback|flashback-ekonomi...|
|  1039302|Kapitalförsäkring...|Brytpunkten,för,d...|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
|  1041102|    Begreppet pengar|Statligt,utfärdad...|     293|Ekonomi &gt; Nationa...|flashback|flashback-ekonomi...|
|  1041767|      Avräkningsnota|första,alternativ...|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
|  1042680|Utländska indexfo...|Tycker,själv,att,...|     489|    Ekonomi &gt; Fonder|flashback|flashback-ekonomi...|
|  1043999|Tulldeklaration, ...|så,vad,mer,behöve...|     258|Ekonomi &gt; Företag...|flashback|flashback-ekonomi...|
|  1045539|        mini futures|handlar,med,RBS,....|     260|Ekonomi &gt; Värdepa...|flashback|flashback-ekonomi...|
+---------+--------------------+--------------------+--------+--------------------+---------+--------------------+
only showing top 20 rows
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// Overview of number of threads in different subforums

df_FL.groupBy($&quot;forum_title&quot;).agg(count($&quot;forum_title&quot;).as(&quot;count&quot;)).show(false)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------+-----+
|forum_title                                               |count|
+----------------------------------------------------------+-----+
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Konsument/Inhandla|26307|
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Familjerätt       |1623 |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Övrigt            |1638 |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Ekonomi           |24284|
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Spartips          |217  |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Juridik           |3246 |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Företagande       |957  |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Lån &amp; skulder     |1168 |
+----------------------------------------------------------+-----+
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>df_FB.groupBy($&quot;forum_title&quot;).agg(count($&quot;forum_title&quot;).as(&quot;count&quot;)).show(false)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------------------------------------------------+-----+
|forum_title                                        |count|
+---------------------------------------------------+-----+
|Ekonomi &gt; Privatekonomi                            |15154|
|Ekonomi &gt; Bitcoin och andra virtuella valutor      |524  |
|Ekonomi &gt; Värdepapper, valutor och råvaror: allmänt|8300 |
|Ekonomi &gt; Fonder                                   |645  |
|Ekonomi &gt; Företagande och företagsekonomi          |12139|
|Ekonomi &gt; Nationalekonomi                          |3114 |
|Ekonomi &gt; Aktier                                   |508  |
|Ekonomi &gt; Ekonomi: övrigt                          |19308|
|Ekonomi &gt; Offshore och skatteplanering             |1567 |
+---------------------------------------------------+-----+
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Set</span> <span class="n">parameters</span><span class="p">,</span> <span class="ow">and</span> <span class="n">perform</span> <span class="n">two</span> <span class="n">different</span> <span class="n">LDAs</span><span class="p">,</span> <span class="n">one</span> <span class="n">on</span> <span class="n">FB</span> <span class="ow">and</span> <span class="n">one</span> <span class="n">on</span> <span class="n">FL</span>

<span class="n">val</span> <span class="n">min_token</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">//</span> <span class="n">only</span> <span class="n">accept</span> <span class="n">tokens</span> <span class="n">larger</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span>
<span class="n">val</span> <span class="n">vocabSize</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">//</span> <span class="n">Size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vocab</span> <span class="n">dictionary</span>
<span class="n">val</span> <span class="n">minDF</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">//</span> <span class="n">The</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">different</span> <span class="n">documents</span> <span class="n">a</span> <span class="n">term</span> <span class="n">must</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">to</span> <span class="n">be</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">minTF</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">//</span> <span class="n">The</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">a</span> <span class="n">term</span> <span class="n">has</span> <span class="n">to</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">document</span> <span class="n">to</span> <span class="n">be</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vocabulary</span>

<span class="n">val</span> <span class="n">numTopics_FL</span> <span class="o">=</span> <span class="n">no_forums</span><span class="p">(</span><span class="n">df_FL</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span> <span class="o">//</span><span class="mi">4</span> <span class="o">//</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">topics</span> <span class="ow">in</span> <span class="n">LDA</span> <span class="n">model</span>
<span class="n">val</span> <span class="n">numTopics_FB</span> <span class="o">=</span> <span class="n">no_forums</span><span class="p">(</span><span class="n">df_FB</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span>
<span class="n">val</span> <span class="n">maxIter</span> <span class="o">=</span> <span class="mi">8</span>  <span class="o">//</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="k">for</span> <span class="n">LDA</span> <span class="n">model</span>
<span class="n">val</span> <span class="n">stopwords</span> <span class="o">=</span> <span class="n">stopwordList</span>
<span class="n">val</span> <span class="p">(</span><span class="n">ldaModel_FL</span><span class="p">,</span> <span class="n">vectorizer_FL</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_lda</span><span class="p">(</span><span class="n">df_FL</span><span class="p">,</span> <span class="n">min_token</span><span class="p">,</span> <span class="n">vocabSize</span><span class="p">,</span> <span class="n">minDF</span><span class="p">,</span> <span class="n">numTopics_FL</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">)</span>
<span class="n">val</span> <span class="p">(</span><span class="n">ldaModel_FB</span><span class="p">,</span> <span class="n">vectorizer_FB</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_lda</span><span class="p">(</span><span class="n">df_FB</span><span class="p">,</span> <span class="n">min_token</span><span class="p">,</span> <span class="n">vocabSize</span><span class="p">,</span> <span class="n">minDF</span><span class="p">,</span> <span class="n">numTopics_FB</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------+
|forum_title                                               |
+----------------------------------------------------------+
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Konsument/Inhandla|
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Familjerätt       |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Övrigt            |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Ekonomi           |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Spartips          |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Juridik           |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Företagande       |
|Allmänna rubriker &gt; Ekonomi &amp; juridik &gt; Lån &amp; skulder     |
+----------------------------------------------------------+

+---------------------------------------------------+
|forum_title                                        |
+---------------------------------------------------+
|Ekonomi &gt; Privatekonomi                            |
|Ekonomi &gt; Bitcoin och andra virtuella valutor      |
|Ekonomi &gt; Värdepapper, valutor och råvaror: allmänt|
|Ekonomi &gt; Fonder                                   |
|Ekonomi &gt; Företagande och företagsekonomi          |
|Ekonomi &gt; Nationalekonomi                          |
|Ekonomi &gt; Aktier                                   |
|Ekonomi &gt; Ekonomi: övrigt                          |
|Ekonomi &gt; Offshore och skatteplanering             |
+---------------------------------------------------+

min_token: Int = 4
vocabSize: Int = 10000
minDF: Int = 5
minTF: Int = 2
numTopics_FL: Int = 8
numTopics_FB: Int = 9
maxIter: Int = 8
stopwords: Array[String] = Array(bara, lite, finns, vill, samt, inga, även, finns, ganska, också, igen, just, that, with, http, jpg, kanske, tycker, gillar, bra, the, 000, måste, tjej, tjejer, tjejen, tjejerna, kvinna, kvinnor, kille, killar, killen, män, rätt, män, com, and, html, många, aldrig, www, mpg, avi, wmv, fan, förhelvetet, riktigt, känner, väldigt, font, size, mms, 2008, 2009, 95kr, dom, får, ska, kommer, två, vet, mer, pengar, pengarna, göra, fick, tror, andra, helt, kunna, behöver, betala, inget, dock, inget, tack, word, all, alla, allas, allt, alltså, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, båda, bådas, både, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, där, därför, då, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjärde, fler, flera, flesta, fram, framför, från, fyra, fyrtio, fyrtionde, få, får, fått, för, före, förra, första, ge, genom, ger, gick, gjorde, gjort, gälla, gäller, gällt, gärna, gå, gång, går, gått, gör, göra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjälp, hon, honom, hundra, hundraen, hundraett, hur, här, i, ibland, icke, igen, in, inför, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jämfört, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kör, legat, ligga, ligger, lägga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, när, nästa, någon, någonting, något, några, nån, nåt, och, också, om, oss, på, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, själv, sjätte, ska, skall, skriver, skulle, slutligen, snart, som, står, säga, säger, sätt, så, sådan, sådana, sådant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvå, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, två, tvåhundra, under, upp, ur, ut, utan, utanför, ute, vad, var, vara, varför, varifrån, varit, varje, varken, vars, varsågod, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, väl, värre, vår, våra, vårt, än, ändå, ännu, är, även, året, åt, åtminstone, åtta, åttio, åttionde, åttonde, över, övre, och, det, att, i, en, jag, hon, som, han, på, den, med, var, sig, för, så, till, är, men, ett, om, hade, de, av, icke, mig, du, henne, då, sin, nu, har, inte, hans, honom, skulle, hennes, där, min, man, ej, vid, kunde, något, från, ut, när, efter, upp, vi, dem, vara, vad, över, än, dig, kan, sina, här, ha, mot, alla, under, någon, eller, allt, mycket, sedan, ju, denna, själv, detta, åt, utan, varit, hur, ingen, mitt, ni, bli, blev, oss, din, dessa, några, deras, blir, mina, samma, vilken, er, sådan, vår, blivit, dess, inom, mellan, sådant, varför, varje, vilka, ditt, vem, vilket, sitta, sådana, vart, dina, vars, vårt, våra, ert, era, vilkas)
ldaModel_FL: org.apache.spark.mllib.clustering.LDAModel = org.apache.spark.mllib.clustering.LocalLDAModel@10a74a7d
vectorizer_FL: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_92cbca9d69d3
ldaModel_FB: org.apache.spark.mllib.clustering.LDAModel = org.apache.spark.mllib.clustering.LocalLDAModel@28741094
vectorizer_FB: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_aaaff6faf1cc
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Here we will visualize the most important part of the different topic
distributions, both for FB and for FL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">pick</span> <span class="n">out</span> <span class="n">the</span> <span class="n">most</span> <span class="n">important</span> <span class="n">terms</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">topic</span> <span class="k">for</span> <span class="n">FL</span><span class="o">.</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FL</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FL</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>8 topics:
TOPIC 0
tillbaka	0.008216191335042956
skatt	0.006509257902643634
betalar	0.005635041121233399
folk	0.005131491885839656
jobb	0.0051057124094540714
==========
TOPIC 1
barn	0.013917573767387432
spara	0.00891926717912398
skrev	0.008795787566591128
följande	0.007687478743540771
köpa	0.007421083954132069
==========
TOPIC 2
jobb	0.005941548013271099
banken	0.005184644368971845
betalar	0.004761136982814706
jobbar	0.004732367048439004
tillbaka	0.00447708103221914
==========
TOPIC 3
köper	0.011086173062869036
handlar	0.010707762120455214
äter	0.007974933506441925
köpa	0.007856980307486902
vuxna	0.005976512509098039
==========
TOPIC 4
köpa	0.009345022745034834
kläder	0.007752851561346635
köpte	0.0057978627025462625
barn	0.005201306667796932
kolla	0.004548491158766831
==========
TOPIC 5
barn	0.02047574524007617
barnet	0.009776681578582441
barnen	0.005742962450413186
skrev	0.004847780768717609
jobb	0.004608856784822973
==========
TOPIC 6
betalar	0.010248488991996553
ekonomi	0.008863292049078849
huset	0.0068847763666443585
köpa	0.006869607591782869
barn	0.0062769843242390586
==========
TOPIC 7
buffert	0.022462688377360988
kontantinsats	0.01832413857067284
000kr	0.012844781601955733
resa	0.008253097762916517
amortering	0.005493083255139651
==========
topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(8, 51, 3, 21, 7),Array(0.008216191335042956, 0.006509257902643634, 0.005635041121233399, 0.005131491885839656, 0.0051057124094540714)), (Array(0, 15, 2, 11, 1),Array(0.013917573767387432, 0.00891926717912398, 0.008795787566591128, 0.007687478743540771, 0.007421083954132069)), (Array(7, 52, 3, 24, 8),Array(0.005941548013271099, 0.005184644368971845, 0.004761136982814706, 0.004732367048439004, 0.00447708103221914)), (Array(5, 12, 168, 1, 161),Array(0.011086173062869036, 0.010707762120455214, 0.007974933506441925, 0.007856980307486902, 0.005976512509098039)), (Array(1, 6, 19, 0, 16),Array(0.009345022745034834, 0.007752851561346635, 0.0057978627025462625, 0.005201306667796932, 0.004548491158766831)), (Array(0, 40, 27, 2, 7),Array(0.02047574524007617, 0.009776681578582441, 0.005742962450413186, 0.004847780768717609, 0.004608856784822973)), (Array(3, 30, 37, 1, 0),Array(0.010248488991996553, 0.008863292049078849, 0.0068847763666443585, 0.006869607591782869, 0.0062769843242390586)), (Array(157, 370, 166, 226, 469),Array(0.022462688377360988, 0.01832413857067284, 0.012844781601955733, 0.008253097762916517, 0.005493083255139651)))
vocabList: Array[String] = Array(barn, köpa, skrev, betalar, alltid, köper, kläder, jobb, tillbaka, saker, olika, följande, handlar, kostar, brukar, spara, kolla, bättre, svar, köpte, borde, folk, hemma, lika, jobbar, faktiskt, precis, barnen, fråga, istället, ekonomi, annars, runt, mindre, inkomst, sambo, hoppas, huset, känns, köpt, barnet, bort, ihop, verkar, alls, håller, problem, dessutom, stor, månad, svårt, skatt, banken, förstår, tjänar, låter, tips, extra, direkt, jobba, länge, räkningar, mamma, klart, större, tyvärr, beror, konto, handla, vissa, ofta, massa, tänker, sånt, liten, ränta, sparar, egentligen, undrar, ville, lägger, skriva, däremot, stora, sälja, billigare, veta, mest, själva, säkert, absolut, tänkte, tänka, enligt, leva, nästan, bilen, föräldrar, först, hitta, sett, funkar, hyra, enkelt, använda, självklart, låna, enda, fortfarande, tidigare, sambon, ungefär, använder, börja, egen, egna, längre, nytt, lätt, utgifter, ringa, kort, lägenhet, börjar, behöva, sitter, summa, billigt, hittar, trots, tillsammans, räkna, pappa, tråden, bästa, liknande, företag, skicka, bank, dyrt, jobbet, flytta, räknar, klarar, pris, hjälpa, lever, säljer, slut, vilja, högre, betalt, anser, lånet, okej, ifrån, oftast, buffert, människor, gott, hålla, vuxna, koll, sätta, tagit, klara, 000kr, dyrare, äter, byta, betalat, jobbat, stort, välja, dotter, hand, tänkt, person, väljer, lycka, gratis, familj, bäst, delar, eget, oavsett, nätet, boende, gemensam, långt, frågan, sidan, gamla, dåligt, sparande, bidrag, tyckte, minst, vanliga, räcker, händer, haha, konstigt, vänta, plus, sonen, priset, hört, undan, sida, summan, drar, dela, betalade, kostade, månaden, räknas, skaffa, skillnad, värt, möjligt, skrivit, exakt, försöka, månader, ersättning, resa, fungerar, försöker, kostnader, läsa, endast, papper, trodde, räntan, hemsida, sätter, inlägg, lägenheten, beroende, prata, skulder, spelar, vanligt, tänk, resten, innebär, liksom, speciellt, massor, söka, gemensamma, skor, säljaren, pappan, dyra, vore, lämna, emot, nöjd, tusen, halva, livet, kontot, roll, ingenting, hittade, åker, höra, början, funderar, butik, namn, igenom, svara, tråd, lönen, enbart, ring, gemensamt, läst, familjen, kassan, heltid, visa, kassa, fattar, personer, arbetslös, fina, ansvar, totalt, ekonomiskt, ringer, paket, ringde, började, nått, slipper, dottern, barnbidraget, satt, telefon, inkomster, såklart, exempel, betalas, internet, företaget, storlek, dålig, vatten, dagis, miljoner, passar, älskar, stämmer, ingår, personen, tanke, vänner, hälften, arbete, skönt, lagt, äger, utbildning, jättebra, varor, lösa, stod, sparat, tjäna, kosta, behövs, låta, försäkring, vagn, fort, ekonomin, frakt, viktigt, möjlighet, kompis, snabbt, glad, sönder, problemet, skit, övrigt, mamman, plats, tydligen, gånger, reda, lägre, situation, vanlig, varan, aning, förstå, semester, bilar, maken, säker, hyran, varandra, tacksam, erfarenhet, billiga, kontantinsats, butiken, skolan, särskilt, kontakt, iallafall, rent, skickar, såna, tycka, mesta, betyder, viss, alternativ, affären, avtal, lilla, 3000, mail, köra, bostad, hittat, kollar, handlat, fint, visste, läser, fonder, förutom, ifall, sparkonto, stan, blöjor, valt, kontakta, givetvis, litet, alldeles, pratar, tiden, maten, priser, väntar, ensam, 2000, behov, antar, knappt, anledning, kollat, läste, roligt, jobbade, sjuk, 5000, skatten, söker, fyller, känna, gifta, japp, räknat, våran, börjat, avgift, posten, slippa, barnbidrag, 1000, vagnen, titta, jätte, affär, beställa, intressant, frågade, iväg, nyfiken, saken, betydligt, förklara, flyttade, antingen, fixa, sällan, bostadsrätt, föräldrarna, kräva, svenska, hamnar, nära, kollade, dras, hjälper, synd, billig, kostnaden, värde, flyttar, amortering, berätta, försäkringar, gången, frågor, rabatt, knappast, någonstans, brev, sjukt, sluta, bensin, sålt, ekonomiska, antal, mannen, räkningarna, illa, svart, blocket, kreditkort, gammal, hända, därifrån, sparade, minns, jobbigt, underhåll, skickat, medan, frågar, resor, fullt, arbetar, otroligt, sämre, tvungen, julklappar, orkar, snälla, landet, senare, föräldrapenning, mobil, kostnad, plagg, gravid, regler, amortera, iofs, kläderna, krav, kortet, princip, inkl, bodde, rimligt, överens, 4000, kronofogden, lättare, höga, kredit, vinst, lång, behövde, form, skull, affärer, konton, möbler, menade, bostadsbidrag, normalt, förstås, föräldraledig, hehe, barnets, prova, förut, banker, sjukskriven, privat, handlade, plugga, fortsätta, kött, kontant, ihåg, räkning, dels, visar, säljare, byxor, körkort, butiker, hänt, lånen, kring, vecka, vårdnad, kräver, naturligtvis, onödigt, förälder, övriga, svaret, mjölk, budget, bild, barnens, sålde, skickade, köpet, lära, bröd, tråkigt, förmodligen, behålla, vägen, himla, nämligen, arbeta, sant, avdrag, rosa, använt, köparen, ändra, tröja, tilläggskommentar, skuld, inköp, valde, info, trådstartarens, fasta, coop, beslut, förslag, nordea, utöver, pass, testa, beställt, facket, personligen, äldre, faktura, belopp, ställe, räntor, intresserad, utomlands, nöjen, antagligen, full, fundera, paketet, arbetsgivare, hämta, avbetalning, lånar, tillräckligt, polisen, jeans, fylla, räcka, fallet, kunder, snarare, förrän, priserna, märke, dator, åring, lunch, såhär, lidl, studielån, perfekt, löser, ensamstående, ekonomisk, kommun, ställa, önskar, bröllop, lämnar, bygga, 1500, krävs, bebis, kronor, starta, forum, försörja, beställde, uppgifter, därmed, 2007, villa, information, stället, chans, världen, delad, försökt, ställen, dumt, leta, stad, begagnat, lyckas, bilder, vuxen, aktier, löner, pratat, bott, högt, bryr, studerar, svarar, skillnaden, förstått, gekås, jacka, glömde, grund, tillägga, tala, godis, nöjda, märken, tjänst, tanken, borta, avgifter, shoppa, syster, hinner, laga, senaste, tillgångar, skulden, öppna, plötsligt, situationen, skriv, ovan, tittar, krona, största, automatiskt, smart, hamna, miljon, beloppet, snygga, anmäla, gett, 6000, leksaker, pluggar, ytterligare, omöjligt, kommunen, lagen, utav, sparkontot, pratade, drygt, människa, vända, puffar, visserligen, sättet, förresten, bestämma, bestämt, datum, barnkläder, frakten, bolag, skatteverket, present, hyresrätt, studier, jävla, kvitto, förhoppningsvis, bankerna, skyldig, ordentligt, sambos, produkter, dags, annorlunda, arbetsgivaren, tillkommer, ringt, jämföra, amorterar, rädd, fattig, passa, samhället, moms, erbjudande, säkerhet, ålder, risk, summor, middag, trist, exempelvis, försök, inkomsten, puff, svarade, jurist, betalda, vårat, dagens, vägrar, värd, allra, staten, minsta, värsta, låga, förhållande, bolån, hänger, dåliga, böcker, kund, trådar, telefonen, räkningen, kostnaderna, anledningen, försvinner, huvudet, usch, hemifrån, håll, lagar, timmar, student, lägsta, utifrån, skiljer, bredband, grej, klar, julklapp, vare, planerar, begära, jaha, flyttat, letar, långa, guld, tillgång, noga, angående, tjänat, ledig, sidor, färg, tillbaks, hårt, planera, advokat, bostaden, igång, klänning, studera, hund, skäl, poäng, extremt, kvalitet, används, systemet, socialbidrag, ställer, isåfall, nuvarande, kompisar, röra, reklam, definitivt, syskon, enskild, ställt, utmärkt, relativt, pension, snygg, datorn, suck, träffa, tvärtom, åkte, öppet, vågar, missat, risken, vinsten, frukt, minus, land, trött, mammaledig, service, spel, chef, svensk, gymnasiet, värdet, funka, avgiften, riktig, snål, anställd, läget, försäljning, säng, osäker, gift, överallt, diskutera, velat, förlorar, bevisa, fakturan, främst, djur, sådär, bestämmer, överhuvudtaget, grönsaker, modell, anställning, kalla, strl, lagom, förhand, åsikter, prylar, länken, skola, följa, 7000, adress, trivs, köpare, kunden, boendet, goda, super, saknar, kram, sköter, skaffar, medans, presenter, tackar, lägg, vitt, sakerna, lånade, kände, byter, medlem, mäklaren, slags, jämför, därefter, tipset, föräldern, täcker, huslån, lånat, billigaste, väll, åsikt, tillfället, slutar, kaffe, 500kr, ansöka, unna, uppe, storlekar, testamente, grattis, rätten, sorry, 8000, tipsa, spar, utom, barns, räknade, provat, hemmet, kanon, troligen, användas, nivå, privata, lyckats, deklarationen, område, senast, plocka, renovering, 2500, toppen, separat, sökt, roliga, slänga, sambons, spendera, egendom)
topics: Array[Array[(String, Double)]] = Array(Array((tillbaka,0.008216191335042956), (skatt,0.006509257902643634), (betalar,0.005635041121233399), (folk,0.005131491885839656), (jobb,0.0051057124094540714)), Array((barn,0.013917573767387432), (spara,0.00891926717912398), (skrev,0.008795787566591128), (följande,0.007687478743540771), (köpa,0.007421083954132069)), Array((jobb,0.005941548013271099), (banken,0.005184644368971845), (betalar,0.004761136982814706), (jobbar,0.004732367048439004), (tillbaka,0.00447708103221914)), Array((köper,0.011086173062869036), (handlar,0.010707762120455214), (äter,0.007974933506441925), (köpa,0.007856980307486902), (vuxna,0.005976512509098039)), Array((köpa,0.009345022745034834), (kläder,0.007752851561346635), (köpte,0.0057978627025462625), (barn,0.005201306667796932), (kolla,0.004548491158766831)), Array((barn,0.02047574524007617), (barnet,0.009776681578582441), (barnen,0.005742962450413186), (skrev,0.004847780768717609), (jobb,0.004608856784822973)), Array((betalar,0.010248488991996553), (ekonomi,0.008863292049078849), (huset,0.0068847763666443585), (köpa,0.006869607591782869), (barn,0.0062769843242390586)), Array((buffert,0.022462688377360988), (kontantinsats,0.01832413857067284), (000kr,0.012844781601955733), (resa,0.008253097762916517), (amortering,0.005493083255139651)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Here</span> <span class="n">we</span> <span class="n">pick</span> <span class="n">out</span> <span class="n">the</span> <span class="n">most</span> <span class="n">important</span> <span class="n">terms</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">topic</span> <span class="k">for</span> <span class="n">FB</span><span class="o">.</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FB</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FB</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FB topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9 topics:
TOPIC 0
aktier	0.010372609709935948
fonder	0.009985682032437188
köpa	0.007147380184535501
företag	0.004942859552056198
olika	0.004763000081202069
==========
TOPIC 1
skatt	0.014364304931778378
företag	0.008645452621562126
företaget	0.008300389229465058
bolaget	0.007903692818210637
bolag	0.006402673712961038
==========
TOPIC 2
folk	0.0052167273044414555
jobb	0.004475724890639614
köpa	0.0044337052877254195
bättre	0.003773904791916776
istället	0.003169961913268716
==========
TOPIC 3
bitcoin	0.015097168905144656
bitcoins	0.009816539841970279
köpa	0.0040680120997631155
företag	0.0032437136384805445
olika	0.0030445615311591244
==========
TOPIC 4
moms	0.00633827140783334
köpa	0.005959993345718559
företag	0.005906188488700269
sälja	0.005238515382692445
betalar	0.004281708500936429
==========
TOPIC 5
banken	0.00864432335805033
konto	0.008339277536899259
bank	0.007340445595021358
tillbaka	0.005965709762899769
ränta	0.005342093657300021
==========
TOPIC 6
köpa	0.0034366699860672793
banken	0.003289013342902767
moms	0.003103723942186164
köper	0.003101990581430088
will	0.0030185287141540774
==========
TOPIC 7
inflation	0.007176851887240197
guld	0.006395635479842193
staten	0.006005858645610903
valuta	0.005155325598855097
värde	0.0049879413505575666
==========
TOPIC 8
aktier	0.012040212950249483
köpa	0.007639727547960423
aktien	0.006203784300724798
bolag	0.0057716967783410945
aktie	0.004584515168344491
==========
topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(1, 42, 0, 2, 15),Array(0.010372609709935948, 0.009985682032437188, 0.007147380184535501, 0.004942859552056198, 0.004763000081202069)), (Array(7, 2, 32, 40, 23),Array(0.014364304931778378, 0.008645452621562126, 0.008300389229465058, 0.007903692818210637, 0.006402673712961038)), (Array(3, 25, 0, 4, 9),Array(0.0052167273044414555, 0.004475724890639614, 0.0044337052877254195, 0.003773904791916776, 0.003169961913268716)), (Array(554, 726, 0, 2, 15),Array(0.015097168905144656, 0.009816539841970279, 0.0040680120997631155, 0.0032437136384805445, 0.0030445615311591244)), (Array(115, 0, 2, 6, 10),Array(0.00633827140783334, 0.005959993345718559, 0.005906188488700269, 0.005238515382692445, 0.004281708500936429)), (Array(5, 22, 20, 12, 13),Array(0.00864432335805033, 0.008339277536899259, 0.007340445595021358, 0.005965709762899769, 0.005342093657300021)), (Array(0, 5, 115, 16, 993),Array(0.0034366699860672793, 0.003289013342902767, 0.003103723942186164, 0.003101990581430088, 0.0030185287141540774)), (Array(220, 87, 65, 254, 56),Array(0.007176851887240197, 0.006395635479842193, 0.006005858645610903, 0.005155325598855097, 0.0049879413505575666)), (Array(1, 0, 63, 23, 100),Array(0.012040212950249483, 0.007639727547960423, 0.006203784300724798, 0.0057716967783410945, 0.004584515168344491)))
vocabList: Array[String] = Array(köpa, aktier, företag, folk, bättre, banken, sälja, skatt, borde, istället, betalar, verkar, tillbaka, ränta, fråga, olika, köper, mindre, alltid, stor, bank, problem, konto, bolag, större, jobb, stora, direkt, runt, lika, svårt, svar, företaget, precis, känns, handlar, saker, förstår, dessutom, kort, bolaget, enkelt, fonder, enligt, låna, högre, säljer, håller, vinst, brukar, kostar, kolla, annars, faktiskt, låter, svenska, värde, egentligen, spara, börja, bort, tidigare, tjänar, aktien, länge, staten, marknaden, enda, säkert, ekonomi, fortfarande, använda, liknande, inkomst, mest, räntan, frågan, tänker, hoppas, vissa, börsen, ihop, börjar, tjäna, tips, klart, banker, guld, däremot, sett, fungerar, miljoner, intressant, exempel, sitter, tråden, kapital, hålla, människor, egen, aktie, möjligt, alls, tänkte, massa, avkastning, jobbar, liten, ifrån, först, beror, köpte, risk, endast, hitta, moms, undrar, bästa, använder, tänka, investera, sätta, innebär, själva, ofta, jobba, stort, jävla, längre, skulder, räkna, handla, priset, leva, bankerna, visa, skriva, egna, trots, lägre, kursen, person, problemet, kontot, hyra, veta, köpt, extra, händer, starta, pris, eget, äger, nästan, månad, sidan, vore, självklart, ungefär, värt, lätt, summa, länder, läsa, tänkt, koll, tyvärr, skicka, givetvis, lånet, land, försöka, skrev, gratis, flytta, behöva, världen, ifall, billigare, vilja, absolut, exakt, form, alternativ, tanke, kostnader, värdet, nytt, avgifter, lägenhet, ökar, lägger, funkar, emot, försöker, långt, minst, enbart, snabbt, igenom, information, stämmer, personer, oavsett, vanligt, vänta, spelar, skit, inlägg, kunder, speciellt, skatten, hemma, tråd, tillgångar, bäst, drar, hittar, betalt, räknar, inflation, ekonomin, totalt, skaffa, plus, barn, beroende, antar, anser, hjälpa, dåligt, största, lever, viss, frågor, risken, sida, roll, sånt, avgift, dagens, lånar, tagit, väljer, gott, vinsten, välja, exempelvis, princip, säker, arbete, kontanter, början, förklara, valuta, varor, antal, knappast, övrigt, läst, rent, ingenting, landet, okej, betyder, ville, utgifter, belopp, bidrag, snarare, tänk, visar, utdelning, oftast, sparande, skatteverket, namn, kring, fond, slut, sätter, därmed, index, lyckas, system, 000kr, anledning, förmodligen, skillnad, skapa, såklart, gamla, skuld, delar, räcker, bilen, firma, möjlighet, nordea, köra, resten, livet, sparar, låta, vanliga, betydligt, sker, billigt, hand, betalat, relativt, hört, produkter, krävs, klarar, lycka, undan, slipper, svensk, lång, fortsätta, bostad, ytterligare, jobbet, hemsida, tusen, sålde, summan, byta, satsa, senare, internet, öppna, särskilt, förstå, ekonomiska, avtal, sälj, resultat, svara, betalas, verksamhet, funderar, fallet, sålt, kortet, kräver, tjänster, priserna, antingen, dålig, klara, tiden, utomlands, höga, lösa, antagligen, privat, pratar, ekonomiskt, priser, dyrare, förutom, personen, investering, kund, reda, papper, satt, medan, avdrag, skickar, förlust, senaste, haha, erfarenhet, fort, situation, aktierna, naturligtvis, personligen, extremt, ringa, kronofogden, siffror, tillräckligt, behövs, trodde, summor, låga, bankkonto, föräldrar, dyrt, räknas, omöjligt, sluta, inflationen, systemet, intresserad, investeringar, grund, försäljning, skulden, lönen, zero, började, vanlig, kollar, svaret, hända, enskild, kronor, tillgång, ovan, dela, tydligen, övriga, söka, sparkonto, sämre, kredit, info, kläder, kostnad, konstigt, boende, tacksam, konton, angående, anledningen, lära, privata, räntor, efterfrågan, huset, gånger, följande, bygga, säkerhet, tillväxt, kurs, affärer, läser, samhället, således, inkomster, igång, läste, miljarder, aning, marknad, skrivit, skatta, nuvarande, nivå, värd, lämna, någonstans, konkurs, ekonomisk, högt, börjat, fattar, skapar, krav, miljon, söker, förslag, främst, bilar, månader, slippa, förlora, lägenheten, förstått, sant, höra, innehav, hamnar, saken, jobbat, titta, tillsammans, faktura, flashback, helvete, skillnaden, nått, chans, stiger, fortsätter, frågar, fonden, tjänst, produkt, sikt, följer, skatter, talar, minskar, behålla, fixa, uppgifter, litet, läge, olja, utbildning, beloppet, vänner, långsiktigt, dels, vägen, uppåt, regler, nära, eventuellt, minus, momsen, fullt, framtida, ägare, dollar, normalt, lågt, pass, sättet, skiten, leder, förlorar, väntar, behov, kontakt, kostnaden, försök, kontakta, jävligt, viktigt, fungera, nätet, räkningar, resa, 1000, ökat, förhand, föra, åker, placera, håll, förstås, varandra, affär, tanken, driva, lagt, bitcoin, otroligt, plats, hyran, utav, följa, minska, utveckling, anställda, hälften, kompis, bostadsrätt, svart, kassa, tjänat, liksom, hårt, berätta, därefter, sjukt, arbeta, hittade, faller, kassan, vinster, analys, portfölj, amerikanska, påverkar, iväg, rejält, mesta, dras, stiga, sidor, prata, uppgång, knappt, brev, intresse, såhär, utöver, kosta, sjunker, kunden, räknat, världens, krona, spel, ställa, beslut, arbetar, dator, pension, positivt, totala, silver, cash, forum, hjälper, löner, motsvarande, rimligt, lättare, hittat, dollarn, tillfället, investerar, sparat, gammal, gången, uttag, lyckats, omsättning, framöver, alldeles, månaden, erbjuder, dyra, kontant, troligen, orkar, används, företagen, smart, procent, tittar, rika, handel, dåliga, google, plötsligt, steg, försvinner, betalning, courtage, fylla, generellt, kreditkort, insatt, spela, korrekt, stod, alternativt, plocka, nämligen, saknar, driver, minns, lägg, familj, betalade, arbetsgivare, bygger, skyldig, diverse, nöjd, ihåg, global, dags, billig, verksamheten, försäkring, hänt, medel, flyttar, kräva, dumt, riktiga, troligtvis, lösning, kraftigt, högst, ersättning, iallafall, sänka, slags, telefon, order, stället, läget, goda, avkastningen, tvungen, verkligheten, utdelningen, växa, inköp, lilla, fundera, konsumtion, överhuvudtaget, bostäder, svårare, massor, ställer, kunskap, rekommendera, gällande, nyheter, post, valutan, tvärtom, ändra, deklarationen, långa, förhoppningsvis, testa, kronan, vare, ring, kapitalet, bitcoins, allting, bryr, höja, fint, värdepapper, praktiken, borta, räntorna, framtiden, illa, desto, resultatet, poäng, tackar, undvika, säkra, anställd, investerare, tillbaks, sällan, sambo, mail, 2000, botten, vända, buffert, tyckte, användas, ansvar, kommande, tankar, valt, nere, billiga, halva, amortera, fastigheter, krediter, lånen, påverka, skiter, skäl, länk, visste, skolan, samband, kallas, väll, blocket, mynt, valutor, starkt, andel, kvitto, jämför, situationen, ämnet, spendera, ingår, lånat, adress, lämnar, kalla, fakturan, produktion, görs, kapitalförsäkring, automatiskt, gett, kollat, uppenbarligen, aktiebolag, enklare, roligt, projekt, privatperson, rapporten, resor, full, iofs, rapport, sedlar, möjligheter, svenskar, sjunka, nordnet, ringer, rekommenderar, slår, företagets, känna, politiker, försökt, varan, missat, faktum, källa, fina, leta, bolagen, växla, passar, menade, visserligen, tycka, uppe, löser, plan, äter, 5000, butik, jämföra, utländska, såna, diskutera, förut, påstår, produkten, skull, antalet, avgiften, samtliga, enskilda, tydligt, polare, hamna, argument, ökad, samhälle, värda, definitivt, eventuella, glad, någonsin, intäkter, folket, rätta, utvecklingen, värsta, fasta, osäker, anses, utifrån, intressanta, spännande, riktig, transaktioner, euro, vågar, garanterat, funderat, deklaration, risker, cirka, 100k, närmare, bolagets, back, framtid, arbetslös, resurser, vänder, startar, posten, säljaren, trådar, bild, huvudet, möjligheten, nedgång, fördel, ökade, sköter, handlas, växer, bolån, framförallt, firman, kollade, depå, slutar, budget, seriöst, tvingas, utveckla, gränsen, alternativet, synd, frågade, snackar, drygt, potential, program, fonderna, dylikt, butiker, nytta, köpet, netto, student, skönt, använt, ordentligt, förr, mamma, isåfall, total, böcker, kostnaderna, regel, senast, snabbare, stöd, tider, privatpersoner, stad, skickat, erbjuda, inser, förhållande, enkel, hämta, gissar, trycka, vettigt, mille, datum, säljare, amortering, obligationer, eventuell, bostaden, fattiga, tala, negativt, sannolikt, minsta, beskattas, paket, röra, ställe, ringde, stark, kunderna, vatten, förutsatt, slutet, nivåer, bestämmer, leda, överens, denne, portföljen, stabil, försäljningen, öppnar, säljs, utdelningar, reklam, internetbank, onödigt, investmentbolag, fördelar, this, skulderna, klar, will, oberoende, svarta, bevisa, annorlunda, möjligen, bevis)
topics: Array[Array[(String, Double)]] = Array(Array((aktier,0.010372609709935948), (fonder,0.009985682032437188), (köpa,0.007147380184535501), (företag,0.004942859552056198), (olika,0.004763000081202069)), Array((skatt,0.014364304931778378), (företag,0.008645452621562126), (företaget,0.008300389229465058), (bolaget,0.007903692818210637), (bolag,0.006402673712961038)), Array((folk,0.0052167273044414555), (jobb,0.004475724890639614), (köpa,0.0044337052877254195), (bättre,0.003773904791916776), (istället,0.003169961913268716)), Array((bitcoin,0.015097168905144656), (bitcoins,0.009816539841970279), (köpa,0.0040680120997631155), (företag,0.0032437136384805445), (olika,0.0030445615311591244)), Array((moms,0.00633827140783334), (köpa,0.005959993345718559), (företag,0.005906188488700269), (sälja,0.005238515382692445), (betalar,0.004281708500936429)), Array((banken,0.00864432335805033), (konto,0.008339277536899259), (bank,0.007340445595021358), (tillbaka,0.005965709762899769), (ränta,0.005342093657300021)), Array((köpa,0.0034366699860672793), (banken,0.003289013342902767), (moms,0.003103723942186164), (köper,0.003101990581430088), (will,0.0030185287141540774)), Array((inflation,0.007176851887240197), (guld,0.006395635479842193), (staten,0.006005858645610903), (valuta,0.005155325598855097), (värde,0.0049879413505575666)), Array((aktier,0.012040212950249483), (köpa,0.007639727547960423), (aktien,0.006203784300724798), (bolag,0.0057716967783410945), (aktie,0.004584515168344491)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
<span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

<span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
  <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
  <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
<span class="p">})</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
<span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">termDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Creates</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span> <span class="n">of</span> <span class="n">forum</span> <span class="ow">in</span> <span class="n">FB</span>
<span class="n">val</span> <span class="n">rawJson</span> <span class="o">=</span> <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Similar</span> <span class="k">as</span> <span class="n">above</span> <span class="n">but</span> <span class="k">for</span> <span class="n">FL</span>

<span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel_FL</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer_FL</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
<span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

<span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
  <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
  <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
<span class="p">})</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
<span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span> <span class="n">of</span> <span class="n">forum</span> <span class="ow">in</span> <span class="n">FB</span>
<span class="n">val</span> <span class="n">rawJson</span> <span class="o">=</span> <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rawJson</span><span class="p">(</span><span class="n">lda_model</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mllib</span><span class="o">.</span><span class="n">clustering</span><span class="o">.</span><span class="n">LDAModel</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">CountVectorizerModel</span><span class="p">):</span> <span class="n">String</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">lda_model</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">vocabulary</span>
  <span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics_FL topics:&quot;</span><span class="p">)</span>
  <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
    <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
  <span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>

  <span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
  <span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
    <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
    <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
  <span class="p">})</span>

  <span class="o">//</span> <span class="n">Create</span> <span class="n">DF</span> <span class="k">with</span> <span class="n">proper</span> <span class="n">column</span> <span class="n">names</span>
  <span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>

  <span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span>
  <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span> <span class="n">to</span> <span class="n">display</span> <span class="n">topic</span> <span class="n">distribution</span>
<span class="n">val</span> <span class="n">rawJson_FL</span> <span class="o">=</span> <span class="n">rawJson</span><span class="p">(</span><span class="n">ldaModel_FL</span><span class="p">,</span> <span class="n">vectorizer_FL</span><span class="p">)</span>
<span class="n">val</span> <span class="n">rawJson_FB</span> <span class="o">=</span> <span class="n">rawJson</span><span class="p">(</span><span class="n">ldaModel_FB</span><span class="p">,</span> <span class="n">vectorizer_FB</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>