
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../../index.html">
  
  <img src="../../../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../_sources/000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks/RaazTiloWork/01_DataIngestion.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks/RaazTiloWork/01_DataIngestion.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="simple nav section-nav flex-column">
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">zenodo</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">record</span><span class="o">/</span><span class="mi">3602254</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">hls4ml_LHCjet_100p_train</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--2020-12-08 10:36:34--  https://zenodo.org/record/3602254/files/hls4ml_LHCjet_100p_train.tar.gz
Resolving zenodo.org (zenodo.org)... 137.138.76.77
Connecting to zenodo.org (zenodo.org)|137.138.76.77|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2764083152 (2.6G) [application/octet-stream]
Saving to: ‘hls4ml_LHCjet_100p_train.tar.gz.1’

     0K .......... .......... .......... .......... ..........  0%  145K 5h9m
    50K .......... .......... .......... .......... ..........  0%  290K 3h52m
   100K .......... .......... .......... .......... ..........  0%  290K 3h26m
   150K .......... .......... .......... .......... ..........  0%  291K 3h13m
   200K .......... .......... .......... .......... ..........  0%  290K 3h5m
   250K .......... .......... .......... .......... ..........  0%  145K 3h26m
   300K .......... .......... .......... .......... ..........  0% 99.0M 2h57m
   350K .......... .......... .......... .......... ..........  0%  290K 2h54m
   400K .......... .......... .......... .......... ..........  0%  145K 3h9m
   450K .......... .......... .......... .......... ..........  0%  290K 3h6m
   500K .......... .......... .......... .......... ..........  0%  145K 3h17m
   550K .......... .......... .......... .......... ..........  0% 93.7M 3h0m
   600K .......... .......... .......... .......... ..........  0%  290K 2h58m
   650K .......... .......... .......... .......... ..........  0%  289K 2h57m
   700K .......... .......... .......... .......... ..........  0%  290K 2h55m
   750K .......... .......... .......... .......... ..........  0%  291K 2h54m
   800K .......... .......... .......... .......... ..........  0%  292K 2h53m
   850K .......... .......... .......... .......... ..........  0%  289K 2h52m
   900K .......... .......... .......... .......... ..........  0%  290K 2h51m
   950K .......... .......... .......... .......... ..........  0%  290K 2h50m
  1000K .......... .......... .......... .......... ..........  0%  146K 2h57m
  1050K .......... .......... .......... .......... ..........  0%  291K 2h56m
  1100K .......... .......... .......... .......... ..........  0% 29.3M 2h48m
  1150K .......... .......... .......... .......... ..........  0%  292K 2h47m
  1200K .......... .......... .......... .......... ..........  0%  290K 2h47m
  1250K .......... .......... .......... .......... ..........  0%  290K 2h46m
  1300K .......... .......... .......... .......... ..........  0%  290K 2h46m
  1350K .......... .......... .......... .......... ..........  0%  291K 2h46m
  1400K .......... .......... .......... .......... ..........  0%  290K 2h45m
  1450K .......... .......... .......... .......... ..........  0%  145K 2h50m
  1500K .......... .......... .......... .......... ..........  0%  290K 2h49m
  1550K .......... .......... .......... .......... ..........  0% 1.16M 2h45m
  1600K .......... .......... .......... .......... ..........  0%  166K 2h49m
  1650K .......... .......... .......... .......... ..........  0% 1.15M 2h45m
  1700K .......... .......... .......... .......... ..........  0% 98.8M 2h40m
  1750K .......... .......... .......... .......... ..........  0%  387K 2h39m
  1800K .......... .......... .......... .......... ..........  0% 1.15M 2h35m
  1850K .......... .......... .......... .......... ..........  0%  125M 2h31m
  1900K .......... .......... .......... .......... ..........  0%  103M 2h27m
  1950K .......... .......... .......... .......... ..........  0%  106M 2h24m
  2000K .......... .......... .......... .......... ..........  0%  389K 2h23m
  2050K .......... .......... .......... .......... ..........  0%  209M 2h20m
  2100K .......... .......... .......... .......... ..........  0% 1.16M 2h17m
  2150K .......... .......... .......... .......... ..........  0%  122M 2h14m
  2200K .......... .......... .......... .......... ..........  0%  157M 2h11m
  2250K .......... .......... .......... .......... ..........  0%  180M 2h8m
  2300K .......... .......... .......... .......... ..........  0%  163M 2h6m
  2350K .......... .......... .......... .......... ..........  0%  140M 2h3m
  2400K .......... .......... .......... .......... ..........  0%  140M 2h0m
  2450K .......... .......... .......... .......... ..........  0%  124M 1h58m
  2500K .......... .......... .......... .......... ..........  0%  391K 1h58m
  2550K .......... .......... .......... .......... ..........  0%  158M 1h56m
  2600K .......... .......... .......... .......... ..........  0%  147M 1h53m
  2650K .......... .......... .......... .......... ..........  0%  138M 1h51m
  2700K .......... .......... .......... .......... ..........  0%  126M 1h49m
  2750K .......... .......... .......... .......... ..........  0% 1.19M 1h48m
  2800K .......... .......... .......... .......... ..........  0%  138M 1h46m
  2850K .......... .......... .......... .......... ..........  0%  162M 1h44m
  2900K .......... .......... .......... .......... ..........  0%  149M 1h43m
  2950K .......... .......... .......... .......... ..........  0%  176M 1h41m
  3000K .......... .......... .......... .......... ..........  0%  139M 99m39s
  3050K .......... .......... .......... .......... ..........  0%  187M 98m3s
  3100K .......... .......... .......... .......... ..........  0%  117M 96m30s
  3150K .......... .......... .......... .......... ..........  0%  160M 94m59s
  3200K .......... .......... .......... .......... ..........  0%  114M 93m32s
  3250K .......... .......... .......... .......... ..........  0%  134M 92m7s
  3300K .......... .......... .......... .......... ..........  0%  129M 90m45s
  3350K .......... .......... .......... .......... ..........  0%  140M 89m25s
  3400K .......... .......... .......... .......... ..........  0%  152M 88m7s
  3450K .......... .......... .......... .......... ..........  0%  124M 86m52s
  3500K .......... .......... .......... .......... ..........  0%  400K 87m13s
  3550K .......... .......... .......... .......... ..........  0% 95.1M 86m1s
  3600K .......... .......... .......... .......... ..........  0%  122M 84m50s
  3650K .......... .......... .......... .......... ..........  0%  110M 83m42s
  3700K .......... .......... .......... .......... ..........  0%  125M 82m35s
  3750K .......... .......... .......... .......... ..........  0%  141M 81m30s
  3800K .......... .......... .......... .......... ..........  0%  152M 80m27s
  3850K .......... .......... .......... .......... ..........  0%  166M 79m25s
  3900K .......... .......... .......... .......... ..........  0%  141M 78m25s
  3950K .......... .......... .......... .......... ..........  0%  182M 77m26s
  4000K .......... .......... .......... .......... ..........  0% 1.24M 76m55s
  4050K .......... .......... .......... .......... ..........  0%  114M 75m59s
  4100K .......... .......... .......... .......... ..........  0%  105M 75m4s
  4150K .......... .......... .......... .......... ..........  0%  141M 74m10s
  4200K .......... .......... .......... .......... ..........  0%  127M 73m18s
  4250K .......... .......... .......... .......... ..........  0%  128M 72m27s
  4300K .......... .......... .......... .......... ..........  0%  138M 71m37s
  4350K .......... .......... .......... .......... ..........  0%  157M 70m49s
  4400K .......... .......... .......... .......... ..........  0%  131M 70m1s
  4450K .......... .......... .......... .......... ..........  0%  136M 69m15s
  4500K .......... .......... .......... .......... ..........  0%  133M 68m29s
  4550K .......... .......... .......... .......... ..........  0%  166M 67m44s
  4600K .......... .......... .......... .......... ..........  0%  133M 67m1s
  4650K .......... .......... .......... .......... ..........  0%  154M 66m18s
  4700K .......... .......... .......... .......... ..........  0%  137M 65m37s
  4750K .......... .......... .......... .......... ..........  0%  147M 64m56s
  4800K .......... .......... .......... .......... ..........  0%  118M 64m16s
  4850K .......... .......... .......... .......... ..........  0%  147M 63m36s
  4900K .......... .......... .......... .......... ..........  0%  163M 62m58s
  4950K .......... .......... .......... .......... ..........  0%  117M 62m20s
  5000K .......... .......... .......... .......... ..........  0%  144M 61m43s
  5050K .......... .......... .......... .......... ..........  0%  408K 62m12s
  5100K .......... .......... .......... .......... ..........  0%  141M 61m36s
  5150K .......... .......... .......... .......... ..........  0%  152M 61m0s
  5200K .......... .......... .......... .......... ..........  0%  159M 60m25s
  5250K .......... .......... .......... .......... ..........  0%  132M 59m51s
  5300K .......... .......... .......... .......... ..........  0%  169M 59m18s
  5350K .......... .......... .......... .......... ..........  0%  138M 58m45s
  5400K .......... .......... .......... .......... ..........  0%  141M 58m13s
  5450K .......... .......... .......... .......... ..........  0%  152M 57m41s
  5500K .......... .......... .......... .......... ..........  0%  151M 57m10s
  5550K .......... .......... .......... .......... ..........  0% 1.24M 56m58s
  5600K .......... .......... .......... .......... ..........  0%  186M 56m28s
  5650K .......... .......... .......... .......... ..........  0%  149M 55m58s
  5700K .......... .......... .......... .......... ..........  0% 88.6M 55m29s
  5750K .......... .......... .......... .......... ..........  0%  154M 55m1s
  5800K .......... .......... .......... .......... ..........  0%  172M 54m33s
  5850K .......... .......... .......... .......... ..........  0%  175M 54m5s
  5900K .......... .......... .......... .......... ..........  0%  155M 53m38s
  5950K .......... .......... .......... .......... ..........  0%  192M 53m11s
  6000K .......... .......... .......... .......... ..........  0%  172M 52m45s
  6050K .......... .......... .......... .......... ..........  0%  188M 52m19s
  6100K .......... .......... .......... .......... ..........  0%  145M 51m53s
  6150K .......... .......... .......... .......... ..........  0%  168M 51m28s
  6200K .......... .......... .......... .......... ..........  0%  142M 51m4s
  6250K .......... .......... .......... .......... ..........  0%  129M 50m40s
  6300K .......... .......... .......... .......... ..........  0%  159M 50m16s
  6350K .......... .......... .......... .......... ..........  0%  141M 49m52s
  6400K .......... .......... .......... .......... ..........  0%  111M 49m29s
  6450K .......... .......... .......... .......... ..........  0%  123M 49m6s
  6500K .......... .......... .......... .......... ..........  0%  119M 48m44s
  6550K .......... .......... .......... .......... ..........  0%  135M 48m22s
  6600K .......... .......... .......... .......... ..........  0%  406K 48m50s
  6650K .......... .......... .......... .......... ..........  0%  127M 48m28s
  6700K .......... .......... .......... .......... ..........  0%  131M 48m7s
  6750K .......... .......... .......... .......... ..........  0%  144M 47m46s
  6800K .......... .......... .......... .......... ..........  0%  147M 47m25s
  6850K .......... .......... .......... .......... ..........  0%  140M 47m4s
  6900K .......... .......... .......... .......... ..........  0%  128M 46m44s
  6950K .......... .......... .......... .......... ..........  0%  171M 46m24s
  7000K .......... .......... .......... .......... ..........  0%  142M 46m4s
  7050K .......... .......... .......... .......... ..........  0% 30.8M 45m46s
  7100K .......... .......... .......... .......... ..........  0% 1.28M 45m41s
  7150K .......... .......... .......... .......... ..........  0%  105M 45m22s
  7200K .......... .......... .......... .......... ..........  0% 93.7M 45m3s
  7250K .......... .......... .......... .......... ..........  0%  112M 44m45s
  7300K .......... .......... .......... .......... ..........  0% 95.0M 44m27s
  7350K .......... .......... .......... .......... ..........  0%  102M 44m9s
  7400K .......... .......... .......... .......... ..........  0%  124M 43m51s
  7450K .......... .......... .......... .......... ..........  0%  129M 43m34s
  7500K .......... .......... .......... .......... ..........  0%  116M 43m16s
  7550K .......... .......... .......... .......... ..........  0%  191M 42m59s
  7600K .......... .......... .......... .......... ..........  0%  205M 42m42s
  7650K .......... .......... .......... .......... ..........  0%  239M 42m26s
  7700K .......... .......... .......... .......... ..........  0%  141M 42m9s
  7750K .......... .......... .......... .......... ..........  0%  205M 41m53s
  7800K .......... .......... .......... .......... ..........  0%  221M 41m37s
  7850K .......... .......... .......... .......... ..........  0%  150M 41m22s
  7900K .......... .......... .......... .......... ..........  0%  169M 41m6s
  7950K .......... .......... .......... .......... ..........  0%  249M 40m51s
  8000K .......... .......... .......... .......... ..........  0%  192M 40m35s
  8050K .......... .......... .......... .......... ..........  0%  234M 40m20s
  8100K .......... .......... .......... .......... ..........  0%  230M 40m6s
  8150K .......... .......... .......... .......... ..........  0%  405K 40m31s
  8200K .......... .......... .......... .......... ..........  0%  123M 40m17s
  8250K .......... .......... .......... .......... ..........  0%  114M 40m2s
  8300K .......... .......... .......... .......... ..........  0% 88.5M 39m48s
  8350K .......... .......... .......... .......... ..........  0%  111M 39m34s
  8400K .......... .......... .......... .......... ..........  0%  105M 39m20s
  8450K .......... .......... .......... .......... ..........  0%  132M 39m6s
  8500K .......... .......... .......... .......... ..........  0%  152M 38m53s
  8550K .......... .......... .......... .......... ..........  0%  119M 38m39s
  8600K .......... .......... .......... .......... ..........  0% 1.28M 38m38s
  8650K .......... .......... .......... .......... ..........  0% 68.6M 38m24s
  8700K .......... .......... .......... .......... ..........  0%  118M 38m11s
  8750K .......... .......... .......... .......... ..........  0%  107M 37m58s
  8800K .......... .......... .......... .......... ..........  0%  123M 37m46s
  8850K .......... .......... .......... .......... ..........  0%  122M 37m33s
  8900K .......... .......... .......... .......... ..........  0%  112M 37m20s
  8950K .......... .......... .......... .......... ..........  0%  117M 37m8s
  9000K .......... .......... .......... .......... ..........  0%  120M 36m56s
  9050K .......... .......... .......... .......... ..........  0%  126M 36m44s
  9100K .......... .......... .......... .......... ..........  0%  109M 36m32s
  9150K .......... .......... .......... .......... ..........  0%  112M 36m20s
  9200K .......... .......... .......... .......... ..........  0%  119M 36m8s
  9250K .......... .......... .......... .......... ..........  0%  112M 35m57s
  9300K .......... .......... .......... .......... ..........  0%  122M 35m45s
  9350K .......... .......... .......... .......... ..........  0%  122M 35m34s
  9400K .......... .......... .......... .......... ..........  0%  117M 35m23s
  9450K .......... .......... .......... .......... ..........  0%  139M 35m12s
  9500K .......... .......... .......... .......... ..........  0%  127M 35m1s
  9550K .......... .......... .......... .......... ..........  0%  121M 34m50s
  9600K .......... .......... .......... .......... ..........  0%  123M 34m39s
  9650K .......... .......... .......... .......... ..........  0%  410K 35m2s
  9700K .......... .......... .......... .......... ..........  0% 80.5M 34m51s
  9750K .......... .......... .......... .......... ..........  0% 3.51M 34m44s
  9800K .......... .......... .......... .......... ..........  0%  100M 34m34s
  9850K .......... .......... .......... .......... ..........  0% 90.7M 34m24s
  9900K .......... .......... .......... .......... ..........  0%  130M 34m13s
  9950K .......... .......... .......... .......... ..........  0%  163M 34m3s
 10000K .......... .......... .......... .......... ..........  0%  158M 33m53s
 10050K .......... .......... .......... .......... ..........  0%  108M 33m43s
 10100K .......... .......... .......... .......... ..........  0%  152M 33m33s
 10150K .......... .......... .......... .......... ..........  0% 1.92M 33m30s
 10200K .......... .......... .......... .......... ..........  0%  111M 33m20s
 10250K .......... .......... .......... .......... ..........  0%  140M 33m10s
 10300K .......... .......... .......... .......... ..........  0%  134M 33m1s
 10350K .......... .......... .......... .......... ..........  0%  149M 32m51s
 10400K .......... .......... .......... .......... ..........  0%  200M 32m42s
 10450K .......... .......... .......... .......... ..........  0%  162M 32m33s
 10500K .......... .......... .......... .......... ..........  0%  150M 32m24s
 10550K .......... .......... .......... .......... ..........  0%  112M 32m14s
 10600K .......... .......... .......... .......... ..........  0% 92.1M 32m5s
 10650K .......... .......... .......... .......... ..........  0%  124M 31m57s
 10700K .......... .......... .......... .......... ..........  0%  109M 31m48s
 10750K .......... .......... .......... .......... ..........  0%  126M 31m39s
 10800K .......... .......... .......... .......... ..........  0%  114M 31m30s
 10850K .......... .......... .......... .......... ..........  0%  142M 31m22s
 10900K .......... .......... .......... .......... ..........  0%  134M 31m13s
 10950K .......... .......... .......... .......... ..........  0%  175M 31m5s
 11000K .......... .......... .......... .......... ..........  0%  130M 30m56s
 11050K .......... .......... .......... .......... ..........  0%  166M 30m48s
 11100K .......... .......... .......... .......... ..........  0%  129M 30m40s
 11150K .......... .......... .......... .......... ..........  0%  146M 30m31s
 11200K .......... .......... .......... .......... ..........  0%  394K 30m54s
 11250K .......... .......... .......... .......... ..........  0%  123M 30m45s
 11300K .......... .......... .......... .......... ..........  0% 5.07M 30m40s
 11350K .......... .......... .......... .......... ..........  0%  140M 30m32s
 11400K .......... .......... .......... .......... ..........  0%  180M 30m24s
 11450K .......... .......... .......... .......... ..........  0%  142M 30m16s
 11500K .......... .......... .......... .......... ..........  0%  133M 30m8s
 11550K .......... .......... .......... .......... ..........  0%  160M 30m0s
 11600K .......... .......... .......... .......... ..........  0%  148M 29m52s
 11650K .......... .......... .......... .......... ..........  0% 77.7M 29m45s
 11700K .......... .......... .......... .......... ..........  0% 1.92M 29m43s
 11750K .......... .......... .......... .......... ..........  0%  200M 29m36s
 11800K .......... .......... .......... .......... ..........  0%  145M 29m28s
 11850K .......... .......... .......... .......... ..........  0%  145M 29m21s
 11900K .......... .......... .......... .......... ..........  0% 77.8M 29m13s
 11950K .......... .......... .......... .......... ..........  0%  111M 29m6s
 12000K .......... .......... .......... .......... ..........  0%  113M 28m59s
 12050K .......... .......... .......... .......... ..........  0%  146M 28m52s
 12100K .......... .......... .......... .......... ..........  0%  158M 28m45s
 12150K .......... .......... .......... .......... ..........  0%  160M 28m38s
 12200K .......... .......... .......... .......... ..........  0%  165M 28m31s
 12250K .......... .......... .......... .......... ..........  0%  162M 28m24s
 12300K .......... .......... .......... .......... ..........  0%  143M 28m17s
 12350K .......... .......... .......... .......... ..........  0%  181M 28m10s
 12400K .......... .......... .......... .......... ..........  0%  129M 28m3s
 12450K .......... .......... .......... .......... ..........  0%  119M 27m57s
 12500K .......... .......... .......... .......... ..........  0%  108M 27m50s
 12550K .......... .......... .......... .......... ..........  0%  135M 27m44s
 12600K .......... .......... .......... .......... ..........  0%  119M 27m37s
 12650K .......... .......... .......... .......... ..........  0%  142M 27m31s
 12700K .......... .......... .......... .......... ..........  0%  394K 27m51s
 12750K .......... .......... .......... .......... ..........  0% 92.2M 27m44s
 12800K .......... .......... .......... .......... ..........  0% 5.06M 27m40s
 12850K .......... .......... .......... .......... ..........  0%  120M 27m34s
 12900K .......... .......... .......... .......... ..........  0%  112M 27m27s
 12950K .......... .......... .......... .......... ..........  0%  118M 27m21s
 13000K .......... .......... .......... .......... ..........  0%  102M 27m15s
 13050K .......... .......... .......... .......... ..........  0%  108M 27m9s
 13100K .......... .......... .......... .......... ..........  0% 97.9M 27m2s
 13150K .......... .......... .......... .......... ..........  0%  134M 26m56s
 13200K .......... .......... .......... .......... ..........  0% 48.4M 26m50s
 13250K .......... .......... .......... .......... ..........  0% 2.00M 26m49s
 13300K .......... .......... .......... .......... ..........  0%  113M 26m43s
 13350K .......... .......... .......... .......... ..........  0%  114M 26m37s
 13400K .......... .......... .......... .......... ..........  0% 98.2M 26m31s
 13450K .......... .......... .......... .......... ..........  0%  134M 26m26s
 13500K .......... .......... .......... .......... ..........  0%  114M 26m20s
 13550K .......... .......... .......... .......... ..........  0%  140M 26m14s
 13600K .......... .......... .......... .......... ..........  0%  110M 26m8s
 13650K .......... .......... .......... .......... ..........  0%  100M 26m3s
 13700K .......... .......... .......... .......... ..........  0% 93.9M 25m57s
 13750K .......... .......... .......... .......... ..........  0%  169M 25m51s
 13800K .......... .......... .......... .......... ..........  0%  201M 25m46s
 13850K .......... .......... .......... .......... ..........  0%  251M 25m40s
 13900K .......... .......... .......... .......... ..........  0%  199M 25m35s
 13950K .......... .......... .......... .......... ..........  0%  222M 25m29s
 14000K .......... .......... .......... .......... ..........  0%  177M 25m24s
 14050K .......... .......... .......... .......... ..........  0%  231M 25m19s
 14100K .......... .......... .......... .......... ..........  0%  213M 25m13s
 14150K .......... .......... .......... .......... ..........  0%  257M 25m8s
 14200K .......... .......... .......... .......... ..........  0% 1.27M 25m10s
 14250K .......... .......... .......... .......... ..........  0%  560K 25m21s
 14300K .......... .......... .......... .......... ..........  0% 99.4M 25m16s
 14350K .......... .......... .......... .......... ..........  0% 5.17M 25m13s
 14400K .......... .......... .......... .......... ..........  0% 96.6M 25m7s
 14450K .......... .......... .......... .......... ..........  0%  121M 25m2s
 14500K .......... .......... .......... .......... ..........  0% 99.3M 24m57s
 14550K .......... .......... .......... .......... ..........  0%  124M 24m52s
 14600K .......... .......... .......... .......... ..........  0%  112M 24m47s
 14650K .......... .......... .......... .......... ..........  0%  124M 24m42s
 14700K .......... .......... .......... .......... ..........  0%  114M 24m37s
 14750K .......... .......... .......... .......... ..........  0% 19.7M 24m32s
 14800K .......... .......... .......... .......... ..........  0% 2.14M 24m32s
 14850K .......... .......... .......... .......... ..........  0%  117M 24m27s
 14900K .......... .......... .......... .......... ..........  0%  109M 24m22s
 14950K .......... .......... .......... .......... ..........  0%  130M 24m17s
 15000K .......... .......... .......... .......... ..........  0%  145M 24m12s
 15050K .......... .......... .......... .......... ..........  0%  161M 24m7s
 15100K .......... .......... .......... .......... ..........  0%  116M 24m3s
 15150K .......... .......... .......... .......... ..........  0%  134M 23m58s
 15200K .......... .......... .......... .......... ..........  0%  136M 23m53s
 15250K .......... .......... .......... .......... ..........  0%  170M 23m49s
 15300K .......... .......... .......... .......... ..........  0%  130M 23m44s
 15350K .......... .......... .......... .......... ..........  0%  190M 23m39s
 15400K .......... .......... .......... .......... ..........  0%  141M 23m35s
 15450K .......... .......... .......... .......... ..........  0%  147M 23m30s

*** WARNING: skipped 4220606 bytes of output ***

2683150K .......... .......... .......... .......... .......... 99% 86.9M 3s
2683200K .......... .......... .......... .......... .......... 99% 63.2M 3s
2683250K .......... .......... .......... .......... .......... 99%  115M 3s
2683300K .......... .......... .......... .......... .......... 99% 91.6M 3s
2683350K .......... .......... .......... .......... .......... 99%  134M 3s
2683400K .......... .......... .......... .......... .......... 99% 98.1M 3s
2683450K .......... .......... .......... .......... .......... 99%  154M 3s
2683500K .......... .......... .......... .......... .......... 99%  136M 3s
2683550K .......... .......... .......... .......... .......... 99%  165M 3s
2683600K .......... .......... .......... .......... .......... 99%  142M 3s
2683650K .......... .......... .......... .......... .......... 99%  192M 3s
2683700K .......... .......... .......... .......... .......... 99%  139M 3s
2683750K .......... .......... .......... .......... .......... 99%  105M 3s
2683800K .......... .......... .......... .......... .......... 99%  156M 3s
2683850K .......... .......... .......... .......... .......... 99%  141M 3s
2683900K .......... .......... .......... .......... .......... 99% 35.3M 3s
2683950K .......... .......... .......... .......... .......... 99%  155M 3s
2684000K .......... .......... .......... .......... .......... 99% 94.8M 3s
2684050K .......... .......... .......... .......... .......... 99% 8.06M 3s
2684100K .......... .......... .......... .......... .......... 99%  668K 3s
2684150K .......... .......... .......... .......... .......... 99%  604K 3s
2684200K .......... .......... .......... .......... .......... 99% 71.0M 3s
2684250K .......... .......... .......... .......... .......... 99% 68.6M 3s
2684300K .......... .......... .......... .......... .......... 99% 93.8M 3s
2684350K .......... .......... .......... .......... .......... 99% 93.1M 3s
2684400K .......... .......... .......... .......... .......... 99%  120M 3s
2684450K .......... .......... .......... .......... .......... 99%  140M 3s
2684500K .......... .......... .......... .......... .......... 99% 99.8M 2s
2684550K .......... .......... .......... .......... .......... 99%  142M 2s
2684600K .......... .......... .......... .......... .......... 99%  137M 2s
2684650K .......... .......... .......... .......... .......... 99%  116M 2s
2684700K .......... .......... .......... .......... .......... 99%  134M 2s
2684750K .......... .......... .......... .......... .......... 99%  156M 2s
2684800K .......... .......... .......... .......... .......... 99%  107M 2s
2684850K .......... .......... .......... .......... .......... 99%  133M 2s
2684900K .......... .......... .......... .......... .......... 99%  113M 2s
2684950K .......... .......... .......... .......... .......... 99% 72.3M 2s
2685000K .......... .......... .......... .......... .......... 99% 99.1M 2s
2685050K .......... .......... .......... .......... .......... 99% 52.3M 2s
2685100K .......... .......... .......... .......... .......... 99% 20.9M 2s
2685150K .......... .......... .......... .......... .......... 99%  639K 2s
2685200K .......... .......... .......... .......... .......... 99%  604K 2s
2685250K .......... .......... .......... .......... .......... 99% 93.6M 2s
2685300K .......... .......... .......... .......... .......... 99% 55.8M 2s
2685350K .......... .......... .......... .......... .......... 99% 99.7M 2s
2685400K .......... .......... .......... .......... .......... 99% 73.7M 2s
2685450K .......... .......... .......... .......... .......... 99%  112M 2s
2685500K .......... .......... .......... .......... .......... 99%  120M 2s
2685550K .......... .......... .......... .......... .......... 99%  136M 2s
2685600K .......... .......... .......... .......... .......... 99%  122M 2s
2685650K .......... .......... .......... .......... .......... 99%  121M 2s
2685700K .......... .......... .......... .......... .......... 99%  103M 2s
2685750K .......... .......... .......... .......... .......... 99%  102M 2s
2685800K .......... .......... .......... .......... .......... 99% 95.0M 2s
2685850K .......... .......... .......... .......... .......... 99%  127M 2s
2685900K .......... .......... .......... .......... .......... 99%  110M 2s
2685950K .......... .......... .......... .......... .......... 99%  130M 2s
2686000K .......... .......... .......... .......... .......... 99%  109M 2s
2686050K .......... .......... .......... .......... .......... 99% 79.0M 2s
2686100K .......... .......... .......... .......... .......... 99% 83.1M 2s
2686150K .......... .......... .......... .......... .......... 99% 87.6M 2s
2686200K .......... .......... .......... .......... .......... 99% 8.94M 2s
2686250K .......... .......... .......... .......... .......... 99%  319K 2s
2686300K .......... .......... .......... .......... .......... 99% 62.2M 2s
2686350K .......... .......... .......... .......... .......... 99% 71.4M 2s
2686400K .......... .......... .......... .......... .......... 99% 73.4M 2s
2686450K .......... .......... .......... .......... .......... 99%  115M 2s
2686500K .......... .......... .......... .......... .......... 99% 91.1M 2s
2686550K .......... .......... .......... .......... .......... 99%  132M 2s
2686600K .......... .......... .......... .......... .......... 99% 71.1M 2s
2686650K .......... .......... .......... .......... .......... 99%  132M 2s
2686700K .......... .......... .......... .......... .......... 99%  125M 2s
2686750K .......... .......... .......... .......... .......... 99%  220M 2s
2686800K .......... .......... .......... .......... .......... 99%  150M 2s
2686850K .......... .......... .......... .......... .......... 99%  211M 2s
2686900K .......... .......... .......... .......... .......... 99%  169M 2s
2686950K .......... .......... .......... .......... .......... 99% 76.4M 2s
2687000K .......... .......... .......... .......... .......... 99% 71.1M 2s
2687050K .......... .......... .......... .......... .......... 99%  136M 2s
2687100K .......... .......... .......... .......... .......... 99% 68.2M 2s
2687150K .......... .......... .......... .......... .......... 99% 83.9M 2s
2687200K .......... .......... .......... .......... .......... 99%  116M 2s
2687250K .......... .......... .......... .......... .......... 99% 61.4M 2s
2687300K .......... .......... .......... .......... .......... 99% 8.89M 2s
2687350K .......... .......... .......... .......... .......... 99%  318K 2s
2687400K .......... .......... .......... .......... .......... 99%  108M 2s
2687450K .......... .......... .......... .......... .......... 99%  138M 2s
2687500K .......... .......... .......... .......... .......... 99% 88.1M 2s
2687550K .......... .......... .......... .......... .......... 99% 74.3M 2s
2687600K .......... .......... .......... .......... .......... 99%  131M 2s
2687650K .......... .......... .......... .......... .......... 99%  172M 2s
2687700K .......... .......... .......... .......... .......... 99% 74.1M 2s
2687750K .......... .......... .......... .......... .......... 99%  122M 2s
2687800K .......... .......... .......... .......... .......... 99%  106M 2s
2687850K .......... .......... .......... .......... .......... 99% 95.8M 2s
2687900K .......... .......... .......... .......... .......... 99%  105M 2s
2687950K .......... .......... .......... .......... .......... 99%  119M 2s
2688000K .......... .......... .......... .......... .......... 99%  108M 2s
2688050K .......... .......... .......... .......... .......... 99%  115M 2s
2688100K .......... .......... .......... .......... .......... 99%  111M 2s
2688150K .......... .......... .......... .......... .......... 99%  115M 2s
2688200K .......... .......... .......... .......... .......... 99% 89.3M 2s
2688250K .......... .......... .......... .......... .......... 99%  135M 2s
2688300K .......... .......... .......... .......... .......... 99%  147M 2s
2688350K .......... .......... .......... .......... .......... 99% 72.3M 2s
2688400K .......... .......... .......... .......... .......... 99% 8.42M 2s
2688450K .......... .......... .......... .......... .......... 99%  318K 2s
2688500K .......... .......... .......... .......... .......... 99% 95.5M 2s
2688550K .......... .......... .......... .......... .......... 99%  125M 2s
2688600K .......... .......... .......... .......... .......... 99% 94.3M 2s
2688650K .......... .......... .......... .......... .......... 99% 32.6M 2s
2688700K .......... .......... .......... .......... .......... 99% 49.9M 2s
2688750K .......... .......... .......... .......... .......... 99%  112M 2s
2688800K .......... .......... .......... .......... .......... 99% 40.2M 2s
2688850K .......... .......... .......... .......... .......... 99% 49.2M 2s
2688900K .......... .......... .......... .......... .......... 99% 90.8M 2s
2688950K .......... .......... .......... .......... .......... 99% 45.2M 2s
2689000K .......... .......... .......... .......... .......... 99% 52.2M 2s
2689050K .......... .......... .......... .......... .......... 99%  101M 2s
2689100K .......... .......... .......... .......... .......... 99%  104M 2s
2689150K .......... .......... .......... .......... .......... 99%  124M 2s
2689200K .......... .......... .......... .......... .......... 99% 93.3M 2s
2689250K .......... .......... .......... .......... .......... 99% 92.3M 2s
2689300K .......... .......... .......... .......... .......... 99%  119M 2s
2689350K .......... .......... .......... .......... .......... 99%  136M 2s
2689400K .......... .......... .......... .......... .......... 99%  114M 2s
2689450K .......... .......... .......... .......... .......... 99%  111M 2s
2689500K .......... .......... .......... .......... .......... 99% 21.7M 2s
2689550K .......... .......... .......... .......... .......... 99%  319K 2s
2689600K .......... .......... .......... .......... .......... 99% 41.5M 2s
2689650K .......... .......... .......... .......... .......... 99%  146M 2s
2689700K .......... .......... .......... .......... .......... 99% 55.3M 2s
2689750K .......... .......... .......... .......... .......... 99% 31.0M 2s
2689800K .......... .......... .......... .......... .......... 99% 47.4M 2s
2689850K .......... .......... .......... .......... .......... 99% 40.6M 2s
2689900K .......... .......... .......... .......... .......... 99% 45.1M 2s
2689950K .......... .......... .......... .......... .......... 99% 68.5M 2s
2690000K .......... .......... .......... .......... .......... 99% 36.5M 2s
2690050K .......... .......... .......... .......... .......... 99% 87.4M 2s
2690100K .......... .......... .......... .......... .......... 99%  139M 2s
2690150K .......... .......... .......... .......... .......... 99%  243M 2s
2690200K .......... .......... .......... .......... .......... 99%  195M 2s
2690250K .......... .......... .......... .......... .......... 99%  148M 2s
2690300K .......... .......... .......... .......... .......... 99%  131M 2s
2690350K .......... .......... .......... .......... .......... 99%  209M 2s
2690400K .......... .......... .......... .......... .......... 99%  201M 1s
2690450K .......... .......... .......... .......... .......... 99%  217M 1s
2690500K .......... .......... .......... .......... .......... 99%  161M 1s
2690550K .......... .......... .......... .......... .......... 99%  250M 1s
2690600K .......... .......... .......... .......... .......... 99%  125M 1s
2690650K .......... .......... .......... .......... .......... 99% 1.04M 1s
2690700K .......... .......... .......... .......... .......... 99%  444K 1s
2690750K .......... .......... .......... .......... .......... 99% 48.3M 1s
2690800K .......... .......... .......... .......... .......... 99% 63.1M 1s
2690850K .......... .......... .......... .......... .......... 99% 36.3M 1s
2690900K .......... .......... .......... .......... .......... 99% 33.5M 1s
2690950K .......... .......... .......... .......... .......... 99% 33.4M 1s
2691000K .......... .......... .......... .......... .......... 99% 66.5M 1s
2691050K .......... .......... .......... .......... .......... 99% 93.9M 1s
2691100K .......... .......... .......... .......... .......... 99% 40.9M 1s
2691150K .......... .......... .......... .......... .......... 99% 77.0M 1s
2691200K .......... .......... .......... .......... .......... 99% 95.8M 1s
2691250K .......... .......... .......... .......... .......... 99%  119M 1s
2691300K .......... .......... .......... .......... .......... 99%  141M 1s
2691350K .......... .......... .......... .......... .......... 99% 74.5M 1s
2691400K .......... .......... .......... .......... .......... 99%  111M 1s
2691450K .......... .......... .......... .......... .......... 99%  143M 1s
2691500K .......... .......... .......... .......... .......... 99%  150M 1s
2691550K .......... .......... .......... .......... .......... 99%  145M 1s
2691600K .......... .......... .......... .......... .......... 99%  141M 1s
2691650K .......... .......... .......... .......... .......... 99%  132M 1s
2691700K .......... .......... .......... .......... .......... 99%  114M 1s
2691750K .......... .......... .......... .......... .......... 99%  128M 1s
2691800K .......... .......... .......... .......... .......... 99%  999K 1s
2691850K .......... .......... .......... .......... .......... 99%  455K 1s
2691900K .......... .......... .......... .......... .......... 99% 53.3M 1s
2691950K .......... .......... .......... .......... .......... 99% 34.5M 1s
2692000K .......... .......... .......... .......... .......... 99%  123M 1s
2692050K .......... .......... .......... .......... .......... 99% 93.6M 1s
2692100K .......... .......... .......... .......... .......... 99% 52.8M 1s
2692150K .......... .......... .......... .......... .......... 99% 40.8M 1s
2692200K .......... .......... .......... .......... .......... 99% 89.5M 1s
2692250K .......... .......... .......... .......... .......... 99% 40.6M 1s
2692300K .......... .......... .......... .......... .......... 99%  105M 1s
2692350K .......... .......... .......... .......... .......... 99%  141M 1s
2692400K .......... .......... .......... .......... .......... 99%  153M 1s
2692450K .......... .......... .......... .......... .......... 99%  238M 1s
2692500K .......... .......... .......... .......... .......... 99% 87.1M 1s
2692550K .......... .......... .......... .......... .......... 99%  116M 1s
2692600K .......... .......... .......... .......... .......... 99%  150M 1s
2692650K .......... .......... .......... .......... .......... 99%  103M 1s
2692700K .......... .......... .......... .......... .......... 99%  127M 1s
2692750K .......... .......... .......... .......... .......... 99%  151M 1s
2692800K .......... .......... .......... .......... .......... 99%  125M 1s
2692850K .......... .......... .......... .......... .......... 99%  110M 1s
2692900K .......... .......... .......... .......... .......... 99%  134M 1s
2692950K .......... .......... .......... .......... .......... 99% 1000K 1s
2693000K .......... .......... .......... .......... .......... 99%  456K 1s
2693050K .......... .......... .......... .......... .......... 99% 90.5M 1s
2693100K .......... .......... .......... .......... .......... 99% 87.0M 1s
2693150K .......... .......... .......... .......... .......... 99%  112M 1s
2693200K .......... .......... .......... .......... .......... 99%  102M 1s
2693250K .......... .......... .......... .......... .......... 99%  112M 1s
2693300K .......... .......... .......... .......... .......... 99%  112M 1s
2693350K .......... .......... .......... .......... .......... 99%  133M 1s
2693400K .......... .......... .......... .......... .......... 99%  108M 1s
2693450K .......... .......... .......... .......... .......... 99%  226M 1s
2693500K .......... .......... .......... .......... .......... 99%  153M 1s
2693550K .......... .......... .......... .......... .......... 99%  114M 1s
2693600K .......... .......... .......... .......... .......... 99%  130M 1s
2693650K .......... .......... .......... .......... .......... 99% 98.4M 1s
2693700K .......... .......... .......... .......... .......... 99% 97.8M 1s
2693750K .......... .......... .......... .......... .......... 99%  130M 1s
2693800K .......... .......... .......... .......... .......... 99%  147M 1s
2693850K .......... .......... .......... .......... .......... 99%  108M 1s
2693900K .......... .......... .......... .......... .......... 99% 99.2M 1s
2693950K .......... .......... .......... .......... .......... 99%  171M 1s
2694000K .......... .......... .......... .......... .......... 99%  163M 1s
2694050K .......... .......... .......... .......... .......... 99%  196M 1s
2694100K .......... .......... .......... .......... .......... 99% 19.2M 1s
2694150K .......... .......... .......... .......... .......... 99%  311K 1s
2694200K .......... .......... .......... .......... .......... 99% 76.2M 1s
2694250K .......... .......... .......... .......... .......... 99%  113M 1s
2694300K .......... .......... .......... .......... .......... 99%  104M 1s
2694350K .......... .......... .......... .......... .......... 99%  125M 1s
2694400K .......... .......... .......... .......... .......... 99%  123M 1s
2694450K .......... .......... .......... .......... .......... 99% 99.8M 1s
2694500K .......... .......... .......... .......... .......... 99%  125M 1s
2694550K .......... .......... .......... .......... .......... 99%  112M 1s
2694600K .......... .......... .......... .......... .......... 99%  120M 1s
2694650K .......... .......... .......... .......... .......... 99%  126M 1s
2694700K .......... .......... .......... .......... .......... 99%  110M 1s
2694750K .......... .......... .......... .......... .......... 99%  126M 1s
2694800K .......... .......... .......... .......... .......... 99% 97.0M 1s
2694850K .......... .......... .......... .......... .......... 99%  124M 1s
2694900K .......... .......... .......... .......... .......... 99%  119M 1s
2694950K .......... .......... .......... .......... .......... 99%  160M 1s
2695000K .......... .......... .......... .......... .......... 99%  209M 1s
2695050K .......... .......... .......... .......... .......... 99%  184M 1s
2695100K .......... .......... .......... .......... .......... 99% 26.5M 1s
2695150K .......... .......... .......... .......... .......... 99% 94.8M 1s
2695200K .......... .......... .......... .......... .......... 99% 92.9M 1s
2695250K .......... .......... .......... .......... .......... 99%  149M 1s
2695300K .......... .......... .......... .......... .......... 99% 1.05M 1s
2695350K .......... .......... .......... .......... .......... 99%  434K 1s
2695400K .......... .......... .......... .......... .......... 99% 71.4M 1s
2695450K .......... .......... .......... .......... .......... 99%  131M 1s
2695500K .......... .......... .......... .......... .......... 99%  174M 1s
2695550K .......... .......... .......... .......... .......... 99% 44.6M 1s
2695600K .......... .......... .......... .......... .......... 99%  100M 1s
2695650K .......... .......... .......... .......... .......... 99%  126M 1s
2695700K .......... .......... .......... .......... .......... 99%  108M 1s
2695750K .......... .......... .......... .......... .......... 99%  107M 1s
2695800K .......... .......... .......... .......... .......... 99%  112M 1s
2695850K .......... .......... .......... .......... .......... 99%  135M 1s
2695900K .......... .......... .......... .......... .......... 99%  127M 1s
2695950K .......... .......... .......... .......... .......... 99%  152M 1s
2696000K .......... .......... .......... .......... .......... 99%  118M 1s
2696050K .......... .......... .......... .......... .......... 99%  152M 1s
2696100K .......... .......... .......... .......... .......... 99%  121M 1s
2696150K .......... .......... .......... .......... .......... 99%  133M 1s
2696200K .......... .......... .......... .......... .......... 99%  133M 1s
2696250K .......... .......... .......... .......... .......... 99%  130M 1s
2696300K .......... .......... .......... .......... .......... 99% 8.36M 0s
2696350K .......... .......... .......... .......... .......... 99% 92.0M 0s
2696400K .......... .......... .......... .......... .......... 99%  134M 0s
2696450K .......... .......... .......... .......... .......... 99%  142M 0s
2696500K .......... .......... .......... .......... .......... 99%  553K 0s
2696550K .......... .......... .......... .......... .......... 99%  747K 0s
2696600K .......... .......... .......... .......... .......... 99% 62.7M 0s
2696650K .......... .......... .......... .......... .......... 99%  202M 0s
2696700K .......... .......... .......... .......... .......... 99%  126M 0s
2696750K .......... .......... .......... .......... .......... 99% 44.3M 0s
2696800K .......... .......... .......... .......... .......... 99%  108M 0s
2696850K .......... .......... .......... .......... .......... 99% 98.3M 0s
2696900K .......... .......... .......... .......... .......... 99%  102M 0s
2696950K .......... .......... .......... .......... .......... 99%  145M 0s
2697000K .......... .......... .......... .......... .......... 99%  101M 0s
2697050K .......... .......... .......... .......... .......... 99%  154M 0s
2697100K .......... .......... .......... .......... .......... 99%  125M 0s
2697150K .......... .......... .......... .......... .......... 99%  105M 0s
2697200K .......... .......... .......... .......... .......... 99%  101M 0s
2697250K .......... .......... .......... .......... .......... 99%  131M 0s
2697300K .......... .......... .......... .......... .......... 99%  118M 0s
2697350K .......... .......... .......... .......... .......... 99%  115M 0s
2697400K .......... .......... .......... .......... .......... 99%  102M 0s
2697450K .......... .......... .......... .......... .......... 99% 9.29M 0s
2697500K .......... .......... .......... .......... .......... 99% 85.8M 0s
2697550K .......... .......... .......... .......... .......... 99%  156M 0s
2697600K .......... .......... .......... .......... .......... 99%  137M 0s
2697650K .......... .......... .......... .......... .......... 99%  169M 0s
2697700K .......... .......... .......... .......... .......... 99%  553K 0s
2697750K .......... .......... .......... .......... .......... 99%  748K 0s
2697800K .......... .......... .......... .......... .......... 99% 48.7M 0s
2697850K .......... .......... .......... .......... .......... 99%  126M 0s
2697900K .......... .......... .......... .......... .......... 99%  147M 0s
2697950K .......... .......... .......... .......... .......... 99% 49.3M 0s
2698000K .......... .......... .......... .......... .......... 99%  151M 0s
2698050K .......... .......... .......... .......... .......... 99%  174M 0s
2698100K .......... .......... .......... .......... .......... 99%  162M 0s
2698150K .......... .......... .......... .......... .......... 99%  142M 0s
2698200K .......... .......... .......... .......... .......... 99%  143M 0s
2698250K .......... .......... .......... .......... .......... 99%  135M 0s
2698300K .......... .......... .......... .......... .......... 99%  172M 0s
2698350K .......... .......... .......... .......... .......... 99%  169M 0s
2698400K .......... .......... .......... .......... .......... 99%  118M 0s
2698450K .......... .......... .......... .......... .......... 99%  151M 0s
2698500K .......... .......... .......... .......... .......... 99%  136M 0s
2698550K .......... .......... .......... .......... .......... 99%  102M 0s
2698600K .......... .......... .......... .......... .......... 99%  113M 0s
2698650K .......... .......... .......... .......... .......... 99%  112M 0s
2698700K .......... .......... .......... .......... .......... 99% 7.81M 0s
2698750K .......... .......... .......... .......... .......... 99% 62.8M 0s
2698800K .......... .......... .......... .......... .......... 99%  128M 0s
2698850K .......... .......... .......... .......... .......... 99%  138M 0s
2698900K .......... .......... .......... .......... .......... 99%  587K 0s
2698950K .......... .......... .......... .......... .......... 99%  699K 0s
2699000K .......... .......... .......... .......... .......... 99% 45.4M 0s
2699050K .......... .......... .......... .......... .......... 99%  125M 0s
2699100K .......... .......... .......... .......... .......... 99%  126M 0s
2699150K .......... .......... .......... .......... .......... 99% 50.8M 0s
2699200K .......... .......... .......... .......... .......... 99%  128M 0s
2699250K .......... .......... .......... .......... ......... 100%  129M=7m37s

2020-12-08 10:44:12 (5.77 MB/s) - ‘hls4ml_LHCjet_100p_train.tar.gz.1’ saved [2764083152/2764083152]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tables</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Collecting tables
  Downloading tables-3.6.1-cp37-cp37m-manylinux1_x86_64.whl (4.3 MB)
Requirement already satisfied: numpy&gt;=1.9.3 in /databricks/python3/lib/python3.7/site-packages (from tables) (1.18.1)
Collecting numexpr&gt;=2.6.2
  Downloading numexpr-2.7.1-cp37-cp37m-manylinux1_x86_64.whl (162 kB)
Installing collected packages: numexpr, tables
Successfully installed numexpr-2.7.1 tables-3.6.1
WARNING: You are using pip version 20.0.2; however, version 20.3.1 is available.
You should consider upgrading via the &#39;/databricks/python3/bin/python3.7 -m pip install --upgrade pip&#39; command.
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">## BOOKMARK FROM HERE IMPORTANT</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="c1">## TO HERE</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="n">fps</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;train/*.h5&#39;</span><span class="p">)</span>
<span class="n">all_key_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">]</span>
<span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">all_key_sets</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring due to missing keys in:&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="n">fp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">fp</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">all_key_sets</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">all_keys</span><span class="p">])</span>

<span class="n">data_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;jetImageHCAL&#39;</span><span class="p">,</span> <span class="s1">&#39;jetConstituentList&#39;</span><span class="p">,</span> <span class="s1">&#39;jetImage&#39;</span><span class="p">,</span> <span class="s1">&#39;jetImageECAL&#39;</span><span class="p">,</span> <span class="s1">&#39;jets&#39;</span><span class="p">]</span>
<span class="n">name_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;particleFeatureNames&#39;</span><span class="p">,</span> <span class="s1">&#39;jetFeatureNames&#39;</span><span class="p">]</span>

<span class="k">assert</span><span class="p">(</span><span class="n">all_keys</span> <span class="o">==</span> <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">data_keys</span><span class="p">,</span> <span class="n">name_keys</span><span class="p">))</span>

<span class="n">fps</span> <span class="o">=</span> <span class="p">[</span><span class="n">fp</span> <span class="k">for</span> <span class="n">fp</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">all_key_sets</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">all_keys</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_unique</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
  <span class="n">x0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">x0</span>

<span class="n">jetFeatureNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">get_unique</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;jetFeatureNames&#39;</span><span class="p">][:]</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">)]</span>
<span class="n">particleFeatureNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">get_unique</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;particleFeatureNames&#39;</span><span class="p">][:]</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1">## Initialise writer based on first result</span>
<span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing: &quot;</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
  
  <span class="c1">## for chunk in h5y.File(fp, &#39;r&#39;, chunksize) ... or similar</span>
  
  <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">row_count</span> <span class="o">=</span> <span class="n">get_unique</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">)</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">row_count</span> <span class="o">==</span> <span class="mi">10000</span><span class="p">)</span>
  
  <span class="c1">## 100x100 bitmap per row</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImageHCAL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
  
  <span class="c1">## 100x100 bitmap per row</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImageECAL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
  
  <span class="c1">## 100x100 bitmap per row</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
  
  <span class="n">constituent_count</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetConstituentList&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  
  <span class="k">assert</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">jetFeatureNames</span><span class="p">)))</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetConstituentList&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="n">constituent_count</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">particleFeatureNames</span><span class="p">)))</span>
  
  <span class="c1">## Slow, but works...</span>
  
  <span class="c1">#jets = pa.Table.from_arrays([f[&#39;jets&#39;][:,i] for i,k in enumerate(jetFeatureNames)], names=jetFeatureNames)</span>
  <span class="c1">#print(jets.schema)</span>
  
  <span class="c1">#particles = pa.Table.from_pydict({ k : [f[&#39;jetConstituentList&#39;][:,j,i] for j in range(constituent_count)] for i,k in enumerate(particleFeatureNames) })</span>
  <span class="c1">#print(particles.schema)</span>
  
  <span class="c1">## Messy and a bit slow, but couldn&#39;t coerce the API to do anything slicker</span>
  <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;file&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">fp</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_count</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span> <span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_count</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="n">k</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetConstituentList&#39;</span><span class="p">][:,:,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">particleFeatureNames</span><span class="p">)</span> <span class="p">})</span>
  <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="n">k</span> <span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;jets&#39;</span><span class="p">][:,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">jetFeatureNames</span><span class="p">)</span> <span class="p">})</span>
  <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="s1">&#39;jetImageHCAL&#39;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImageHCAL&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                <span class="s1">&#39;jetImageECAL&#39;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImageECAL&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                <span class="s1">&#39;jetImage&#39;</span>     <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;jetImage&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">})</span>

  <span class="n">data_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
  
  <span class="c1">## print(data_table[&#39;j1_px&#39;])</span>
  
  <span class="k">if</span> <span class="n">writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1">## Initialise writer based on schema from first parsed data</span>
    
    <span class="c1">## BOOKMARK FROM HERE IMPORTANT</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">ParquetWriter</span><span class="p">(</span><span class="s1">&#39;jetImage.parquet&#39;</span><span class="p">,</span> <span class="n">data_table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
    
  <span class="n">writer</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">data_table</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">## TO HERE</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Ignoring due to missing keys in: [(&#39;train/jetImage_7_100p_0_10000.h5&#39;, &lt;KeysViewHDF5 []&gt;)]
Processing:  train/jetImage_4_100p_10000_20000.h5
Processing:  train/jetImage_1_100p_50000_60000.h5
Processing:  train/jetImage_6_100p_40000_50000.h5
Processing:  train/jetImage_1_100p_30000_40000.h5
Processing:  train/jetImage_2_100p_70000_80000.h5
Processing:  train/jetImage_4_100p_80000_90000.h5
Processing:  train/jetImage_3_100p_80000_90000.h5
Processing:  train/jetImage_3_100p_50000_60000.h5
Processing:  train/jetImage_6_100p_0_10000.h5
Processing:  train/jetImage_1_100p_70000_80000.h5
Processing:  train/jetImage_5_100p_0_10000.h5
Processing:  train/jetImage_0_100p_0_10000.h5
Processing:  train/jetImage_1_100p_40000_50000.h5
Processing:  train/jetImage_5_100p_10000_20000.h5
Processing:  train/jetImage_6_100p_60000_70000.h5
Processing:  train/jetImage_6_100p_50000_60000.h5
Processing:  train/jetImage_5_100p_20000_30000.h5
Processing:  train/jetImage_5_100p_30000_40000.h5
Processing:  train/jetImage_7_100p_20000_30000.h5
Processing:  train/jetImage_3_100p_10000_20000.h5
Processing:  train/jetImage_2_100p_40000_50000.h5
Processing:  train/jetImage_0_100p_20000_30000.h5
Processing:  train/jetImage_5_100p_80000_90000.h5
Processing:  train/jetImage_2_100p_0_10000.h5
Processing:  train/jetImage_2_100p_20000_30000.h5
Processing:  train/jetImage_2_100p_60000_70000.h5
Processing:  train/jetImage_4_100p_40000_50000.h5
Processing:  train/jetImage_0_100p_80000_90000.h5
Processing:  train/jetImage_4_100p_50000_60000.h5
Processing:  train/jetImage_3_100p_30000_40000.h5
Processing:  train/jetImage_0_100p_30000_40000.h5
Processing:  train/jetImage_0_100p_70000_80000.h5
Processing:  train/jetImage_2_100p_30000_40000.h5
Processing:  train/jetImage_0_100p_40000_50000.h5
Processing:  train/jetImage_1_100p_0_10000.h5
Processing:  train/jetImage_3_100p_60000_70000.h5
Processing:  train/jetImage_6_100p_10000_20000.h5
Processing:  train/jetImage_6_100p_30000_40000.h5
Processing:  train/jetImage_0_100p_60000_70000.h5
Processing:  train/jetImage_1_100p_80000_90000.h5
Processing:  train/jetImage_5_100p_40000_50000.h5
Processing:  train/jetImage_3_100p_0_10000.h5
Processing:  train/jetImage_0_100p_50000_60000.h5
Processing:  train/jetImage_5_100p_60000_70000.h5
Processing:  train/jetImage_6_100p_20000_30000.h5
Processing:  train/jetImage_4_100p_20000_30000.h5
Processing:  train/jetImage_4_100p_30000_40000.h5
Processing:  train/jetImage_3_100p_40000_50000.h5
Processing:  train/jetImage_4_100p_60000_70000.h5
Processing:  train/jetImage_6_100p_80000_90000.h5
Processing:  train/jetImage_3_100p_70000_80000.h5
Processing:  train/jetImage_5_100p_50000_60000.h5
Processing:  train/jetImage_2_100p_50000_60000.h5
Processing:  train/jetImage_4_100p_70000_80000.h5
Processing:  train/jetImage_2_100p_80000_90000.h5
Processing:  train/jetImage_1_100p_20000_30000.h5
Processing:  train/jetImage_1_100p_60000_70000.h5
Processing:  train/jetImage_2_100p_10000_20000.h5
Processing:  train/jetImage_5_100p_70000_80000.h5
Processing:  train/jetImage_0_100p_10000_20000.h5
Processing:  train/jetImage_1_100p_10000_20000.h5
Processing:  train/jetImage_3_100p_20000_30000.h5
Processing:  train/jetImage_4_100p_0_10000.h5
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">lh</span> <span class="n">jetImage</span><span class="o">.</span><span class="n">parquet</span>
<span class="n">pwd</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-rw-r--r-- 1 root root 6.6G Dec  4 14:21 jetImage.parquet
/databricks/driver
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zcat</span> <span class="n">hls4ml_LHCjet_100p_train</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">|</span> <span class="n">file</span> <span class="o">-</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/dev/stdin: POSIX tar archive (GNU)
</pre></div>
</div>
</div></blockquote>
<p>I am going to download locally and see what’s up… In the mean time
have a read through the links in notebook <code class="docutils literal notranslate"><span class="pre">03_...</span></code> in this directory..
Raaz</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">physics</span><span class="o">/</span><span class="n">LHC</span><span class="o">/</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/jetImage.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p/&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res1: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res6: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p.parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res16: Array[org.apache.spark.sql.Row] = Array([train/jetImage_2_100p_40000_50000.h5,10000], [train/jetImage_2_100p_0_10000.h5,10000], [train/jetImage_5_100p_80000_90000.h5,10000], [train/jetImage_0_100p_20000_30000.h5,10000], [train/jetImage_0_100p_70000_80000.h5,10000], [train/jetImage_3_100p_30000_40000.h5,10000], [train/jetImage_0_100p_30000_40000.h5,10000], [train/jetImage_4_100p_50000_60000.h5,10000], [train/jetImage_4_100p_10000_20000.h5,10000], [train/jetImage_1_100p_30000_40000.h5,10000], [train/jetImage_6_100p_40000_50000.h5,10000], [train/jetImage_1_100p_50000_60000.h5,10000], [train/jetImage_6_100p_50000_60000.h5,10000], [train/jetImage_5_100p_10000_20000.h5,10000], [train/jetImage_1_100p_40000_50000.h5,10000], [train/jetImage_6_100p_60000_70000.h5,10000], [train/jetImage_3_100p_60000_70000.h5,10000], [train/jetImage_0_100p_60000_70000.h5,10000], [train/jetImage_6_100p_30000_40000.h5,10000], [train/jetImage_6_100p_10000_20000.h5,10000], [train/jetImage_5_100p_40000_50000.h5,10000], [train/jetImage_1_100p_80000_90000.h5,10000], [train/jetImage_0_100p_50000_60000.h5,10000], [train/jetImage_3_100p_0_10000.h5,10000], [train/jetImage_5_100p_20000_30000.h5,10000], [train/jetImage_3_100p_10000_20000.h5,10000], [train/jetImage_5_100p_30000_40000.h5,10000], [train/jetImage_7_100p_20000_30000.h5,10000], [train/jetImage_2_100p_30000_40000.h5,10000], [train/jetImage_0_100p_40000_50000.h5,10000], [train/jetImage_1_100p_0_10000.h5,10000], [train/jetImage_4_100p_80000_90000.h5,10000], [train/jetImage_3_100p_50000_60000.h5,10000], [train/jetImage_3_100p_80000_90000.h5,10000], [train/jetImage_2_100p_70000_80000.h5,10000], [train/jetImage_4_100p_30000_40000.h5,10000], [train/jetImage_5_100p_60000_70000.h5,10000], [train/jetImage_4_100p_20000_30000.h5,10000], [train/jetImage_6_100p_20000_30000.h5,10000], [train/jetImage_3_100p_40000_50000.h5,10000], [train/jetImage_6_100p_80000_90000.h5,10000], [train/jetImage_3_100p_70000_80000.h5,10000], [train/jetImage_4_100p_60000_70000.h5,10000], [train/jetImage_4_100p_40000_50000.h5,10000], [train/jetImage_0_100p_80000_90000.h5,10000], [train/jetImage_2_100p_20000_30000.h5,10000], [train/jetImage_2_100p_60000_70000.h5,10000], [train/jetImage_2_100p_50000_60000.h5,10000], [train/jetImage_5_100p_50000_60000.h5,10000], [train/jetImage_2_100p_80000_90000.h5,10000], [train/jetImage_4_100p_70000_80000.h5,10000], [train/jetImage_6_100p_0_10000.h5,10000], [train/jetImage_5_100p_0_10000.h5,10000], [train/jetImage_0_100p_0_10000.h5,10000], [train/jetImage_1_100p_70000_80000.h5,10000], [train/jetImage_1_100p_20000_30000.h5,10000], [train/jetImage_1_100p_60000_70000.h5,10000], [train/jetImage_5_100p_70000_80000.h5,10000], [train/jetImage_2_100p_10000_20000.h5,10000], [train/jetImage_0_100p_10000_20000.h5,10000], [train/jetImage_3_100p_20000_30000.h5,10000], [train/jetImage_1_100p_10000_20000.h5,10000], [train/jetImage_4_100p_0_10000.h5,10000])
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/hls4ml_LHCjet_100p_train.tar.gz&quot;</span><span class="p">,</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res1: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">physics</span><span class="o">/</span><span class="n">LHC</span><span class="o">/</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>At least the file is in dbfs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">possiblyMalformedInput</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>possiblyMalformedInput: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz MapPartitionsRDD[71] at textFile at command-738986526041468:1
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">possiblyMalformedInput</span><span class="o">.</span><span class="n">count</span> <span class="o">//</span> <span class="n">so</span> <span class="n">it</span> <span class="n">reads</span> <span class="n">the</span> <span class="n">lines</span> <span class="n">fine</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res3: Long = 17498163
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">possiblyMalformedInput</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">compressed</span> <span class="n">text</span><span class="p">,</span> <span class="n">but</span> <span class="n">hdf</span> <span class="nb">format</span><span class="o">...</span> <span class="n">so</span> <span class="n">google</span> <span class="n">search</span> <span class="p">(</span><span class="n">perhapos</span> <span class="ow">in</span> <span class="n">incognito</span> <span class="ow">in</span> <span class="n">chrome</span> <span class="ow">or</span> <span class="n">private</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">firefox</span><span class="p">)</span> <span class="k">for</span> 
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res4: Array[String] = Array(train/jetImage_0_100p_0_10000.h5????????????????????????????????????????????????????????????????????0000644?0310007?0005316?00270271115?13605363745?015142? 0????????????????????????????????????????????????????????????????????????????????????????????????????ustar  ?dshep???????????????????????????def-cg?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????�HDF)
</pre></div>
</div>
</div></blockquote>
<p>google search returned</p>
<ul class="simple">
<li><p>first try:
https://forums.databricks.com/questions/22178/how-to-parse-hdf5-file-using-sparkreadformat.html</p></li>
<li><p>deeped dive if needed:
https://www.hdfgroup.org/2015/03/from-hdf5-datasets-to-apache-spark-rdds/</p></li>
<li><p>etc</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.hdfgroup.spark.hdf5._</span> 
<span class="kn">import</span> <span class="nn">org.apache.spark.sql.SparkSession</span> 
<span class="o">//</span><span class="n">val</span> <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="p">()</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Spark SQL HDF5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="n">val</span> <span class="n">df</span><span class="o">=</span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;extension&quot;</span><span class="p">,</span> <span class="s2">&quot;he5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;recursion&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hdf5</span><span class="p">(</span><span class="s2">&quot;/tmp/&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Looks like libraries are needed… One need to recall how the HDF5
connector works and how these files are organized… Raaz</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># try from here ...for mixing python and scala cell-specifically</span>
<span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Out[12]: 2
</pre></div>
</div>
</div></blockquote>
<p>Parquet-ing the already processed h5 files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conf
derby.log
eventlogs
logs
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">## BOOKMARK FROM HERE IMPORTANT</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>

<span class="k">def</span> <span class="nf">get_unique</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
  <span class="n">x0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">x0</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;06_LHC/h5/train_multi_20v_100P.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">data_keys</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">row_count</span> <span class="o">=</span> <span class="n">get_unique</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">)</span>
<span class="c1">#print(len(data_keys))</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">data_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">2</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">3</span><span class="p">]][:]),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">4</span><span class="p">]][:])}</span>
<span class="n">data_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">writer</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">ParquetWriter</span><span class="p">(</span><span class="s1">&#39;train.parquet&#39;</span><span class="p">,</span> <span class="n">data_table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">data_table</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;06_LHC/h5/test_multi_20v_100P.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">data_keys</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">row_count</span> <span class="o">=</span> <span class="n">get_unique</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">)</span>
<span class="c1">#print(len(data_keys))</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">data_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">2</span><span class="p">]][:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">3</span><span class="p">]][:]),</span>
         <span class="n">data_keys</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">data_keys</span><span class="p">[</span><span class="mi">4</span><span class="p">]][:])}</span>
<span class="n">data_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">writer</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">ParquetWriter</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span> <span class="n">data_table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">data_table</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/train.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/train/&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/test.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/test/&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res1: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/train&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/train.parquet&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/test&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/test.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res2: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="n">train</span><span class="o">.</span><span class="n">parquet</span> <span class="mi">06</span><span class="n">_LHC</span>
<span class="n">mv</span> <span class="n">test</span><span class="o">.</span><span class="n">parquet</span> <span class="mi">06</span><span class="n">_LHC</span>
</pre></div>
</div>
</div>
</div>
<p>Preparing data for test</p>
<p>OK THIS WASN’T SO EASY…. ARRAYS NEED TO BE RESHAPED INTO LISTS. SO
READING FROM PARQUET WILL BE COMPLICATED. BEGGING THE QUESTION…. WHY
BOTHER???</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">==</span><span class="mf">1.15</span> 
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Collecting tensorflow==1.15
  Downloading tensorflow-1.15.0-cp37-cp37m-manylinux2010_x86_64.whl (412.3 MB)
Collecting tensorboard&lt;1.16.0,&gt;=1.15.0
  Downloading tensorboard-1.15.0-py3-none-any.whl (3.8 MB)
Collecting termcolor&gt;=1.1.0
  Downloading termcolor-1.1.0.tar.gz (3.9 kB)
Collecting protobuf&gt;=3.6.1
  Downloading protobuf-3.14.0-cp37-cp37m-manylinux1_x86_64.whl (1.0 MB)
Collecting gast==0.2.2
  Downloading gast-0.2.2.tar.gz (10 kB)
Collecting keras-applications&gt;=1.0.8
  Downloading Keras_Applications-1.0.8-py3-none-any.whl (50 kB)
Collecting wrapt&gt;=1.11.1
  Downloading wrapt-1.12.1.tar.gz (27 kB)
Collecting absl-py&gt;=0.7.0
  Downloading absl_py-0.11.0-py3-none-any.whl (127 kB)
Collecting opt-einsum&gt;=2.3.2
  Downloading opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Requirement already satisfied: six&gt;=1.10.0 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (1.14.0)
Requirement already satisfied: wheel&gt;=0.26 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (0.34.2)
Collecting keras-preprocessing&gt;=1.0.5
  Downloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)
Collecting google-pasta&gt;=0.1.6
  Downloading google_pasta-0.2.0-py3-none-any.whl (57 kB)
Collecting astor&gt;=0.6.0
  Downloading astor-0.8.1-py2.py3-none-any.whl (27 kB)
Collecting grpcio&gt;=1.8.6
  Downloading grpcio-1.34.0-cp37-cp37m-manylinux2014_x86_64.whl (3.9 MB)
Requirement already satisfied: numpy&lt;2.0,&gt;=1.16.0 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (1.18.1)
Collecting tensorflow-estimator==1.15.1
  Downloading tensorflow_estimator-1.15.1-py2.py3-none-any.whl (503 kB)
Collecting markdown&gt;=2.6.8
  Downloading Markdown-3.3.3-py3-none-any.whl (96 kB)
Collecting werkzeug&gt;=0.11.15
  Downloading Werkzeug-1.0.1-py2.py3-none-any.whl (298 kB)
Requirement already satisfied: setuptools&gt;=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard&lt;1.16.0,&gt;=1.15.0-&gt;tensorflow==1.15) (45.2.0)
Collecting h5py
  Downloading h5py-3.1.0-cp37-cp37m-manylinux1_x86_64.whl (4.0 MB)
Collecting importlib-metadata; python_version &lt; &quot;3.8&quot;
  Downloading importlib_metadata-3.1.1-py3-none-any.whl (9.6 kB)
Collecting cached-property; python_version &lt; &quot;3.8&quot;
  Downloading cached_property-1.5.2-py2.py3-none-any.whl (7.6 kB)
Collecting zipp&gt;=0.5
  Downloading zipp-3.4.0-py3-none-any.whl (5.2 kB)
Building wheels for collected packages: termcolor, gast, wrapt
  Building wheel for termcolor (setup.py): started
  Building wheel for termcolor (setup.py): finished with status &#39;done&#39;
  Created wheel for termcolor: filename=termcolor-1.1.0-py3-none-any.whl size=4830 sha256=7f7b1093b1e1a4db8723f6d7d8f1f7cc74bbe2a24115c4364fe2011c918333d6
  Stored in directory: /root/.cache/pip/wheels/3f/e3/ec/8a8336ff196023622fbcb36de0c5a5c218cbb24111d1d4c7f2
  Building wheel for gast (setup.py): started
  Building wheel for gast (setup.py): finished with status &#39;done&#39;
  Created wheel for gast: filename=gast-0.2.2-py3-none-any.whl size=7539 sha256=9bdba73c820b9a007a4822b1d7c02afc0cfcd24ea63e362e31403b0a916d0b85
  Stored in directory: /root/.cache/pip/wheels/21/7f/02/420f32a803f7d0967b48dd823da3f558c5166991bfd204eef3
  Building wheel for wrapt (setup.py): started
  Building wheel for wrapt (setup.py): finished with status &#39;done&#39;
  Created wheel for wrapt: filename=wrapt-1.12.1-cp37-cp37m-linux_x86_64.whl size=68653 sha256=d268cc348b28d04df96d2f7470cab7408a0756fc068700c30d2d6d92d055e217
  Stored in directory: /root/.cache/pip/wheels/62/76/4c/aa25851149f3f6d9785f6c869387ad82b3fd37582fa8147ac6
Successfully built termcolor gast wrapt
Installing collected packages: absl-py, zipp, importlib-metadata, markdown, protobuf, werkzeug, grpcio, tensorboard, termcolor, gast, cached-property, h5py, keras-applications, wrapt, opt-einsum, keras-preprocessing, google-pasta, astor, tensorflow-estimator, tensorflow
Successfully installed absl-py-0.11.0 astor-0.8.1 cached-property-1.5.2 gast-0.2.2 google-pasta-0.2.0 grpcio-1.34.0 h5py-3.1.0 importlib-metadata-3.1.1 keras-applications-1.0.8 keras-preprocessing-1.1.2 markdown-3.3.3 opt-einsum-3.3.0 protobuf-3.14.0 tensorboard-1.15.0 tensorflow-1.15.0 tensorflow-estimator-1.15.1 termcolor-1.1.0 werkzeug-1.0.1 wrapt-1.12.1 zipp-3.4.0
WARNING: You are using pip version 20.0.2; however, version 20.3.1 is available.
You should consider upgrading via the &#39;/databricks/python3/bin/python3.7 -m pip install --upgrade pip&#39; command.
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>

<span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">size</span><span class="o">=</span> <span class="mi">1</span>

<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;MNIST-data-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">rank</span><span class="p">)</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[</span><span class="n">rank</span><span class="p">::</span><span class="n">size</span><span class="p">]</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[</span><span class="n">rank</span><span class="p">::</span><span class="n">size</span><span class="p">]</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="n">rank</span><span class="p">::</span><span class="n">size</span><span class="p">]</span>

<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">rank</span><span class="p">::</span><span class="n">size</span><span class="p">]</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="n">x_train</span> <span class="o">/=</span> <span class="mi">255</span>

<span class="n">x_test</span> <span class="o">/=</span> <span class="mi">255</span>

<span class="c1">#y_train = keras.utils.to_categorical(y_train, num_classes)</span>

<span class="c1">#y_test = keras.utils.to_categorical(y_test, num_classes)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Out[32]: (10000, 28, 28, 1)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">## BOOKMARK FROM HERE IMPORTANT</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>

<span class="k">def</span> <span class="nf">get_unique</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
  <span class="n">x0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
  <span class="k">assert</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">x0</span>

<span class="c1">#print(len(data_keys))</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;x_train&#39;</span> <span class="p">:</span> <span class="n">x_train</span><span class="p">,</span>
         <span class="s1">&#39;y_train&#39;</span> <span class="p">:</span> <span class="n">y_train</span><span class="p">}</span>

<span class="n">data_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">writer</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">ParquetWriter</span><span class="p">(</span><span class="s1">&#39;horovod_data_train.parquet&#39;</span><span class="p">,</span> <span class="n">data_table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">data_table</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;x_test&#39;</span> <span class="p">:</span> <span class="n">x_test</span><span class="p">,</span>
         <span class="s1">&#39;y_test&#39;</span> <span class="p">:</span> <span class="n">y_test</span><span class="p">}</span>

<span class="n">data_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">writer</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">ParquetWriter</span><span class="p">(</span><span class="s1">&#39;horovod_data_test.parquet&#39;</span><span class="p">,</span> <span class="n">data_table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">data_table</span><span class="p">)</span>
  
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/horovod_data_train.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_train/&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:////databricks/driver/horovod_data_test.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_test/&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res7: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_train&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_train.parquet&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">mv</span><span class="p">(</span><span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_test&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:///datasets/physics/LHC/horovod_data_test.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res8: Boolean = true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pq</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;horovod_data_test.parquet&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x_test&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Out[34]: pyarrow.Table
x_test: list&lt;item: list&lt;item: list&lt;item: double&gt;&gt;&gt;
  child 0, item: list&lt;item: list&lt;item: double&gt;&gt;
      child 0, item: list&lt;item: double&gt;
          child 0, item: double
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_x_test</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Out[33]: pyarrow.Table
x_test: list&lt;item: list&lt;item: list&lt;item: double&gt;&gt;&gt;
  child 0, item: list&lt;item: list&lt;item: double&gt;&gt;
      child 0, item: list&lt;item: double&gt;
          child 0, item: double
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x_test</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Out[30]: array([[[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]],


       [[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]],


       [[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]],


       ...,


       [[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]],


       [[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]],


       [[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        ...,

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]],

        [[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]]], dtype=float32)
</pre></div>
</div>
</div></blockquote>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks/RaazTiloWork"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>