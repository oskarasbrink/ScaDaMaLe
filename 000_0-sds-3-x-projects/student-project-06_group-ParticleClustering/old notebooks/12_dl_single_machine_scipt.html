
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks/12_dl_single_machine_scipt.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks/12_dl_single_machine_scipt.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="simple nav section-nav flex-column">
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>In this notebook we run the single machine training code.</p>
<p>First we install the dependencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">==</span><span class="mf">1.15</span> 
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name: tensorflow
Version: 1.15.0
Summary: TensorFlow is an open source machine learning framework for everyone.
Home-page: https://www.tensorflow.org/
Author: Google Inc.
Author-email: packages@tensorflow.org
License: Apache 2.0
Location: /local_disk0/.ephemeral_nfs/envs/pythonEnv-c0a9508f-34fb-40b9-a992-5b1f7d42c50e/lib/python3.7/site-packages
Requires: absl-py, protobuf, gast, keras-applications, wrapt, opt-einsum, wheel, keras-preprocessing, termcolor, astor, google-pasta, six, tensorflow-estimator, grpcio, numpy, tensorboard
Required-by: 
</pre></div>
</div>
</div></blockquote>
<p>Run the training of the model using a single machine.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="mi">06</span><span class="n">_LHC</span><span class="o">/</span><span class="n">scripts</span>

<span class="n">python</span> <span class="n">train_kmeans</span><span class="o">.</span><span class="n">py</span>  <span class="o">--</span><span class="n">log_dir</span> <span class="n">FOLDER_NAME</span> 
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cp: cannot stat &#39;/databricks/driver/06_LHC/scripts/models/gapnet_clasify.py.py&#39;: No such file or directory
WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../models/gapnet_classify.py:17: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From train_kmeans.py:105: The name tf.train.exponential_decay is deprecated. Please use tf.compat.v1.train.exponential_decay instead.

WARNING:tensorflow:From train_kmeans.py:129: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:776: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:790: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:152: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:28: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:55: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../models/gapnet_classify.py:38: calling reduce_max_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../utils/tf_util.py:495: The name tf.nn.avg_pool is deprecated. Please use tf.nn.avg_pool2d instead.

WARNING:tensorflow:From /databricks/driver/06_LHC/scripts/../models/gapnet_classify.py:136: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From train_kmeans.py:154: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From train_kmeans.py:161: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From train_kmeans.py:164: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From train_kmeans.py:168: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-12-08 16:47:34.678034: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-12-08 16:47:34.709287: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300085000 Hz
2020-12-08 16:47:34.709820: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x66df620 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-08 16:47:34.709864: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-08 16:47:34.711811: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library &#39;libcuda.so.1&#39;; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-12-08 16:47:34.711849: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: UNKNOWN ERROR (303)
2020-12-08 16:47:34.711890: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (1120-111446-sagas559-10-149-243-59): /proc/driver/nvidia/version does not exist
WARNING:tensorflow:From train_kmeans.py:170: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2020-12-08 16:47:34.839843: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignAdd: CPU 
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  Variable (VariableV2) /device:GPU:0
  Variable/Assign (Assign) /device:GPU:0
  Variable/read (Identity) /device:GPU:0
  Adam/value (Const) /device:GPU:0
  Adam (AssignAdd) /device:GPU:0
  Adam_1/value (Const) /device:GPU:0
  Adam_1 (AssignAdd) /device:GPU:0
  save/Assign_6 (Assign) /device:GPU:0

2020-12-08 16:47:34.840244: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_newfea_conv_head_0/bn/beta (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_layerfilter0_newfea_conv_head_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_layerfilter0_newfea_conv_head_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_141 (Assign) /device:GPU:0
  save/Assign_142 (Assign) /device:GPU:0
  save/Assign_143 (Assign) /device:GPU:0

2020-12-08 16:47:34.840522: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_newfea_conv_head_0/bn/gamma (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/gamma/Adam_1/read (Identity) /device:GPU:0
  Adam/update_layerfilter0_newfea_conv_head_0/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_layerfilter0_newfea_conv_head_0/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_144 (Assign) /device:GPU:0
  save/Assign_145 (Assign) /device:GPU:0
  save/Assign_146 (Assign) /device:GPU:0

2020-12-08 16:47:34.840820: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze/ExponentialMovingAverage/Initializer/zeros (Const) 
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze/ExponentialMovingAverage (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze/ExponentialMovingAverage/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg/sub_1/Switch (Switch) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg/Switch (RefSwitch) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg (AssignSub) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond_1/Switch_1 (Switch) /device:GPU:0
  save/Assign_147 (Assign) /device:GPU:0

2020-12-08 16:47:34.841059: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/layerfilter0_newfea_conv_head_0/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  layerfilter0_newfea_conv_head_0/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_148 (Assign) /device:GPU:0

2020-12-08 16:47:34.841368: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_edgefea_0/bn/beta (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_layerfilter0_edgefea_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_layerfilter0_edgefea_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_116 (Assign) /device:GPU:0
  save/Assign_117 (Assign) /device:GPU:0
  save/Assign_118 (Assign) /device:GPU:0

2020-12-08 16:47:34.841623: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_edgefea_0/bn/gamma (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/gamma/Adam_1/read (Identity) /device:GPU:0
  Adam/update_layerfilter0_edgefea_0/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_layerfilter0_edgefea_0/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_119 (Assign) /device:GPU:0
  save/Assign_120 (Assign) /device:GPU:0
  save/Assign_121 (Assign) /device:GPU:0

2020-12-08 16:47:34.841992: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze/ExponentialMovingAverage/Initializer/zeros (Const) 
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze/ExponentialMovingAverage (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze/ExponentialMovingAverage/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg/sub_1/Switch (Switch) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg/Switch (RefSwitch) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg (AssignSub) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond_1/Switch_1 (Switch) /device:GPU:0
  save/Assign_122 (Assign) /device:GPU:0

2020-12-08 16:47:34.842229: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  layerfilter0_edgefea_0/bn/layerfilter0_edgefea_0/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  layerfilter0_edgefea_0/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_123 (Assign) /device:GPU:0

2020-12-08 16:47:34.842544: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_self_att_conv_head_0/bn/beta (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/read (Identity) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam/read (Identity) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_layerfilter0_self_att_conv_head_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_layerfilter0_self_att_conv_head_0/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_155 (Assign) /device:GPU:0
  save/Assign_156 (Assign) /device:GPU:0
  save/Assign_157 (Assign) /device:GPU:0

2020-12-08 16:47:34.842821: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  layerfilter0_self_att_conv_head_0/bn/gamma (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/read (Identity) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam/read (Identity) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  layerfilter0_self_att_conv_head_0/bn/gamma/Adam_1/read (Identity) /device:GPU:0

*** WARNING: skipped 74241 bytes of output ***

  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  gapnet12/bn/gapnet12/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  gapnet12/bn/gapnet12/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  gapnet12/bn/gapnet12/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  gapnet12/bn/gapnet12/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  gapnet12/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  gapnet12/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  gapnet12/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  gapnet12/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_109 (Assign) /device:GPU:0

2020-12-08 16:47:34.852312: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  agg/bn/beta (VariableV2) /device:GPU:0
  agg/bn/beta/Assign (Assign) /device:GPU:0
  agg/bn/beta/read (Identity) /device:GPU:0
  agg/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  agg/bn/beta/Adam (VariableV2) /device:GPU:0
  agg/bn/beta/Adam/Assign (Assign) /device:GPU:0
  agg/bn/beta/Adam/read (Identity) /device:GPU:0
  agg/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  agg/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  agg/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  agg/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_agg/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_agg/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_12 (Assign) /device:GPU:0
  save/Assign_13 (Assign) /device:GPU:0
  save/Assign_14 (Assign) /device:GPU:0

2020-12-08 16:47:34.852568: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  agg/bn/gamma (VariableV2) /device:GPU:0
  agg/bn/gamma/Assign (Assign) /device:GPU:0
  agg/bn/gamma/read (Identity) /device:GPU:0
  agg/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  agg/bn/gamma/Adam (VariableV2) /device:GPU:0
  agg/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  agg/bn/gamma/Adam/read (Identity) /device:GPU:0
  agg/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  agg/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  agg/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  agg/bn/gamma/Adam_1/read (Identity) /device:GPU:0
  Adam/update_agg/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_agg/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_15 (Assign) /device:GPU:0
  save/Assign_16 (Assign) /device:GPU:0
  save/Assign_17 (Assign) /device:GPU:0

2020-12-08 16:47:34.852876: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  agg/bn/agg/bn/moments/Squeeze/ExponentialMovingAverage/Initializer/zeros (Const) 
  agg/bn/agg/bn/moments/Squeeze/ExponentialMovingAverage (VariableV2) /device:GPU:0
  agg/bn/agg/bn/moments/Squeeze/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  agg/bn/agg/bn/moments/Squeeze/ExponentialMovingAverage/read (Identity) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg/sub_1/Switch (Switch) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg/Switch (RefSwitch) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg (AssignSub) /device:GPU:0
  agg/bn/cond_1/Switch_1 (Switch) /device:GPU:0
  save/Assign_10 (Assign) /device:GPU:0

2020-12-08 16:47:34.853132: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  agg/bn/agg/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  agg/bn/agg/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  agg/bn/agg/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  agg/bn/agg/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  agg/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  agg/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_11 (Assign) /device:GPU:0

2020-12-08 16:47:34.853491: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc1/bn/beta (VariableV2) /device:GPU:0
  fc1/bn/beta/Assign (Assign) /device:GPU:0
  fc1/bn/beta/read (Identity) /device:GPU:0
  fc1/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  fc1/bn/beta/Adam (VariableV2) /device:GPU:0
  fc1/bn/beta/Adam/Assign (Assign) /device:GPU:0
  fc1/bn/beta/Adam/read (Identity) /device:GPU:0
  fc1/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  fc1/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  fc1/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  fc1/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_fc1/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_fc1/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_26 (Assign) /device:GPU:0
  save/Assign_27 (Assign) /device:GPU:0
  save/Assign_28 (Assign) /device:GPU:0

2020-12-08 16:47:34.853750: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc1/bn/gamma (VariableV2) /device:GPU:0
  fc1/bn/gamma/Assign (Assign) /device:GPU:0
  fc1/bn/gamma/read (Identity) /device:GPU:0
  fc1/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  fc1/bn/gamma/Adam (VariableV2) /device:GPU:0
  fc1/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  fc1/bn/gamma/Adam/read (Identity) /device:GPU:0
  fc1/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  fc1/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  fc1/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  fc1/bn/gamma/Adam_1/read (Identity) /device:GPU:0
  Adam/update_fc1/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_fc1/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_31 (Assign) /device:GPU:0
  save/Assign_32 (Assign) /device:GPU:0
  save/Assign_33 (Assign) /device:GPU:0

2020-12-08 16:47:34.854034: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc1/bn/fc1/bn/moments/Squeeze/ExponentialMovingAverage/Initializer/zeros (Const) 
  fc1/bn/fc1/bn/moments/Squeeze/ExponentialMovingAverage (VariableV2) /device:GPU:0
  fc1/bn/fc1/bn/moments/Squeeze/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  fc1/bn/fc1/bn/moments/Squeeze/ExponentialMovingAverage/read (Identity) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg/sub_1/Switch (Switch) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg/Switch (RefSwitch) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg (AssignSub) /device:GPU:0
  fc1/bn/cond_1/Switch_1 (Switch) /device:GPU:0
  save/Assign_29 (Assign) /device:GPU:0

2020-12-08 16:47:34.854269: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc1/bn/fc1/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  fc1/bn/fc1/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  fc1/bn/fc1/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  fc1/bn/fc1/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  fc1/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  fc1/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_30 (Assign) /device:GPU:0

2020-12-08 16:47:34.854590: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc2/bn/beta (VariableV2) /device:GPU:0
  fc2/bn/beta/Assign (Assign) /device:GPU:0
  fc2/bn/beta/read (Identity) /device:GPU:0
  fc2/bn/beta/Adam/Initializer/zeros (Const) /device:GPU:0
  fc2/bn/beta/Adam (VariableV2) /device:GPU:0
  fc2/bn/beta/Adam/Assign (Assign) /device:GPU:0
  fc2/bn/beta/Adam/read (Identity) /device:GPU:0
  fc2/bn/beta/Adam_1/Initializer/zeros (Const) /device:GPU:0
  fc2/bn/beta/Adam_1 (VariableV2) /device:GPU:0
  fc2/bn/beta/Adam_1/Assign (Assign) /device:GPU:0
  fc2/bn/beta/Adam_1/read (Identity) /device:GPU:0
  Adam/update_fc2/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_fc2/bn/beta/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_40 (Assign) /device:GPU:0
  save/Assign_41 (Assign) /device:GPU:0
  save/Assign_42 (Assign) /device:GPU:0

2020-12-08 16:47:34.854846: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc2/bn/gamma (VariableV2) /device:GPU:0
  fc2/bn/gamma/Assign (Assign) /device:GPU:0
  fc2/bn/gamma/read (Identity) /device:GPU:0
  fc2/bn/gamma/Adam/Initializer/zeros (Const) /device:GPU:0
  fc2/bn/gamma/Adam (VariableV2) /device:GPU:0
  fc2/bn/gamma/Adam/Assign (Assign) /device:GPU:0
  fc2/bn/gamma/Adam/read (Identity) /device:GPU:0
  fc2/bn/gamma/Adam_1/Initializer/zeros (Const) /device:GPU:0
  fc2/bn/gamma/Adam_1 (VariableV2) /device:GPU:0
  fc2/bn/gamma/Adam_1/Assign (Assign) /device:GPU:0
  fc2/bn/gamma/Adam_1/read (Identity) /device:GPU:0
  Adam/update_fc2/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  Adam_1/update_fc2/bn/gamma/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_45 (Assign) /device:GPU:0
  save/Assign_46 (Assign) /device:GPU:0
  save/Assign_47 (Assign) /device:GPU:0

2020-12-08 16:47:34.855106: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc2/bn/fc2/bn/moments/Squeeze/ExponentialMovingAverage/Initializer/zeros (Const) 
  fc2/bn/fc2/bn/moments/Squeeze/ExponentialMovingAverage (VariableV2) /device:GPU:0
  fc2/bn/fc2/bn/moments/Squeeze/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  fc2/bn/fc2/bn/moments/Squeeze/ExponentialMovingAverage/read (Identity) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg/sub_1/Switch (Switch) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg/Switch (RefSwitch) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg (AssignSub) /device:GPU:0
  fc2/bn/cond_1/Switch_1 (Switch) /device:GPU:0
  save/Assign_43 (Assign) /device:GPU:0

2020-12-08 16:47:34.855355: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
AssignSub: CPU 
Const: CPU XLA_CPU 
Switch: CPU XLA_CPU 
Assign: CPU 
VariableV2: CPU 
Identity: CPU XLA_CPU 
RefSwitch: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  fc2/bn/fc2/bn/moments/Squeeze_1/ExponentialMovingAverage/Initializer/zeros (Const) 
  fc2/bn/fc2/bn/moments/Squeeze_1/ExponentialMovingAverage (VariableV2) /device:GPU:0
  fc2/bn/fc2/bn/moments/Squeeze_1/ExponentialMovingAverage/Assign (Assign) /device:GPU:0
  fc2/bn/fc2/bn/moments/Squeeze_1/ExponentialMovingAverage/read (Identity) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/sub_1/Switch (Switch) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1/Switch (RefSwitch) /device:GPU:0
  fc2/bn/cond/ExponentialMovingAverage/AssignMovingAvg_1 (AssignSub) /device:GPU:0
  fc2/bn/cond_1/Switch_2 (Switch) /device:GPU:0
  save/Assign_44 (Assign) /device:GPU:0

2020-12-08 16:47:34.855728: W tensorflow/core/common_runtime/colocation_graph.cc:983] Failed to place the graph without changing the devices of some resources. Some of the operations (that had to be colocated with resource generating operations) are not supported on the resources&#39; devices. Current candidate devices are [
  /job:localhost/replica:0/task:0/device:CPU:0].
See below for details of this colocation group:
Colocation Debug Info:
Colocation group had the following types and supported devices: 
Root Member(assigned_device_name_index_=-1 requested_device_name_=&#39;/device:GPU:0&#39; assigned_device_name_=&#39;&#39; resource_device_name_=&#39;/device:GPU:0&#39; supported_device_types_=[CPU] possible_devices_=[]
Const: CPU XLA_CPU 
Identity: CPU XLA_CPU 
ApplyAdam: CPU 
VariableV2: CPU 
Assign: CPU 

Colocation members, user-requested devices, and framework assigned devices, if any:
  mu (VariableV2) /device:GPU:0
  mu/Assign (Assign) /device:GPU:0
  mu/read (Identity) /device:GPU:0
  mu/Adam/Initializer/zeros (Const) /device:GPU:0
  mu/Adam (VariableV2) /device:GPU:0
  mu/Adam/Assign (Assign) /device:GPU:0
  mu/Adam/read (Identity) /device:GPU:0
  mu/Adam_1/Initializer/zeros (Const) /device:GPU:0
  mu/Adam_1 (VariableV2) /device:GPU:0
  mu/Adam_1/Assign (Assign) /device:GPU:0
  mu/Adam_1/read (Identity) /device:GPU:0
  Adam/update_mu/ApplyAdam (ApplyAdam) /device:GPU:0
  save/Assign_219 (Assign) /device:GPU:0
  save/Assign_220 (Assign) /device:GPU:0
  save/Assign_221 (Assign) /device:GPU:0

WARNING:tensorflow:From train_kmeans.py:175: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

WARNING:tensorflow:From train_kmeans.py:176: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From train_kmeans.py:180: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

pid: 20449
--- Get model and loss
--- Get training operator
Total number of weights for the model:  186211.0
**** EPOCH 000 ****
2020-12-08 16:47:57.420472: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 262144000 exceeds 10% of system memory.
2020-12-08 16:47:57.663760: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 262144000 exceeds 10% of system memory.
2020-12-08 16:47:58.020343: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 262144000 exceeds 10% of system memory.
2020-12-08 16:47:58.219301: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 262144000 exceeds 10% of system memory.
2020-12-08 16:47:58.816135: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 262144000 exceeds 10% of system memory.
loaded 302664 events
2020-12-08 16:47:56.071269
learning rate: 0.001000
train mean loss: 2.814424
train clustering accuracy: 0.000000
loaded 75666 events
test mean loss: 1.624215
testing clustering accuracy: 0.000000
Model saved in file: ../logs/FOLDER_NAME/model.ckpt
**** EPOCH 001 ****
loaded 302664 events
2020-12-08 17:41:31.666040
learning rate: 0.000500
train mean loss: 0.957961
train clustering accuracy: 0.000000
loaded 75666 events
test mean loss: 1.144227
testing clustering accuracy: 0.000000
Model saved in file: ../logs/FOLDER_NAME/model.ckpt
**** EPOCH 002 ****
loaded 302664 events
2020-12-08 18:34:13.333730
learning rate: 0.000500
train mean loss: 0.795200
train clustering accuracy: 0.000000
loaded 75666 events
test mean loss: 1.040589
testing clustering accuracy: 0.000000
Model saved in file: ../logs/FOLDER_NAME/model.ckpt
**** EPOCH 003 ****
loaded 302664 events
2020-12-08 19:26:30.352318
learning rate: 0.000250
train mean loss: 0.697213
train clustering accuracy: 0.000000
loaded 75666 events
test mean loss: 1.019679
testing clustering accuracy: 0.000000
Model saved in file: ../logs/FOLDER_NAME/model.ckpt
**** EPOCH 004 ****
</pre></div>
</div>
</div></blockquote>
<p>TODO: test if evaluation of the model runs as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="mi">06</span><span class="n">_LHC</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">FOLDER_NAME</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>checkpoint
cluster.ckpt.data-00000-of-00001
cluster.ckpt.index
cluster.ckpt.meta
log_dkm.txt
model.ckpt.data-00000-of-00001
model.ckpt.index
model.ckpt.meta
test
train
train_kmeans.py
</pre></div>
</div>
</div></blockquote>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-06_group-ParticleClustering/old notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>